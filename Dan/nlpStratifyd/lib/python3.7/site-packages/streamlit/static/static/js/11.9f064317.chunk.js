(window["webpackJsonpstreamlit-browser"]=window["webpackJsonpstreamlit-browser"]||[]).push([[11],{1469:function(e,t,n){!function(e){"use strict";function t(e,t,n){return e.fields=t||[],e.fname=n,e}function n(e){return null==e?null:e.fields}function r(e){throw Error(e)}function i(e){var t,n,i,a=[],o=null,u=0,s=e.length,l="";function c(){a.push(l+e.substring(t,n)),l="",t=n+1}for(e+="",t=n=0;n<s;++n)if("\\"===(i=e[n]))l+=e.substring(t,n),t=++n;else if(i===o)c(),o=null,u=-1;else{if(o)continue;t===u&&'"'===i?(t=n+1,o=i):t===u&&"'"===i?(t=n+1,o=i):"."!==i||u?"["===i?(n>t&&c(),u=t=n+1):"]"===i&&(u||r("Access path missing open bracket: "+e),u>0&&c(),u=0,t=n+1):n>t?c():t=n+1}return u&&r("Access path missing closing bracket: "+e),o&&r("Access path missing closing quote: "+e),n>t&&(n++,c()),a}var a=Array.isArray;function o(e){return e===Object(e)}function u(e){return"string"===typeof e}function s(e){return a(e)?"["+e.map(s)+"]":o(e)||u(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function l(e,n){var r=i(e),a="return _["+r.map(s).join("][")+"];";return t(Function("_",a),[e=1===r.length?r[0]:e],n||e)}var c=[],f=l("id"),d=t(function(e){return e},c,"identity"),h=t(function(){return 0},c,"zero"),p=t(function(){return 1},c,"one"),v=t(function(){return!0},c,"true"),m=t(function(){return!1},c,"false");function g(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var y=0,b=1,x=2,w=3,k=4;function A(e,t,n,r){var i,u;if(o(n)&&!a(n))for(i in u=o(e[t])?e[t]:e[t]={},n)r&&(!0===r||r[i])?A(u,i,n[i]):u[i]=n[i];else e[t]=n}function E(e,t){if(null==e)return t;var n={},r=[];function i(e){n[e.name]||(n[e.name]=1,r.push(e))}return t.forEach(i),e.forEach(i),r}function D(e){return e[e.length-1]}function C(e){return null==e||""===e?null:+e}function O(e){return function(t){return e*Math.exp(t)}}function F(e){return function(t){return Math.log(e*t)}}function _(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function S(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function M(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function j(e,t,n,r){var i=n(e[0]),a=n(D(e)),o=(a-i)*t;return[r(i-o),r(a-o)]}function T(e,t,n,r,i){var a=r(e[0]),o=r(D(e)),u=null!=t?r(t):(a+o)/2;return[i(u+(a-u)*n),i(u+(o-u)*n)]}function N(e){return null!=e?a(e)?e:[e]:[]}function B(e){return"function"===typeof e}var R=Object.prototype.hasOwnProperty;function z(e,t){return R.call(e,t)}var P={};function L(e){return"[object Date]"===Object.prototype.toString.call(e)}function I(e){return"number"===typeof e}function U(e,t){for(var n="";--t>=0;)n+=e;return n}function q(e){return I(e)?e:L(e)?e:Date.parse(e)}e.Debug=k,e.Error=b,e.Info=w,e.None=y,e.Warn=x,e.accessor=t,e.accessorFields=n,e.accessorName=function(e){return null==e?null:e.fname},e.array=N,e.clampRange=function(e,t,n){var r,i=e[0],a=e[1];return a<i&&(r=a,a=i,i=r),(r=a-i)>=n-t?[t,n]:[i=Math.min(Math.max(i,t),n-r),i+r]},e.compare=function(e,r){var a,o,u,l,c,f,d,h,p,v=[],m=(e=N(e)).map(function(e,t){return null==e?null:(v.push(t),B(e)?e:i(e).map(s).join("]["))}),g=v.length-1,y=N(r),b="var u,v;return ";if(g<0)return null;for(o=0;o<=g;++o)B(u=m[a=v[o]])?(l="(u=this."+(f="f"+a)+"(a))",c="(v=this."+f+"(b))",(d=d||{})[f]=u):(l="(u=a["+u+"])",c="(v=b["+u+"])"),f="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))","descending"!==y[a]?(p=1,h=-1):(p=-1,h=1),b+="("+l+"<"+c+"||u==null)&&v!=null?"+h+":(u>v||v==null)&&u!=null?"+p+":"+f+"!==u&&v===v?"+h+":v!==v&&u===u?"+p+(a<g?":":":0");return u=Function("a","b",b+";"),d&&(u=u.bind(d)),e=e.reduce(function(e,t){return B(t)?(n(t)||[]).forEach(function(t){e[t]=1}):null!=t&&(e[t+""]=1),e},{}),t(u,Object.keys(e))},e.constant=function(e){return B(e)?e:function(){return e}},e.debounce=function(e,t){var n,r;function i(){t(r),n=r=null}return function(t){r=t,n&&clearTimeout(n),n=setTimeout(i,e)}},e.error=r,e.extend=function(e){for(var t,n,r=1,i=arguments.length;r<i;++r)for(n in t=arguments[r])e[n]=t[n];return e},e.extent=function(e,t){var n,r,i,a,o=0;if(e&&(n=e.length))if(null==t){for(r=e[o];null==r||r!==r;r=e[++o]);for(i=a=r;o<n;++o)null!=(r=e[o])&&(r<i&&(i=r),r>a&&(a=r))}else{for(r=t(e[o]);null==r||r!==r;r=t(e[++o]));for(i=a=r;o<n;++o)null!=(r=t(e[o]))&&(r<i&&(i=r),r>a&&(a=r))}return[i,a]},e.extentIndex=function(e,t){var n,r,i,a,o,u=-1,s=e.length;if(null==t){for(;++u<s;)if(null!=(r=e[u])&&r>=r){n=i=r;break}for(a=o=u;++u<s;)null!=(r=e[u])&&(n>r&&(n=r,a=u),i<r&&(i=r,o=u))}else{for(;++u<s;)if(null!=(r=t(e[u],u,e))&&r>=r){n=i=r;break}for(a=o=u;++u<s;)null!=(r=t(e[u],u,e))&&(n>r&&(n=r,a=u),i<r&&(i=r,o=u))}return[a,o]},e.falsy=m,e.fastmap=function(e){var t,n,r={};function i(e){return z(r,e)&&r[e]!==P}return t={size:0,empty:0,object:r,has:i,get:function(e){return i(e)?r[e]:void 0},set:function(e,n){return i(e)||(++t.size,r[e]===P&&--t.empty),r[e]=n,this},delete:function(e){return i(e)&&(--t.size,++t.empty,r[e]=P),this},clear:function(){t.size=t.empty=0,t.object=r={}},test:function(e){return arguments.length?(n=e,t):n},clean:function(){var e,i,a={},o=0;for(e in r)(i=r[e])===P||n&&n(i)||(a[e]=i,++o);t.size=o,t.empty=0,t.object=r=a}},e&&Object.keys(e).forEach(function(n){t.set(n,e[n])}),t},e.field=l,e.flush=function(e,t,n,r,i,a){if(!n&&0!==n)return a;var o,u,s=e[0],l=D(e),c=+n;return l<s&&(o=s,s=l,l=o),(o=Math.abs(t-s))<(u=Math.abs(l-t))&&o<=c?r:u<=c?i:a},e.hasOwnProperty=z,e.id=f,e.identity=d,e.inherits=function(e,t){var n=e.prototype=Object.create(t.prototype);return n.constructor=e,n},e.inrange=function(e,t,n,r){var i,a=t[0],o=t[t.length-1];return a>o&&(i=a,a=o,o=i),r=void 0===r||r,((n=void 0===n||n)?a<=e:a<e)&&(r?e<=o:e<o)},e.isArray=a,e.isBoolean=function(e){return"boolean"===typeof e},e.isDate=L,e.isFunction=B,e.isNumber=I,e.isObject=o,e.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},e.isString=u,e.key=function(e,n){return e&&(e=n?N(e).map(function(e){return e.replace(/\\(.)/g,"$1")}):N(e)),t(e&&e.length?Function("_","return ''+"+e.map(function(e){return"_["+(n?s(e):i(e).map(s).join("]["))+"]"}).join("+'|'+")+";"):function(){return""},e,"key")},e.lerp=function(e,t){var n=e[0],r=D(e),i=+t;return i?1===i?r:n+i*(r-n):n},e.logger=function(e,t){var n=e||y;return{level:function(e){return arguments.length?(n=+e,this):n},error:function(){return n>=b&&g(t||"error","ERROR",arguments),this},warn:function(){return n>=x&&g(t||"warn","WARN",arguments),this},info:function(){return n>=w&&g(t||"log","INFO",arguments),this},debug:function(){return n>=k&&g(t||"log","DEBUG",arguments),this}}},e.merge=function(e,t,n,r){var i=t.length,a=n.length;if(!a)return t;if(!i)return n;for(var o=r||new t.constructor(i+a),u=0,s=0,l=0;u<i&&s<a;++l)o[l]=e(t[u],n[s])>0?n[s++]:t[u++];for(;u<i;++u,++l)o[l]=t[u];for(;s<a;++s,++l)o[l]=n[s];return o},e.mergeConfig=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){for(var n in t)if("signals"===n)e.signals=E(e.signals,t.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;A(e,n,t[n],r)}return e},{})},e.one=p,e.pad=function(e,t,n,r){var i=n||" ",a=e+"",o=t-a.length;return o<=0?a:"left"===r?U(i,o)+a:"center"===r?U(i,~~(o/2))+a+U(i,Math.ceil(o/2)):a+U(i,o)},e.panLinear=function(e,t){return j(e,t,C,d)},e.panLog=function(e,t){var n=Math.sign(e[0]);return j(e,t,F(n),O(n))},e.panPow=function(e,t,n){return j(e,t,M(n),M(1/n))},e.panSymlog=function(e,t,n){return j(e,t,_(n),S(n))},e.peek=D,e.quarter=function(e){return 1+~~(new Date(e).getMonth()/3)},e.repeat=U,e.span=function(e){return e&&D(e)-e[0]||0},e.splitAccessPath=i,e.stringValue=s,e.toBoolean=function(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e)&&!!e},e.toDate=function(e,t){return t=t||q,null==e||""===e?null:t(e)},e.toNumber=C,e.toSet=function(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t},e.toString=function(e){return null==e||""===e?null:e+""},e.truncate=function(e,t,n,r){var i=null!=r?r:"\u2026",a=e+"",o=a.length,u=Math.max(0,t-i.length);return o<=t?a:"left"===n?i+a.slice(o-u):"center"===n?a.slice(0,Math.ceil(u/2))+i+a.slice(o-~~(u/2)):a.slice(0,u)+i},e.truthy=v,e.utcquarter=function(e){return 1+~~(new Date(e).getUTCMonth()/3)},e.visitArray=function(e,t,n){if(e){var r,i=0,a=e.length;if(t)for(;i<a;++i)(r=t(e[i]))&&n(r,i,e);else e.forEach(n)}},e.writeConfig=A,e.zero=h,e.zoomLinear=function(e,t,n){return T(e,t,n,C,d)},e.zoomLog=function(e,t,n){var r=Math.sign(e[0]);return T(e,t,n,F(r),O(r))},e.zoomPow=function(e,t,n,r){return T(e,t,n,M(r),M(1/r))},e.zoomSymlog=function(e,t,n,r){return T(e,t,n,_(r),S(r))},Object.defineProperty(e,"__esModule",{value:!0})}(t)},1476:function(e,t,n){var r=n(21),i=n(1622);!function(e,t,n){"use strict";function a(e){var n=e||t.identity,r=[],i={};return r.add=function(e){var t=n(e);return i[t]||(i[t]=1,r.push(e)),r},r.remove=function(e){var t,a=n(e);return i[a]&&(i[a]=0,(t=r.indexOf(e))>=0&&r.splice(t,1)),r},r}function o(e,t){return u.apply(this,arguments)}function u(){return(u=i(r.mark(function e(t,n){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),t.error(e.t0);case 8:case"end":return e.stop()}},e,null,[[0,5]])}))).apply(this,arguments)}var s=Symbol("vega_id"),l=1;function c(e){return e[s]}function f(e,t){return e[s]=t,e}function d(e){var t=e===Object(e)?e:{data:e};return c(t)?t:f(t,l++)}function h(e,t){for(var n in e)t[n]=e[n];return t}function p(e){return e&&e.constructor===v}function v(){var e=[],n=[],r=[],i=[],a=[],o=!1;return{constructor:v,insert:function(n){for(var r=t.array(n),i=0,a=r.length;i<a;++i)e.push(r[i]);return this},remove:function(e){for(var r=t.isFunction(e)?i:n,a=t.array(e),o=0,u=a.length;o<u;++o)r.push(a[o]);return this},modify:function(e,n,i){var o={field:n,value:t.constant(i)};return t.isFunction(e)?(o.filter=e,a.push(o)):(o.tuple=e,r.push(o)),this},encode:function(e,n){return t.isFunction(e)?a.push({filter:e,field:n}):r.push({tuple:e,field:n}),this},reflow:function(){return o=!0,this},pulse:function(t,u){var s,l,f,h,p,v,m={},g={};for(s=0,l=u.length;s<l;++s)m[c(u[s])]=1;for(s=0,l=n.length;s<l;++s)m[c(p=n[s])]=-1;for(s=0,l=i.length;s<l;++s)h=i[s],u.forEach(function(e){h(e)&&(m[c(e)]=-1)});for(s=0,l=e.length;s<l;++s)v=c(p=e[s]),m[v]?m[v]=1:t.add.push(d(e[s]));for(s=0,l=u.length;s<l;++s)p=u[s],m[c(p)]<0&&t.rem.push(p);function y(e,n,r){r?e[n]=r(e):t.encode=n,o||(g[c(e)]=e)}for(s=0,l=r.length;s<l;++s)p=(f=r[s]).tuple,h=f.field,(v=m[c(p)])>0&&(y(p,h,f.value),t.modifies(h));for(s=0,l=a.length;s<l;++s)f=a[s],h=f.filter,u.forEach(function(e){h(e)&&m[c(e)]>0&&y(e,f.field,f.value)}),t.modifies(f.field);if(o)t.mod=n.length||i.length?u.filter(function(e){return m[c(e)]>0}):u.slice();else for(v in g)t.mod.push(g[v]);return t}}}var m="_:mod:_";function g(){Object.defineProperty(this,m,{writable:!0,value:{}})}var y=g.prototype;y.set=function(e,n,r,i){var a=this,o=a[e],u=a[m];return null!=n&&n>=0?(o[n]!==r||i)&&(o[n]=r,u[n+":"+e]=-1,u[e]=-1):(o!==r||i)&&(a[e]=r,u[e]=t.isArray(r)?1+r.length:-1),a},y.modified=function(e,n){var r,i=this[m];if(!arguments.length){for(r in i)if(i[r])return!0;return!1}if(t.isArray(e)){for(r=0;r<e.length;++r)if(i[e[r]])return!0;return!1}return null!=n&&n>=0?n+1<i[e]||!!i[n+":"+e]:!!i[e]},y.clear=function(){return this[m]={},this};var b=0,x=new g;function w(e,t,n,r){this.id=++b,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}var k=w.prototype;function A(e){return function(t){var n=this.flags;return 0===arguments.length?!!(n&e):(this.flags=t?n|e:n&~e,this)}}k.targets=function(){return this._targets||(this._targets=a(t.id))},k.set=function(e){return this.value!==e?(this.value=e,1):0},k.skip=A(1),k.modified=A(2),k.parameters=function(e,n,r){n=!1!==n;var i,a,o,u,s=this,l=s._argval=s._argval||new g,c=s._argops=s._argops||[],f=[];function d(e,t,r){r instanceof w?(r!==s&&(n&&r.targets().add(s),f.push(r)),c.push({op:r,name:e,index:t})):l.set(e,t,r)}for(i in e)if(a=e[i],"pulse"===i)t.array(a).forEach(function(e){e instanceof w?e!==s&&(e.targets().add(s),f.push(e)):t.error("Pulse parameters must be operator instances.")}),s.source=a;else if(t.isArray(a))for(l.set(i,-1,Array(o=a.length)),u=0;u<o;++u)d(i,u,a[u]);else d(i,-1,a);return this.marshall().clear(),r&&(c.initonly=!0),f},k.marshall=function(e){var t,n,r,i,a,o=this._argval||x,u=this._argops;if(u){for(n=0,r=u.length;n<r;++n)a=(i=(t=u[n]).op).modified()&&i.stamp===e,o.set(t.name,t.index,i.value,a);if(u.initonly){for(n=0;n<r;++n)(t=u[n]).op.targets().remove(this);this._argops=null,this._update=null}}return o},k.evaluate=function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},k.run=function(e){return e.stamp<this.stamp?e.StopPropagation:(this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e);var t};var E=0;function D(e,t,n){this.id=++E,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function C(e,t,n){return new D(e,t,n)}var O=D.prototype;O._filter=t.truthy,O._apply=t.identity,O.targets=function(){return this._targets||(this._targets=a(t.id))},O.consume=function(e){return arguments.length?(this._consume=!!e,this):!!this._consume},O.receive=function(e){if(this._filter(e)){for(var t=this.value=this._apply(e),n=this._targets,r=n?n.length:0,i=0;i<r;++i)n[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},O.filter=function(e){var t=C(e);return this.targets().add(t),t},O.apply=function(e){var t=C(null,e);return this.targets().add(t),t},O.merge=function(){var e=C();this.targets().add(e);for(var t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},O.throttle=function(e){var t=-1;return this.filter(function(){var n=Date.now();return n-t>e?(t=n,1):0})},O.debounce=function(e){var n=C();return this.targets().add(C(null,null,t.debounce(e,function(e){var t=e.dataflow;n.receive(e),t&&t.run&&t.run()}))),n},O.between=function(e,t){var n=!1;return e.targets().add(C(null,null,function(){n=!0})),t.targets().add(C(null,null,function(){n=!1})),this.filter(function(){return n})};var F=n.read;function _(){return(_=i(r.mark(function e(t,i){var a,o,u;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this,o=0,e.prev=2,e.next=5,a.loader().load(t,{context:"dataflow",response:n.responseType(i&&i.type)});case 5:u=e.sent;try{u=F(u,i)}catch(r){o=-2,a.warn("Data ingestion failed",t,r)}e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),o=-1,a.warn("Loading failed",t,e.t0);case 13:return e.abrupt("return",{data:u,status:o});case 14:case"end":return e.stop()}},e,this,[[2,9]])}))).apply(this,arguments)}function S(){return(S=i(r.mark(function e(n,i,a){var o,u,s;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(u=(o=this)._pending||M(o)).requests+=1,e.next=4,o.request(i,a);case 4:return s=e.sent,o.pulse(n,o.changeset().remove(t.truthy).insert(s.data||[])),u.done(),e.abrupt("return",s);case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function M(e){var t,n=new Promise(function(e){t=e});return n.requests=0,n.done=function(){0===--n.requests&&(e._pending=null,t(e))},e._pending=n}var j={skip:!0};function T(e,n,r,i,a,o){var u,s,l=t.extend({},o,j);t.isFunction(r)||(r=t.constant(r)),void 0===i?u=function(t){return e.touch(r(t))}:t.isFunction(i)?(s=new w(null,i,a,!1),u=function(t){s.evaluate(t);var n=r(t),i=s.value;p(i)?e.pulse(n,i,o):e.update(n,i,l)}):u=function(t){return e.update(r(t),i,l)},n.apply(u)}function N(e,n,r,i,a,o){if(void 0===i)n.targets().add(r);else{var u=o||{},s=new w(null,function(e,n){return n=t.isFunction(n)?n:t.constant(n),e?function(t,r){var i=n(t,r);return e.skip()||(e.skip(i!==this.value).value=i),i}:n}(r,i),a,!1);s.modified(u.force),s.rank=n.rank,n.targets().add(s),r&&(s.skip(!0),s.value=r.value,s.targets().add(r),e.connect(r,[s]))}}var B={};function R(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}var z=R.prototype;function P(e,t){return e?function(n,r){return e(n,r)&&t(n,r)}:t}function L(e,n){var r=[];return t.visitArray(e,n,function(e){r.push(e)}),r}function I(e,t){var n={};return e.visit(t,function(e){n[c(e)]=1}),function(e){return n[c(e)]?null:e}}function U(e,t,n,r){var i,a,o,u,s,l=this,c=0;for(this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n,o=0,u=n.length;o<u;++o)if((i=n[o]).stamp===t){if(i.fields)for(s in a=l.fields||(l.fields={}),i.fields)a[s]=1;i.changed(l.ADD)&&(c|=l.ADD),i.changed(l.REM)&&(c|=l.REM),i.changed(l.MOD)&&(c|=l.MOD)}this.changes=c}z.StopPropagation=B,z.ADD=1,z.REM=2,z.MOD=4,z.ADD_REM=3,z.ADD_MOD=5,z.ALL=7,z.REFLOW=8,z.SOURCE=16,z.NO_SOURCE=32,z.NO_FIELDS=64,z.fork=function(e){return new R(this.dataflow).init(this,e)},z.clone=function(){var e=this.fork(7);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(23)},z.addAll=function(){var e=this;return this.source&&this.source.length!==this.add.length?((e=new R(this.dataflow).init(this)).add=e.source,e):e},z.init=function(e,t){var n=this;return n.stamp=e.stamp,n.encode=e.encode,!e.fields||64&t||(n.fields=e.fields),1&t?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),2&t?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),4&t?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),32&t?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source),n},z.runAfter=function(e){this.dataflow.runAfter(e)},z.changed=function(e){var t=e||7;return 1&t&&this.add.length||2&t&&this.rem.length||4&t&&this.mod.length},z.reflow=function(e){if(e)return this.fork(7).reflow();var t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(4,I(this,1))),this},z.modifies=function(e){var n=this.fields||(this.fields={});return t.isArray(e)?e.forEach(function(e){return n[e]=!0}):n[e]=!0,this},z.modified=function(e,n){var r=this.fields;return!(!n&&!this.mod.length||!r)&&(arguments.length?t.isArray(e)?e.some(function(e){return r[e]}):r[e]:!!r)},z.filter=function(e,t){var n=this;return 1&e&&(n.addF=P(n.addF,t)),2&e&&(n.remF=P(n.remF,t)),4&e&&(n.modF=P(n.modF,t)),16&e&&(n.srcF=P(n.srcF,t)),n},z.materialize=function(e){var t=this;return 1&(e=e||7)&&t.addF&&(t.add=L(t.add,t.addF),t.addF=null),2&e&&t.remF&&(t.rem=L(t.rem,t.remF),t.remF=null),4&e&&t.modF&&(t.mod=L(t.mod,t.modF),t.modF=null),16&e&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},z.visit=function(e,n){var r,i,a=this,o=n;return 16&e?(t.visitArray(a.source,a.srcF,o),a):(1&e&&t.visitArray(a.add,a.addF,o),2&e&&t.visitArray(a.rem,a.remF,o),4&e&&t.visitArray(a.mod,a.modF,o),8&e&&(r=a.source)&&((i=a.add.length+a.mod.length)===r.length||(i?t.visitArray(r,I(a,5),o):t.visitArray(r,a.srcF,o))),a)};var q=t.inherits(U,R);function W(){return(W=i(r.mark(function e(n,i,u){var s,l,c,f,d,h,p,v,m,g;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l=(s=this).logLevel(),!s._pulse){e.next=3;break}return e.abrupt("return",V(s));case 3:if(!s._pending){e.next=6;break}return e.next=6,s._pending;case 6:if(!i){e.next=9;break}return e.next=9,o(s,i);case 9:if(s._touched.length){e.next=12;break}return s.info("Dataflow invoked, but nothing to do."),e.abrupt("return",s);case 12:c=++s._clock,f=0,s._pulse=new R(s,c,n),l>=t.Info&&(p=Date.now(),s.debug("-- START PROPAGATION ("+c+") -----")),s._touched.forEach(function(e){return s._enqueue(e,!0)}),s._touched=a(t.id),e.prev=17;case 18:if(!(s._heap.size()>0)){e.next=33;break}if((d=s._heap.pop()).rank===d.qrank){e.next=23;break}return s._enqueue(d,!0),e.abrupt("continue",18);case 23:if(!(h=d.run(s._getPulse(d,n))).then){e.next=28;break}return e.next=27,h;case 27:h=e.sent;case 28:l>=t.Debug&&s.debug(d.id,h===B?"STOP":h,d),h!==B&&d._targets&&d._targets.forEach(function(e){return s._enqueue(e)}),++f,e.next=18;break;case 33:e.next=39;break;case 35:e.prev=35,e.t0=e.catch(17),s._heap.clear(),v=e.t0;case 39:if(s._input={},s._pulse=null,l>=t.Info&&(p=Date.now()-p,s.info("> Pulse "+c+": "+f+" operators; "+p+"ms")),v&&(s._postrun=[],s.error(v)),!s._postrun.length){e.next=53;break}m=s._postrun.sort(function(e,t){return t.priority-e.priority}),s._postrun=[],g=0;case 47:if(!(g<m.length)){e.next=53;break}return e.next=50,o(s,m[g].callback);case 50:++g,e.next=47;break;case 53:if(!u){e.next=56;break}return e.next=56,o(s,u);case 56:return e.abrupt("return",s);case 57:case"end":return e.stop()}},e,this,[[17,35]])}))).apply(this,arguments)}function H(){return(H=i(r.mark(function e(t,n,i){var a,o=this;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._running){e.next=5;break}return e.next=3,this._running;case 3:e.next=0;break;case 5:return a=function(){return o._running=null},(this._running=this.evaluate(t,n,i)).then(a,a),e.abrupt("return",this._running);case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function V(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}q.fork=function(e){var t=new R(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,function(e){return t.add.push(e)}),e&t.REM&&this.visit(t.REM,function(e){return t.rem.push(e)}),e&t.MOD&&this.visit(t.MOD,function(e){return t.mod.push(e)})),t},q.changed=function(e){return this.changes&e},q.modified=function(e){var n=this,r=n.fields;return r&&n.changes&n.MOD?t.isArray(e)?e.some(function(e){return r[e]}):r[e]:0},q.filter=function(){t.error("MultiPulse does not support filtering.")},q.materialize=function(){t.error("MultiPulse does not support materialization.")},q.visit=function(e,t){var n=this,r=n.pulses,i=r.length,a=0;if(e&n.SOURCE)for(;a<i;++a)r[a].visit(e,t);else for(;a<i;++a)r[a].stamp===n.stamp&&r[a].visit(e,t);return n};var G={skip:!1,force:!1};function $(e){var t=[];return{clear:function(){return t=[]},size:function(){return t.length},peek:function(){return t[0]},push:function(n){return t.push(n),Y(t,0,t.length-1,e)},pop:function(){var n,r=t.pop();return t.length?(n=t[0],t[0]=r,function(e,t,n){for(var r,i=t,a=e.length,o=e[t],u=1+(t<<1);u<a;)(r=u+1)<a&&n(e[u],e[r])>=0&&(u=r),e[t]=e[u],u=1+((t=u)<<1);e[t]=o,Y(e,i,t,n)}(t,0,e)):n=r,n}}}function Y(e,t,n,r){var i,a,o;for(i=e[n];n>t&&r(i,a=e[o=n-1>>1])<0;)e[n]=a,n=o;return e[n]=i}function X(){this.logger(t.logger()),this.logLevel(t.Error),this._clock=0,this._rank=0;try{this._loader=n.loader()}catch(e){}this._touched=a(t.id),this._input={},this._pulse=null,this._heap=$(function(e,t){return e.qrank-t.qrank}),this._postrun=[]}var J=X.prototype;function Q(e){return function(){return this._log[e].apply(this,arguments)}}function K(e,t){w.call(this,e,null,t)}J.stamp=function(){return this._clock},J.loader=function(e){return arguments.length?(this._loader=e,this):this._loader},J.cleanThreshold=1e4,J.add=function(e,n,r,i){var a,o=1;return e instanceof w?a=e:e&&e.prototype instanceof w?a=new e:t.isFunction(e)?a=new w(null,e):(o=0,a=new w(e,n)),this.rank(a),o&&(i=r,r=n),r&&this.connect(a,a.parameters(r,i)),this.touch(a),a},J.connect=function(e,t){var n,r,i=e.rank;for(n=0,r=t.length;n<r;++n)if(i<t[n].rank)return void this.rerank(e)},J.rank=function(e){e.rank=++this._rank},J.rerank=function(e){for(var n,r,i,a=[e];a.length;)if(this.rank(n=a.pop()),r=n._targets)for(i=r.length;--i>=0;)a.push(n=r[i]),n===e&&t.error("Cycle detected in dataflow graph.")},J.pulse=function(e,t,n){this.touch(e,n||G);var r=new R(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,i),this},J.touch=function(e,t){var n=t||G;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this},J.update=function(e,t,n){var r=n||G;return(e.set(t)||r.force)&&this.touch(e,r),this},J.changeset=v,J.ingest=function(e,t,n){return this.pulse(e,this.changeset().insert(F(t,n)))},J.parse=F,J.preload=function(e,t,n){return S.apply(this,arguments)},J.request=function(e,t){return _.apply(this,arguments)},J.events=function(e,n,r,i){for(var a,o=this,u=C(r,i),s=function(e){e.dataflow=o;try{u.receive(e)}catch(t){o.error(t)}finally{o.run()}},l=0,c=(a="string"===typeof e&&"undefined"!==typeof document?document.querySelectorAll(e):t.array(e)).length;l<c;++l)a[l].addEventListener(n,s);return u},J.on=function(e,t,n,r,i){return(e instanceof w?N:T)(this,e,t,n,r,i),this},J.evaluate=function(e,t,n){return W.apply(this,arguments)},J.run=function(e,t,n){return this._pulse?V(this):(this.evaluate(e,t,n),this)},J.runAsync=function(e,t,n){return H.apply(this,arguments)},J.runAfter=function(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}},J._enqueue=function(e,t){var n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))},J._getPulse=function(e,n){var r=e.source,i=this._clock;return r&&t.isArray(r)?new U(this,i,r.map(function(e){return e.pulse}),n):this._input[e.id]||function(e,t){return t&&t.stamp===e.stamp?t:(e=e.fork(),t&&t!==B&&(e.source=t.source),e)}(this._pulse,r&&r.pulse)},J.logger=function(e){return arguments.length?(this._log=e,this):this._log},J.error=Q("error"),J.warn=Q("warn"),J.info=Q("info"),J.debug=Q("debug"),J.logLevel=Q("level");var Z=t.inherits(K,w);Z.run=function(e){var t,n=this;return e.stamp<this.stamp?e.StopPropagation:(this.skip()?this.skip(!1):t=this.evaluate(e),(t=t||e).then?t=t.then(function(e){return n.pulse=e}):t!==e.StopPropagation&&(this.pulse=t),t)},Z.evaluate=function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},Z.transform=function(){};var ee={};function te(e){return e=e&&e.toLowerCase(),t.hasOwnProperty(ee,e)?ee[e]:null}e.Dataflow=X,e.EventStream=D,e.MultiPulse=U,e.Operator=w,e.Parameters=g,e.Pulse=R,e.Transform=K,e.UniqueList=a,e.asyncCallback=o,e.changeset=v,e.definition=function(e){var t=te(e);return t&&t.Definition||null},e.derive=function(e){return h(e,d({}))},e.ingest=d,e.isChangeSet=p,e.isTuple=function(e){return!(!e||!c(e))},e.rederive=h,e.replace=function(e,t){return f(t,c(e))},e.stableCompare=function(e,t){return e?t?function(n,r){return e(n,r)||c(t(n))-c(t(r))}:function(t,n){return e(t,n)||c(t)-c(n)}:null},e.transform=te,e.transforms=ee,e.tupleid=c,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1469),n(1797))},1508:function(e,t,n){var r=n(21),i=n(309),a=n(311);!function(e){"use strict";var t=r.mark(B),n=r.mark(P);function o(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function u(e){var t;return 1===e.length&&(t=e,e=function(e,n){return o(t(e),n)}),{left:function(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var a=r+i>>>1;e(t[a],n)<0?r=a+1:i=a}return r},right:function(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var a=r+i>>>1;e(t[a],n)>0?i=a:r=a+1}return r}}}var s=u(o),l=s.right,c=s.left;function f(e,t){var n=0;if(void 0===t){var r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;null!=s&&(s=+s)>=s&&++n}}catch(m){i=!0,a=m}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}else{var l=-1,c=!0,f=!1,d=void 0;try{for(var h,p=e[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var v=h.value;null!=(v=t(v,++l,e))&&(v=+v)>=v&&++n}}catch(m){f=!0,d=m}finally{try{c||null==p.return||p.return()}finally{if(f)throw d}}}return n}function d(e){return 0|e.length}function h(e){return!(e>0)}function p(e){return"object"!==typeof e||"length"in e?e:Array.from(e)}function v(e,t){var n,r=0,i=0,a=0;if(void 0===t){var o=!0,u=!1,s=void 0;try{for(var l,c=e[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value;null!=f&&(f=+f)>=f&&(a+=(n=f-i)*(f-(i+=n/++r)))}}catch(b){u=!0,s=b}finally{try{o||null==c.return||c.return()}finally{if(u)throw s}}}else{var d=-1,h=!0,p=!1,v=void 0;try{for(var m,g=e[Symbol.iterator]();!(h=(m=g.next()).done);h=!0){var y=m.value;null!=(y=t(y,++d,e))&&(y=+y)>=y&&(a+=(n=y-i)*(y-(i+=n/++r)))}}catch(b){p=!0,v=b}finally{try{h||null==g.return||g.return()}finally{if(p)throw v}}}if(r>1)return a/(r-1)}function m(e,t){var n=v(e,t);return n?Math.sqrt(n):n}function g(e,t){var n,r;if(void 0===t){var i=!0,a=!1,o=void 0;try{for(var u,s=e[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;null!=l&&(void 0===n?l>=l&&(n=r=l):(n>l&&(n=l),r<l&&(r=l)))}}catch(g){a=!0,o=g}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}}else{var c=-1,f=!0,d=!1,h=void 0;try{for(var p,v=e[Symbol.iterator]();!(f=(p=v.next()).done);f=!0){var m=p.value;null!=(m=t(m,++c,e))&&(void 0===n?m>=m&&(n=r=m):(n>m&&(n=m),r<m&&(r=m)))}}catch(g){d=!0,h=g}finally{try{f||null==v.return||v.return()}finally{if(d)throw h}}}return[n,r]}function y(e){return e}function b(e,t,n,r){return function e(a,o){if(o>=r.length)return n(a);var u=new Map,s=r[o++],l=-1,c=!0,f=!1,d=void 0;try{for(var h,p=a[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var v=h.value,m=s(v,++l,a),g=u.get(m);g?g.push(v):u.set(m,[v])}}catch(O){f=!0,d=O}finally{try{c||null==p.return||p.return()}finally{if(f)throw d}}var y=!0,b=!1,x=void 0;try{for(var w,k=u[Symbol.iterator]();!(y=(w=k.next()).done);y=!0){var A=w.value,E=i(A,2),D=E[0],C=E[1];u.set(D,e(C,o))}}catch(O){b=!0,x=O}finally{try{y||null==k.return||k.return()}finally{if(b)throw x}}return t(u)}(e,0)}var x=Array.prototype.slice;function w(e){return function(){return e}}function k(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),a=new Array(i);++r<i;)a[r]=e+r*n;return a}var A=Math.sqrt(50),E=Math.sqrt(10),D=Math.sqrt(2);function C(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=A?10:a>=E?5:a>=D?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=A?10:a>=E?5:a>=D?2:1)}function O(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=A?i*=10:a>=E?i*=5:a>=D&&(i*=2),t<e?-i:i}function F(e){return Math.ceil(Math.log(f(e))/Math.LN2)+1}function _(){var e=y,t=g,n=F;function r(r){Array.isArray(r)||(r=Array.from(r));var i,a,o=r.length,u=new Array(o);for(i=0;i<o;++i)u[i]=e(r[i],i,r);var s=t(u),c=s[0],f=s[1],d=n(u,c,f);Array.isArray(d)||(d=O(c,f,d),d=k(Math.ceil(c/d)*d,f,d));for(var h=d.length;d[0]<=c;)d.shift(),--h;for(;d[h-1]>f;)d.pop(),--h;var p,v=new Array(h+1);for(i=0;i<=h;++i)(p=v[i]=[]).x0=i>0?d[i-1]:c,p.x1=i<h?d[i]:f;for(i=0;i<o;++i)c<=(a=u[i])&&a<=f&&v[l(d,a,0,h)].push(r[i]);return v}return r.value=function(t){return arguments.length?(e="function"===typeof t?t:w(t),r):e},r.domain=function(e){return arguments.length?(t="function"===typeof e?e:w([e[0],e[1]]),r):t},r.thresholds=function(e){return arguments.length?(n="function"===typeof e?e:Array.isArray(e)?w(x.call(e)):w(e),r):n},r}function S(e,t){var n;if(void 0===t){var r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;null!=s&&(n<s||void 0===n&&s>=s)&&(n=s)}}catch(m){i=!0,a=m}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}else{var l=-1,c=!0,f=!1,d=void 0;try{for(var h,p=e[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var v=h.value;null!=(v=t(v,++l,e))&&(n<v||void 0===n&&v>=v)&&(n=v)}}catch(m){f=!0,d=m}finally{try{c||null==p.return||p.return()}finally{if(f)throw d}}}return n}function M(e,t){var n;if(void 0===t){var r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;null!=s&&(n>s||void 0===n&&s>=s)&&(n=s)}}catch(m){i=!0,a=m}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}else{var l=-1,c=!0,f=!1,d=void 0;try{for(var h,p=e[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var v=h.value;null!=(v=t(v,++l,e))&&(n>v||void 0===n&&v>=v)&&(n=v)}}catch(m){f=!0,d=m}finally{try{c||null==p.return||p.return()}finally{if(f)throw d}}}return n}function j(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:o;r>n;){if(r-n>600){var a=r-n+1,u=t-n+1,s=Math.log(a),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(a-l)/a)*(u-a/2<0?-1:1);j(e,t,Math.max(n,Math.floor(t-u*l/a+c)),Math.min(r,Math.floor(t+(a-u)*l/a+c)),i)}var f=e[t],d=n,h=r;for(T(e,n,t),i(e[r],f)>0&&T(e,n,r);d<h;){for(T(e,d,h),++d,--h;i(e[d],f)<0;)++d;for(;i(e[h],f)>0;)--h}0===i(e[n],f)?T(e,n,h):T(e,++h,r),h<=t&&(n=h+1),t<=h&&(r=h-1)}return e}function T(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function N(e){return null===e?NaN:+e}function B(e,n){var i,a,o,u,s,l,c,f,d,h,p,v,m;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==n){t.next=30;break}i=!0,a=!1,o=void 0,t.prev=4,u=e[Symbol.iterator]();case 6:if(i=(s=u.next()).done){t.next=14;break}if(!(null!=(l=s.value)&&(l=+l)>=l)){t.next=11;break}return t.next=11,l;case 11:i=!0,t.next=6;break;case 14:t.next=20;break;case 16:t.prev=16,t.t0=t.catch(4),a=!0,o=t.t0;case 20:t.prev=20,t.prev=21,i||null==u.return||u.return();case 23:if(t.prev=23,!a){t.next=26;break}throw o;case 26:return t.finish(23);case 27:return t.finish(20);case 28:t.next=58;break;case 30:c=-1,f=!0,d=!1,h=void 0,t.prev=34,p=e[Symbol.iterator]();case 36:if(f=(v=p.next()).done){t.next=44;break}if(m=v.value,!(null!=(m=n(m,++c,e))&&(m=+m)>=m)){t.next=41;break}return t.next=41,m;case 41:f=!0,t.next=36;break;case 44:t.next=50;break;case 46:t.prev=46,t.t1=t.catch(34),d=!0,h=t.t1;case 50:t.prev=50,t.prev=51,f||null==p.return||p.return();case 53:if(t.prev=53,!d){t.next=56;break}throw h;case 56:return t.finish(53);case 57:return t.finish(50);case 58:case"end":return t.stop()}},t,null,[[4,16,20,28],[21,,23,27],[34,46,50,58],[51,,53,57]])}function R(e,t,n){if(r=(e=Float64Array.from(B(e,n))).length){if((t=+t)<=0||r<2)return M(e);if(t>=1)return S(e);var r,i=(r-1)*t,a=Math.floor(i),o=S(j(e,a).subarray(0,a+1));return o+(M(e.subarray(a+1))-o)*(i-a)}}function z(e,t){var n,r=-1,i=-1;if(void 0===t){var a=!0,o=!1,u=void 0;try{for(var s,l=e[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;++i,null!=c&&(n<c||void 0===n&&c>=c)&&(n=c,r=i)}}catch(g){o=!0,u=g}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}}else{var f=!0,d=!1,h=void 0;try{for(var p,v=e[Symbol.iterator]();!(f=(p=v.next()).done);f=!0){var m=p.value;null!=(m=t(m,++i,e))&&(n<m||void 0===n&&m>=m)&&(n=m,r=i)}}catch(g){d=!0,h=g}finally{try{f||null==v.return||v.return()}finally{if(d)throw h}}}return r}function P(e){var t,i,a,o,u,s;return r.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:t=!0,i=!1,a=void 0,n.prev=3,o=e[Symbol.iterator]();case 5:if(t=(u=o.next()).done){n.next=11;break}return s=u.value,n.delegateYield(s,"t0",8);case 8:t=!0,n.next=5;break;case 11:n.next=17;break;case 13:n.prev=13,n.t1=n.catch(3),i=!0,a=n.t1;case 17:n.prev=17,n.prev=18,t||null==o.return||o.return();case 20:if(n.prev=20,!i){n.next=23;break}throw a;case 23:return n.finish(20);case 24:return n.finish(17);case 25:case"end":return n.stop()}},n,null,[[3,13,17,25],[18,,20,24]])}function L(e,t){var n,r=-1,i=-1;if(void 0===t){var a=!0,o=!1,u=void 0;try{for(var s,l=e[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;++i,null!=c&&(n>c||void 0===n&&c>=c)&&(n=c,r=i)}}catch(g){o=!0,u=g}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}}else{var f=!0,d=!1,h=void 0;try{for(var p,v=e[Symbol.iterator]();!(f=(p=v.next()).done);f=!0){var m=p.value;null!=(m=t(m,++i,e))&&(n>m||void 0===n&&m>=m)&&(n=m,r=i)}}catch(g){d=!0,h=g}finally{try{f||null==v.return||v.return()}finally{if(d)throw h}}}return r}function I(e,t){return[e,t]}function U(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;if(1===n.length)return L(e,n);var r=-1,i=-1,a=!0,u=!1,s=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var f=l.value;++i,(r<0?0===n(f,f):n(f,t)<0)&&(t=f,r=i)}}catch(d){u=!0,s=d}finally{try{a||null==c.return||c.return()}finally{if(u)throw s}}return r}function q(e){if(!(i=e.length))return[];for(var t=-1,n=M(e,W),r=new Array(n);++t<n;)for(var i,a=-1,o=r[t]=new Array(i);++a<i;)o[a]=e[a][t];return r}function W(e){return e.length}e.ascending=o,e.bin=_,e.bisect=l,e.bisectLeft=c,e.bisectRight=l,e.bisector=u,e.count=f,e.cross=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r="function"===typeof t[t.length-1]&&function(e){return function(t){return e.apply(void 0,a(t))}}(t.pop()),i=(t=t.map(p)).map(d),o=t.length-1,u=new Array(o+1).fill(0),s=[];if(o<0||i.some(h))return s;for(;;){s.push(u.map(function(e,n){return t[n][e]}));for(var l=o;++u[l]===i[l];){if(0===l)return r?s.map(r):s;u[l--]=0}}},e.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},e.deviation=m,e.extent=g,e.greatest=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,r=!1;if(1===n.length){var i,a=!0,u=!1,s=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var f=l.value,d=n(f);(r?o(d,i)>0:0===o(d,d))&&(t=f,i=d,r=!0)}}catch(b){u=!0,s=b}finally{try{a||null==c.return||c.return()}finally{if(u)throw s}}}else{var h=!0,p=!1,v=void 0;try{for(var m,g=e[Symbol.iterator]();!(h=(m=g.next()).done);h=!0){var y=m.value;(r?n(y,t)>0:0===n(y,y))&&(t=y,r=!0)}}catch(b){p=!0,v=b}finally{try{h||null==g.return||g.return()}finally{if(p)throw v}}}return t},e.greatestIndex=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;if(1===n.length)return z(e,n);var r=-1,i=-1,a=!0,u=!1,s=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var f=l.value;++i,(r<0?0===n(f,f):n(f,t)>0)&&(t=f,r=i)}}catch(d){u=!0,s=d}finally{try{a||null==c.return||c.return()}finally{if(u)throw s}}return r},e.group=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return b(e,y,y,n)},e.groups=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return b(e,Array.from,y,n)},e.histogram=_,e.least=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,r=!1;if(1===n.length){var i,a=!0,u=!1,s=void 0;try{for(var l,c=e[Symbol.iterator]();!(a=(l=c.next()).done);a=!0){var f=l.value,d=n(f);(r?o(d,i)<0:0===o(d,d))&&(t=f,i=d,r=!0)}}catch(b){u=!0,s=b}finally{try{a||null==c.return||c.return()}finally{if(u)throw s}}}else{var h=!0,p=!1,v=void 0;try{for(var m,g=e[Symbol.iterator]();!(h=(m=g.next()).done);h=!0){var y=m.value;(r?n(y,t)<0:0===n(y,y))&&(t=y,r=!0)}}catch(b){p=!0,v=b}finally{try{h||null==g.return||g.return()}finally{if(p)throw v}}}return t},e.leastIndex=U,e.max=S,e.maxIndex=z,e.mean=function(e,t){var n=0,r=0;if(void 0===t){var i=!0,a=!1,o=void 0;try{for(var u,s=e[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;null!=l&&(l=+l)>=l&&(++n,r+=l)}}catch(g){a=!0,o=g}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}}else{var c=-1,f=!0,d=!1,h=void 0;try{for(var p,v=e[Symbol.iterator]();!(f=(p=v.next()).done);f=!0){var m=p.value;null!=(m=t(m,++c,e))&&(m=+m)>=m&&(++n,r+=m)}}catch(g){d=!0,h=g}finally{try{f||null==v.return||v.return()}finally{if(d)throw h}}}if(n)return r/n},e.median=function(e,t){return R(e,.5,t)},e.merge=function(e){return Array.from(P(e))},e.min=M,e.minIndex=L,e.pairs=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:I,r=[],i=!1,a=!0,o=!1,u=void 0;try{for(var s,l=e[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;i&&r.push(n(t,c)),t=c,i=!0}}catch(f){o=!0,u=f}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}return r},e.permute=function(e,t){return Array.from(t,function(t){return e[t]})},e.quantile=R,e.quantileSorted=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:N;if(r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),o=+n(e[a],a,e);return o+(+n(e[a+1],a+1,e)-o)*(i-a)}},e.quickselect=j,e.range=k,e.rollup=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return b(e,y,t,r)},e.rollups=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return b(e,Array.from,t,r)},e.scan=function(e,t){var n=U(e,t);return n<0?void 0:n},e.shuffle=function(e){for(var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length)-(r=+r);i;)n=Math.random()*i--|0,t=e[i+r],e[i+r]=e[n+r],e[n+r]=t;return e},e.sum=function(e,t){var n=0;if(void 0===t){var r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;(s=+s)&&(n+=s)}}catch(m){i=!0,a=m}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}else{var l=-1,c=!0,f=!1,d=void 0;try{for(var h,p=e[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var v=h.value;(v=+t(v,++l,e))&&(n+=v)}}catch(m){f=!0,d=m}finally{try{c||null==p.return||p.return()}finally{if(f)throw d}}}return n},e.thresholdFreedmanDiaconis=function(e,t,n){return Math.ceil((n-t)/(2*(R(e,.75)-R(e,.25))*Math.pow(f(e),-1/3)))},e.thresholdScott=function(e,t,n){return Math.ceil((n-t)/(3.5*m(e)*Math.pow(f(e),-1/3)))},e.thresholdSturges=F,e.tickIncrement=C,e.tickStep=O,e.ticks=function(e,t,n){var r,i,a,o,u=-1;if(n=+n,(e=+e)===(t=+t)&&n>0)return[e];if((r=t<e)&&(i=e,e=t,t=i),0===(o=C(e,t,n))||!isFinite(o))return[];if(o>0)for(e=Math.ceil(e/o),t=Math.floor(t/o),a=new Array(i=Math.ceil(t-e+1));++u<i;)a[u]=(e+u)*o;else for(e=Math.floor(e*o),t=Math.ceil(t*o),a=new Array(i=Math.ceil(e-t+1));++u<i;)a[u]=(e-u)/o;return r&&a.reverse(),a},e.transpose=q,e.variance=v,e.zip=function(){return q(arguments)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},1622:function(e,t){function n(e,t,n,r,i,a,o){try{var u=e[a](o),s=u.value}catch(l){return void n(l)}u.done?t(s):Promise.resolve(s).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise(function(i,a){var o=e.apply(t,r);function u(e){n(o,i,a,u,s,"next",e)}function s(e){n(o,i,a,u,s,"throw",e)}u(void 0)})}}},1623:function(e,t,n){var r=n(309),i=n(21);!function(e,t){"use strict";var n=i.mark(a);function a(e,t){var r,a,o,u,s,l,c,f,d,h,p,v,m;return i.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0!==t){n.next=30;break}r=!0,a=!1,o=void 0,n.prev=4,u=e[Symbol.iterator]();case 6:if(r=(s=u.next()).done){n.next=14;break}if(!(null!=(l=s.value)&&(l=+l)>=l)){n.next=11;break}return n.next=11,l;case 11:r=!0,n.next=6;break;case 14:n.next=20;break;case 16:n.prev=16,n.t0=n.catch(4),a=!0,o=n.t0;case 20:n.prev=20,n.prev=21,r||null==u.return||u.return();case 23:if(n.prev=23,!a){n.next=26;break}throw o;case 26:return n.finish(23);case 27:return n.finish(20);case 28:n.next=58;break;case 30:c=-1,f=!0,d=!1,h=void 0,n.prev=34,p=e[Symbol.iterator]();case 36:if(f=(v=p.next()).done){n.next=44;break}if(m=v.value,!(null!=(m=t(m,++c,e))&&(m=+m)>=m)){n.next=41;break}return n.next=41,m;case 41:f=!0,n.next=36;break;case 44:n.next=50;break;case 46:n.prev=46,n.t1=n.catch(34),d=!0,h=n.t1;case 50:n.prev=50,n.prev=51,f||null==p.return||p.return();case 53:if(n.prev=53,!d){n.next=56;break}throw h;case 56:return n.finish(53);case 57:return n.finish(50);case 58:case"end":return n.stop()}},n,null,[[4,16,20,28],[21,,23,27],[34,46,50,58],[51,,53,57]])}function o(e,n,r){var i=Float64Array.from(a(e,r));return i.sort(t.ascending),n.map(function(e){return t.quantileSorted(i,e)})}function u(e,t){return o(e,[.25,.5,.75],t)}e.random=Math.random;var s=Math.sqrt(2*Math.PI),l=Math.SQRT2,c=NaN;function f(t,n){t=t||0,n=null==n?1:n;var r,i,a=0,o=0;if(c===c)a=c,c=NaN;else{do{r=(a=2*e.random()-1)*a+(o=2*e.random()-1)*o}while(0===r||r>1);a*=i=Math.sqrt(-2*Math.log(r)/r),c=o*i}return t+a*n}function d(e,t,n){var r=(e-(t||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*s)}function h(e,t,n){var r,i=(e-(t=t||0))/(n=null==n?1:n),a=Math.abs(i);if(a>37)r=0;else{var o=Math.exp(-a*a/2);a<7.07106781186547?(r=o*((((((.0352624965998911*a+.700383064443688)*a+6.37396220353165)*a+33.912866078383)*a+112.079291497871)*a+221.213596169931)*a+220.206867912376),r/=((((((.0883883476483184*a+1.75566716318264)*a+16.064177579207)*a+86.7807322029461)*a+296.564248779674)*a+637.333633378831)*a+793.826512519948)*a+440.413735824752):r=o/(a+1/(a+2/(a+3/(a+4/(a+.65)))))/2.506628274631}return i>0?1-r:r}function p(e,t,n){return e<0||e>1?NaN:(t||0)+(null==n?1:n)*l*function(e){var t,n=-Math.log((1-e)*(1+e));return n<6.25?t=1.6536545626831027+(t=.24015818242558962+(t=(t=(t=.00018673420803405714+(t=(t=(t=4.2347877827932404e-7+(t=(t=(t=1.0512122733215323e-9+(t=(t=(t=26335093153082323e-28+(t=(t=(t=6637638134358324e-30+(t=20972767875968562e-33+(t=(t=11157877678025181e-33+(t=128584807152564e-32+(t=(t=-364441206401782e-35)*(n-=3.125)-16850591381820166e-35)*n)*n)*n-1333171662854621e-31)*n)*n)*n-4054566272975207e-29)*n-8151934197605472e-29)*n)*n-12975133253453532e-27)*n-5415412054294628e-26)*n)*n-4.112633980346984e-9)*n-2.9070369957882005e-8)*n)*n-13654692000834679e-22)*n-13882523362786469e-21)*n)*n-.000740702534166267)*n-.006033670871430149)*n)*n:n<16?(n=Math.sqrt(n)-3.25,t=3.0838856104922208+(t=1.0052589676941592+(t=.005370914553590064+(t=(t=.002491442096107851+(t=(t=.0009532893797373805+(t=(t=24031110387097894e-21+(t=6828485145957318e-20+(t=(t=12475304481671779e-21+(t=29234449089955446e-22+(t=(t=15027403968909828e-22+(t=1.8239629214389228e-8+(t=(t=9.075656193888539e-8+(t=2.2137376921775787e-9)*n)*n-2.7517406297064545e-7)*n)*n)*n-4013867526981546e-21)*n)*n)*n-47318229009055734e-21)*n)*n)*n-.0003550375203628475)*n)*n-.0016882755560235047)*n)*n-.003751208507569241)*n)*n)*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,t=4.849906401408584+(t=1.0103004648645344+(t=(t=(t=7599527703001776e-20+(t=(t=4526062597223154e-21+(t=(t=2.2900482228026655e-7+(t=(t=2.914795345090108e-8+(t=(t=7.61570120807834e-9+(t=(t=1.5076572693500548e-9+(t=(t=-27109920616438573e-27)*n-2.555641816996525e-10)*n)*n-3.789465440126737e-9)*n)*n-1.496002662714924e-8)*n)*n-6.771199775845234e-8)*n)*n-9.9298272942317e-7)*n)*n-1968177810553167e-20)*n)*n-.00021503011930044477)*n-.00013871931833623122)*n)*n):t=1/0,t*e}(2*e-1)}function v(e,t){var n,r,i={mean:function(e){return arguments.length?(n=e||0,i):n},stdev:function(e){return arguments.length?(r=null==e?1:e,i):r},sample:function(){return f(n,r)},pdf:function(e){return d(e,n,r)},cdf:function(e){return h(e,n,r)},icdf:function(e){return p(e,n,r)}};return i.mean(e).stdev(t)}function m(e){var n=e.length,r=u(e),i=(r[2]-r[0])/1.34,a=i?Math.min(t.deviation(e),i):a||Math.abs(e[0])||1;return 1.06*a*Math.pow(n,-.2)}function g(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+f()*t)}function y(e,t,n){if(e<=0)return 0;t=t||0,n=null==n?1:n;var r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*s*e)}function b(e,t,n){return h(Math.log(e),t,n)}function x(e,t,n){return Math.exp(p(e,t,n))}function w(t,n){return null==n&&(n=null==t?1:t,t=0),t+(n-t)*e.random()}function k(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function A(e,t,n){return null==n&&(n=null==t?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function E(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function D(e,t,n,r){var i=r-e*e,a=Math.abs(i)<1e-24?0:(n-e*t)/i;return[t-a*e,a]}function C(e,t,n,r){e=e.filter(function(e){var r=t(e),i=n(e);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i}),r&&e.sort(function(e,n){return t(e)-t(n)});var i=new Float64Array(e.length),a=new Float64Array(e.length),o=0,u=!0,s=!1,l=void 0;try{for(var c,f=e[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var d=c.value;i[o]=t(d),a[o]=n(d),++o}}catch(h){s=!0,l=h}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}return[i,a]}function O(e,t,n,r){var i,a,o=-1,u=-1,s=!0,l=!1,c=void 0;try{for(var f,d=e[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var h=f.value;i=t(h,++o,e),a=n(h,o,e),null!=i&&(i=+i)>=i&&null!=a&&(a=+a)>=a&&r(i,a,++u)}}catch(p){l=!0,c=p}finally{try{s||null==d.return||d.return()}finally{if(l)throw c}}}function F(e,t,n,r,i){var a=0,o=0;return O(e,t,n,function(e,t){var n=t-i(e),u=t-r;a+=n*n,o+=u*u}),1-a/o}function _(e,t,n){var r=0,i=0,a=0,o=0,u=0;O(e,t,n,function(e,t){r+=e,i+=t,a+=e*t,o+=e*e,++u});var s=D(r/u,i/u,a/u,o/u),l=function(e){return s[0]+s[1]*e};return{coef:s,predict:l,rSquared:F(e,t,n,i/u,l)}}function S(e,t,n){var r=0,i=0,a=0,o=0,u=0,s=0,l=0,c=0;O(e,t,n,function(e,t){var n=e*e;r+=e,i+=t,a+=n,o+=n*e,u+=n*n,s+=e*t,l+=n*t,++c});var f=a-r*r/c,d=o-a*r/c,h=u-a*a/c,p=f*h-d*d,v=((l-=a*(i/=c))*f-(s-=r*i)*d)/p,m=(s*h-l*d)/p,g=i-m*(r/c)-v*(a/c),y=function(e){return v*e*e+m*e+g};return{coef:[g,m,v],predict:y,rSquared:F(e,t,n,i,y)}}var M=2,j=1e-12;function T(e){return(e=1-e*e*e)*e*e}function N(e,t,n){var r=e[t],i=n[0],a=n[1]+1;if(!(a>=e.length))for(;t>i&&e[a]-r<=r-e[i];)n[0]=++i,n[1]=a,++a}var B=.1*Math.PI/180;function R(e,t,n){var r=Math.atan2(n[1]-e[1],n[0]-e[0]),i=Math.atan2(t[1]-e[1],t[0]-e[0]);return Math.abs(r-i)}e.bin=function(e){var t,n,r,i,a,o,u,s,l=e.maxbins||20,c=e.base||10,f=Math.log(c),d=e.divide||[5,2],h=e.extent[0],p=e.extent[1],v=e.span||p-h||Math.abs(h)||1;if(e.step)t=e.step;else if(e.steps){for(a=v/l,o=0,u=e.steps.length;o<u&&e.steps[o]<a;++o);t=e.steps[Math.max(0,o-1)]}else{for(n=Math.ceil(Math.log(l)/f),r=e.minstep||0,t=Math.max(r,Math.pow(c,Math.round(Math.log(v)/f)-n));Math.ceil(v/t)>l;)t*=c;for(o=0,u=d.length;o<u;++o)(a=t/d[o])>=r&&v/a<=l&&(t=a)}return i=(a=Math.log(t))>=0?0:1+~~(-a/f),s=Math.pow(c,-i-1),(e.nice||void 0===e.nice)&&(h=h<(a=Math.floor(h/t+s)*t)?a-t:a,p=Math.ceil(p/t)*t),{start:h,stop:p===h?h+t:p,step:t}},e.bootstrapCI=function(n,r,i,o){if(!n.length)return[void 0,void 0];var u,s,l,c,f=Float64Array.from(a(n,o)),d=f.length,h=r;for(l=0,c=Array(h);l<h;++l){for(u=0,s=0;s<d;++s)u+=f[~~(e.random()*d)];c[l]=u/d}return c.sort(t.ascending),[t.quantile(c,i/2),t.quantile(c,1-i/2)]},e.cumulativeLogNormal=b,e.cumulativeNormal=h,e.cumulativeUniform=A,e.densityLogNormal=y,e.densityNormal=d,e.densityUniform=k,e.dotbin=function(e,t,n,r){r=r||function(e){return e};for(var i,a=0,o=1,u=e.length,s=new Float64Array(u),l=r(e[0]),c=l,f=l+t;o<u;++o){if((i=r(e[o]))>=f){for(c=(l+c)/2;a<o;++a)s[a]=c;f=i+t,l=i}c=i}for(c=(l+c)/2;a<o;++a)s[a]=c;return n?function(e,t){for(var n,r,i=e.length,a=0,o=1;e[a]===e[o];)++o;for(;o<i;){for(n=o+1;e[o]===e[n];)++n;if(e[o]-e[o-1]<t){for(r=o+(a+n-o-o>>1);r<o;)e[r++]=e[o];for(;r>o;)e[r--]=e[a]}a=o,o=n}return e}(s,t+t/4):s},e.quantileLogNormal=x,e.quantileNormal=p,e.quantileUniform=E,e.quantiles=o,e.quartiles=u,e.randomInteger=function(t,n){null==n&&(n=t,t=0);var r,i,a,o={min:function(e){return arguments.length?(a=i-(r=e||0),o):r},max:function(e){return arguments.length?(a=(i=e||0)-r,o):i},sample:function(){return r+Math.floor(a*e.random())},pdf:function(e){return e===Math.floor(e)&&e>=r&&e<i?1/a:0},cdf:function(e){var t=Math.floor(e);return t<r?0:t>=i?1:(t-r+1)/a},icdf:function(e){return e>=0&&e<=1?r-1+Math.floor(e*a):NaN}};return o.min(t).max(n)},e.randomKDE=function(t,n){var r=v(),i={},a=0;return i.data=function(e){return arguments.length?(t=e,a=e?e.length:0,i.bandwidth(n)):t},i.bandwidth=function(e){return arguments.length?(!(n=e)&&t&&(n=m(t)),i):n},i.sample=function(){return t[~~(e.random()*a)]+n*r.sample()},i.pdf=function(e){for(var i=0,o=0;o<a;++o)i+=r.pdf((e-t[o])/n);return i/n/a},i.cdf=function(e){for(var i=0,o=0;o<a;++o)i+=r.cdf((e-t[o])/n);return i/a},i.icdf=function(){throw Error("KDE icdf not supported.")},i.data(t)},e.randomLCG=function(e){return function(){return(e=(1103515245*e+12345)%2147483647)/2147483647}},e.randomLogNormal=function(e,t){var n,r,i={mean:function(e){return arguments.length?(n=e||0,i):n},stdev:function(e){return arguments.length?(r=null==e?1:e,i):r},sample:function(){return g(n,r)},pdf:function(e){return y(e,n,r)},cdf:function(e){return b(e,n,r)},icdf:function(e){return x(e,n,r)}};return i.mean(e).stdev(t)},e.randomMixture=function(t,n){var r,i={},a=0;function o(e){var t,n=[],r=0;for(t=0;t<a;++t)r+=n[t]=null==e[t]?1:+e[t];for(t=0;t<a;++t)n[t]/=r;return n}return i.weights=function(e){return arguments.length?(r=o(n=e||[]),i):n},i.distributions=function(e){return arguments.length?(e?(a=e.length,t=e):(a=0,t=[]),i.weights(n)):t},i.sample=function(){for(var n=e.random(),i=t[a-1],o=r[0],u=0;u<a-1;o+=r[++u])if(n<o){i=t[u];break}return i.sample()},i.pdf=function(e){for(var n=0,i=0;i<a;++i)n+=r[i]*t[i].pdf(e);return n},i.cdf=function(e){for(var n=0,i=0;i<a;++i)n+=r[i]*t[i].cdf(e);return n},i.icdf=function(){throw Error("Mixture icdf not supported.")},i.distributions(t).weights(n)},e.randomNormal=v,e.randomUniform=function(e,t){var n,r,i={min:function(e){return arguments.length?(n=e||0,i):n},max:function(e){return arguments.length?(r=null==e?1:e,i):r},sample:function(){return w(n,r)},pdf:function(e){return k(e,n,r)},cdf:function(e){return A(e,n,r)},icdf:function(e){return E(e,n,r)}};return null==t&&(t=null==e?1:e,e=0),i.min(e).max(t)},e.regressionExp=function(e,t,n){var r=0,i=0,a=0,o=0,u=0,s=0;O(e,t,n,function(e,t){var n=Math.log(t),l=e*t;r+=t,a+=l,u+=e*l,i+=t*n,o+=l*n,++s});var l=D(a/r,i/r,o/r,u/r),c=function(e){return l[0]*Math.exp(l[1]*e)};return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:F(e,t,n,r/s,c)}},e.regressionLinear=_,e.regressionLoess=function(e,n,i,a){for(var o=C(e,n,i,!0),u=r(o,2),s=u[0],l=u[1],c=s.length,f=Math.max(2,~~(a*c)),d=new Float64Array(c),h=new Float64Array(c),p=new Float64Array(c).fill(1),v=-1;++v<=M;){for(var m=[0,f-1],g=0;g<c;++g){for(var y=s[g],b=m[0],x=m[1],w=y-s[b]>s[x]-y?b:x,k=0,A=0,E=0,O=0,F=0,_=1/Math.abs(s[w]-y||1),S=b;S<=x;++S){var B=s[S],R=l[S],z=T(Math.abs(y-B)*_)*p[S],P=B*z;k+=z,A+=P,E+=R*z,O+=R*P,F+=B*P}var L=D(A/k,E/k,O/k,F/k),I=r(L,2),U=I[0],q=I[1];d[g]=U+q*y,h[g]=Math.abs(l[g]-d[g]),N(s,g+1,m)}if(v===M)break;var W=t.median(h);if(Math.abs(W)<j)break;for(var H,V,G=0;G<c;++G)H=h[G]/(6*W),p[G]=H>=1?j:(V=1-H*H)*V}return function(e,t){for(var n,r=e.length,i=[],a=0,o=0,u=[];a<r;++a)n=e[a],u[0]===n?u[1]+=(t[a]-u[1])/++o:(o=0,u=[n,t[a]],i.push(u));return i}(s,d)},e.regressionLog=function(e,t,n){var r=0,i=0,a=0,o=0,u=0;O(e,t,n,function(e,t){e=Math.log(e),r+=e,i+=t,a+=e*t,o+=e*e,++u});var s=D(r/u,i/u,a/u,o/u),l=function(e){return s[0]+s[1]*Math.log(e)};return{coef:s,predict:l,rSquared:F(e,t,n,i/u,l)}},e.regressionPoly=function(e,t,n,i){if(1===i)return _(e,t,n);if(2===i)return S(e,t,n);var a,o,u,s,l,c=C(e,t,n),f=r(c,2),d=f[0],h=f[1],p=d.length,v=[],m=[],g=i+1,y=0;for(a=0;a<p;++a)y+=h[a];for(a=0;a<g;++a){for(u=0,s=0;u<p;++u)s+=Math.pow(d[u],a)*h[u];for(v.push(s),l=new Float64Array(g),o=0;o<g;++o){for(u=0,s=0;u<p;++u)s+=Math.pow(d[u],a+o);l[o]=s}m.push(l)}m.push(v);var b=function(e){var t,n,r,i,a,o=e.length-1,u=[];for(t=0;t<o;++t){for(i=t,n=t+1;n<o;++n)Math.abs(e[t][n])>Math.abs(e[t][i])&&(i=n);for(r=t;r<o+1;++r)a=e[r][t],e[r][t]=e[r][i],e[r][i]=a;for(n=t+1;n<o;++n)for(r=o;r>=t;r--)e[r][n]-=e[r][t]*e[t][n]/e[t][t]}for(n=o-1;n>=0;--n){for(a=0,r=n+1;r<o;++r)a+=e[r][n]*u[r];u[n]=(e[o][n]-a)/e[n][n]}return u}(m),x=function(e){for(var t=0,n=0,r=b.length;n<r;++n)t+=b[n]*Math.pow(e,n);return t};return{coef:b,predict:x,rSquared:F(e,t,n,y/p,x)}},e.regressionPow=function(e,t,n){var r=0,i=0,a=0,o=0,u=0,s=0;O(e,t,n,function(e,t){var n=Math.log(e),l=Math.log(t);r+=n,i+=l,a+=n*l,o+=n*n,u+=t,++s});var l=D(r/s,i/s,a/s,o/s),c=function(e){return l[0]*Math.pow(e,l[1])};return l[0]=Math.exp(l[0]),{coef:l,predict:c,rSquared:F(e,t,n,u/s,c)}},e.regressionQuad=S,e.sampleCurve=function(e,t,n,r){n=n||25,r=Math.max(n,r||200);var i=function(t){return[t,e(t)]},a=t[0],o=t[1],u=o-a,s=u/r,l=[i(a)],c=[];if(n===r){for(var f=1;f<r;++f)l.push(i(a+f/n*u));return l.push(i(o)),l}c.push(i(o));for(var d=n;--d>0;)c.push(i(a+d/n*u));for(var h=l[0],p=c[c.length-1];p;){var v=i((h[0]+p[0])/2);v[0]-h[0]>=s&&R(h,v,p)>B?c.push(v):(h=p,l.push(p),c.pop()),p=c[c.length-1]}return l},e.sampleLogNormal=g,e.sampleNormal=f,e.sampleUniform=w,e.setRandom=function(t){e.random=t},Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1508))},1624:function(e,t,n){var r=n(135);!function(e,t,n,i,a,o){"use strict";var u;function s(e,t,n){var r=e-t+2*n;return e?r>0?r:1:0}var l="identity",c="linear",f="log",d="pow",h="sqrt",p="symlog",v="time",m="utc",g="sequential",y="diverging",b="quantile",x="quantize",w="threshold",k="ordinal",A="point",E="band",D="bin-ordinal";function C(e){return e&&e.startsWith(g)}function O(e){return e&&e.startsWith(y)}var F={millisecond:n.timeMillisecond,second:n.timeSecond,minute:n.timeMinute,hour:n.timeHour,day:n.timeDay,week:n.timeWeek,month:n.timeMonth,year:n.timeYear},_={millisecond:n.utcMillisecond,second:n.utcSecond,minute:n.utcMinute,hour:n.utcHour,day:n.utcDay,week:n.utcWeek,month:n.utcMonth,year:n.utcYear};function S(){var e,t,n=a.scaleOrdinal().unknown(void 0),r=n.domain,o=n.range,u=[0,1],l=!1,c=0,f=0,d=.5;function h(){var n=r().length,a=u[1]<u[0],h=u[a-0],p=u[1-a],v=s(n,c,f);e=(p-h)/(v||1),l&&(e=Math.floor(e)),h+=(p-h-e*(n-c))*d,t=e*(1-c),l&&(h=Math.round(h),t=Math.round(t));var m=i.range(n).map(function(t){return h+e*t});return o(a?m.reverse():m)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),h()):r()},n.range=function(e){return arguments.length?(u=[+e[0],+e[1]],h()):u.slice()},n.rangeRound=function(e){return u=[+e[0],+e[1]],l=!0,h()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(l=!!e,h()):l},n.padding=function(e){return arguments.length?(f=Math.max(0,Math.min(1,e)),c=f,h()):c},n.paddingInner=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),h()):c},n.paddingOuter=function(e){return arguments.length?(f=Math.max(0,Math.min(1,e)),h()):f},n.align=function(e){return arguments.length?(d=Math.max(0,Math.min(1,e)),h()):d},n.invertRange=function(e){if(null!=e[0]&&null!=e[1]){var n,a,s,l=+e[0],c=+e[1],f=u[1]<u[0],d=f?o().reverse():o(),h=d.length-1;if(l===l&&c===c&&(c<l&&(s=l,l=c,c=s),!(c<d[0]||l>u[1-f])))return n=Math.max(0,i.bisectRight(d,l)-1),a=l===c?n:i.bisectRight(d,c)-1,l-d[n]>t+1e-10&&++n,f&&(s=n,n=h-a,a=h-s),n>a?void 0:r().slice(n,a+1)}},n.invert=function(e){var t=n.invertRange([e,e]);return t?t[0]:t},n.copy=function(){return S().domain(r()).range(u).round(l).paddingInner(c).paddingOuter(f).align(d)},h()}var M=Array.prototype.map;function j(e){return M.call(e,function(e){return+e})}var T=Array.prototype.slice;function N(e,n){return arguments.length>1?(B[e]=function(e,t){return function(){var n=t();return n.invertRange||(n.invertRange=n.invert?function(e){return function(t){var n,r=t[0],i=t[1];return i<r&&(n=r,r=i,i=n),[e.invert(r),e.invert(i)]}}(n):n.invertExtent?function(e){return function(t){var n,r,i,a,o=e.range(),u=t[0],s=t[1],l=-1;for(s<u&&(r=u,u=s,s=r),i=0,a=o.length;i<a;++i)o[i]>=u&&o[i]<=s&&(l<0&&(l=i),n=i);if(!(l<0))return u=e.invertExtent(o[l]),s=e.invertExtent(o[n]),[void 0===u[0]?u[1]:u[0],void 0===s[1]?s[0]:s[1]]}}(n):void 0),n.type=e,n}}(e,n),this):t.hasOwnProperty(B,e)?B[e]:void 0}var B=(r(u={},l,a.scaleIdentity),r(u,c,a.scaleLinear),r(u,f,a.scaleLog),r(u,d,a.scalePow),r(u,h,a.scaleSqrt),r(u,p,a.scaleSymlog),r(u,v,a.scaleTime),r(u,m,a.scaleUtc),r(u,g,a.scaleSequential),r(u,g+"-"+c,a.scaleSequential),r(u,g+"-"+f,a.scaleSequentialLog),r(u,g+"-"+d,a.scaleSequentialPow),r(u,g+"-"+h,a.scaleSequentialSqrt),r(u,g+"-"+p,a.scaleSequentialSymlog),r(u,y+"-"+c,a.scaleDiverging),r(u,y+"-"+f,a.scaleDivergingLog),r(u,y+"-"+d,a.scaleDivergingPow),r(u,y+"-"+h,a.scaleDivergingSqrt),r(u,y+"-"+p,a.scaleDivergingSymlog),r(u,b,a.scaleQuantile),r(u,x,a.scaleQuantize),r(u,w,a.scaleThreshold),r(u,D,function e(){var n=[],r=[];function o(e){return null==e||e!==e?void 0:r[(i.bisect(n,e)-1)%r.length]}return o.domain=function(e){return arguments.length?(n=j(e),o):n.slice()},o.range=function(e){return arguments.length?(r=T.call(e),o):r.slice()},o.tickFormat=function(e,r){return a.tickFormat(n[0],t.peek(n),null==e?10:e,r)},o.copy=function(){return e().domain(o.domain()).range(o.range())},o}),r(u,k,a.scaleOrdinal),r(u,E,S),r(u,A,function(){return function e(t){var n=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return e(n())},t}(S().paddingInner(1))}),u);for(var R in B)N(R,B[R]);var z=["clamp","base","constant","exponent"];function P(e,t,n){return o.piecewise(L(t||"rgb",n),e)}function L(e,t){var n=o[function(e){return"interpolate"+e.toLowerCase().split("-").map(function(e){return e[0].toUpperCase()+e.slice(1)}).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function I(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}function U(e,t){for(var n in e)W(n,t(e[n]))}var q={};function W(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(q[e]=t,this):q[e]}U({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},I),U({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},function(e){return P(I(e))}),Object.defineProperty(e,"scaleImplicit",{enumerable:!0,get:function(){return a.scaleImplicit}}),Object.defineProperty(e,"tickFormat",{enumerable:!0,get:function(){return a.tickFormat}}),e.Band=E,e.BinOrdinal=D,e.Diverging=y,e.Identity=l,e.Linear=c,e.Log=f,e.Ordinal=k,e.Point=A,e.Pow=d,e.Quantile=b,e.Quantize=x,e.Sequential=g,e.Sqrt=h,e.Symlog=p,e.Threshold=w,e.Time=v,e.UTC=m,e.bandSpace=s,e.interpolate=L,e.interpolateColors=P,e.interpolateRange=function(e,n){var r=n[0],i=t.peek(n)-r;return function(t){return e(r+t*i)}},e.isContinuous=function(e){switch(e){case c:case f:case d:case h:case p:case v:case m:case g:return!0}return!1},e.isDiscrete=function(e){return e===D||e===k||e===E||e===A},e.isDiscretizing=function(e){return e===D||e===b||e===x||e===w},e.isDiverging=O,e.isInterpolating=function(e){return C(e)||O(e)},e.isLogarithmic=function(e){return e===f||e.endsWith("-log")},e.isQuantile=function(e){return e===b},e.isSequential=C,e.isTemporal=function(e){return e===v||e===m},e.isValidScaleType=function(e){switch(e){case l:case c:case f:case d:case h:case p:case v:case m:case g:case b:case x:case w:case k:case A:case E:case D:return!0}return!1},e.quantizeInterpolator=function(e,t){for(var n=new Array(t),r=t+1,i=0;i<t;)n[i]=e(++i/r);return n},e.scale=N,e.scaleCopy=function(e){var t=e.type,n=e.copy();return n.type=t,n},e.scaleFraction=function(e,n,r){var i,a,o,u=r-n;return u&&Number.isFinite(u)?(i=(a=e.type).indexOf("-"),a=i<0?a:a.slice(i+1),o=N(a)().domain([n,r]).range([0,1]),z.forEach(function(t){return e[t]?o[t](e[t]()):0}),o):t.constant(.5)},e.scheme=W,e.timeInterval=function(e,n){var r=n===m?_:F;return t.hasOwnProperty(r,e)&&r[e]},Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1469),n(2880),n(1508),n(2881),n(585))},1693:function(e,t,n){!function(e,t,n,r,i,a){"use strict";function o(e){this.clear(),e&&this.union(e)}var u=o.prototype;u.clone=function(){return new o(this)},u.clear=function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},u.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},u.equals=function(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},u.set=function(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},u.add=function(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},u.expand=function(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},u.round=function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},u.translate=function(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},u.rotate=function(e,t,n){var r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},u.rotatedPoints=function(e,t,n){var r=this.x1,i=this.y1,a=this.x2,o=this.y2,u=Math.cos(e),s=Math.sin(e),l=t-t*u+n*s,c=n-t*s-n*u;return[u*r-s*i+l,s*r+u*i+c,u*r-s*o+l,s*r+u*o+c,u*a-s*i+l,s*a+u*i+c,u*a-s*o+l,s*a+u*o+c]},u.union=function(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},u.intersect=function(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},u.encloses=function(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},u.alignsWith=function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},u.intersects=function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},u.contains=function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},u.width=function(){return this.x2-this.x1},u.height=function(){return this.y2-this.y1};var s=0,l="p_";function c(e){return e&&e.gradient}function f(e,t,n){var r=e.id,i=e.gradient,a="radial"===i?l:"";return r||(r=e.id="gradient_"+s++,"radial"===i?(e.x1=d(e.x1,.5),e.y1=d(e.y1,.5),e.r1=d(e.r1,0),e.x2=d(e.x2,.5),e.y2=d(e.y2,.5),e.r2=d(e.r2,.5),a=l):(e.x1=d(e.x1,0),e.y1=d(e.y1,0),e.x2=d(e.x2,1),e.y2=d(e.y2,0))),t[r]=e,"url("+(n||"")+"#"+a+r+")"}function d(e,t){return null!=e?e:t}function h(e){this.mark=e,this.bounds=this.bounds||new o}function p(e){h.call(this,e),this.items=this.items||[]}function v(e){this._pending=0,this._loader=e||r.loader()}t.inherits(p,h);var m=v.prototype;function g(e){e._pending+=1}function y(e){e._pending-=1}m.pending=function(){return this._pending},m.sanitizeURL=function(e){var t=this;return g(t),t._loader.sanitize(e,{context:"href"}).then(function(e){return y(t),e}).catch(function(){return y(t),null})},m.loadImage=function(e){var t=this,r=n.image();return g(t),t._loader.sanitize(e,{context:"image"}).then(function(e){var n=e.href;if(!n||!r)throw{url:n};var i=new r;return i.onload=function(){y(t),i.loaded=!0},i.onerror=function(){y(t),i.loaded=!1},i.src=n,i}).catch(function(e){return y(t),{loaded:!1,width:0,height:0,src:e&&e.url||""}})},m.ready=function(){var e=this;return new Promise(function(t){!function n(r){e.pending()?setTimeout(function(){n(!0)},10):t(r)}(!1)})};var b={basis:{curve:i.curveBasis},"basis-closed":{curve:i.curveBasisClosed},"basis-open":{curve:i.curveBasisOpen},bundle:{curve:i.curveBundle,tension:"beta",value:.85},cardinal:{curve:i.curveCardinal,tension:"tension",value:0},"cardinal-open":{curve:i.curveCardinalOpen,tension:"tension",value:0},"cardinal-closed":{curve:i.curveCardinalClosed,tension:"tension",value:0},"catmull-rom":{curve:i.curveCatmullRom,tension:"alpha",value:.5},"catmull-rom-closed":{curve:i.curveCatmullRomClosed,tension:"alpha",value:.5},"catmull-rom-open":{curve:i.curveCatmullRomOpen,tension:"alpha",value:.5},linear:{curve:i.curveLinear},"linear-closed":{curve:i.curveLinearClosed},monotone:{horizontal:i.curveMonotoneY,vertical:i.curveMonotoneX},natural:{curve:i.curveNatural},step:{curve:i.curveStep},"step-after":{curve:i.curveStepAfter},"step-before":{curve:i.curveStepBefore}};function x(e,n,r){var i=t.hasOwnProperty(b,e)&&b[e],a=null;return i&&(a=i.curve||i[n||"vertical"],i.tension&&null!=r&&(a=a[i.tension](r))),a}var w={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},k=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/];function A(e){var t,n,r,i,a,o,u,s,l,c,f,d=[];for(s=0,c=(t=e.slice().replace(k[0],"###$1").split(k[1]).slice(1)).length;s<c;++s){for(r=(n=t[s]).slice(1).trim().replace(k[2],"$1###$2").split(k[3]),i=[o=n.charAt(0)],l=0,f=r.length;l<f;++l)(a=+r[l])===a&&i.push(a);if(u=w[o.toLowerCase()],i.length-1>u)for(l=1,f=i.length;l<f;l+=u)d.push([o].concat(i.slice(l,l+u)));else d.push(i)}return d}var E=Math.PI/180,D=Math.PI/2,C=2*Math.PI,O=Math.sqrt(3)/2,F={},_={},S=[].join;function M(e){var t=S.call(e);if(_[t])return _[t];var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=e[6],l=e[7],c=l*o,f=-s*u,d=s*o,h=l*u,p=Math.cos(i),v=Math.sin(i),m=Math.cos(a),g=Math.sin(a),y=.5*(a-i),b=Math.sin(.5*y),x=8/3*b*b/Math.sin(y),w=n+p-x*v,k=r+v+x*p,A=n+m,E=r+g,D=A+x*g,C=E-x*m;return _[t]=[c*w+f*k,d*w+h*k,c*D+f*C,d*D+h*C,c*A+f*E,d*A+h*E]}var j=["l",0,0,0,0,0,0,0];function T(e,t){var n=j[0]=e[0];if("a"===n||"A"===n)j[1]=t*e[1],j[2]=t*e[2],j[3]=e[3],j[4]=e[4],j[5]=e[5],j[6]=t*e[6],j[7]=t*e[7];else for(var r=1,i=e.length;r<i;++r)j[r]=t*e[r];return j}function N(e,t,n,r,i){var a,o,u,s,l,c=null,f=0,d=0,h=0,p=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),e.beginPath&&e.beginPath();for(var v=0,m=t.length;v<m;++v){switch(a=t[v],1!==i&&(a=T(a,i)),a[0]){case"l":f+=a[1],d+=a[2],e.lineTo(f+n,d+r);break;case"L":f=a[1],d=a[2],e.lineTo(f+n,d+r);break;case"h":f+=a[1],e.lineTo(f+n,d+r);break;case"H":f=a[1],e.lineTo(f+n,d+r);break;case"v":d+=a[1],e.lineTo(f+n,d+r);break;case"V":d=a[1],e.lineTo(f+n,d+r);break;case"m":f+=a[1],d+=a[2],e.moveTo(f+n,d+r);break;case"M":f=a[1],d=a[2],e.moveTo(f+n,d+r);break;case"c":o=f+a[5],u=d+a[6],h=f+a[3],p=d+a[4],e.bezierCurveTo(f+a[1]+n,d+a[2]+r,h+n,p+r,o+n,u+r),f=o,d=u;break;case"C":f=a[5],d=a[6],h=a[3],p=a[4],e.bezierCurveTo(a[1]+n,a[2]+r,h+n,p+r,f+n,d+r);break;case"s":o=f+a[3],u=d+a[4],h=2*f-h,p=2*d-p,e.bezierCurveTo(h+n,p+r,f+a[1]+n,d+a[2]+r,o+n,u+r),h=f+a[1],p=d+a[2],f=o,d=u;break;case"S":o=a[3],u=a[4],h=2*f-h,p=2*d-p,e.bezierCurveTo(h+n,p+r,a[1]+n,a[2]+r,o+n,u+r),f=o,d=u,h=a[1],p=a[2];break;case"q":o=f+a[3],u=d+a[4],h=f+a[1],p=d+a[2],e.quadraticCurveTo(h+n,p+r,o+n,u+r),f=o,d=u;break;case"Q":o=a[3],u=a[4],e.quadraticCurveTo(a[1]+n,a[2]+r,o+n,u+r),f=o,d=u,h=a[1],p=a[2];break;case"t":o=f+a[1],u=d+a[2],null===c[0].match(/[QqTt]/)?(h=f,p=d):"t"===c[0]?(h=2*f-s,p=2*d-l):"q"===c[0]&&(h=2*f-h,p=2*d-p),s=h,l=p,e.quadraticCurveTo(h+n,p+r,o+n,u+r),d=u,h=(f=o)+a[1],p=d+a[2];break;case"T":o=a[1],u=a[2],h=2*f-h,p=2*d-p,e.quadraticCurveTo(h+n,p+r,o+n,u+r),f=o,d=u;break;case"a":B(e,f+n,d+r,[a[1],a[2],a[3],a[4],a[5],a[6]+f+n,a[7]+d+r]),f+=a[6],d+=a[7];break;case"A":B(e,f+n,d+r,[a[1],a[2],a[3],a[4],a[5],a[6]+n,a[7]+r]),f=a[6],d=a[7];break;case"z":case"Z":e.closePath()}c=a}}function B(e,t,n,r){for(var i=function(e,t,n,r,i,a,o,u,s){var l=S.call(arguments);if(F[l])return F[l];var c=o*E,f=Math.sin(c),d=Math.cos(c),h=d*(u-e)*.5+f*(s-t)*.5,p=d*(s-t)*.5-f*(u-e)*.5,v=h*h/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);v>1&&(n*=v=Math.sqrt(v),r*=v);var m=d/n,g=f/n,y=-f/r,b=d/r,x=m*u+g*s,w=y*u+b*s,k=m*e+g*t,A=y*e+b*t,O=1/((k-x)*(k-x)+(A-w)*(A-w))-.25;O<0&&(O=0);var _=Math.sqrt(O);a==i&&(_=-_);var M=.5*(x+k)-_*(A-w),j=.5*(w+A)+_*(k-x),T=Math.atan2(w-j,x-M),N=Math.atan2(A-j,k-M)-T;N<0&&1===a?N+=C:N>0&&0===a&&(N-=C);for(var B=Math.ceil(Math.abs(N/(D+.001))),R=[],z=0;z<B;++z){var P=T+z*N/B,L=T+(z+1)*N/B;R[z]=[M,j,P,L,n,r,f,d]}return F[l]=R}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n),a=0;a<i.length;++a){var o=M(i[a]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}var R={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,C)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,i=n/2.5,a=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-a),e.lineTo(i,-a),e.lineTo(0,-n),e.lineTo(-i,-a),e.lineTo(-r,-a),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=O*n,i=r-.5773502691896257*n,a=n/4;e.moveTo(0,-r-i),e.lineTo(-a,r-i),e.lineTo(a,r-i),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=O*n,i=r-.5773502691896257*n;e.moveTo(0,-r-i),e.lineTo(-n,r-i),e.lineTo(n,r-i),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=O*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=O*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=O*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=O*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function z(e){return t.hasOwnProperty(R,e)?R[e]:function(e){if(!t.hasOwnProperty(P,e)){var n=A(e);P[e]={draw:function(e,t){N(e,n,0,0,Math.sqrt(t)/2)}}}return P[e]}(e)}var P={};function L(e){return e.x}function I(e){return e.y}function U(e){return e.width}function q(e){return e.height}function W(e){return function(){return e}}function H(){var e=L,t=I,n=U,r=q,i=W(0),o=null;function u(u,s,l){var c,f=null!=s?s:+e.call(this,u),d=null!=l?l:+t.call(this,u),h=+n.call(this,u),p=+r.call(this,u),v=+i.call(this,u);if(o||(o=c=a.path()),v<=0)o.rect(f,d,h,p);else{var m=f+h,g=d+p;o.moveTo(f+v,d),o.lineTo(m-v,d),o.quadraticCurveTo(m,d,m,d+v),o.lineTo(m,g-v),o.quadraticCurveTo(m,g,m-v,g),o.lineTo(f+v,g),o.quadraticCurveTo(f,g,f,g-v),o.lineTo(f,d+v),o.quadraticCurveTo(f,d,f+v,d),o.closePath()}if(c)return o=null,c+""||null}return u.x=function(t){return arguments.length?(e="function"===typeof t?t:W(+t),u):e},u.y=function(e){return arguments.length?(t="function"===typeof e?e:W(+e),u):t},u.width=function(e){return arguments.length?(n="function"===typeof e?e:W(+e),u):n},u.height=function(e){return arguments.length?(r="function"===typeof e?e:W(+e),u):r},u.cornerRadius=function(e){return arguments.length?(i="function"===typeof e?e:W(+e),u):i},u.context=function(e){return arguments.length?(o=null==e?null:e,u):o},u}function V(){var e,t,n,r,i,o,u,s,l=null;function c(e,t,n){var r=n/2;if(i){var a=u-t,c=e-o;if(a||c){var f=Math.sqrt(a*a+c*c),d=(a/=f)*s,h=(c/=f)*s,p=Math.atan2(c,a);l.moveTo(o-d,u-h),l.lineTo(e-a*r,t-c*r),l.arc(e,t,r,p-Math.PI,p),l.lineTo(o+d,u+h),l.arc(o,u,s,p,p+Math.PI)}else l.arc(e,t,r,0,C);l.closePath()}else i=1;o=e,u=t,s=r}function f(o){var u,s,f,d=o.length,h=!1;for(null==l&&(l=f=a.path()),u=0;u<=d;++u)!(u<d&&r(s=o[u],u,o))===h&&(h=!h)&&(i=0),h&&c(+e(s,u,o),+t(s,u,o),+n(s,u,o));if(f)return l=null,f+""||null}return f.x=function(t){return arguments.length?(e=t,f):e},f.y=function(e){return arguments.length?(t=e,f):t},f.size=function(e){return arguments.length?(n=e,f):n},f.defined=function(e){return arguments.length?(r=e,f):r},f.context=function(e){return arguments.length?(l=null==e?null:e,f):l},f}function G(e){return e.x||0}function $(e){return e.y||0}function Y(e){return e.cornerRadius||0}function X(e){return!(!1===e.defined)}var J=i.arc().startAngle(function(e){return e.startAngle||0}).endAngle(function(e){return e.endAngle||0}).padAngle(function(e){return e.padAngle||0}).innerRadius(function(e){return e.innerRadius||0}).outerRadius(function(e){return e.outerRadius||0}).cornerRadius(Y),Q=i.area().x(G).y1($).y0(function(e){return(e.y||0)+(e.height||0)}).defined(X),K=i.area().y($).x1(G).x0(function(e){return(e.x||0)+(e.width||0)}).defined(X),Z=i.line().x(G).y($).defined(X),ee=H().x(G).y($).width(function(e){return e.width||0}).height(function(e){return e.height||0}).cornerRadius(Y),te=i.symbol().type(function(e){return z(e.shape||"circle")}).size(function(e){return null==e.size?64:e.size}),ne=V().x(G).y($).defined(X).size(function(e){return e.size||1});function re(e,t,n,r){return ee.context(e)(t,n,r)}function ie(e,t){return t.stroke&&0!==t.opacity&&0!==t.strokeOpacity&&e.expand(null!=t.strokeWidth?+t.strokeWidth:1),e}var ae,oe=C-1e-8;function ue(e){return ae=e,ue}function se(){}function le(e,t){ae.add(e,t)}ue.beginPath=se,ue.closePath=se,ue.moveTo=le,ue.lineTo=le,ue.rect=function(e,t,n,r){le(e,t),le(e+n,t+r)},ue.quadraticCurveTo=function(e,t,n,r){le(e,t),le(n,r)},ue.bezierCurveTo=function(e,t,n,r,i,a){le(e,t),le(n,r),le(i,a)},ue.arc=function(e,t,n,r,i,a){if(Math.abs(i-r)>oe)return le(e-n,t-n),void le(e+n,t+n);var o,u,s,l,c=1/0,f=-1/0,d=1/0,h=-1/0;function p(e){s=n*Math.cos(e),l=n*Math.sin(e),s<c&&(c=s),s>f&&(f=s),l<d&&(d=l),l>h&&(h=l)}if(p(r),p(i),i!==r)if((r%=C)<0&&(r+=C),(i%=C)<0&&(i+=C),i<r&&(a=!a,o=r,r=i,i=o),a)for(i-=C,o=r-r%D,u=0;u<4&&o>i;++u,o-=D)p(o);else for(o=r-r%D+D,u=0;u<4&&o<i;++u,o+=D)p(o);le(e+c,t+d),le(e+f,t+h)};var ce=(ce=n.canvas(1,1))?ce.getContext("2d"):null,fe=new o;function de(e){return function(t,n){if(!ce)return!0;e(ce,t),fe.clear().union(t.bounds).intersect(n).round();for(var r=fe.x1,i=fe.y1,a=fe.x2,o=fe.y2,u=i;u<=o;++u)for(var s=r;s<=a;++s)if(ce.isPointInPath(s,u))return!0;return!1}}function he(e,t){return t.contains(e.x||0,e.y||0)}function pe(e,t){var n=e.x||0,r=e.y||0,i=e.width||0,a=e.height||0;return t.intersects(fe.set(n,r,n+i,r+a))}function ve(e,t){var n=e.x||0,r=e.y||0;return me(t,n,r,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r)}function me(e,t,n,r,i){var a,o,u,s,l=e.x1,c=e.y1,f=e.x2,d=e.y2,h=r-t,p=i-n,v=0,m=1;for(s=0;s<4;++s){if(0===s&&(a=-h,o=-(l-t)),1===s&&(a=h,o=f-t),2===s&&(a=-p,o=-(c-n)),3===s&&(a=p,o=d-n),Math.abs(a)<1e-10&&o<0)return!1;if(u=o/a,a<0){if(u>m)return!1;u>v&&(v=u)}else if(a>0){if(u<v)return!1;u<m&&(m=u)}}return!0}function ge(e,t){return null==e?t:e}function ye(e,t,n){return c(n)?function(e,t,n){for(var r=n.width(),i=n.height(),a=t.stops,o=a.length,u="radial"===t.gradient?e.createRadialGradient(n.x1+ge(t.x1,.5)*r,n.y1+ge(t.y1,.5)*i,Math.max(r,i)*ge(t.r1,0),n.x1+ge(t.x2,.5)*r,n.y1+ge(t.y2,.5)*i,Math.max(r,i)*ge(t.r2,.5)):e.createLinearGradient(n.x1+ge(t.x1,0)*r,n.y1+ge(t.y1,0)*i,n.x1+ge(t.x2,1)*r,n.y1+ge(t.y2,0)*i),s=0;s<o;++s)u.addColorStop(a[s].offset,a[s].color);return u}(e,n,t.bounds):n}function be(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=ye(e,t,t.fill),!0)}var xe=[];function we(e,t,n){var r=null!=(r=t.strokeWidth)?r:1;return!(r<=0)&&(n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=ye(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||xe),e.lineDashOffset=t.strokeDashOffset||0),!0)}function ke(e,t){return e.zindex-t.zindex||e.index-t.index}function Ae(e){if(!e.zdirty)return e.zitems;var t,n,r,i=e.items,a=[];for(n=0,r=i.length;n<r;++n)(t=i[n]).index=n,t.zindex&&a.push(t);return e.zdirty=!1,e.zitems=a.sort(ke)}function Ee(e,t){var n,r,i=e.items;if(i&&i.length){var a=Ae(e);if(a&&a.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||t(i[n]);i=a}for(n=0,r=i.length;n<r;++n)t(i[n])}}function De(e,t){var n,r,i=e.items;if(!i||!i.length)return null;var a=Ae(e);for(a&&a.length&&(i=a),r=i.length;--r>=0;)if(n=t(i[r]))return n;if(i===a)for(r=(i=e.items).length;--r>=0;)if(!i[r].zindex&&(n=t(i[r])))return n;return null}function Ce(e){return function(t,n,r){Ee(n,function(n){r&&!r.intersects(n.bounds)||Fe(e,t,n,n)})}}function Oe(e){return function(t,n,r){!n.items.length||r&&!r.intersects(n.bounds)||Fe(e,t,n.items[0],n.items)}}function Fe(e,t,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(e(t,r)||(n.fill&&be(t,n,i)&&t.fill(),n.stroke&&we(t,n,i)&&t.stroke()))}function _e(e){return e=e||t.truthy,function(t,n,r,i,a,o){return r*=t.pixelRatio,i*=t.pixelRatio,De(n,function(n){var u=n.bounds;if((!u||u.contains(a,o))&&u)return e(t,n,r,i,a,o)?n:void 0})}}function Se(e,t){return function(n,r,i,a){var o,u,s=Array.isArray(r)?r[0]:r,l=null==t?s.fill:t,c=s.stroke&&n.isPointInStroke;return c&&(o=s.strokeWidth,u=s.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=u?u:"butt"),!e(n,r)&&(l&&n.isPointInPath(i,a)||c&&n.isPointInStroke(i,a))}}function Me(e){return _e(Se(e))}function je(e,t){return"translate("+e+","+t+")"}function Te(e){return"rotate("+e+")"}function Ne(e){return je(e.x||0,e.y||0)}function Be(e,t,n){function r(e,n){var r=n.x||0,i=n.y||0,a=n.angle||0;e.translate(r,i),a&&e.rotate(a*=E),e.beginPath(),t(e,n),a&&e.rotate(-a),e.translate(-r,-i)}return{type:e,tag:"path",nested:!1,attr:function(e,n){e("transform",function(e){return je(e.x||0,e.y||0)+(e.angle?" "+Te(e.angle):"")}(n)),e("d",t(null,n))},bound:function(e,n){var r=n.x||0,i=n.y||0;return t(ue(e),n),ie(e,n).translate(r,i),n.angle&&e.rotate(n.angle*E,r,i),e},draw:Ce(r),pick:Me(r),isect:n||de(r)}}var Re=Be("arc",function(e,t){return J.context(e)(t)});function ze(e,t,n){function r(e,n){e.beginPath(),t(e,n)}var i=Se(r);return{type:e,tag:"path",nested:!0,attr:function(e,n){var r=n.mark.items;r.length&&e("d",t(null,r))},bound:function(e,n){var r=n.items;return 0===r.length?e:(t(ue(e),r),ie(e,r[0]))},draw:Oe(r),pick:function(e,t,n,r,a,o){var u=t.items,s=t.bounds;return!u||!u.length||s&&!s.contains(a,o)?null:(n*=e.pixelRatio,r*=e.pixelRatio,i(e,u,n,r)?u[0]:null)},isect:he,tip:n}}var Pe=ze("area",function(e,t){var n=t[0],r=n.interpolate||"linear";return("horizontal"===n.orient?K:Q).curve(x(r,n.orient,n.tension)).context(e)(t)},function(e,t){for(var n,r,i="horizontal"===e[0].orient?t[1]:t[0],a="horizontal"===e[0].orient?"y":"x",o=e.length,u=1/0;--o>=0;)!1!==e[o].defined&&(r=Math.abs(e[o][a]-i))<u&&(u=r,n=e[o]);return n}),Le=1;function Ie(e,n,r){var i=n.clip,a=e._defs,o=n.clip_id||(n.clip_id="clip"+Le++),u=a.clipping[o]||(a.clipping[o]={id:o});return t.isFunction(i)?u.path=i(null):(u.width=r.width||0,u.height=r.height||0),"url(#"+o+")"}var Ue=.5;function qe(e,t){var n=t.stroke?Ue:0;e.beginPath(),re(e,t,n,n)}var We=Se(qe),He={type:"group",tag:"g",nested:!1,attr:function(e,t){e("transform",Ne(t))},bound:function(e,t){if(!t.clip&&t.items)for(var n=t.items,r=0,i=n.length;r<i;++r)e.union(n[r].bounds);return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),ie(e,t),e.translate(t.x||0,t.y||0)},draw:function(e,t,n){var r=this;Ee(t,function(t){var i,a=t.x||0,o=t.y||0,u=t.width||0,s=t.height||0;e.save(),e.translate(a,o),(t.stroke||t.fill)&&(i=null==t.opacity?1:t.opacity)>0&&(qe(e,t),t.fill&&be(e,t,i)&&e.fill(),t.stroke&&we(e,t,i)&&e.stroke()),t.clip&&(e.beginPath(),e.rect(0,0,u,s),e.clip()),n&&n.translate(-a,-o),Ee(t,function(t){r.draw(e,t,n)}),n&&n.translate(a,o),e.restore()})},pick:function(e,t,n,r,i,a){if(t.bounds&&!t.bounds.contains(i,a)||!t.items)return null;var o=this,u=n*e.pixelRatio,s=r*e.pixelRatio;return De(t,function(l){var c,f,d,h;if(!(h=l.bounds)||h.contains(i,a))return f=l.x||0,d=l.y||0,e.save(),e.translate(f,d),f=i-f,d=a-d,!(c=De(l,function(e){return function(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(e,f,d)?o.pick(e,n,r,f,d):null}))&&!1!==t.interactive&&(l.fill||l.stroke)&&We(e,l,u,s)&&(c=l),e.restore(),c||null})},isect:pe,background:function(e,t){var n=t.stroke?Ue:0;e("class","background"),e("d",re(null,t,n,n))},foreground:function(e,t,n){e("clip-path",t.clip?Ie(n,t,t):null)}};function Ve(e,t){var n=e.image;return n&&n.url===e.url||(n={loaded:!1,width:0,height:0},t.loadImage(e.url).then(function(t){e.image=t,e.image.url=e.url})),n}function Ge(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function $e(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function Ye(e,t){return"center"===e?t/2:"right"===e?t:0}function Xe(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var Je={type:"image",tag:"image",nested:!1,attr:function(e,t,n){var r=Ve(t,n),i=t.x||0,a=t.y||0,o=Ge(t,r),u=$e(t,r),s=!1===t.aspect?"none":"xMidYMid";i-=Ye(t.align,o),a-=Xe(t.baseline,u),e("href",r.src||"","http://www.w3.org/1999/xlink","xlink:href"),e("transform",je(i,a)),e("width",o),e("height",u),e("preserveAspectRatio",s)},bound:function(e,t){var n=t.image,r=t.x||0,i=t.y||0,a=Ge(t,n),o=$e(t,n);return r-=Ye(t.align,a),i-=Xe(t.baseline,o),e.set(r,i,r+a,i+o)},draw:function(e,t,n){var r=this;Ee(t,function(t){if(!n||n.intersects(t.bounds)){var i,a,o,u,s=Ve(t,r),l=t.x||0,c=t.y||0,f=Ge(t,s),d=$e(t,s);l-=Ye(t.align,f),c-=Xe(t.baseline,d),!1!==t.aspect&&(a=s.width/s.height,o=t.width/t.height,a===a&&o===o&&a!==o&&(o<a?(c+=(d-(u=f/a))/2,d=u):(l+=(f-(u=d*a))/2,f=u))),s.loaded&&(e.globalAlpha=null!=(i=t.opacity)?i:1,e.drawImage(s,l,c,f,d))}})},pick:_e(),isect:t.truthy,get:Ve,xOffset:Ye,yOffset:Xe},Qe=ze("line",function(e,t){var n=t[0],r=n.interpolate||"linear";return Z.curve(x(r,n.orient,n.tension)).context(e)(t)},function(e,t){for(var n,r,i=Math.pow(e[0].strokeWidth||1,2),a=e.length;--a>=0;)if(!1!==e[a].defined&&(n=e[a].x-t[0])*n+(r=e[a].y-t[1])*r<i)return e[a];return null});function Ke(e,t){var n=t.path;if(null==n)return!0;var r=t.pathCache;r&&r.path===n||((t.pathCache=r=A(n)).path=n),N(e,r,t.x,t.y)}var Ze={type:"path",tag:"path",nested:!1,attr:function(e,t){e("transform",Ne(t)),e("d",t.path)},bound:function(e,t){return Ke(ue(e),t)?e.set(0,0,0,0):ie(e,t)},draw:Ce(Ke),pick:Me(Ke),isect:de(Ke)};function et(e,t){e.beginPath(),re(e,t)}var tt={type:"rect",tag:"path",nested:!1,attr:function(e,t){e("d",re(null,t))},bound:function(e,t){var n,r;return ie(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)},draw:Ce(et),pick:Me(et),isect:pe};function nt(e,t,n){var r,i,a,o;return!(!t.stroke||!we(e,t,n))&&(r=t.x||0,i=t.y||0,a=null!=t.x2?t.x2:r,o=null!=t.y2?t.y2:i,e.beginPath(),e.moveTo(r,i),e.lineTo(a,o),!0)}var rt,it={type:"rule",tag:"line",nested:!1,attr:function(e,t){e("transform",Ne(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function(e,t){var n,r;return ie(e.set(n=t.x||0,r=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r),t)},draw:function(e,t,n){Ee(t,function(t){if(!n||n.intersects(t.bounds)){var r=null==t.opacity?1:t.opacity;r&&nt(e,t,r)&&e.stroke()}})},pick:_e(function(e,t,n,r){return!!e.isPointInStroke&&nt(e,t,1)&&e.isPointInStroke(n,r)}),isect:ve},at=Be("shape",function(e,t){return(t.mark.shape||t.shape).context(e)(t)}),ot=Be("symbol",function(e,t){return te.context(e)(t)},he),ut={height:dt,measureWidth:ct,estimateWidth:st,width:st,canvas:ht};function st(e,t){return rt=dt(e),lt(mt(e,t))}function lt(e){return~~(.8*e.length*rt)}function ct(e,t){return dt(e)<=0?0:(ce.font=yt(e),ft(mt(e,t)))}function ft(e){return ce.measureText(e).width}function dt(e){return null!=e.fontSize?e.fontSize:11}function ht(e){ut.width=e&&ce?ct:st}function pt(e){return null!=e.lineHeight?e.lineHeight:dt(e)+2}function vt(e){return n=e.lineBreak&&e.text&&!t.isArray(e.text)?e.text.split(e.lineBreak):e.text,t.isArray(n)?n.length>1?n:n[0]:n;var n}function mt(e,t){return null==t?"":e.limit>0?function(e,t){var n,r=+e.limit,i=t+"";if(ut.width===ct?(ce.font=yt(e),n=ft):(rt=dt(e),n=lt),n(i)<r)return i;var a,o=e.ellipsis||"\u2026",u="rtl"===e.dir,s=0,l=i.length;if(r-=n(o),u){for(;s<l;)a=s+l>>>1,n(i.slice(a))>r?s=a+1:l=a;return o+i.slice(s)}for(;s<l;)a=1+(s+l>>>1),n(i.slice(0,a))<r?s=a:l=a-1;return i.slice(0,s)+o}(e,t):t+""}function gt(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function yt(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+dt(e)+"px "+gt(e,t)}function bt(e){var t=e.baseline,n=dt(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:0)}ht(!0);var xt={left:"start",center:"middle",right:"end"},wt=new o;function kt(e){var t,n=e.x||0,r=e.y||0,i=e.radius||0;return i&&(t=(e.theta||0)-D,n+=i*Math.cos(t),r+=i*Math.sin(t)),wt.x1=n,wt.y1=r,wt}function At(e,n,r){var i,a=ut.height(n),o=n.align,u=kt(n),s=u.x1,l=u.y1,c=n.dx||0,f=(n.dy||0)+bt(n)-Math.round(.8*a),d=vt(n);if(t.isArray(d)?(a+=pt(n)*(d.length-1),i=d.reduce(function(e,t){return Math.max(e,ut.width(n,t))},0)):i=ut.width(n,d),"center"===o?c-=i/2:"right"===o&&(c-=i),e.set(c+=s,f+=l,c+i,f+a),n.angle&&!r)e.rotate(n.angle*E,s,l);else if(2===r)return e.rotatedPoints(n.angle*E,s,l);return e}var Et={type:"text",tag:"text",nested:!1,attr:function(e,t){var n,r=t.dx||0,i=(t.dy||0)+bt(t),a=kt(t),o=a.x1,u=a.y1,s=t.angle||0;e("text-anchor",xt[t.align]||"start"),s?(n=je(o,u)+" "+Te(s),(r||i)&&(n+=" "+je(r,i))):n=je(o+r,u+i),e("transform",n)},bound:At,draw:function(e,n,r){Ee(n,function(n){var i,a,o,u,s,l,c,f=null==n.opacity?1:n.opacity;if(!(r&&!r.intersects(n.bounds)||0===f||n.fontSize<=0||null==n.text||0===n.text.length)){if(e.font=yt(n),e.textAlign=n.align||"left",a=(i=kt(n)).x1,o=i.y1,n.angle&&(e.save(),e.translate(a,o),e.rotate(n.angle*E),a=o=0),a+=n.dx||0,o+=(n.dy||0)+bt(n),l=vt(n),t.isArray(l))for(s=pt(n),u=0;u<l.length;++u)c=mt(n,l[u]),n.fill&&be(e,n,f)&&e.fillText(c,a,o),n.stroke&&we(e,n,f)&&e.strokeText(c,a,o),o+=s;else c=mt(n,l),n.fill&&be(e,n,f)&&e.fillText(c,a,o),n.stroke&&we(e,n,f)&&e.strokeText(c,a,o);n.angle&&e.restore()}})},pick:_e(function(e,t,n,r,i,a){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=kt(t),u=o.x1,s=o.y1,l=At(wt,t,1),c=-t.angle*E,f=Math.cos(c),d=Math.sin(c),h=f*i-d*a+(u-f*u+d*s),p=d*i+f*a+(s-d*u-f*s);return l.contains(h,p)}),isect:function(e,t){var n=At(wt,e,2);return me(t,n[0],n[1],n[2],n[3])||me(t,n[0],n[1],n[4],n[5])||me(t,n[4],n[5],n[6],n[7])||me(t,n[2],n[3],n[6],n[7])}},Dt=ze("trail",function(e,t){return ne.context(e)(t)},function(e,t){for(var n,r,i=e.length;--i>=0;)if(!1!==e[i].defined&&(n=e[i].x-t[0])*n+(r=e[i].y-t[1])*r<(n=e[i].size||1)*n)return e[i];return null}),Ct={arc:Re,area:Pe,group:He,image:Je,line:Qe,path:Ze,rect:tt,rule:it,shape:at,symbol:ot,text:Et,trail:Dt};function Ot(e,t,n){var r=Ct[e.mark.marktype],i=t||r.bound;return r.nested&&(e=e.mark),i(e.bounds||(e.bounds=new o),e,n)}var Ft={mark:null};function _t(e,t,n){var r,i,a,u,s=Ct[e.marktype],l=s.bound,c=e.items,f=c&&c.length;if(s.nested)return f?a=c[0]:(Ft.mark=e,a=Ft),u=Ot(a,l,n),t=t&&t.union(u)||u;if(t=t||e.bounds&&e.bounds.clear()||new o,f)for(r=0,i=c.length;r<i;++r)t.union(Ot(c[r],l,n));return e.bounds=t}var St=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","interpolate","tension","orient","defined","url","path","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant"];function Mt(e,t){return JSON.stringify(e,St,t)}function jt(e){return function e(t){var n,r,i,a=t.marktype,o=t.items;if(o)for(r=0,i=o.length;r<i;++r)n=a?"mark":"group",o[r][n]=t,o[r].zindex&&(o[r][n].zdirty=!0),"group"===(a||n)&&e(o[r]);return a&&_t(t),t}("string"===typeof e?JSON.parse(e):e)}function Tt(e){arguments.length?this.root=jt(e):(this.root=Bt({marktype:"group",name:"root",role:"frame"}),this.root.items=[new p(this.root)])}var Nt=Tt.prototype;function Bt(e,t){return{bounds:new o,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0}}function Rt(e,t,n){return!e&&"undefined"!==typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function zt(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function Pt(e,t,n,r){var i,a=e.childNodes[t];return a&&a.tagName.toLowerCase()===n.toLowerCase()||(i=a||null,a=Rt(e.ownerDocument,n,r),e.insertBefore(a,i)),a}function Lt(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function It(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Ut(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function qt(e,t){this._active=null,this._handlers={},this._loader=e||r.loader(),this._tooltip=t||Wt}function Wt(e,t,n,r){e.element().setAttribute("title",r||"")}Nt.toJSON=function(e){return Mt(this.root,e||0)},Nt.mark=function(e,t,n){var r=Bt(e,t=t||this.root.items[0]);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r};var Ht=qt.prototype;function Vt(e){this._el=null,this._bgcolor=null,this._loader=new v(e)}Ht.initialize=function(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},Ht.element=function(){return this._el},Ht.canvas=function(){return this._el&&this._el.firstChild},Ht.origin=function(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},Ht.scene=function(e){return arguments.length?(this._scene=e,this):this._scene},Ht.on=function(){},Ht.off=function(){},Ht._handlerIndex=function(e,t,n){for(var r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},Ht.handlers=function(e){var t,n=this._handlers,r=[];if(e)r.push.apply(r,n[this.eventName(e)]);else for(t in n)r.push.apply(r,n[t]);return r},Ht.eventName=function(e){var t=e.indexOf(".");return t<0?e:e.slice(0,t)},Ht.handleHref=function(e,t,n){this._loader.sanitize(n,{context:"href"}).then(function(t){var n=new MouseEvent(e.type,e),r=Rt(null,"a");for(var i in t)r.setAttribute(i,t[i]);r.dispatchEvent(n)}).catch(function(){})},Ht.handleTooltip=function(e,t,n){if(t&&null!=t.tooltip){t=function(e,t,n,r){var i,a,o=e&&e.mark;if(o&&(i=Ct[o.marktype]).tip){for((a=Ut(t,n))[0]-=r[0],a[1]-=r[1];e=e.mark.group;)a[0]-=e.x||0,a[1]-=e.y||0;e=i.tip(o.items,a)}return e}(t,e,this.canvas(),this._origin);var r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},Ht.getItemBoundingClientRect=function(e){if(t=this.canvas()){for(var t,n=t.getBoundingClientRect(),r=this._origin,i=e.bounds,a=i.x1+r[0]+n.left,o=i.y1+r[1]+n.top,u=i.width(),s=i.height();e.mark&&(e=e.mark.group);)a+=e.x||0,o+=e.y||0;return{x:a,y:o,width:u,height:s,left:a,top:o,right:a+u,bottom:o+s}}};var Gt=Vt.prototype;Gt.initialize=function(e,t,n,r,i){return this._el=e,this.resize(t,n,r,i)},Gt.element=function(){return this._el},Gt.canvas=function(){return this._el&&this._el.firstChild},Gt.background=function(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},Gt.resize=function(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},Gt.dirty=function(){},Gt.render=function(e){var t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},Gt._render=function(){},Gt.renderAsync=function(e){var t=this.render(e);return this._ready?this._ready.then(function(){return t}):Promise.resolve(t)},Gt._load=function(e,t){var n=this,r=n._loader[e](t);if(!n._ready){var i=n._call;n._ready=n._loader.ready().then(function(e){e&&i(),n._ready=null})}return r},Gt.sanitizeURL=function(e){return this._load("sanitizeURL",e)},Gt.loadImage=function(e){return this._load("loadImage",e)};var $t="mouseout";function Yt(e,t){qt.call(this,e,t),this._down=null,this._touch=null,this._first=!0}var Xt=t.inherits(Yt,qt);function Jt(e,t,n){return function(r){var i=this._active,a=this.pickEvent(r);a===i?this.fire(e,r):(i&&i.exit||this.fire(n,r),this._active=a,this.fire(t,r),this.fire(e,r))}}function Qt(e){return function(t){this.fire(e,t),this._active=null}}Xt.initialize=function(e,t,n){var r=this._canvas=e&&zt(e,"canvas");if(r){var i=this;this.events.forEach(function(e){r.addEventListener(e,function(t){Xt[e]?Xt[e].call(i,t):i.fire(e,t)})})}return qt.prototype.initialize.call(this,e,t,n)},Xt.canvas=function(){return this._canvas},Xt.context=function(){return this._canvas.getContext("2d")},Xt.events=["keydown","keypress","keyup","dragenter","dragleave","dragover","mousedown","mouseup","mousemove","mouseout","mouseover","click","dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],Xt.DOMMouseScroll=function(e){this.fire("mousewheel",e)},Xt.mousemove=Jt("mousemove","mouseover","mouseout"),Xt.dragover=Jt("dragover","dragenter","dragleave"),Xt.mouseout=Qt("mouseout"),Xt.dragleave=Qt("dragleave"),Xt.mousedown=function(e){this._down=this._active,this.fire("mousedown",e)},Xt.click=function(e){this._down===this._active&&(this.fire("click",e),this._down=null)},Xt.touchstart=function(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",e,!0)},Xt.touchmove=function(e){this.fire("touchmove",e,!0)},Xt.touchend=function(e){this.fire("touchend",e,!0),this._touch=null},Xt.fire=function(e,t,n){var r,i,a=n?this._touch:this._active,o=this._handlers[e];if(t.vegaType=e,"click"===e&&a&&a.href?this.handleHref(t,a,a.href):"mousemove"!==e&&e!==$t||this.handleTooltip(t,a,e!==$t),o)for(r=0,i=o.length;r<i;++r)o[r].handler.call(this._obj,t,a)},Xt.on=function(e,t){var n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(r[n]||(r[n]=[])).push({type:e,handler:t}),this},Xt.off=function(e,t){var n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&r.splice(i,1),this},Xt.pickEvent=function(e){var t=Ut(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},Xt.pick=function(e,t,n,r,i){var a=this.context();return Ct[e.marktype].pick.call(this,a,e,t,n,r,i)};var Kt="undefined"!==typeof window&&window.devicePixelRatio||1;function Zt(e){Vt.call(this,e),this._redraw=!1,this._dirty=new o}var en=t.inherits(Zt,Vt),tn=Vt.prototype,nn=new o;function rn(e,t){qt.call(this,e,t);var n=this;n._hrefHandler=on(n,function(e,t){t&&t.href&&n.handleHref(e,t,t.href)}),n._tooltipHandler=on(n,function(e,t){n.handleTooltip(e,t,e.type!==$t)})}en.initialize=function(e,t,r,i,a,o){return this._options=o,this._canvas=n.canvas(1,1,o&&o.type),e&&(Lt(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),tn.initialize.call(this,e,t,r,i,a)},en.resize=function(e,t,n,r){return tn.resize.call(this,e,t,n,r),function(e,t,n,r,i,a){var o,u="undefined"!==typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,s=e.getContext("2d"),l=u?Kt:i;for(o in e.width=t*l,e.height=n*l,a)s[o]=a[o];u&&1!==l&&(e.style.width=t+"px",e.style.height=n+"px"),s.pixelRatio=l,s.setTransform(l,0,0,l,l*r[0],l*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options&&this._options.context),this._redraw=!0,this},en.canvas=function(){return this._canvas},en.context=function(){return this._canvas?this._canvas.getContext("2d"):null},en.dirty=function(e){var t=function(e,t){if(null==t)return e;for(var n=nn.clear().union(e);null!=t;t=t.mark.group)n.translate(t.x||0,t.y||0);return n}(e.bounds,e.mark.group);this._dirty.union(t)},en._render=function(e){var t=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty;return t.save(),this._redraw||a.empty()?(this._redraw=!1,a=null):a=function(e,t,n){return t.expand(1).round(),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(t,a,n),this.clear(-n[0],-n[1],r,i),this.draw(t,e,a),t.restore(),this._dirty.clear(),this},en.draw=function(e,n,r){var i=Ct[n.marktype];n.clip&&function(e,n){var r=n.clip;if(e.save(),e.beginPath(),t.isFunction(r))r(e);else{var i=n.group;e.rect(0,0,i.width||0,i.height||0)}e.clip()}(e,n),i.draw.call(this,e,n,r),n.clip&&e.restore()},en.clear=function(e,t,n,r){var i=this.context();i.clearRect(e,t,n,r),null!=this._bgcolor&&(i.fillStyle=this._bgcolor,i.fillRect(e,t,n,r))};var an=t.inherits(rn,qt);function on(e,t){return function(n){var r=n.target.__data__;n.vegaType=n.type,r=Array.isArray(r)?r[0]:r,t.call(e._obj,n,r)}}function un(e,t,n){var r,i,a="<"+e;if(t)for(r in t)null!=(i=t[r])&&(a+=" "+r+'="'+i+'"');return n&&(a+=" "+n),a+">"}function sn(e){return"</"+e+">"}an.initialize=function(e,t,n){var r=this._svg;return r&&(r.removeEventListener("click",this._hrefHandler),r.removeEventListener("mousemove",this._tooltipHandler),r.removeEventListener($t,this._tooltipHandler)),this._svg=r=e&&zt(e,"svg"),r&&(r.addEventListener("click",this._hrefHandler),r.addEventListener("mousemove",this._tooltipHandler),r.addEventListener($t,this._tooltipHandler)),qt.prototype.initialize.call(this,e,t,n)},an.canvas=function(){return this._svg},an.on=function(e,t){var n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){var i={type:e,handler:t,listener:on(this,t)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},an.off=function(e,t){var n=this.eventName(e),r=this._handlers[n],i=this._handlerIndex(r,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this};var ln={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},cn={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},fn=Object.keys(cn),dn=ln.xmlns;function hn(e){Vt.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var pn=t.inherits(hn,Vt),vn=Vt.prototype;function mn(e,t,n){var r,i,a;if("radial"===t.gradient){var o=Pt(e,n++,"pattern",dn);o.setAttribute("id",l+t.id),o.setAttribute("viewBox","0,0,1,1"),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("preserveAspectRatio","xMidYMid slice"),(o=Pt(o,0,"rect",dn)).setAttribute("width","1"),o.setAttribute("height","1"),o.setAttribute("fill","url("+Dn()+"#"+t.id+")"),(e=Pt(e,n++,"radialGradient",dn)).setAttribute("id",t.id),e.setAttribute("fx",t.x1),e.setAttribute("fy",t.y1),e.setAttribute("fr",t.r1),e.setAttribute("cx",t.x2),e.setAttribute("cy",t.y2),e.setAttribute("r",t.r2)}else(e=Pt(e,n++,"linearGradient",dn)).setAttribute("id",t.id),e.setAttribute("x1",t.x1),e.setAttribute("x2",t.x2),e.setAttribute("y1",t.y1),e.setAttribute("y2",t.y2);for(r=0,i=t.stops.length;r<i;++r)(a=Pt(e,r,"stop",dn)).setAttribute("offset",t.stops[r].offset),a.setAttribute("stop-color",t.stops[r].color);return Lt(e,r),n}function gn(e,t,n){var r;return(e=Pt(e,n,"clipPath",dn)).setAttribute("id",t.id),t.path?(r=Pt(e,0,"path",dn)).setAttribute("d",t.path):((r=Pt(e,0,"rect",dn)).setAttribute("x",0),r.setAttribute("y",0),r.setAttribute("width",t.width),r.setAttribute("height",t.height)),n+1}function yn(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function bn(e,t,n,r,i){var a,o=e._svg;if(!o&&(o=Rt(a=t.ownerDocument,r,dn),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},"g"===r))){var u=Rt(a,"path",dn);u.setAttribute("class","background"),o.appendChild(u),u.__data__=e;var s=Rt(a,"g",dn);o.appendChild(s),s.__data__=e}return(o.ownerSVGElement!==i||function(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}pn.initialize=function(e,t,n,r){return e&&(this._svg=Pt(e,0,"svg",dn),this._svg.setAttribute("class","marks"),Lt(e,1),this._root=Pt(this._svg,0,"g",dn),Lt(this._svg,1)),this._defs={gradient:{},clipping:{}},this.background(this._bgcolor),vn.initialize.call(this,e,t,n,r)},pn.background=function(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),vn.background.apply(this,arguments)},pn.resize=function(e,t,n,r){return vn.resize.call(this,e,t,n,r),this._svg&&(this._svg.setAttribute("width",this._width*this._scale),this._svg.setAttribute("height",this._height*this._scale),this._svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height),this._root.setAttribute("transform","translate("+this._origin+")")),this._dirty=[],this},pn.canvas=function(){return this._svg},pn.svg=function(){if(!this._svg)return null;var e={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var t in ln)e[t]=ln[t];var n=this._bgcolor?un("rect",{width:this._width,height:this._height,style:"fill: "+this._bgcolor+";"})+sn("rect"):"";return un("svg",e)+n+this._svg.innerHTML+sn("svg")},pn._render=function(e){return this._dirtyCheck()&&(this._dirtyAll&&this._resetDefs(),this.draw(this._root,e),Lt(this._root,1)),this.updateDefs(),this._dirty=[],++this._dirtyID,this},pn.updateDefs=function(){var e,t=this._svg,n=this._defs,r=n.el,i=0;for(e in n.gradient)r||(n.el=r=Pt(t,0,"defs",dn)),i=mn(r,n.gradient[e],i);for(e in n.clipping)r||(n.el=r=Pt(t,0,"defs",dn)),i=gn(r,n.clipping[e],i);r&&(0===i?(t.removeChild(r),n.el=null):Lt(r,i))},pn._resetDefs=function(){var e=this._defs;e.gradient={},e.clipping={}},pn.dirty=function(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},pn.isDirty=function(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},pn._dirtyCheck=function(){this._dirtyAll=!0;var e=this._dirty;if(!e.length||!this._dirtyID)return!0;var t,n,r,i,a,o,u,s=++this._dirtyID;for(a=0,o=e.length;a<o;++a)(n=(t=e[a]).mark).marktype!==r&&(r=n.marktype,i=Ct[r]),n.zdirty&&n.dirty!==s&&(this._dirtyAll=!1,yn(t,s),n.items.forEach(function(e){e.dirty=s})),n.zdirty||(t.exit?(i.nested&&n.items.length?(u=n.items[0])._svg&&this._update(i,u._svg,u):t._svg&&(u=t._svg.parentNode)&&u.removeChild(t._svg),t._svg=null):(t=i.nested?n.items[0]:t)._update!==s&&(t._svg&&t._svg.ownerSVGElement?this._update(i,t._svg,t):(this._dirtyAll=!1,yn(t,s)),t._update=s));return!this._dirtyAll},pn.draw=function(e,t,n){if(!this.isDirty(t))return t._svg;var r,i=this,a=this._svg,o=Ct[t.marktype],u=!1===t.interactive?"none":null,s="g"===o.tag,l=null,c=0;function f(e){var t=i.isDirty(e),n=bn(e,r,l,o.tag,a);t&&(i._update(o,n,e),s&&function(e,t,n){t=t.lastChild;var r,i=0;Ee(n,function(n){r=e.draw(t,n,r),++i}),Lt(t,1+i)}(i,n,e)),l=n,++c}return(r=bn(t,e,n,"g",a)).setAttribute("class",It(t)),s||r.style.setProperty("pointer-events",u),t.clip?r.setAttribute("clip-path",Ie(i,t,t.group)):r.removeAttribute("clip-path"),o.nested?t.items.length&&f(t.items[0]):Ee(t,f),Lt(r,c),r};var xn=null,wn=null,kn={group:function(e,t,n){wn=t.__values__,xn=t.childNodes[1],e.foreground(En,n,this),xn=t.childNodes[0],e.background(En,n,this);var r=!1===n.mark.interactive?"none":null;r!==wn.events&&(xn.style.setProperty("pointer-events",r),wn.events=r)},text:function(e,n,r){var i,a,o,u,s=vt(r);t.isArray(s)?(i=(a=s.map(function(e){return mt(r,e)})).join("\n"))!==wn.text&&(Lt(n,0),o=n.ownerDocument,u=pt(r),a.forEach(function(e,t){var i=Rt(o,"tspan",dn);i.__data__=r,i.textContent=e,t&&(i.setAttribute("x",0),i.setAttribute("dy",u)),n.appendChild(i)}),wn.text=i):(a=mt(r,s))!==wn.text&&(n.textContent=a,wn.text=a),An(n,"font-family",gt(r)),An(n,"font-size",dt(r)+"px"),An(n,"font-style",r.fontStyle),An(n,"font-variant",r.fontVariant),An(n,"font-weight",r.fontWeight)}};function An(e,t,n){n!==wn[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),wn[t]=n)}function En(e,t,n){t!==wn[e]&&(null!=t?n?xn.setAttributeNS(n,e,t):xn.setAttribute(e,t):n?xn.removeAttributeNS(n,e):xn.removeAttribute(e),wn[e]=t)}function Dn(){var e;return"undefined"===typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function Cn(e){Vt.call(this,e),this._text={head:"",bg:"",root:"",foot:"",defs:"",body:""},this._defs={gradient:{},clipping:{}}}pn._update=function(e,t,n){xn=t,wn=t.__values__,e.attr(En,n,this);var r=kn[e.type];r&&r.call(this,e,t,n),this.style(xn,n)},pn.style=function(e,t){var n,r,i,a,o;if(null!=t)for(n=0,r=fn.length;n<r;++n)o=t[i=fn[n]],"font"===i&&(o=gt(t)),o!==wn[i]&&(a=cn[i],null==o?"fill"===a?e.style.setProperty(a,"none"):e.style.removeProperty(a):(c(o)&&(o=f(o,this._defs.gradient,Dn())),e.style.setProperty(a,o+"")),wn[i]=o)};var On,Fn=t.inherits(Cn,Vt),_n=Vt.prototype;function Sn(e,t,n,r){On[r||e]=t}function Mn(e,t,n,r){if(null==e)return"";var i,a,o,u,s,l="";for("bgrect"===n&&!1===t.interactive&&(l+="pointer-events: none; "),"text"===n&&(l+="font-family: "+gt(e)+"; ",l+="font-size: "+dt(e)+"px; ",e.fontStyle&&(l+="font-style: "+e.fontStyle+"; "),e.fontVariant&&(l+="font-variant: "+e.fontVariant+"; "),e.fontWeight&&(l+="font-weight: "+e.fontWeight+"; ")),i=0,a=fn.length;i<a;++i)o=fn[i],u=cn[o],null==(s=e[o])?"fill"===u&&(l+="fill: none; "):"transparent"!==s||"fill"!==u&&"stroke"!==u?(c(s)&&(s=f(s,r.gradient,"")),l+=u+": "+s+"; "):l+=u+": none; ";return l?'style="'+l.trim()+'"':null}function jn(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}Fn.resize=function(e,t,n,r){_n.resize.call(this,e,t,n,r);var i=this._origin,a=this._text,o={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var u in ln)o[u]=ln[u];a.head=un("svg",o);var s=this._bgcolor;return"transparent"!==s&&"none"!==s||(s=null),a.bg=s?un("rect",{width:this._width,height:this._height,style:"fill: "+s+";"})+sn("rect"):"",a.root=un("g",{transform:"translate("+i+")"}),a.foot=sn("g")+sn("svg"),this},Fn.background=function(){var e=_n.background.apply(this,arguments);return arguments.length&&this._text.head&&this.resize(this._width,this._height,this._origin,this._scale),e},Fn.svg=function(){var e=this._text;return e.head+e.bg+e.defs+e.root+e.body+e.foot},Fn._render=function(e){return this._text.body=this.mark(e),this._text.defs=this.buildDefs(),this},Fn.buildDefs=function(){var e,t,n,r,i,a=this._defs,o="";for(t in a.gradient){for(i=(n=a.gradient[t]).stops,"radial"===n.gradient?(o+=un(r="pattern",{id:l+t,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o+=un("rect",{width:"1",height:"1",fill:"url(#"+t+")"})+sn("rect"),o+=sn(r),o+=un(r="radialGradient",{id:t,fx:n.x1,fy:n.y1,fr:n.r1,cx:n.x2,cy:n.y2,r:n.r2})):o+=un(r="linearGradient",{id:t,x1:n.x1,x2:n.x2,y1:n.y1,y2:n.y2}),e=0;e<i.length;++e)o+=un("stop",{offset:i[e].offset,"stop-color":i[e].color})+sn("stop");o+=sn(r)}for(t in a.clipping)n=a.clipping[t],o+=un("clipPath",{id:t}),n.path?o+=un("path",{d:n.path})+sn("path"):o+=un("rect",{x:0,y:0,width:n.width,height:n.height})+sn("rect"),o+=sn("clipPath");return o.length>0?un("defs")+o+sn("defs"):""},Fn.attributes=function(e,t){return On={},e(Sn,t,this),On},Fn.href=function(e){var t,n=this,r=e.href;if(r){if(t=n._hrefs&&n._hrefs[r])return t;n.sanitizeURL(r).then(function(e){e["xlink:href"]=e.href,e.href=null,(n._hrefs||(n._hrefs={}))[r]=e})}return null},Fn.mark=function(e){var n,r=this,i=Ct[e.marktype],a=i.tag,o=this._defs,u="";function s(s){var l=r.href(s);if(l&&(u+=un("a",l)),n="g"!==a?Mn(s,e,a,o):null,u+=un(a,r.attributes(i.attr,s),n),"text"===a){var c=vt(s);if(t.isArray(c))for(var f={x:0,dy:pt(s)},d=0;d<c.length;++d)u+=un("tspan",d?f:null)+jn(mt(s,c[d]))+sn("tspan");else u+=jn(mt(s,c))}else"g"===a&&(u+=un("path",r.attributes(i.background,s),Mn(s,e,"bgrect",o))+sn("path"),u+=un("g",r.attributes(i.foreground,s))+r.markGroup(s)+sn("g"));u+=sn(a),l&&(u+=sn("a"))}return"g"!==a&&!1===e.interactive&&(n='style="pointer-events: none;"'),u+=un("g",{class:It(e),"clip-path":e.clip?Ie(r,e,e.group):null},n),i.nested?e.items&&e.items.length&&s(e.items[0]):Ee(e,s),u+sn("g")},Fn.markGroup=function(e){var t=this,n="";return Ee(e,function(e){n+=t.mark(e)}),n};var Tn={Canvas:"canvas",PNG:"png",SVG:"svg",None:"none"},Nn={};function Bn(e,t,n,r){if(function(e,t,n){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!n||n(e)))}(e,t,n)){var i=e.items,a=e.marktype,o=i.length,u=0;if("group"===a)for(;u<o;++u)Rn(i[u],t,n,r);else for(var s=Ct[a].isect;u<o;++u){var l=i[u];zn(l,t,s)&&r.push(l)}}return r}function Rn(e,t,n,r){n&&n(e.mark)&&zn(e,t,Ct.group.isect)&&r.push(e);var i=e.items,a=i&&i.length;if(a){var o=e.x||0,u=e.y||0;t.translate(-o,-u);for(var s=0;s<a;++s)Bn(i[s],t,n,r);t.translate(o,u)}return r}function zn(e,t,n){var r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}Nn.canvas=Nn.png={renderer:Zt,headless:Zt,handler:Yt},Nn.svg={renderer:hn,headless:Cn,handler:rn},Nn.none={};var Pn=new o,Ln=1e-9;function In(e,n,r){return e===n||("path"===r?Un(e,n):e instanceof Date&&n instanceof Date?+e===+n:t.isNumber(e)&&t.isNumber(n)?Math.abs(e-n)<=Ln:e&&n&&(t.isObject(e)||t.isObject(n))?null!=e&&null!=n&&function(e,t){var n,r,i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(i.sort(),a.sort(),r=i.length-1;r>=0;r--)if(i[r]!=a[r])return!1;for(r=i.length-1;r>=0;r--)if(n=i[r],!In(e[n],t[n],n))return!1;return typeof e===typeof t}(e,n):e==n)}function Un(e,t){return In(A(e),A(t))}e.Bounds=o,e.CanvasHandler=Yt,e.CanvasRenderer=Zt,e.Gradient=function(e,t){var n,r=[];return n={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:r,stop:function(e,t){return r.push({offset:e,color:t}),n}}},e.GroupItem=p,e.Handler=qt,e.Item=h,e.Marks=Ct,e.RenderType=Tn,e.Renderer=Vt,e.ResourceLoader=v,e.SVGHandler=rn,e.SVGRenderer=hn,e.SVGStringRenderer=Cn,e.Scenegraph=Tt,e.boundClip=function(e){var n=e.clip;if(t.isFunction(n))n(ue(Pn.clear()));else{if(!n)return;Pn.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(Pn)},e.boundContext=ue,e.boundItem=Ot,e.boundMark=_t,e.boundStroke=ie,e.closeTag=sn,e.domChild=Pt,e.domClear=Lt,e.domCreate=Rt,e.domFind=zt,e.font=yt,e.fontFamily=gt,e.fontSize=dt,e.intersect=function(e,n,r){var i=[],a=(new o).union(n),u=e.marktype;return u?Bn(e,a,r,i):"group"===u?Rn(e,a,r,i):t.error("Intersect scene must be mark node or group item.")},e.intersectBoxLine=me,e.intersectPath=de,e.intersectPoint=he,e.intersectRule=ve,e.lineHeight=pt,e.multiLineOffset=function(e){var n=vt(e);return(t.isArray(n)?n.length-1:0)*pt(e)},e.openTag=un,e.pathCurves=x,e.pathEqual=Un,e.pathParse=A,e.pathRectangle=H,e.pathRender=N,e.pathSymbols=z,e.pathTrail=V,e.point=Ut,e.renderModule=function(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Nn[e]=t,this):Nn[e]},e.resetSVGClipId=function(){Le=1},e.sceneEqual=In,e.sceneFromJSON=jt,e.scenePickVisit=De,e.sceneToJSON=Mt,e.sceneVisit=Ee,e.sceneZOrder=Ae,e.textMetrics=ut,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1469),n(2072),n(1797),n(212),n(589))},1797:function(e,t,n){(function(e){var r=n(21),i=n(1622);!function(t,n,a,o,u){"use strict";var s=/^([A-Za-z]+:)?\/\//,l=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,c=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,f="file://";function d(e,t){return h.apply(this,arguments)}function h(){return(h=i(r.mark(function e(t,n){var i,a;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sanitize(t,n);case 2:return i=e.sent,a=i.href,e.abrupt("return",i.localFile?this.file(a):this.http(a,n));case 5:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function p(e,t){return v.apply(this,arguments)}function v(){return(v=i(r.mark(function e(t,i){var a,o,u,d,h,p,v;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.extend({},this.options,i),a=this.fileAccess,o={href:null},p=l.test(t.replace(c,"")),null!=t&&"string"===typeof t&&p||n.error("Sanitize failure, invalid URI: "+n.stringValue(t)),v=s.test(t),(h=i.baseURL)&&!v&&(t.startsWith("/")||"/"===h[h.length-1]||(t="/"+t),t=h+t),d=(u=t.startsWith(f))||"file"===i.mode||"http"!==i.mode&&!v&&a,u?t=t.slice(f.length):t.startsWith("//")&&("file"===i.defaultProtocol?(t=t.slice(2),d=!0):t=(i.defaultProtocol||"http")+":"+t),Object.defineProperty(o,"localFile",{value:!!d}),o.href=t,i.target&&(o.target=i.target+""),i.rel&&(o.rel=i.rel+""),e.abrupt("return",o);case 13:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function m(e){return e?function(t){return new Promise(function(n,r){e.readFile(t,function(e,t){e?r(e):n(t)})})}:g}function g(){return y.apply(this,arguments)}function y(){return(y=i(r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.error("No file system access.");case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function b(e){return e?function(){var t=i(r.mark(function t(i,a){var o,u,s;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.extend({},this.options.http,a),u=a&&a.response,t.next=4,e(i,o);case 4:return s=t.sent,t.abrupt("return",s.ok?n.isFunction(s[u])?s[u]():s.text():n.error(s.status+""+s.statusText));case 6:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}():x}function x(){return w.apply(this,arguments)}function w(){return(w=i(r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.error("No HTTP fetch method available.");case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var k={boolean:n.toBoolean,integer:n.toNumber,number:n.toNumber,date:n.toDate,string:n.toString,unknown:n.identity},A=[function(e){return"true"===e||"false"===e||!0===e||!1===e},function(e){return O(e)&&Number.isInteger(+e)},O,function(e){return!Number.isNaN(Date.parse(e))}],E=["boolean","integer","number","date"];function D(e,t){if(!e||!e.length)return"unknown";var n,r,i,a,o=0,u=e.length,s=A.length,l=A.map(function(e,t){return t+1});for(r=0,u=e.length;r<u;++r)for(n=t?e[r][t]:e[r],i=0;i<s;++i)if(l[i]&&null!=(a=n)&&a===a&&!A[i](n)&&(l[i]=0,++o===A.length))return"string";return o=l.reduce(function(e,t){return 0===e?t:e},0)-1,E[o]}function C(e,t){return t.reduce(function(t,n){return t[n]=D(e,n),t},{})}function O(e){return!Number.isNaN(+e)&&!(e instanceof Date)}function F(e){var t=function(t,r){var i={delimiter:e};return _(t,r?n.extend(r,i):i)};return t.responseType="text",t}function _(e,t){return t.header&&(e=t.header.map(n.stringValue).join(t.delimiter)+"\n"+e),a.dsvFormat(t.delimiter).parse(e+"")}function S(t,r){var i,a=r&&r.property?n.field(r.property):n.identity;return!n.isObject(t)||(i=t,"function"===typeof e&&n.isFunction(e.isBuffer)&&e.isBuffer(i))?a(JSON.parse(t)):function(e,t){return t&&t.copy?JSON.parse(JSON.stringify(e)):e}(a(t))}_.responseType="text",S.responseType="json";var M={interior:function(e,t){return e!==t},exterior:function(e,t){return e===t}};function j(e,t){var r,i,a,u;return e=S(e,t),t&&t.feature?(r=o.feature,a=t.feature):t&&t.mesh?(r=o.mesh,a=t.mesh,u=M[t.filter]):n.error("Missing TopoJSON feature or mesh parameter."),(i=(i=e.objects[a])?r(e,i,u):n.error("Invalid TopoJSON object: "+a))&&i.features||[i]}j.responseType="json";var T={dsv:_,csv:F(","),tsv:F("\t"),json:S,topojson:j};function N(e,t){return arguments.length>1?(T[e]=t,this):n.hasOwnProperty(T,e)?T[e]:null}var B=function(e,t){return function(n){return{options:n||{},sanitize:p,load:d,fileAccess:!!t,file:m(t),http:b(e)}}}("undefined"!==typeof fetch&&fetch,null);t.format=T,t.formats=N,t.inferType=D,t.inferTypes=C,t.loader=B,t.read=function(e,t,r){var i=N((t=t||{}).type||"json");return i||n.error("Unknown data format type: "+t.type),e=i(e,t),t.parse&&function(e,t,n){if(e.length){n=n||u.timeParse;var r,i,a,o,s,l,c,f=e.columns||Object.keys(e[0]);for("auto"===t&&(t=C(e,f)),f=Object.keys(t),r=f.map(function(e){var r,i,a=t[e];if(a&&(0===a.indexOf("date:")||0===a.indexOf("utc:")))return("'"===(i=(r=a.split(/:(.+)?/,2))[1])[0]&&"'"===i[i.length-1]||'"'===i[0]&&'"'===i[i.length-1])&&(i=i.slice(1,-1)),"utc"===r[0]?u.utcParse(i):n(i);if(!k[a])throw Error("Illegal format pattern: "+e+":"+a);return k[a]}),o=0,l=e.length,c=f.length;o<l;++o)for(i=e[o],s=0;s<c;++s)a=f[s],i[a]=r[s](i[a])}}(e,t.parse,r),n.hasOwnProperty(e,"columns")&&delete e.columns,e},t.responseType=function(e){var t=N(e);return t&&t.responseType||"text"},t.typeParsers=k,Object.defineProperty(t,"__esModule",{value:!0})}(t,n(1469),n(1795),n(2876),n(588))}).call(this,n(60).Buffer)},1798:function(e,t,n){var r=n(309);!function(e,t,n,i,a,o,u,s,l,c,f,d,h){"use strict";function p(e){var t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function v(e){var t=s.rgb(e);return.2126*p(t.r)+.7152*p(t.g)+.0722*p(t.b)}function m(e,t){var n=v(e),r=v(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function g(e){var t=this.context.data[e];return t?t.values.value:[]}function y(e,t,n){var r=this.context.data[e]["index:"+t],i=r?r.value.get(n):void 0;return i?i.count:i}function b(e,t){var n=this.context.dataflow,r=this.context.data[e].input;return n.pulse(r,n.changeset().remove(o.truthy).insert(t)),1}function x(e,t,n){if(e){var r=this.context.dataflow,i=e.mark.source;r.pulse(i,r.changeset().encode(e,t))}return void 0!==n?n:e}var w={};function k(e,t,n){var r=e+":"+n,i=w[r];return i&&i[0]===t||(w[r]=i=[t,t(n)]),i[1]}function A(e,t){return k("format",l.format,t)(e)}function E(e,t){return k("timeFormat",c.timeFormat,t)(e)}function D(e,t){return k("utcFormat",c.utcFormat,t)(e)}function C(e,t){return k("timeParse",c.timeParse,t)(e)}function O(e,t){return k("utcParse",c.utcParse,t)(e)}var F=new Date(2e3,0,1);function _(e,t,n){return Number.isInteger(e)&&Number.isInteger(t)?(F.setMonth(e),F.setDate(t),E(F,n)):""}function S(e){return _(e,1,"%B")}function M(e){return _(e,1,"%b")}function j(e){return _(0,2+e,"%A")}function T(e){return _(0,2+e,"%a")}function N(e,t){var n;return o.isFunction(e)?e:o.isString(e)?(n=t.scales[e])&&n.value:void 0}function B(e,t){var n=N(e,(t||this).context);return n&&n.range?n.range():[]}function R(e,t){var n=N(e,(t||this).context);return n?n.domain():[]}function z(e,t){var n=N(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}function P(e,t,n){return f.bandSpace(e||0,t||0,n||0)}function L(e,t){var n=N(e,(t||this).context);return n?n.copy():void 0}function I(e,t,n){var r=N(e,(n||this).context);return r&&void 0!==t?r(t):void 0}function U(e,t,n){var r=N(e,(n||this).context);return r?o.isArray(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}function q(e,t){return function(n,r,i){if(n){var a=N(n,(i||this).context);return a&&a.path[e](r)}return t(r)}}var W=q("area",d.geoArea),H=q("bounds",d.geoBounds),V=q("centroid",d.geoCentroid);function G(e){var t=this.context.group,n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n}function $(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function Y(){return $(this.context.dataflow,"warn",arguments)}function X(){return $(this.context.dataflow,"info",arguments)}function J(){return $(this.context.dataflow,"debug",arguments)}function Q(){var e=[].slice.call(arguments);return e.unshift({}),o.extend.apply(null,e)}function K(e,t){return e===t||e!==e&&t!==t||(o.isArray(e)?!(!o.isArray(t)||e.length!==t.length)&&function(e,t){for(var n=0,r=e.length;n<r;++n)if(!K(e[n],t[n]))return!1;return!0}(e,t):!(!o.isObject(e)||!o.isObject(t))&&Z(e,t))}function Z(e,t){for(var n in e)if(!K(e[n],t[n]))return!1;return!0}function ee(e){return function(t){return Z(e,t)}}function te(e,t,r,i,a,u){var s,l,c=this.context.dataflow,f=this.context.data[e],d=f.input,h=f.changes,p=c.stamp();if(!1===c._trigger||!(d.value.length||t||i))return 0;if((!h||h.stamp<p)&&(f.changes=h=c.changeset(),h.stamp=p,c.runAfter(function(){f.modified=!0,c.pulse(d,h).run()},!0,1)),r&&(s=!0===r?o.truthy:o.isArray(r)||n.isTuple(r)?r:ee(r),h.remove(s)),t&&h.insert(t),i&&(s=ee(i),d.value.some(s)?h.remove(s):h.insert(i)),a)for(l in u)h.modify(a,l,u[l]);return 1}function ne(e){var t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)}function re(e){var t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)}function ie(e,t,n,r,i){e=N(e,(i||this).context);var a=h.Gradient(t,n),u=e.domain(),s=u[0],l=o.peek(u),c=o.identity;return l-s?c=f.scaleFraction(e,s,l):e=(e.interpolator?f.scale("sequential")().interpolator(e.interpolator()):f.scale("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,l=1]),e.ticks&&(s!==(u=e.ticks(+r||15))[0]&&u.unshift(s),l!==o.peek(u)&&u.push(l)),u.forEach(function(t){return a.stop(c(t),e(t))}),a}function ae(e,t,n){var r=N(e,(n||this).context);return function(e){return r?r.path.context(e)(t):""}}function oe(e){var t=null;return function(n){return n?h.pathRender(n,t=t||h.pathParse(e)):e}}var ue={};function se(e){return e.data}function le(e,t){var n=g.call(t,e);return n.root&&n.root.lookup||ue}function ce(e,t,n){var r=le(e,this),i=r[t],a=r[n];return i&&a?i.path(a).map(se):void 0}function fe(e,t){var n=le(e,this)[t];return n?n.ancestors().map(se):void 0}var de="undefined"!==typeof window&&window||null;function he(){return de?de.screen:{}}function pe(){return de?[de.innerWidth,de.innerHeight]:[void 0,void 0]}function ve(){var e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]}var me=":",ge="@",ye="%";function be(e,n,r,i){n[0].type!==t.Literal&&o.error("First argument to data functions must be a string literal.");var a=n[0].value,u=me+a;if(!o.hasOwnProperty(u,i))try{i[u]=r.getData(a).tuplesRef()}catch(s){}}function xe(e,n,r,i){n[0].type!==t.Literal&&o.error("First argument to indata must be a string literal."),n[1].type!==t.Literal&&o.error("Second argument to indata must be a string literal.");var a=n[0].value,u=n[1].value,s=ge+u;o.hasOwnProperty(s,i)||(i[s]=r.getData(a).indataRef(r,u))}function we(e,n,r,i){if(n[0].type===t.Literal)ke(r,i,n[0].value);else if(n[0].type===t.Identifier)for(e in r.scales)ke(r,i,e)}function ke(e,t,n){var r=ye+n;if(!o.hasOwnProperty(t,r))try{t[r]=e.scaleRef(n)}catch(i){}}var Ae={random:function(){return a.random()},cumulativeNormal:a.cumulativeNormal,cumulativeLogNormal:a.cumulativeLogNormal,cumulativeUniform:a.cumulativeUniform,densityNormal:a.densityNormal,densityLogNormal:a.densityLogNormal,densityUniform:a.densityUniform,quantileNormal:a.quantileNormal,quantileLogNormal:a.quantileLogNormal,quantileUniform:a.quantileUniform,sampleNormal:a.sampleNormal,sampleLogNormal:a.sampleLogNormal,sampleUniform:a.sampleUniform,isArray:o.isArray,isBoolean:o.isBoolean,isDate:o.isDate,isDefined:function(e){return void 0!==e},isNumber:o.isNumber,isObject:o.isObject,isRegExp:o.isRegExp,isString:o.isString,isTuple:n.isTuple,isValid:function(e){return null!=e&&e===e},toBoolean:o.toBoolean,toDate:o.toDate,toNumber:o.toNumber,toString:o.toString,flush:o.flush,lerp:o.lerp,merge:Q,pad:o.pad,peek:o.peek,span:o.span,inrange:o.inrange,truncate:o.truncate,rgb:s.rgb,lab:s.lab,hcl:s.hcl,hsl:s.hsl,luminance:v,contrast:m,sequence:u.range,format:A,utcFormat:D,utcParse:O,timeFormat:E,timeParse:C,monthFormat:S,monthAbbrevFormat:M,dayFormat:j,dayAbbrevFormat:T,quarter:o.quarter,utcquarter:o.utcquarter,warn:Y,info:X,debug:J,extent:o.extent,inScope:G,intersect:function(e,t,n){if(!e)return[];var i=r(e,2),a=i[0],u=i[1],s=(new h.Bounds).set(a[0],a[1],u[0],u[1]),l=n||this.context.dataflow.scenegraph().root;return h.intersect(l,s,function(e){var t=null;if(e){var n=o.array(e.marktype),r=o.array(e.markname);t=function(e){return(!n.length||n.some(function(t){return e.marktype===t}))&&(!r.length||r.some(function(t){return e.name===t}))}}return t}(t))},clampRange:o.clampRange,pinchDistance:ne,pinchAngle:re,screen:he,containerSize:ve,windowSize:pe,bandspace:P,setdata:b,pathShape:oe,panLinear:o.panLinear,panLog:o.panLog,panPow:o.panPow,panSymlog:o.panSymlog,zoomLinear:o.zoomLinear,zoomLog:o.zoomLog,zoomPow:o.zoomPow,zoomSymlog:o.zoomSymlog,encode:x,modify:te},Ee=["view","item","group","xy","x","y"],De="event.vega.",Ce="this.",Oe={};function Fe(e,t,n){return 1===arguments.length?Ae[e]:(Ae[e]=t,n&&(Oe[e]=n),Se&&(Se.functions[e]=Ce+e),this)}Fe("bandwidth",z,we),Fe("copy",L,we),Fe("domain",R,we),Fe("range",B,we),Fe("invert",U,we),Fe("scale",I,we),Fe("gradient",ie,we),Fe("geoArea",W,we),Fe("geoBounds",H,we),Fe("geoCentroid",V,we),Fe("geoShape",ae,we),Fe("indata",y,xe),Fe("data",g,be),Fe("treePath",ce,be),Fe("treeAncestors",fe,be),Fe("vlSelectionTest",i.selectionTest,i.selectionVisitor),Fe("vlSelectionResolve",i.selectionResolve,i.selectionVisitor);var _e={blacklist:["_"],whitelist:["datum","event","item"],fieldvar:"datum",globalvar:function(e){return"_["+o.stringValue("$"+e)+"]"},functions:function(e){var n=t.functions(e);for(var r in Ee.forEach(function(e){return n[e]=De+e}),Ae)n[r]=Ce+r;return n},constants:t.constants,visitors:Oe},Se=t.codegen(_e);Object.defineProperty(e,"formatLocale",{enumerable:!0,get:function(){return l.formatDefaultLocale}}),Object.defineProperty(e,"timeFormatLocale",{enumerable:!0,get:function(){return c.timeFormatDefaultLocale}}),e.DataPrefix=me,e.IndexPrefix=ge,e.ScalePrefix=ye,e.SignalPrefix="$",e.bandspace=P,e.bandwidth=z,e.codeGenerator=Se,e.codegenParams=_e,e.containerSize=ve,e.contrast=m,e.copy=L,e.data=g,e.dataVisitor=be,e.dayAbbrevFormat=T,e.dayFormat=j,e.debug=J,e.domain=R,e.encode=x,e.expressionFunction=Fe,e.format=A,e.functionContext=Ae,e.geoArea=W,e.geoBounds=H,e.geoCentroid=V,e.geoShape=ae,e.inScope=G,e.indata=y,e.indataVisitor=xe,e.info=X,e.invert=U,e.luminance=v,e.merge=Q,e.modify=te,e.monthAbbrevFormat=M,e.monthFormat=S,e.pathShape=oe,e.pinchAngle=re,e.pinchDistance=ne,e.range=B,e.scale=I,e.scaleGradient=ie,e.scaleVisitor=we,e.screen=he,e.setdata=b,e.timeFormat=E,e.timeParse=C,e.treeAncestors=fe,e.treePath=ce,e.utcFormat=D,e.utcParse=O,e.warn=Y,e.windowSize=pe,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1799),n(1476),n(2893),n(1623),n(1469),n(1508),n(2894),n(587),n(588),n(1624),n(1692),n(1693))},1799:function(e,t,n){!function(e,t){"use strict";var n,r,i,a,o,u="RawCode",s="Literal",l="Property",c="Identifier",f="ArrayExpression",d="BinaryExpression",h="CallExpression",p="ConditionalExpression",v="LogicalExpression",m="MemberExpression",g="ObjectExpression",y="UnaryExpression";function b(e){this.type=e}b.prototype.visit=function(e){var t,n,r;if(e(this))return 1;for(n=0,r=(t=function(e){switch(e.type){case f:return e.elements;case d:case v:return[e.left,e.right];case h:var t=e.arguments.slice();return t.unshift(e.callee),t;case p:return[e.test,e.consequent,e.alternate];case m:return[e.object,e.property];case g:return e.properties;case l:return[e.key,e.value];case y:return[e.argument];case c:case s:case u:default:return[]}}(this)).length;n<r;++n)if(t[n].visit(e))return 1};var x=1,w=2,k=3,A=4,E=5,D=6,C=7,O=8;(n={})[x]="Boolean",n[w]="<end>",n[k]="Identifier",n[A]="Keyword",n[E]="Null",n[D]="Numeric",n[C]="Punctuator",n[O]="String",n[9]="RegularExpression";var F="ArrayExpression",_="BinaryExpression",S="CallExpression",M="ConditionalExpression",j="Identifier",T="Literal",N="LogicalExpression",B="MemberExpression",R="ObjectExpression",z="Property",P="UnaryExpression",L="Unexpected token %0",I="Unexpected number",U="Unexpected string",q="Unexpected identifier",W="Unexpected reserved word",H="Unexpected end of input",V="Invalid regular expression",G="Invalid regular expression: missing /",$="Octal literals are not allowed in strict mode.",Y="Duplicate data property in object literal not allowed in strict mode",X="ILLEGAL",J="Disabled.",Q=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),K=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Z(e,t){if(!e)throw new Error("ASSERT: "+t)}function ee(e){return e>=48&&e<=57}function te(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function ne(e){return"01234567".indexOf(e)>=0}function re(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function ie(e){return 10===e||13===e||8232===e||8233===e}function ae(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&Q.test(String.fromCharCode(e))}function oe(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&K.test(String.fromCharCode(e))}var ue={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function se(){for(var e;i<a&&(re(e=r.charCodeAt(i))||ie(e));)++i}function le(e){var t,n,o,u=0;for(n="u"===e?4:2,t=0;t<n;++t)i<a&&te(r[i])?(o=r[i++],u=16*u+"0123456789abcdef".indexOf(o.toLowerCase())):De({},L,X);return String.fromCharCode(u)}function ce(){var e,t,n,o;for(t=0,"}"===(e=r[i])&&De({},L,X);i<a&&te(e=r[i++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&De({},L,X),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),o=56320+(t-65536&1023),String.fromCharCode(n,o))}function fe(){var e,t;for(e=r.charCodeAt(i++),t=String.fromCharCode(e),92===e&&(117!==r.charCodeAt(i)&&De({},L,X),++i,(e=le("u"))&&"\\"!==e&&ae(e.charCodeAt(0))||De({},L,X),t=e);i<a&&oe(e=r.charCodeAt(i));)++i,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==r.charCodeAt(i)&&De({},L,X),++i,(e=le("u"))&&"\\"!==e&&oe(e.charCodeAt(0))||De({},L,X),t+=e);return t}function de(){var e,t;return e=i,{type:1===(t=92===r.charCodeAt(i)?fe():function(){var e,t;for(e=i++;i<a;){if(92===(t=r.charCodeAt(i)))return i=e,fe();if(!oe(t))break;++i}return r.slice(e,i)}()).length?k:ue.hasOwnProperty(t)?A:"null"===t?E:"true"===t||"false"===t?x:k,value:t,start:e,end:i}}function he(){var e,t,n,a,o=i,u=r.charCodeAt(i),s=r[i];switch(u){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++i,{type:C,value:String.fromCharCode(u),start:o,end:i};default:if(61===(e=r.charCodeAt(i+1)))switch(u){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return i+=2,{type:C,value:String.fromCharCode(u)+String.fromCharCode(e),start:o,end:i};case 33:case 61:return i+=2,61===r.charCodeAt(i)&&++i,{type:C,value:r.slice(o,i),start:o,end:i}}}return">>>="===(a=r.substr(i,4))?{type:C,value:a,start:o,end:i+=4}:">>>"===(n=a.substr(0,3))||"<<="===n||">>="===n?{type:C,value:n,start:o,end:i+=3}:s===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(s)>=0||"=>"===t?{type:C,value:t,start:o,end:i+=2}:"<>=!+-*%&|^/".indexOf(s)>=0?{type:C,value:s,start:o,end:++i}:void De({},L,X)}function pe(){var e,t,n;if(Z(ee((n=r[i]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=i,e="","."!==n){if(e=r[i++],n=r[i],"0"===e){if("x"===n||"X"===n)return++i,function(e){for(var t="";i<a&&te(r[i]);)t+=r[i++];return 0===t.length&&De({},L,X),ae(r.charCodeAt(i))&&De({},L,X),{type:D,value:parseInt("0x"+t,16),start:e,end:i}}(t);if(ne(n))return function(e){for(var t="0"+r[i++];i<a&&ne(r[i]);)t+=r[i++];return(ae(r.charCodeAt(i))||ee(r.charCodeAt(i)))&&De({},L,X),{type:D,value:parseInt(t,8),octal:!0,start:e,end:i}}(t);n&&ee(n.charCodeAt(0))&&De({},L,X)}for(;ee(r.charCodeAt(i));)e+=r[i++];n=r[i]}if("."===n){for(e+=r[i++];ee(r.charCodeAt(i));)e+=r[i++];n=r[i]}if("e"===n||"E"===n)if(e+=r[i++],"+"!==(n=r[i])&&"-"!==n||(e+=r[i++]),ee(r.charCodeAt(i)))for(;ee(r.charCodeAt(i));)e+=r[i++];else De({},L,X);return ae(r.charCodeAt(i))&&De({},L,X),{type:D,value:parseFloat(e),start:t,end:i}}function ve(){var e,t,n,u;return o=null,se(),e=i,t=function(){var e,t,n,o;for(Z("/"===(e=r[i]),"Regular expression literal must start with a slash"),t=r[i++],n=!1,o=!1;i<a;)if(t+=e=r[i++],"\\"===e)ie((e=r[i++]).charCodeAt(0))&&De({},G),t+=e;else if(ie(e.charCodeAt(0)))De({},G);else if(n)"]"===e&&(n=!1);else{if("/"===e){o=!0;break}"["===e&&(n=!0)}return o||De({},G),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";i<a&&oe((e=r[i]).charCodeAt(0));)++i,"\\"===e&&i<a?De({},L,X):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&De({},V,n),{value:n,literal:t}}(),u=function(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(e,t){if(parseInt(t,16)<=1114111)return"x";De({},V)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){De({},V)}try{return new RegExp(e,t)}catch(i){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:u,regex:{pattern:t.value,flags:n.value},start:e,end:i}}function me(){var e;return se(),i>=a?{type:w,start:i,end:i}:ae(e=r.charCodeAt(i))?de():40===e||41===e||59===e?he():39===e||34===e?function(){var e,t,n,o,u="",s=!1;for(Z("'"===(e=r[i])||'"'===e,"String literal must starts with a quote"),t=i,++i;i<a;){if((n=r[i++])===e){e="";break}if("\\"===n)if((n=r[i++])&&ie(n.charCodeAt(0)))"\r"===n&&"\n"===r[i]&&++i;else switch(n){case"u":case"x":"{"===r[i]?(++i,u+=ce()):u+=le(n);break;case"n":u+="\n";break;case"r":u+="\r";break;case"t":u+="\t";break;case"b":u+="\b";break;case"f":u+="\f";break;case"v":u+="\v";break;default:ne(n)?(0!==(o="01234567".indexOf(n))&&(s=!0),i<a&&ne(r[i])&&(s=!0,o=8*o+"01234567".indexOf(r[i++]),"0123".indexOf(n)>=0&&i<a&&ne(r[i])&&(o=8*o+"01234567".indexOf(r[i++]))),u+=String.fromCharCode(o)):u+=n}else{if(ie(n.charCodeAt(0)))break;u+=n}}return""!==e&&De({},L,X),{type:O,value:u,octal:s,start:t,end:i}}():46===e?ee(r.charCodeAt(i+1))?pe():he():ee(e)?pe():he()}function ge(){var e;return i=(e=o).end,o=me(),i=e.end,e}function ye(){var e;e=i,o=me(),i=e}function be(e,t,n){var r=new b("||"===e||"&&"===e?N:_);return r.operator=e,r.left=t,r.right=n,r}function xe(e,t){var n=new b(S);return n.callee=e,n.arguments=t,n}function we(e){var t=new b(j);return t.name=e,t}function ke(e){var t=new b(T);return t.value=e.value,t.raw=r.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function Ae(e,t,n){var r=new b(B);return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function Ee(e,t,n){var r=new b(z);return r.key=t,r.value=n,r.kind=e,r}function De(e,t){var n,r=Array.prototype.slice.call(arguments,2),a=t.replace(/%(\d)/g,function(e,t){return Z(t<r.length,"Message reference must be in range"),r[t]});throw(n=new Error(a)).index=i,n.description=a,n}function Ce(e){e.type===w&&De(e,H),e.type===D&&De(e,I),e.type===O&&De(e,U),e.type===k&&De(e,q),e.type===A&&De(e,W),De(e,L,e.value)}function Oe(e){var t=ge();t.type===C&&t.value===e||Ce(t)}function Fe(e){return o.type===C&&o.value===e}function _e(e){return o.type===A&&o.value===e}function Se(){var e=[];for(i=o.start,Oe("[");!Fe("]");)Fe(",")?(ge(),e.push(null)):(e.push(qe()),Fe("]")||Oe(","));return ge(),function(e){var t=new b(F);return t.elements=e,t}(e)}function Me(){var e;return i=o.start,(e=ge()).type===O||e.type===D?(e.octal&&De(e,$),ke(e)):we(e.value)}function je(){var e,t,n;return i=o.start,(e=o).type===k?(n=Me(),Oe(":"),Ee("init",n,qe())):e.type!==w&&e.type!==C?(t=Me(),Oe(":"),Ee("init",t,qe())):void Ce(e)}function Te(){var e,t,n=[],r={},a=String;for(i=o.start,Oe("{");!Fe("}");)t="$"+((e=je()).key.type===j?e.key.name:a(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?De({},Y):r[t]=!0,n.push(e),Fe("}")||Oe(",");return Oe("}"),function(e){var t=new b(R);return t.properties=e,t}(n)}var Ne={if:1,this:1};function Be(){var e,t,n;if(Fe("("))return function(){var e;return Oe("("),e=We(),Oe(")"),e}();if(Fe("["))return Se();if(Fe("{"))return Te();if(e=o.type,i=o.start,e===k||Ne[o.value])n=we(ge().value);else if(e===O||e===D)o.octal&&De(o,$),n=ke(ge());else{if(e===A)throw new Error(J);e===x?((t=ge()).value="true"===t.value,n=ke(t)):e===E?((t=ge()).value=null,n=ke(t)):Fe("/")||Fe("/=")?(n=ke(ve()),ye()):Ce(ge())}return n}function Re(){var e=[];if(Oe("("),!Fe(")"))for(;i<a&&(e.push(qe()),!Fe(")"));)Oe(",");return Oe(")"),e}function ze(){var e;return i=o.start,function(e){return e.type===k||e.type===A||e.type===x||e.type===E}(e=ge())||Ce(e),we(e.value)}function Pe(){var e;return Oe("["),e=We(),Oe("]"),e}function Le(){var e=function(){var e;for(e=Be();;)if(Fe("."))Oe("."),e=Ae(".",e,ze());else if(Fe("("))e=xe(e,Re());else{if(!Fe("["))break;e=Ae("[",e,Pe())}return e}();if(o.type===C&&(Fe("++")||Fe("--")))throw new Error(J);return e}function Ie(){var e,t;if(o.type!==C&&o.type!==A)t=Le();else{if(Fe("++")||Fe("--"))throw new Error(J);if(Fe("+")||Fe("-")||Fe("~")||Fe("!"))e=ge(),t=Ie(),t=function(e,t){var n=new b(P);return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(_e("delete")||_e("void")||_e("typeof"))throw new Error(J);t=Le()}}return t}function Ue(e){var t=0;if(e.type!==C&&e.type!==A)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function qe(){var e,t;return e=function(){var e,t,n,r,i,a,u,s,l,c;if(e=o,l=Ie(),0===(i=Ue(r=o)))return l;for(r.prec=i,ge(),t=[e,o],a=[l,r,u=Ie()];(i=Ue(o))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)u=a.pop(),s=a.pop().value,l=a.pop(),t.pop(),n=be(s,l,u),a.push(n);(r=ge()).prec=i,a.push(r),t.push(o),n=Ie(),a.push(n)}for(n=a[c=a.length-1],t.pop();c>1;)t.pop(),n=be(a[c-1].value,a[c-2],n),c-=2;return n}(),Fe("?")&&(ge(),t=qe(),Oe(":"),e=function(e,t,n){var r=new b(M);return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,qe())),e}function We(){var e=qe();if(Fe(","))throw new Error(J);return e}var He={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function Ve(e){function n(t,n,r){return function(i){return function(t,n,r,i){var a=e(n[0]);return r&&(a=r+"("+a+")",0===r.lastIndexOf("new ",0)&&(a="("+a+")")),a+"."+t+(i<0?"":0===i?"()":"("+n.slice(1).map(e).join(",")+")")}(t,i,n,r)}}var r="new Date";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(n){n.length<3&&t.error("Missing arguments to clamp function."),n.length>3&&t.error("Too many arguments to clamp function.");var r=n.map(e);return"Math.max("+r[1]+", Math.min("+r[2]+","+r[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),join:n("join",null),indexof:n("indexOf",null),lastindexof:n("lastIndexOf",null),slice:n("slice",null),reverse:function(t){return"("+e(t[0])+").slice().reverse()"},parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase","String",0),lower:n("toLowerCase","String",0),substring:n("substring","String"),split:n("split","String"),replace:n("replace","String"),trim:n("trim","String",0),regexp:"RegExp",test:n("test","RegExp"),if:function(n){n.length<3&&t.error("Missing arguments to if function."),n.length>3&&t.error("Too many arguments to if function.");var r=n.map(e);return"("+r[0]+"?"+r[1]+":"+r[2]+")"}}}e.ASTNode=b,e.ArrayExpression=f,e.BinaryExpression=d,e.CallExpression=h,e.ConditionalExpression=p,e.Identifier=c,e.Literal=s,e.LogicalExpression=v,e.MemberExpression=m,e.ObjectExpression=g,e.Property=l,e.RawCode=u,e.UnaryExpression=y,e.codegen=function(e){var n=(e=e||{}).whitelist?t.toSet(e.whitelist):{},r=e.blacklist?t.toSet(e.blacklist):{},i=e.constants||He,a=(e.functions||Ve)(d),o=e.globalvar,u=e.fieldvar,s={},l={},c=0,f=t.isFunction(o)?o:function(e){return o+'["'+e+'"]'};function d(e){if(t.isString(e))return e;var n=h[e.type];return null==n&&t.error("Unsupported type: "+e.type),n(e)}var h={Literal:function(e){return e.raw},Identifier:function(e){var a=e.name;return c>0?a:t.hasOwnProperty(r,a)?t.error("Illegal identifier: "+a):t.hasOwnProperty(i,a)?i[a]:t.hasOwnProperty(n,a)?a:(s[a]=1,f(a))},MemberExpression:function(e){var t=!e.computed,n=d(e.object);t&&(c+=1);var r=d(e.property);return n===u&&(l[function(e){var t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(r)]=1),t&&(c-=1),n+(t?"."+r:"["+r+"]")},CallExpression:function(e){"Identifier"!==e.callee.type&&t.error("Illegal callee type: "+e.callee.type);var n=e.callee.name,r=e.arguments,i=t.hasOwnProperty(a,n)&&a[n];return i||t.error("Unrecognized function: "+n),t.isFunction(i)?i(r):i+"("+r.map(d).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(d).join(",")+"]"},BinaryExpression:function(e){return"("+d(e.left)+e.operator+d(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+d(e.argument)+")"},ConditionalExpression:function(e){return"("+d(e.test)+"?"+d(e.consequent)+":"+d(e.alternate)+")"},LogicalExpression:function(e){return"("+d(e.left)+e.operator+d(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(d).join(",")+"}"},Property:function(e){c+=1;var t=d(e.key);return c-=1,t+":"+d(e.value)}};function p(e){var t={code:d(e),globals:Object.keys(s),fields:Object.keys(l)};return s={},l={},t}return p.functions=a,p.constants=i,p},e.constants=He,e.functions=Ve,e.parse=function(e){i=0,a=(r=e).length,o=null,ye();var t=We();if(o.type!==w)throw new Error("Unexpect token after expression.");return t},Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1469))},2071:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1469),i=n(1476),a=n(2877),o=n(2878),u=n(2879),s=n(2883),l=n(2884),c=n(2886),f=n(2887),d=n(2888),h=n(2890),p=n(2891),v=n(1623),m=n(1797),g=n(1693),y=n(1624),b=n(2073),x=n(2892),w=n(1798),k=n(2895),A=n(2074);r.extend(i.transforms,a,o,u,s,l,c,f,d,h,p),Object.keys(r).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})}),Object.keys(v).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return v[e]}})}),Object.keys(m).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return m[e]}})}),Object.keys(g).forEach(function(e){"default"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return g[e]}})}),Object.defineProperty(t,"Dataflow",{enumerable:!0,get:function(){return i.Dataflow}}),Object.defineProperty(t,"EventStream",{enumerable:!0,get:function(){return i.EventStream}}),Object.defineProperty(t,"MultiPulse",{enumerable:!0,get:function(){return i.MultiPulse}}),Object.defineProperty(t,"Operator",{enumerable:!0,get:function(){return i.Operator}}),Object.defineProperty(t,"Parameters",{enumerable:!0,get:function(){return i.Parameters}}),Object.defineProperty(t,"Pulse",{enumerable:!0,get:function(){return i.Pulse}}),Object.defineProperty(t,"Transform",{enumerable:!0,get:function(){return i.Transform}}),Object.defineProperty(t,"changeset",{enumerable:!0,get:function(){return i.changeset}}),Object.defineProperty(t,"definition",{enumerable:!0,get:function(){return i.definition}}),Object.defineProperty(t,"ingest",{enumerable:!0,get:function(){return i.ingest}}),Object.defineProperty(t,"isTuple",{enumerable:!0,get:function(){return i.isTuple}}),Object.defineProperty(t,"transform",{enumerable:!0,get:function(){return i.transform}}),Object.defineProperty(t,"transforms",{enumerable:!0,get:function(){return i.transforms}}),Object.defineProperty(t,"tupleid",{enumerable:!0,get:function(){return i.tupleid}}),Object.defineProperty(t,"interpolate",{enumerable:!0,get:function(){return y.interpolate}}),Object.defineProperty(t,"interpolateColors",{enumerable:!0,get:function(){return y.interpolateColors}}),Object.defineProperty(t,"interpolateRange",{enumerable:!0,get:function(){return y.interpolateRange}}),Object.defineProperty(t,"quantizeInterpolator",{enumerable:!0,get:function(){return y.quantizeInterpolator}}),Object.defineProperty(t,"scale",{enumerable:!0,get:function(){return y.scale}}),Object.defineProperty(t,"scheme",{enumerable:!0,get:function(){return y.scheme}}),Object.defineProperty(t,"timeInterval",{enumerable:!0,get:function(){return y.timeInterval}}),Object.defineProperty(t,"projection",{enumerable:!0,get:function(){return b.projection}}),Object.defineProperty(t,"View",{enumerable:!0,get:function(){return x.View}}),Object.defineProperty(t,"expressionFunction",{enumerable:!0,get:function(){return w.expressionFunction}}),Object.defineProperty(t,"formatLocale",{enumerable:!0,get:function(){return w.formatLocale}}),Object.defineProperty(t,"timeFormatLocale",{enumerable:!0,get:function(){return w.timeFormatLocale}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return k.parse}}),Object.defineProperty(t,"runtime",{enumerable:!0,get:function(){return A.parse}}),Object.defineProperty(t,"runtimeContext",{enumerable:!0,get:function(){return A.context}}),t.version="5.7.3"},2072:function(e,t,n){!function(e){"use strict";function t(e,t){if("undefined"!==typeof document&&document.createElement){var n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}e.domCanvas=t,e.canvas=t,e.image=function(){return"undefined"!==typeof Image?Image:null},Object.defineProperty(e,"__esModule",{value:!0})}(t)},2073:function(e,t,n){!function(e,t){"use strict";var n=t.geoPath(),r=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function i(e,n){if(!e||"string"!==typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(a[e]=function(e,n){return function i(){var a=n();return a.type=e,a.path=t.geoPath().projection(a),a.copy=a.copy||function(){var e=i();return r.forEach(function(t){a[t]&&e[t](a[t]())}),e.path.pointRadius(a.path.pointRadius()),e},a}}(e,n),this):a[e]||null}var a={albers:t.geoAlbers,albersusa:t.geoAlbersUsa,azimuthalequalarea:t.geoAzimuthalEqualArea,azimuthalequidistant:t.geoAzimuthalEquidistant,conicconformal:t.geoConicConformal,conicequalarea:t.geoConicEqualArea,conicequidistant:t.geoConicEquidistant,equalEarth:t.geoEqualEarth,equirectangular:t.geoEquirectangular,gnomonic:t.geoGnomonic,identity:t.geoIdentity,mercator:t.geoMercator,naturalEarth1:t.geoNaturalEarth1,orthographic:t.geoOrthographic,stereographic:t.geoStereographic,transversemercator:t.geoTransverseMercator};for(var o in a)i(o,a[o]);e.getProjectionPath=function(e){return e&&e.path||n},e.projection=i,e.projectionProperties=r,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1692))},2074:function(e,t,n){!function(e,t,n){"use strict";function r(e,t,n){";"!==t[t.length-1]&&(t="return("+t+");");var r=Function.apply(null,e.concat(t));return n&&n.functions?r.bind(n.functions):r}function i(e,t){return r(["event"],e,t)}function a(e,t){return r(["item","_"],e,t)}function o(e,t,r){var i,a;for(i in r=r||{},e)a=e[i],r[i]=n.isArray(a)?a.map(function(e){return u(e,t,r)}):u(a,t,r);return r}function u(e,t,r){if(!e||!n.isObject(e))return e;for(var i,a=0,o=s.length;a<o;++a)if(i=s[a],n.hasOwnProperty(e,i.key))return i.parse(e,t,r);return e}var s=[{key:"$ref",parse:function(e,t){return t.get(e.$ref)||n.error("Operator not defined: "+e.$ref)}},{key:"$key",parse:function(e,t){var r="k:"+e.$key+"_"+!!e.$flat;return t.fn[r]||(t.fn[r]=n.key(e.$key,e.$flat))}},{key:"$expr",parse:function(e,t,i){e.$params&&o(e.$params,t,i);var a="e:"+e.$expr+"_"+e.$name;return t.fn[a]||(t.fn[a]=n.accessor(function(e,t){return r(["datum","_"],e,t)}(e.$expr,t),e.$fields,e.$name))}},{key:"$field",parse:function(e,t){if(!e.$field)return null;var r="f:"+e.$field+"_"+e.$name;return t.fn[r]||(t.fn[r]=n.field(e.$field,e.$name))}},{key:"$encode",parse:function(e,t){var r,i,o=e.$encode,u={};for(r in o)i=o[r],u[r]=n.accessor(a(i.$expr,t),i.$fields),u[r].output=i.$output;return u}},{key:"$compare",parse:function(e,r){var i="c:"+e.$compare+"_"+e.$order,a=n.array(e.$compare).map(function(e){return e&&e.$tupleid?t.tupleid:e});return r.fn[i]||(r.fn[i]=n.compare(a,e.$order))}},{key:"$context",parse:function(e,t){return t}},{key:"$subflow",parse:function(e,t){var n=e.$subflow;return function(e,r,i){var a=d(n,t.fork()),o=a.get(n.operators[0].id),u=a.signals.parent;return u&&u.set(i),o}}},{key:"$tupleid",parse:function(){return t.tupleid}}];function l(e){return(e+"").toLowerCase()}function c(e,t){"operator"!==l(e.type)&&e.type?t.transform(e,e.type):t.operator(e,e.update?function(e,t){return r(["_"],e,t)}(e.update,t):null)}function f(e,t){var a=n.isObject(a=e.source)?a.$ref:a,u=t.get(a),s=null,l=e.update,c=void 0;u||n.error("Source not defined: "+e.source),s=e.target&&e.target.$expr?i(e.target.$expr,t):t.get(e.target),l&&l.$expr&&(l.$params&&(c=o(l.$params,t)),l=function(e,t){return r(["_","event"],e,t)}(l.$expr,t)),t.update(e,u,s,l,c)}function d(e,t){var r=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),r.forEach(function(e){c(e,t)}),r.forEach(function(e){!function(e,t){if(e.params){var r=t.get(e.id);r||n.error("Invalid operator id: "+e.id),t.dataflow.connect(r,r.parameters(o(e.params,t),e.react,e.initonly))}}(e,t)}),(e.streams||[]).forEach(function(e){!function(e,t){var r,a=null!=e.filter?i(e.filter,t):void 0,o=null!=e.stream?t.get(e.stream):void 0;e.source?o=t.events(e.source,e.type,a):e.merge&&(o=(r=e.merge.map(t.get.bind(t)))[0].merge.apply(r[0],r.slice(1))),e.between&&(r=e.between.map(t.get.bind(t)),o=o.between(r[0],r[1])),e.filter&&(o=o.filter(a)),null!=e.throttle&&(o=o.throttle(+e.throttle)),null!=e.debounce&&(o=o.debounce(+e.debounce)),null==o&&n.error("Invalid stream definition: "+JSON.stringify(e)),e.consume&&o.consume(!0),t.stream(e,o)}(e,t)}),(e.updates||[]).forEach(function(e){f(e,t)}),t.resolve()}var h={skip:!0};function p(e,t,n){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function v(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.functions=e.functions,this.events=e.events,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}p.prototype=v.prototype={fork:function(){var e=new v(this);return(this.subcontext||(this.subcontext=[])).push(e),e},get:function(e){return this.nodes[e]},set:function(e,t){return this.nodes[e]=t},add:function(e,t){var n,r=this,i=r.dataflow;if(r.set(e.id,t),"collect"===l(e.type)&&(n=e.value)&&(n.$ingest?i.ingest(t,n.$ingest,n.$format):n.$request?i.preload(t,n.$request,n.$format):i.pulse(t,i.changeset().insert(n))),e.root&&(r.root=t),e.parent){var a=r.get(e.parent.$ref);a?(i.connect(a,[t]),t.targets().add(a)):(r.unresolved=r.unresolved||[]).push(function(){a=r.get(e.parent.$ref),i.connect(a,[t]),t.targets().add(a)})}if(e.signal&&(r.signals[e.signal]=t),e.scale&&(r.scales[e.scale]=t),e.data)for(var o in e.data)n=r.data[o]||(r.data[o]={}),e.data[o].forEach(function(e){n[e]=t})},resolve:function(){return(this.unresolved||[]).forEach(function(e){e()}),delete this.unresolved,this},operator:function(e,t){this.add(e,this.dataflow.add(e.value,t))},transform:function(e,t){this.add(e,this.dataflow.add(this.transforms[l(t)]))},stream:function(e,t){this.set(e.id,t)},update:function(e,t,n,r,i){this.dataflow.on(t,n,r,i,e.options)},getState:function(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach(function(n){var i=t.signals[n];e.signals(n,i)&&(r[n]=i.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(function(n){var r=t.data[n];e.data(n,r)&&(i[n]=r.input.value)})}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map(function(t){return t.getState(e)})),n},setState:function(e){var t=this,r=t.dataflow,i=e.data,a=e.signals;Object.keys(a||{}).forEach(function(e){r.update(t.signals[e],a[e],h)}),Object.keys(i||{}).forEach(function(e){r.pulse(t.data[e].input,r.changeset().remove(n.truthy).insert(i[e]))}),(e.subcontext||[]).forEach(function(e,n){var r=t.subcontext[n];r&&r.setState(e)})}},e.context=function(e,t,n){return new p(e,t,n)},e.expression=r,e.parse=d,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1476),n(1469))},2875:function(e,t,n){(function(t){var r=n(21),i=n(14),a=n(15);e.exports=function(e,n){"use strict";var o="6.0.0";function u(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{s(r.next(e))}catch(t){a(t)}}function u(e){try{s(r.throw(e))}catch(t){a(t)}}function s(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,u)}s((r=r.apply(e,t||[])).next())})}var s=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=Object.prototype.hasOwnProperty;function c(e,t){return l.call(e,t)}function f(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);for(var r in t=[],e)c(e,r)&&t.push(r);return t}function d(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function h(e){for(var t,n=0,r=e.length;n<r;){if(!((t=e.charCodeAt(n))>=48&&t<=57))return!1;n++}return!0}function p(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function v(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function m(e,t){var n=[e];for(var r in t){var i="object"===typeof t[r]?JSON.stringify(t[r],null,2):t[r];"undefined"!==typeof i&&n.push(r+": "+i)}return n.join("\n")}var g=function(e){function t(t,n,r,i,a){var o=this.constructor,u=e.call(this,m(t,{name:n,index:r,operation:i,tree:a}))||this;return u.name=n,u.index=r,u.operation=i,u.tree=a,Object.setPrototypeOf(u,o.prototype),u.message=m(t,{name:n,index:r,operation:i,tree:a}),u}return s(t,e),t}(Error),y=g,b=d,x={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=k(n,this.path);r&&(r=d(r));var i=A(n,{op:"remove",path:this.from}).removed;return A(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=k(n,this.from);return A(n,{op:"add",path:this.path,value:d(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:O(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},w={add:function(e,t,n){return h(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:x.move,copy:x.copy,test:x.test,_get:x._get};function k(e,t){if(""==t)return e;var n={op:"_get",path:t};return A(e,n),n.value}function A(e,t,n,r,i,a){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===i&&(i=!0),void 0===a&&(a=0),n&&("function"==typeof n?n(t,0,e,t.path):D(t,0)),""===t.path){var o={newDocument:e};if("add"===t.op)return o.newDocument=t.value,o;if("replace"===t.op)return o.newDocument=t.value,o.removed=e,o;if("move"===t.op||"copy"===t.op)return o.newDocument=k(e,t.from),"move"===t.op&&(o.removed=e),o;if("test"===t.op){if(o.test=O(e,t.value),!1===o.test)throw new y("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return o.newDocument=e,o}if("remove"===t.op)return o.removed=e,o.newDocument=null,o;if("_get"===t.op)return t.value=e,o;if(n)throw new y("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,t,e);return o}r||(e=d(e));var u=(t.path||"").split("/"),s=e,l=1,c=u.length,f=void 0,p=void 0,m=void 0;for(m="function"==typeof n?n:D;;){if(p=u[l],i&&"__proto__"==p)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===f&&(void 0===s[p]?f=u.slice(0,l).join("/"):l==c-1&&(f=t.path),void 0!==f&&m(t,0,e,f)),l++,Array.isArray(s)){if("-"===p)p=s.length;else{if(n&&!h(p))throw new y("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,t,e);h(p)&&(p=~~p)}if(l>=c){if(n&&"add"===t.op&&p>s.length)throw new y("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,t,e);if(!1===(o=w[t.op].call(t,s,p,e)).test)throw new y("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return o}}else if(p&&-1!=p.indexOf("~")&&(p=v(p)),l>=c){if(!1===(o=x[t.op].call(t,s,p,e)).test)throw new y("Test operation failed","TEST_OPERATION_FAILED",a,t,e);return o}s=s[p]}}function E(e,t,n,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=!0),n&&!Array.isArray(t))throw new y("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=d(e));for(var a=new Array(t.length),o=0,u=t.length;o<u;o++)a[o]=A(e,t[o],n,!0,i,o),e=a[o].newDocument;return a.newDocument=e,a}function D(e,t,n,r){if("object"!==typeof e||null===e||Array.isArray(e))throw new y("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!x[e.op])throw new y("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!==typeof e.path)throw new y("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new y('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!==typeof e.from)throw new y("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new y("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&function e(t){if(void 0===t)return!0;if(t)if(Array.isArray(t)){for(var n=0,r=t.length;n<r;n++)if(e(t[n]))return!0}else if("object"===typeof t){var i=f(t),a=i.length;for(n=0;n<a;n++)if(e(t[i[n]]))return!0}return!1}(e.value))throw new y("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var i=e.path.split("/").length,a=r.split("/").length;if(i!==a+1&&i!==a)throw new y("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==r)throw new y("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var o=C([{op:"_get",path:e.from,value:void 0}],n);if(o&&"OPERATION_PATH_UNRESOLVABLE"===o.name)throw new y("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function C(e,t,n){try{if(!Array.isArray(e))throw new y("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)E(d(t),d(e),n||!0);else{n=n||D;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(i){if(i instanceof y)return i;throw i}}function O(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,r,i,a=Array.isArray(e),o=Array.isArray(t);if(a&&o){if((r=e.length)!=t.length)return!1;for(n=r;0!==n--;)if(!O(e[n],t[n]))return!1;return!0}if(a!=o)return!1;var u=Object.keys(e);if((r=u.length)!==Object.keys(t).length)return!1;for(n=r;0!==n--;)if(!t.hasOwnProperty(u[n]))return!1;for(n=r;0!==n--;)if(!O(e[i=u[n]],t[i]))return!1;return!0}return e!==e&&t!==t}var F=Object.freeze({__proto__:null,JsonPatchError:y,deepClone:b,getValueByPointer:k,applyOperation:A,applyPatch:E,applyReducer:function(e,t,n){var r=A(e,t);if(!1===r.test)throw new y("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument},validator:D,validate:C,_areEquals:O}),_=new WeakMap,S=function(e){this.observers=new Map,this.obj=e},M=function(e,t){this.callback=e,this.observer=t};function j(e,t){void 0===t&&(t=!1);var n=_.get(e.object);T(n.value,e.object,e.patches,"",t),e.patches.length&&E(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function T(e,t,n,r,i){if(t!==e){"function"===typeof t.toJSON&&(t=t.toJSON());for(var a=f(t),o=f(e),u=!1,s=o.length-1;s>=0;s--){var l=e[v=o[s]];if(!c(t,v)||void 0===t[v]&&void 0!==l&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(i&&n.push({op:"test",path:r+"/"+p(v),value:d(l)}),n.push({op:"remove",path:r+"/"+p(v)}),u=!0):(i&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}));else{var h=t[v];"object"==typeof l&&null!=l&&"object"==typeof h&&null!=h?T(l,h,n,r+"/"+p(v),i):l!==h&&(i&&n.push({op:"test",path:r+"/"+p(v),value:d(l)}),n.push({op:"replace",path:r+"/"+p(v),value:d(h)}))}}if(u||a.length!=o.length)for(s=0;s<a.length;s++){var v;c(e,v=a[s])||void 0===t[v]||n.push({op:"add",path:r+"/"+p(v),value:d(t[v])})}}}var N=Object.freeze({__proto__:null,unobserve:function(e,t){t.unobserve()},observe:function(e,t){var n,r=function(e){return _.get(e)}(e);if(r){var i=function(e,t){return e.observers.get(t)}(r,t);n=i&&i.observer}else r=new S(e),_.set(e,r);if(n)return n;if(n={},r.value=d(e),t){n.callback=t,n.next=null;var a=function(){j(n)},o=function(){clearTimeout(n.next),n.next=setTimeout(a)};"undefined"!==typeof window&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return n.patches=[],n.object=e,n.unobserve=function(){j(n),clearTimeout(n.next),function(e,t){e.observers.delete(t.callback)}(r,n),"undefined"!==typeof window&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},r.observers.set(t,new M(t,n)),n},generate:j,compare:function(e,t,n){void 0===n&&(n=!1);var r=[];return T(e,t,r,"",n),r}});Object.assign({},F,N,{JsonPatchError:g,deepClone:d,escapePathComponent:p,unescapePathComponent:v});var B=/("(?:[^\\"]|\\.)*")|[:,]/g,R=function(e,t){var n,r,i;return t=t||{},n=JSON.stringify([1],void 0,void 0===t.indent?2:t.indent).slice(2,-3),r=""===n?1/0:void 0===t.maxLength?80:t.maxLength,i=t.replacer,function e(t,a,o){var u,s,l,c,f,d,h,p,v,m,g,y;if(t&&"function"===typeof t.toJSON&&(t=t.toJSON()),void 0===(g=JSON.stringify(t,i)))return g;if(h=r-a.length-o,g.length<=h&&(v=g.replace(B,function(e,t){return t||e+" "})).length<=h)return v;if(null!=i&&(t=JSON.parse(g),i=void 0),"object"===typeof t&&null!==t){if(p=a+n,l=[],s=0,Array.isArray(t))for(m="[",u="]",h=t.length;s<h;s++)l.push(e(t[s],p,s===h-1?0:1)||"null");else for(m="{",u="}",h=(d=Object.keys(t)).length;s<h;s++)c=d[s],f=JSON.stringify(c)+": ",void 0!==(y=e(t[c],p,f.length+(s===h-1?0:1)))&&l.push(f+y);if(l.length>0)return[m,n+l.join(",\n"+p),u].join("\n"+a)}return g}(e,"",0)};function z(e,t){return e(t={exports:{}},t.exports),t.exports}var P,L=z(function(e,n){var r;n=e.exports=h,r="object"===typeof t&&Object({NODE_ENV:"production",PUBLIC_URL:"."})&&Object({NODE_ENV:"production",PUBLIC_URL:"."}).NODE_DEBUG&&/\bsemver\b/i.test(Object({NODE_ENV:"production",PUBLIC_URL:"."}).NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},n.SEMVER_SPEC_VERSION="2.0.0";var i=256,a=Number.MAX_SAFE_INTEGER||9007199254740991,o=n.re=[],u=n.src=[],s=n.tokens={},l=0;function c(e){s[e]=l++}c("NUMERICIDENTIFIER"),u[s.NUMERICIDENTIFIER]="0|[1-9]\\d*",c("NUMERICIDENTIFIERLOOSE"),u[s.NUMERICIDENTIFIERLOOSE]="[0-9]+",c("NONNUMERICIDENTIFIER"),u[s.NONNUMERICIDENTIFIER]="\\d*[a-zA-Z-][a-zA-Z0-9-]*",c("MAINVERSION"),u[s.MAINVERSION]="("+u[s.NUMERICIDENTIFIER]+")\\.("+u[s.NUMERICIDENTIFIER]+")\\.("+u[s.NUMERICIDENTIFIER]+")",c("MAINVERSIONLOOSE"),u[s.MAINVERSIONLOOSE]="("+u[s.NUMERICIDENTIFIERLOOSE]+")\\.("+u[s.NUMERICIDENTIFIERLOOSE]+")\\.("+u[s.NUMERICIDENTIFIERLOOSE]+")",c("PRERELEASEIDENTIFIER"),u[s.PRERELEASEIDENTIFIER]="(?:"+u[s.NUMERICIDENTIFIER]+"|"+u[s.NONNUMERICIDENTIFIER]+")",c("PRERELEASEIDENTIFIERLOOSE"),u[s.PRERELEASEIDENTIFIERLOOSE]="(?:"+u[s.NUMERICIDENTIFIERLOOSE]+"|"+u[s.NONNUMERICIDENTIFIER]+")",c("PRERELEASE"),u[s.PRERELEASE]="(?:-("+u[s.PRERELEASEIDENTIFIER]+"(?:\\."+u[s.PRERELEASEIDENTIFIER]+")*))",c("PRERELEASELOOSE"),u[s.PRERELEASELOOSE]="(?:-?("+u[s.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+u[s.PRERELEASEIDENTIFIERLOOSE]+")*))",c("BUILDIDENTIFIER"),u[s.BUILDIDENTIFIER]="[0-9A-Za-z-]+",c("BUILD"),u[s.BUILD]="(?:\\+("+u[s.BUILDIDENTIFIER]+"(?:\\."+u[s.BUILDIDENTIFIER]+")*))",c("FULL"),c("FULLPLAIN"),u[s.FULLPLAIN]="v?"+u[s.MAINVERSION]+u[s.PRERELEASE]+"?"+u[s.BUILD]+"?",u[s.FULL]="^"+u[s.FULLPLAIN]+"$",c("LOOSEPLAIN"),u[s.LOOSEPLAIN]="[v=\\s]*"+u[s.MAINVERSIONLOOSE]+u[s.PRERELEASELOOSE]+"?"+u[s.BUILD]+"?",c("LOOSE"),u[s.LOOSE]="^"+u[s.LOOSEPLAIN]+"$",c("GTLT"),u[s.GTLT]="((?:<|>)?=?)",c("XRANGEIDENTIFIERLOOSE"),u[s.XRANGEIDENTIFIERLOOSE]=u[s.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*",c("XRANGEIDENTIFIER"),u[s.XRANGEIDENTIFIER]=u[s.NUMERICIDENTIFIER]+"|x|X|\\*",c("XRANGEPLAIN"),u[s.XRANGEPLAIN]="[v=\\s]*("+u[s.XRANGEIDENTIFIER]+")(?:\\.("+u[s.XRANGEIDENTIFIER]+")(?:\\.("+u[s.XRANGEIDENTIFIER]+")(?:"+u[s.PRERELEASE]+")?"+u[s.BUILD]+"?)?)?",c("XRANGEPLAINLOOSE"),u[s.XRANGEPLAINLOOSE]="[v=\\s]*("+u[s.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+u[s.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+u[s.XRANGEIDENTIFIERLOOSE]+")(?:"+u[s.PRERELEASELOOSE]+")?"+u[s.BUILD]+"?)?)?",c("XRANGE"),u[s.XRANGE]="^"+u[s.GTLT]+"\\s*"+u[s.XRANGEPLAIN]+"$",c("XRANGELOOSE"),u[s.XRANGELOOSE]="^"+u[s.GTLT]+"\\s*"+u[s.XRANGEPLAINLOOSE]+"$",c("COERCE"),u[s.COERCE]="(^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])",c("COERCERTL"),o[s.COERCERTL]=new RegExp(u[s.COERCE],"g"),c("LONETILDE"),u[s.LONETILDE]="(?:~>?)",c("TILDETRIM"),u[s.TILDETRIM]="(\\s*)"+u[s.LONETILDE]+"\\s+",o[s.TILDETRIM]=new RegExp(u[s.TILDETRIM],"g"),c("TILDE"),u[s.TILDE]="^"+u[s.LONETILDE]+u[s.XRANGEPLAIN]+"$",c("TILDELOOSE"),u[s.TILDELOOSE]="^"+u[s.LONETILDE]+u[s.XRANGEPLAINLOOSE]+"$",c("LONECARET"),u[s.LONECARET]="(?:\\^)",c("CARETTRIM"),u[s.CARETTRIM]="(\\s*)"+u[s.LONECARET]+"\\s+",o[s.CARETTRIM]=new RegExp(u[s.CARETTRIM],"g"),c("CARET"),u[s.CARET]="^"+u[s.LONECARET]+u[s.XRANGEPLAIN]+"$",c("CARETLOOSE"),u[s.CARETLOOSE]="^"+u[s.LONECARET]+u[s.XRANGEPLAINLOOSE]+"$",c("COMPARATORLOOSE"),u[s.COMPARATORLOOSE]="^"+u[s.GTLT]+"\\s*("+u[s.LOOSEPLAIN]+")$|^$",c("COMPARATOR"),u[s.COMPARATOR]="^"+u[s.GTLT]+"\\s*("+u[s.FULLPLAIN]+")$|^$",c("COMPARATORTRIM"),u[s.COMPARATORTRIM]="(\\s*)"+u[s.GTLT]+"\\s*("+u[s.LOOSEPLAIN]+"|"+u[s.XRANGEPLAIN]+")",o[s.COMPARATORTRIM]=new RegExp(u[s.COMPARATORTRIM],"g"),c("HYPHENRANGE"),u[s.HYPHENRANGE]="^\\s*("+u[s.XRANGEPLAIN]+")\\s+-\\s+("+u[s.XRANGEPLAIN]+")\\s*$",c("HYPHENRANGELOOSE"),u[s.HYPHENRANGELOOSE]="^\\s*("+u[s.XRANGEPLAINLOOSE]+")\\s+-\\s+("+u[s.XRANGEPLAINLOOSE]+")\\s*$",c("STAR"),u[s.STAR]="(<|>)?=?\\s*\\*";for(var f=0;f<l;f++)r(f,u[f]),o[f]||(o[f]=new RegExp(u[f]));function d(e,t){if(t&&"object"===typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof h)return e;if("string"!==typeof e)return null;if(e.length>i)return null;if(!(t.loose?o[s.LOOSE]:o[s.FULL]).test(e))return null;try{return new h(e,t)}catch(n){return null}}function h(e,t){if(t&&"object"===typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof h){if(e.loose===t.loose)return e;e=e.version}else if("string"!==typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>i)throw new TypeError("version is longer than "+i+" characters");if(!(this instanceof h))return new h(e,t);r("SemVer",e,t),this.options=t,this.loose=!!t.loose;var n=e.trim().match(t.loose?o[s.LOOSE]:o[s.FULL]);if(!n)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>a||this.major<0)throw new TypeError("Invalid major version");if(this.minor>a||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>a||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<a)return t}return e}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}n.parse=d,n.valid=function(e,t){var n=d(e,t);return n?n.version:null},n.clean=function(e,t){var n=d(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null},n.SemVer=h,h.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},h.prototype.toString=function(){return this.version},h.prototype.compare=function(e){return r("SemVer.compare",this.version,this.options,e),e instanceof h||(e=new h(e,this.options)),this.compareMain(e)||this.comparePre(e)},h.prototype.compareMain=function(e){return e instanceof h||(e=new h(e,this.options)),v(this.major,e.major)||v(this.minor,e.minor)||v(this.patch,e.patch)},h.prototype.comparePre=function(e){if(e instanceof h||(e=new h(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return v(n,i)}while(++t)},h.prototype.compareBuild=function(e){e instanceof h||(e=new h(e,this.options));var t=0;do{var n=this.build[t],i=e.build[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return v(n,i)}while(++t)},h.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var n=this.prerelease.length;--n>=0;)"number"===typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);-1===n&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},n.inc=function(e,t,n,r){"string"===typeof n&&(r=n,n=void 0);try{return new h(e,n).inc(t,r).version}catch(i){return null}},n.diff=function(e,t){if(b(e,t))return null;var n=d(e),r=d(t),i="";if(n.prerelease.length||r.prerelease.length){i="pre";var a="prerelease"}for(var o in n)if(("major"===o||"minor"===o||"patch"===o)&&n[o]!==r[o])return i+o;return a},n.compareIdentifiers=v;var p=/^[0-9]+$/;function v(e,t){var n=p.test(e),r=p.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1}function m(e,t,n){return new h(e,n).compare(new h(t,n))}function g(e,t,n){return m(e,t,n)>0}function y(e,t,n){return m(e,t,n)<0}function b(e,t,n){return 0===m(e,t,n)}function x(e,t,n){return 0!==m(e,t,n)}function w(e,t,n){return m(e,t,n)>=0}function k(e,t,n){return m(e,t,n)<=0}function A(e,t,n,r){switch(t){case"===":return"object"===typeof e&&(e=e.version),"object"===typeof n&&(n=n.version),e===n;case"!==":return"object"===typeof e&&(e=e.version),"object"===typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return b(e,n,r);case"!=":return x(e,n,r);case">":return g(e,n,r);case">=":return w(e,n,r);case"<":return y(e,n,r);case"<=":return k(e,n,r);default:throw new TypeError("Invalid operator: "+t)}}function E(e,t){if(t&&"object"===typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof E){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof E))return new E(e,t);r("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===D?this.value="":this.value=this.operator+this.semver.version,r("comp",this)}n.rcompareIdentifiers=function(e,t){return v(t,e)},n.major=function(e,t){return new h(e,t).major},n.minor=function(e,t){return new h(e,t).minor},n.patch=function(e,t){return new h(e,t).patch},n.compare=m,n.compareLoose=function(e,t){return m(e,t,!0)},n.compareBuild=function(e,t,n){var r=new h(e,n),i=new h(t,n);return r.compare(i)||r.compareBuild(i)},n.rcompare=function(e,t,n){return m(t,e,n)},n.sort=function(e,t){return e.sort(function(e,r){return n.compareBuild(e,r,t)})},n.rsort=function(e,t){return e.sort(function(e,r){return n.compareBuild(r,e,t)})},n.gt=g,n.lt=y,n.eq=b,n.neq=x,n.gte=w,n.lte=k,n.cmp=A,n.Comparator=E;var D={};function C(e,t){if(t&&"object"===typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof C)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new C(e.raw,t);if(e instanceof E)return new C(e.value,t);if(!(this instanceof C))return new C(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(function(e){return this.parseRange(e.trim())},this).filter(function(e){return e.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function O(e,t){for(var n=!0,r=e.slice(),i=r.pop();n&&r.length;)n=r.every(function(e){return i.intersects(e,t)}),i=r.pop();return n}function F(e){return!e||"x"===e.toLowerCase()||"*"===e}function _(e,t,n,r,i,a,o,u,s,l,c,f,d){return((t=F(n)?"":F(r)?">="+n+".0.0":F(i)?">="+n+"."+r+".0":">="+t)+" "+(u=F(s)?"":F(l)?"<"+(+s+1)+".0.0":F(c)?"<"+s+"."+(+l+1)+".0":f?"<="+s+"."+l+"."+c+"-"+f:"<="+u)).trim()}function S(e,t,n){for(var i=0;i<e.length;i++)if(!e[i].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(i=0;i<e.length;i++)if(r(e[i].semver),e[i].semver!==D&&e[i].semver.prerelease.length>0){var a=e[i].semver;if(a.major===t.major&&a.minor===t.minor&&a.patch===t.patch)return!0}return!1}return!0}function M(e,t,n){try{t=new C(t,n)}catch(r){return!1}return t.test(e)}function j(e,t,n,r){var i,a,o,u,s;switch(e=new h(e,r),t=new C(t,r),n){case">":i=g,a=k,o=y,u=">",s=">=";break;case"<":i=y,a=w,o=g,u="<",s="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(M(e,t,r))return!1;for(var l=0;l<t.set.length;++l){var c=t.set[l],f=null,d=null;if(c.forEach(function(e){e.semver===D&&(e=new E(">=0.0.0")),f=f||e,d=d||e,i(e.semver,f.semver,r)?f=e:o(e.semver,d.semver,r)&&(d=e)}),f.operator===u||f.operator===s)return!1;if((!d.operator||d.operator===u)&&a(e,d.semver))return!1;if(d.operator===s&&o(e,d.semver))return!1}return!0}E.prototype.parse=function(e){var t=this.options.loose?o[s.COMPARATORLOOSE]:o[s.COMPARATOR],n=e.match(t);if(!n)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new h(n[2],this.options.loose):this.semver=D},E.prototype.toString=function(){return this.value},E.prototype.test=function(e){if(r("Comparator.test",e,this.options.loose),this.semver===D||e===D)return!0;if("string"===typeof e)try{e=new h(e,this.options)}catch(t){return!1}return A(e,this.operator,this.semver,this.options)},E.prototype.intersects=function(e,t){if(!(e instanceof E))throw new TypeError("a Comparator is required");var n;if(t&&"object"===typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||(n=new C(e.value,t),M(this.value,n,t));if(""===e.operator)return""===e.value||(n=new C(this.value,t),M(e.semver,n,t));var r=(">="===this.operator||">"===this.operator)&&(">="===e.operator||">"===e.operator),i=("<="===this.operator||"<"===this.operator)&&("<="===e.operator||"<"===e.operator),a=this.semver.version===e.semver.version,o=(">="===this.operator||"<="===this.operator)&&(">="===e.operator||"<="===e.operator),u=A(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),s=A(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return r||i||a&&o||u||s},n.Range=C,C.prototype.format=function(){return this.range=this.set.map(function(e){return e.join(" ").trim()}).join("||").trim(),this.range},C.prototype.toString=function(){return this.range},C.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var n=t?o[s.HYPHENRANGELOOSE]:o[s.HYPHENRANGE];e=e.replace(n,_),r("hyphen replace",e),e=e.replace(o[s.COMPARATORTRIM],"$1$2$3"),r("comparator trim",e,o[s.COMPARATORTRIM]),e=(e=(e=e.replace(o[s.TILDETRIM],"$1~")).replace(o[s.CARETTRIM],"$1^")).split(/\s+/).join(" ");var i=t?o[s.COMPARATORLOOSE]:o[s.COMPARATOR],a=e.split(" ").map(function(e){return function(e,t){return r("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map(function(e){return function(e,t){r("caret",e,t);var n=t.loose?o[s.CARETLOOSE]:o[s.CARET];return e.replace(n,function(t,n,i,a,o){var u;return r("caret",e,t,n,i,a,o),F(n)?u="":F(i)?u=">="+n+".0.0 <"+(+n+1)+".0.0":F(a)?u="0"===n?">="+n+"."+i+".0 <"+n+"."+(+i+1)+".0":">="+n+"."+i+".0 <"+(+n+1)+".0.0":o?(r("replaceCaret pr",o),u="0"===n?"0"===i?">="+n+"."+i+"."+a+"-"+o+" <"+n+"."+i+"."+(+a+1):">="+n+"."+i+"."+a+"-"+o+" <"+n+"."+(+i+1)+".0":">="+n+"."+i+"."+a+"-"+o+" <"+(+n+1)+".0.0"):(r("no pr"),u="0"===n?"0"===i?">="+n+"."+i+"."+a+" <"+n+"."+i+"."+(+a+1):">="+n+"."+i+"."+a+" <"+n+"."+(+i+1)+".0":">="+n+"."+i+"."+a+" <"+(+n+1)+".0.0"),r("caret return",u),u})}(e,t)}).join(" ")}(e,t),r("caret",e),e=function(e,t){return e.trim().split(/\s+/).map(function(e){return function(e,t){var n=t.loose?o[s.TILDELOOSE]:o[s.TILDE];return e.replace(n,function(t,n,i,a,o){var u;return r("tilde",e,t,n,i,a,o),F(n)?u="":F(i)?u=">="+n+".0.0 <"+(+n+1)+".0.0":F(a)?u=">="+n+"."+i+".0 <"+n+"."+(+i+1)+".0":o?(r("replaceTilde pr",o),u=">="+n+"."+i+"."+a+"-"+o+" <"+n+"."+(+i+1)+".0"):u=">="+n+"."+i+"."+a+" <"+n+"."+(+i+1)+".0",r("tilde return",u),u})}(e,t)}).join(" ")}(e,t),r("tildes",e),e=function(e,t){return r("replaceXRanges",e,t),e.split(/\s+/).map(function(e){return function(e,t){e=e.trim();var n=t.loose?o[s.XRANGELOOSE]:o[s.XRANGE];return e.replace(n,function(n,i,a,o,u,s){r("xRange",e,n,i,a,o,u,s);var l=F(a),c=l||F(o),f=c||F(u),d=f;return"="===i&&d&&(i=""),s=t.includePrerelease?"-0":"",l?n=">"===i||"<"===i?"<0.0.0-0":"*":i&&d?(c&&(o=0),u=0,">"===i?(i=">=",c?(a=+a+1,o=0,u=0):(o=+o+1,u=0)):"<="===i&&(i="<",c?a=+a+1:o=+o+1),n=i+a+"."+o+"."+u+s):c?n=">="+a+".0.0"+s+" <"+(+a+1)+".0.0"+s:f&&(n=">="+a+"."+o+".0"+s+" <"+a+"."+(+o+1)+".0"+s),r("xRange return",n),n})}(e,t)}).join(" ")}(e,t),r("xrange",e),e=function(e,t){return r("replaceStars",e,t),e.trim().replace(o[s.STAR],"")}(e,t),r("stars",e),e}(e,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(a=a.filter(function(e){return!!e.match(i)})),a=a.map(function(e){return new E(e,this.options)},this)},C.prototype.intersects=function(e,t){if(!(e instanceof C))throw new TypeError("a Range is required");return this.set.some(function(n){return O(n,t)&&e.set.some(function(e){return O(e,t)&&n.every(function(n){return e.every(function(e){return n.intersects(e,t)})})})})},n.toComparators=function(e,t){return new C(e,t).set.map(function(e){return e.map(function(e){return e.value}).join(" ").trim().split(" ")})},C.prototype.test=function(e){if(!e)return!1;if("string"===typeof e)try{e=new h(e,this.options)}catch(n){return!1}for(var t=0;t<this.set.length;t++)if(S(this.set[t],e,this.options))return!0;return!1},n.satisfies=M,n.maxSatisfying=function(e,t,n){var r=null,i=null;try{var a=new C(t,n)}catch(o){return null}return e.forEach(function(e){a.test(e)&&(r&&-1!==i.compare(e)||(i=new h(r=e,n)))}),r},n.minSatisfying=function(e,t,n){var r=null,i=null;try{var a=new C(t,n)}catch(o){return null}return e.forEach(function(e){a.test(e)&&(r&&1!==i.compare(e)||(i=new h(r=e,n)))}),r},n.minVersion=function(e,t){e=new C(e,t);var n=new h("0.0.0");if(e.test(n))return n;if(n=new h("0.0.0-0"),e.test(n))return n;n=null;for(var r=0;r<e.set.length;++r)e.set[r].forEach(function(e){var t=new h(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":n&&!g(n,t)||(n=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}});return n&&e.test(n)?n:null},n.validRange=function(e,t){try{return new C(e,t).range||"*"}catch(n){return null}},n.ltr=function(e,t,n){return j(e,t,"<",n)},n.gtr=function(e,t,n){return j(e,t,">",n)},n.outside=j,n.prerelease=function(e,t){var n=d(e,t);return n&&n.prerelease.length?n.prerelease:null},n.intersects=function(e,t,n){return e=new C(e,n),t=new C(t,n),e.intersects(t)},n.coerce=function(e,t){if(e instanceof h)return e;if("number"===typeof e&&(e=String(e)),"string"!==typeof e)return null;var n=null;if((t=t||{}).rtl){for(var r;(r=o[s.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&r.index+r[0].length===n.index+n[0].length||(n=r),o[s.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;o[s.COERCERTL].lastIndex=-1}else n=e.match(o[s.COERCE]);return null===n?null:d(n[2]+"."+(n[3]||"0")+"."+(n[4]||"0"),t)}}),I=(L.SEMVER_SPEC_VERSION,L.re,L.src,L.tokens,L.parse,L.valid,L.clean,L.SemVer,L.inc,L.diff,L.compareIdentifiers,L.rcompareIdentifiers,L.major,L.minor,L.patch,L.compare,L.compareLoose,L.compareBuild,L.rcompare,L.sort,L.rsort,L.gt,L.lt,L.eq,L.neq,L.gte,L.lte,L.cmp,L.Comparator,L.Range,L.toComparators,L.satisfies),U=(L.maxSatisfying,L.minSatisfying,L.minVersion,L.validRange,L.ltr,L.gtr,L.outside,L.prerelease,L.intersects,L.coerce,(P=z(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=/\/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t[0],version:t[1]}}}))&&P.__esModule&&Object.prototype.hasOwnProperty.call(P,"default")?P.default:P),q={background:"#333",title:{color:"#fff"},style:{"guide-label":{fill:"#fff"},"guide-title":{fill:"#fff"}},axis:{domainColor:"#fff",gridColor:"#888",tickColor:"#fff"}},W={background:"#fff",arc:{fill:"#4572a7"},area:{fill:"#4572a7"},line:{stroke:"#4572a7",strokeWidth:2},path:{stroke:"#4572a7"},rect:{fill:"#4572a7"},shape:{stroke:"#4572a7"},symbol:{fill:"#4572a7",strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},H={arc:{fill:"#30a2da"},area:{fill:"#30a2da"},axis:{domainColor:"#cbcbcb",grid:!0,gridColor:"#cbcbcb",gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:"#cbcbcb",tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:"#f0f0f0",group:{fill:"#f0f0f0"},legend:{labelColor:"#333",labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:"#333",titleFontSize:14,titlePadding:10},line:{stroke:"#30a2da",strokeWidth:2},path:{stroke:"#30a2da",strokeWidth:.5},rect:{fill:"#30a2da"},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:"#30a2da"},style:{bar:{binSpacing:2,fill:"#30a2da",stroke:null}},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},V={group:{fill:"#e5e5e5"},arc:{fill:"#000"},area:{fill:"#000"},line:{stroke:"#000"},path:{stroke:"#000"},rect:{fill:"#000"},shape:{stroke:"#000"},symbol:{fill:"#000",size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},G="Benton Gothic Bold, sans-serif",$={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},Y={background:"#ffffff",title:{anchor:"start",color:"#000000",font:G,fontSize:22,fontWeight:"normal"},arc:{fill:"#82c6df"},area:{fill:"#82c6df"},line:{stroke:"#82c6df",strokeWidth:2},path:{stroke:"#82c6df"},rect:{fill:"#82c6df"},shape:{stroke:"#82c6df"},symbol:{fill:"#82c6df",size:30},axis:{labelFont:"Benton Gothic, sans-serif",labelFontSize:11.5,labelFontWeight:"normal",titleFont:G,titleFontSize:13,titleFontWeight:"normal"},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:"Benton Gothic, sans-serif",labelFontSize:11.5,symbolType:"square",titleFont:G,titleFontSize:13,titleFontWeight:"normal"},range:{category:$["category-6"],diverging:$["fireandice-6"],heatmap:$["fire-7"],ordinal:$["fire-7"],ramp:$["fire-7"]}},X={background:"#f9f9f9",arc:{fill:"#ab5787"},area:{fill:"#ab5787"},line:{stroke:"#ab5787"},path:{stroke:"#ab5787"},rect:{fill:"#ab5787"},shape:{stroke:"#ab5787"},symbol:{fill:"#ab5787",size:30},axis:{domainColor:"#979797",domainWidth:.5,gridWidth:.2,labelColor:"#979797",tickColor:"#979797",tickWidth:.2,titleColor:"#979797"},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},J={background:"#fff",arc:{fill:"#3e5c69"},area:{fill:"#3e5c69"},line:{stroke:"#3e5c69"},path:{stroke:"#3e5c69"},rect:{fill:"#3e5c69"},shape:{stroke:"#3e5c69"},symbol:{fill:"#3e5c69"},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Q={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},K={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:"Lato"},axisX:{domain:!0,domainColor:"#000000",domainWidth:1,grid:!1,labelFontSize:12,labelFont:"Lato",labelAngle:0,tickColor:"#000000",tickSize:5,titleFontSize:12,titlePadding:10,titleFont:"Lato"},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:"Lato",labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:"Lato",titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:"Lato",symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:"Lato",orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Q["six-groups-cat-1"],diverging:Q["diverging-colors"],heatmap:Q["diverging-colors"],ordinal:Q["six-groups-seq"],ramp:Q["shades-blue"]},area:{fill:"#1696d2"},rect:{fill:"#1696d2"},line:{color:"#1696d2",stroke:"#1696d2",strokeWidth:5},trail:{color:"#1696d2",stroke:"#1696d2",strokeWidth:0,size:1},path:{stroke:"#1696d2",strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:"#1696d2",fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:"#1696d2",stroke:!1}},arc:{fill:"#1696d2"},shape:{stroke:"#1696d2"},symbol:{fill:"#1696d2",size:30}},Z=Object.freeze({__proto__:null,version:"2.5.0",dark:q,excel:W,fivethirtyeight:H,ggplot2:V,latimes:Y,quartz:X,vox:J,urbaninstitute:K}),ee="#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n",te="vg-tooltip-element",ne={offsetX:10,offsetY:10,id:te,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2};function re(e,t,n){return e.fields=t||[],e.fname=n,e}function ie(e){throw Error(e)}var ae=Array.isArray;function oe(e){return e===Object(e)}function ue(e){return"string"===typeof e}function se(e){return ae(e)?"["+e.map(se)+"]":oe(e)||ue(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}var le=[];function ce(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){for(var n in t)if("signals"===n)e.signals=de(e.signals,t.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;fe(e,n,t[n],r)}return e},{})}function fe(e,t,n,r){var i,a;if(oe(n)&&!ae(n))for(i in a=oe(e[t])?e[t]:e[t]={},n)r&&(!0===r||r[i])?fe(a,i,n[i]):a[i]=n[i];else e[t]=n}function de(e,t){if(null==e)return t;var n={},r=[];function i(e){n[e.name]||(n[e.name]=1,r.push(e))}return t.forEach(i),e.forEach(i),r}(function(e,t){var n=function(e){var t,n,r,i=[],a=null,o=0,u=e.length,s="";function l(){i.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<u;++n)if("\\"===(r=e[n]))s+=e.substring(t,n),t=++n;else if(r===a)l(),a=null,o=-1;else{if(a)continue;t===o&&'"'===r?(t=n+1,a=r):t===o&&"'"===r?(t=n+1,a=r):"."!==r||o?"["===r?(n>t&&l(),o=t=n+1):"]"===r&&(o||ie("Access path missing open bracket: "+e),o>0&&l(),o=0,t=n+1):n>t?l():t=n+1}return o&&ie("Access path missing closing bracket: "+e),a&&ie("Access path missing closing quote: "+e),n>t&&(n++,l()),i}(e),r="return _["+n.map(se).join("][")+"];";re(Function("_",r),[e=1===n.length?n[0]:e],t||e)})("id"),re(function(e){return e},le,"identity"),re(function(){return 0},le,"zero"),re(function(){return 1},le,"one"),re(function(){return!0},le,"true"),re(function(){return!1},le,"false");var he=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n};function pe(e,t){return JSON.stringify(e,function(e){var t=[];return function(n,r){if("object"!==typeof r||null===r)return r;var i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}(t))}var ve=function(){function e(t){i(this,e),this.options=Object.assign(Object.assign({},ne),t);var n=this.options.id;if(this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){var r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=function(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return ee.toString().replace(te,e)}(n);var a=document.head;a.childNodes.length>0?a.insertBefore(r,a.childNodes[0]):a.appendChild(r)}this.el=document.getElementById(n),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",n),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el))}return a(e,[{key:"tooltipHandler",value:function(e,t,n,r){if(null!=r&&""!==r){this.el.innerHTML=function(e,t,n){if(ae(e))return"[".concat(e.map(function(e){return t(ue(e)?e:pe(e,n))}).join(", "),"]");if(oe(e)){var r="",i=e,a=i.title,o=he(i,["title"]);a&&(r+="<h2>".concat(t(a),"</h2>"));var u=Object.keys(o);if(u.length>0){r+="<table>";var s=!0,l=!1,c=void 0;try{for(var f,d=u[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var h=f.value,p=o[h];void 0!==p&&(oe(p)&&(p=pe(p,n)),r+='<tr><td class="key">'.concat(t(h),':</td><td class="value">').concat(t(p),"</td></tr>"))}}catch(v){l=!0,c=v}finally{try{s||null==d.return||d.return()}finally{if(l)throw c}}r+="</table>"}return r||"{}"}return t(e)}(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible","".concat(this.options.theme,"-theme"));var i=function(e,t,n,r){var i=e.clientX+n;i+t.width>window.innerWidth&&(i=+e.clientX-n-t.width);var a=e.clientY+r;return a+t.height>window.innerHeight&&(a=+e.clientY-r-t.height),{x:i,y:a}}(t,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY),a=i.x,o=i.y;this.el.setAttribute("style","top: ".concat(o,"px; left: ").concat(a,"px"))}else this.el.classList.remove("visible","".concat(this.options.theme,"-theme"))}}]),e}();function me(e,t,n){var r=e.open(t),i=250,a=~~(1e4/i);e.addEventListener("message",function t(n){n.source===r&&(a=0,e.removeEventListener("message",t,!1))},!1),setTimeout(function e(){a<=0||(r.postMessage(n,"*"),setTimeout(e,i),a-=1)},i)}var ge='.vega-embed {\n  position: relative;\n  display: inline-block; }\n  .vega-embed.has-actions {\n    padding-right: 38px; }\n  .vega-embed details:not([open]) > :not(summary) {\n    display: none !important; }\n  .vega-embed summary {\n    list-style: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 6px;\n    z-index: 1000;\n    background: white;\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n    color: #1b1e23;\n    border: 1px solid #aaa;\n    border-radius: 999px;\n    opacity: 0.2;\n    transition: opacity 0.4s ease-in;\n    outline: none;\n    cursor: pointer;\n    line-height: 0px; }\n    .vega-embed summary::-webkit-details-marker {\n      display: none; }\n    .vega-embed summary:active {\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\n    .vega-embed summary svg {\n      width: 14px;\n      height: 14px; }\n  .vega-embed details[open] summary {\n    opacity: 0.7; }\n  .vega-embed:hover summary,\n  .vega-embed:focus summary {\n    opacity: 1 !important;\n    transition: opacity 0.2s ease; }\n  .vega-embed .vega-actions {\n    position: absolute;\n    top: 35px;\n    right: -9px;\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n    border: 1px solid #d9d9d9;\n    background: white;\n    animation-duration: 0.15s;\n    animation-name: scale-in;\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5); }\n    .vega-embed .vega-actions a {\n      padding: 8px 16px;\n      font-family: sans-serif;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      color: #434a56;\n      text-decoration: none; }\n      .vega-embed .vega-actions a:hover {\n        background-color: #f7f7f9;\n        color: black; }\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n      content: "";\n      display: inline-block;\n      position: absolute; }\n    .vega-embed .vega-actions::before {\n      left: auto;\n      right: 14px;\n      top: -16px;\n      border: 8px solid #0000;\n      border-bottom-color: #d9d9d9; }\n    .vega-embed .vega-actions::after {\n      left: auto;\n      right: 15px;\n      top: -14px;\n      border: 7px solid #0000;\n      border-bottom-color: #fff; }\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: scroll;\n  padding-right: 14px; }\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6); }\n  to {\n    opacity: 1;\n    transform: scale(1); } }\n';function ye(e){return e.startsWith("http://")||e.startsWith("https://")||e.startsWith("//")}function be(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++)xe(e,a[i]);return e}function xe(t,n){for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r];e.writeConfig(t,a,n[a],!0)}}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});var we=e,ke=n,Ae=window;void 0===ke&&Ae.vl&&Ae.vl.compile&&(ke=Ae.vl);var Ee={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},De={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Ce={vega:"Vega","vega-lite":"Vega-Lite"},Oe={vega:we.version,"vega-lite":ke?ke.version:"not available"},Fe={vega:function(e){return e},"vega-lite":function(e,t){return ke.compile(e,{config:t}).spec}},_e='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>';function Se(e,t,n,r){var i="<html><head>".concat(t,'</head><body><pre><code class="json">'),a="</code></pre>".concat(n,"</body></html>"),o=window.open("");o.document.write(i+e+a),o.document.title="".concat(Ce[r]," JSON Source")}function Me(e,t){if(e.$schema){var n=U(e.$schema);t&&t!==n.library&&console.warn("The given visualization spec is written in ".concat(Ce[n.library],", but mode argument sets ").concat(Ce[t]||t,"."));var r=n.library;return I(Oe[r],"^".concat(n.version.slice(1)))||console.warn("The input spec uses ".concat(Ce[r]," ").concat(n.version,", but the current version of ").concat(Ce[r]," is v").concat(Oe[r],".")),r}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":t||"vega"}function je(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return u(this,void 0,void 0,r.mark(function i(){var a,o,u,s,l;return r.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(i=n.loader,a=i&&"load"in i?n.loader:we.loader(n.loader),!ue(t)){r.next=9;break}return r.t1=JSON,r.next=5,a.load(t);case 5:r.t2=r.sent,r.t0=r.t1.parse.call(r.t1,r.t2),r.next=10;break;case 9:r.t0=t;case 10:return o=r.t0,r.next=13,Te(o.usermeta&&o.usermeta.embedOptions||{},a);case 13:return u=r.sent,r.next=16,Te(n,a);case 16:return s=r.sent,l=Object.assign(Object.assign({},be(s,u)),{config:ce(s.config,u.config)}),r.next=20,Ne(e,o,l,a);case 20:return r.abrupt("return",r.sent);case 21:case"end":return r.stop()}var i},i)}))}function Te(e,t){return u(this,void 0,void 0,r.mark(function n(){var i,a;return r.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!ue(e.config)){n.next=8;break}return n.t1=JSON,n.next=4,t.load(e.config);case 4:n.t2=n.sent,n.t0=n.t1.parse.call(n.t1,n.t2),n.next=9;break;case 8:n.t0=e.config||{};case 9:if(i=n.t0,!ue(e.patch)){n.next=18;break}return n.t4=JSON,n.next=14,t.load(e.patch);case 14:n.t5=n.sent,n.t3=n.t4.parse.call(n.t4,n.t5),n.next=19;break;case 18:n.t3=e.patch;case 19:return a=n.t3,n.abrupt("return",Object.assign(Object.assign(Object.assign({},e),a?{patch:a}:{}),i?{config:i}:{}));case 21:case"end":return n.stop()}},n)}))}function Ne(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;return u(this,void 0,void 0,r.mark(function a(){var o,u,s,l,c,f,d,h,p,v,m,g,y,b,x,w,k,A,D,C,O,F,_,S,M,j,T,N,B,z,P;return r.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return o=n.theme?ce(Z[n.theme],n.config):n.config,L=n.actions,u="boolean"===typeof L?n.actions:be({},Ee,n.actions||{}),s=Object.assign(Object.assign({},De),n.i18n),l=n.renderer||"canvas",c=n.logLevel||we.Warn,f=n.downloadFileName||"visualization",!1!==n.defaultStyle&&(d="vega-embed-style",document.getElementById(d)||((h=document.createElement("style")).id=d,h.innerText=void 0===n.defaultStyle||!0===n.defaultStyle?ge.toString():n.defaultStyle,document.head.appendChild(h))),p=Me(t,n.mode),v=Fe[p](t,o),"vega-lite"===p&&v.$schema&&(m=U(v.$schema),I(Oe.vega,"^".concat(m.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(m.version,", but current version is v").concat(Oe.vega,"."))),(g="string"===typeof e?document.querySelector(e):e).classList.add("vega-embed"),u&&g.classList.add("has-actions"),g.innerHTML="",(y=n.patch)&&(v=y instanceof Function?y(v):E(v,y,!0,!1).newDocument),b=we.parse(v,"vega-lite"===p?{}:o),x=new we.View(b,{loader:i,logLevel:c,renderer:l}),!1!==n.tooltip&&(a=n.tooltip,w="function"===typeof a?n.tooltip:new ve(!0===n.tooltip?{}:n.tooltip).call,x.tooltip(w)),void 0===(k=n.hover)&&(k="vega"===p),k&&(D=(A="boolean"===typeof k?{}:k).hoverSet,C=A.updateSet,x.hover(D,C)),n&&(n.width&&x.width(n.width),n.height&&x.height(n.height),n.padding&&x.padding(n.padding)),r.next=25,x.initialize(e).runAsync();case 25:if(!1!==u){if(O=g,!1!==n.defaultStyle&&((F=document.createElement("details")).title=s.CLICK_TO_VIEW_ACTIONS,g.append(F),O=F,(_=document.createElement("summary")).innerHTML=_e,F.append(_),document.addEventListener("click",function(e){F.contains(e.target)||F.removeAttribute("open")})),S=document.createElement("div"),O.append(S),S.classList.add("vega-actions"),!0===u||!1!==u.export)for(M=function(){var e=T[j];if(!0===u||!0===u.export||u.export[e]){var t=s["".concat(e.toUpperCase(),"_ACTION")],r=document.createElement("a");r.text=t,r.href="#",r.target="_blank",r.download="".concat(f,".").concat(e),r.addEventListener("mousedown",function(t){var r=this;x.toImageURL(e,n.scaleFactor).then(function(e){r.href=e}).catch(function(e){throw e}),t.preventDefault()}),S.append(r)}},j=0,T=["svg","png"];j<T.length;j++)M();!0!==u&&!1===u.source||((N=document.createElement("a")).text=s.SOURCE_ACTION,N.href="#",N.addEventListener("mousedown",function(e){Se(R(t),n.sourceHeader||"",n.sourceFooter||"",p),e.preventDefault()}),S.append(N)),"vega-lite"!==p||!0!==u&&!1===u.compiled||((B=document.createElement("a")).text=s.COMPILED_ACTION,B.href="#",B.addEventListener("mousedown",function(e){Se(R(v),n.sourceHeader||"",n.sourceFooter||"","vega"),e.preventDefault()}),S.append(B)),!0!==u&&!1===u.editor||(z=n.editorUrl||"https://vega.github.io/editor/",(P=document.createElement("a")).text=s.EDITOR_ACTION,P.href="#",P.addEventListener("mousedown",function(e){me(window,z,{config:o,mode:p,renderer:l,spec:R(t)}),e.preventDefault()}),S.append(P))}return r.abrupt("return",{view:x,spec:t,vgSpec:v});case 27:case"end":return r.stop()}var a,L},a)}))}function Be(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u(this,void 0,void 0,r.mark(function n(){var i,a,o,u;return r.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return(i=document.createElement("div")).classList.add("vega-embed-wrapper"),a=document.createElement("div"),i.appendChild(a),o=!0===t.actions||!1===t.actions?t.actions:Object.assign({export:!0,source:!1,compiled:!0,editor:!0},t.actions||{}),n.next=7,je(a,e,Object.assign({actions:o},t||{}));case 7:return u=n.sent,i.value=u.view,n.abrupt("return",i);case 10:case"end":return n.stop()}},n)}))}function Re(e){return e instanceof HTMLElement}var ze=function(){return arguments.length>1&&(e.isString(arguments.length<=0?void 0:arguments[0])&&!ye(arguments.length<=0?void 0:arguments[0])||Re(arguments.length<=0?void 0:arguments[0])||3===arguments.length)?je(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]):Be(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1])};return ze.vegaLite=ke,ze.vl=ke,ze.container=Be,ze.embed=je,ze.vega=we,ze.default=je,ze.version=o,ze}(n(2071),n(2897))}).call(this,n(58))},2876:function(e,t,n){!function(e){"use strict";function t(e){return e}function n(e){if(null==e)return t;var n,r,i=e.scale[0],a=e.scale[1],o=e.translate[0],u=e.translate[1];return function(e,t){t||(n=r=0);var s=2,l=e.length,c=new Array(l);for(c[0]=(n+=e[0])*i+o,c[1]=(r+=e[1])*a+u;s<l;)c[s]=e[s],++s;return c}}function r(e){var t,r=n(e.transform),i=1/0,a=i,o=-i,u=-i;function s(e){(e=r(e))[0]<i&&(i=e[0]),e[0]>o&&(o=e[0]),e[1]<a&&(a=e[1]),e[1]>u&&(u=e[1])}function l(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(l);break;case"Point":s(e.coordinates);break;case"MultiPoint":e.coordinates.forEach(s)}}for(t in e.arcs.forEach(function(e){for(var t,n=-1,s=e.length;++n<s;)(t=r(e[n],n))[0]<i&&(i=t[0]),t[0]>o&&(o=t[0]),t[1]<a&&(a=t[1]),t[1]>u&&(u=t[1])}),e.objects)l(e.objects[t]);return[i,a,o,u]}function i(e,t){var n=t.id,r=t.bbox,i=null==t.properties?{}:t.properties,o=a(e,t);return null==n&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function a(e,t){var r=n(e.transform),i=e.arcs;function a(e,t){t.length&&t.pop();for(var n=i[e<0?~e:e],a=0,o=n.length;a<o;++a)t.push(r(n[a],a));e<0&&function(e,t){for(var n,r=e.length,i=r-t;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}(t,o)}function o(e){return r(e)}function u(e){for(var t=[],n=0,r=e.length;n<r;++n)a(e[n],t);return t.length<2&&t.push(t[0]),t}function s(e){for(var t=u(e);t.length<4;)t.push(t[0]);return t}function l(e){return e.map(s)}return function e(t){var n,r=t.type;switch(r){case"GeometryCollection":return{type:r,geometries:t.geometries.map(e)};case"Point":n=o(t.coordinates);break;case"MultiPoint":n=t.coordinates.map(o);break;case"LineString":n=u(t.arcs);break;case"MultiLineString":n=t.arcs.map(u);break;case"Polygon":n=l(t.arcs);break;case"MultiPolygon":n=t.arcs.map(l);break;default:return null}return{type:r,coordinates:n}}(t)}function o(e,t){var n={},r={},i={},a=[],o=-1;function u(e,t){for(var r in e){var i=e[r];delete t[i.start],delete i.start,delete i.end,i.forEach(function(e){n[e<0?~e:e]=1}),a.push(i)}}return t.forEach(function(n,r){var i,a=e.arcs[n<0?~n:n];a.length<3&&!a[1][0]&&!a[1][1]&&(i=t[++o],t[o]=n,t[r]=i)}),t.forEach(function(t){var n,a,o=function(t){var n,r=e.arcs[t<0?~t:t],i=r[0];return e.transform?(n=[0,0],r.forEach(function(e){n[0]+=e[0],n[1]+=e[1]})):n=r[r.length-1],t<0?[n,i]:[i,n]}(t),u=o[0],s=o[1];if(n=i[u])if(delete i[n.end],n.push(t),n.end=s,a=r[s]){delete r[a.start];var l=a===n?n:n.concat(a);r[l.start=n.start]=i[l.end=a.end]=l}else r[n.start]=i[n.end]=n;else if(n=r[s])if(delete r[n.start],n.unshift(t),n.start=u,a=i[u]){delete i[a.end];var c=a===n?n:a.concat(n);r[c.start=a.start]=i[c.end=n.end]=c}else r[n.start]=i[n.end]=n;else r[(n=[t]).start=u]=i[n.end=s]=n}),u(i,r),u(r,i),t.forEach(function(e){n[e<0?~e:e]||a.push([e])}),a}function u(e,t,n){var r,i,a;if(arguments.length>1)r=function(e,t,n){var r,i=[],a=[];function o(e){var t=e<0?~e:e;(a[t]||(a[t]=[])).push({i:e,g:r})}function u(e){e.forEach(o)}function s(e){e.forEach(u)}return function e(t){switch(r=t,t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"LineString":u(t.arcs);break;case"MultiLineString":case"Polygon":s(t.arcs);break;case"MultiPolygon":!function(e){e.forEach(s)}(t.arcs)}}(t),a.forEach(null==n?function(e){i.push(e[0].i)}:function(e){n(e[0].g,e[e.length-1].g)&&i.push(e[0].i)}),i}(0,t,n);else for(i=0,r=new Array(a=e.arcs.length);i<a;++i)r[i]=i;return{type:"MultiLineString",arcs:o(e,r)}}function s(e,t){var n={},r=[],i=[];function u(e){e.forEach(function(t){t.forEach(function(t){(n[t=t<0?~t:t]||(n[t]=[])).push(e)})}),r.push(e)}function s(t){return function(e){for(var t,n=-1,r=e.length,i=e[r-1],a=0;++n<r;)t=i,i=e[n],a+=t[0]*i[1]-t[1]*i[0];return Math.abs(a)}(a(e,{type:"Polygon",arcs:[t]}).coordinates[0])}return t.forEach(function e(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"Polygon":u(t.arcs);break;case"MultiPolygon":t.arcs.forEach(u)}}),r.forEach(function(e){if(!e._){var t=[],r=[e];for(e._=1,i.push(t);e=r.pop();)t.push(e),e.forEach(function(e){e.forEach(function(e){n[e<0?~e:e].forEach(function(e){e._||(e._=1,r.push(e))})})})}}),r.forEach(function(e){delete e._}),{type:"MultiPolygon",arcs:i.map(function(t){var r,i=[];if(t.forEach(function(e){e.forEach(function(e){e.forEach(function(e){n[e<0?~e:e].length<2&&i.push(e)})})}),(r=(i=o(e,i)).length)>1)for(var a,u,l=1,c=s(i[0]);l<r;++l)(a=s(i[l]))>c&&(u=i[0],i[0]=i[l],i[l]=u,c=a);return i}).filter(function(e){return e.length>0})}}function l(e,t){for(var n=0,r=e.length;n<r;){var i=n+r>>>1;e[i]<t?n=i+1:r=i}return n}function c(e){if(null==e)return t;var n,r,i=e.scale[0],a=e.scale[1],o=e.translate[0],u=e.translate[1];return function(e,t){t||(n=r=0);var s=2,l=e.length,c=new Array(l),f=Math.round((e[0]-o)/i),d=Math.round((e[1]-u)/a);for(c[0]=f-n,n=f,c[1]=d-r,r=d;s<l;)c[s]=e[s],++s;return c}}e.bbox=r,e.feature=function(e,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return i(e,t)})}:i(e,t)},e.merge=function(e){return a(e,s.apply(this,arguments))},e.mergeArcs=s,e.mesh=function(e){return a(e,u.apply(this,arguments))},e.meshArcs=u,e.neighbors=function(e){var t={},n=e.map(function(){return[]});function r(e,n){e.forEach(function(e){e<0&&(e=~e);var r=t[e];r?r.push(n):t[e]=[n]})}function i(e,t){e.forEach(function(e){r(e,t)})}var a={LineString:r,MultiLineString:i,Polygon:i,MultiPolygon:function(e,t){e.forEach(function(e){i(e,t)})}};for(var o in e.forEach(function e(t,n){"GeometryCollection"===t.type?t.geometries.forEach(function(t){e(t,n)}):t.type in a&&a[t.type](t.arcs,n)}),t)for(var u=t[o],s=u.length,c=0;c<s;++c)for(var f=c+1;f<s;++f){var d,h=u[c],p=u[f];(d=n[h])[o=l(d,p)]!==p&&d.splice(o,0,p),(d=n[p])[o=l(d,h)]!==h&&d.splice(o,0,h)}return n},e.quantize=function(e,t){if(e.transform)throw new Error("already quantized");if(t&&t.scale)s=e.bbox;else{if(!((n=Math.floor(t))>=2))throw new Error("n must be \u22652");var n,i=(s=e.bbox||r(e))[0],a=s[1],o=s[2],u=s[3];t={scale:[o-i?(o-i)/(n-1):1,u-a?(u-a)/(n-1):1],translate:[i,a]}}var s,l,f=c(t),d=e.objects,h={};function p(e){return f(e)}function v(e){var t;switch(e.type){case"GeometryCollection":t={type:"GeometryCollection",geometries:e.geometries.map(v)};break;case"Point":t={type:"Point",coordinates:p(e.coordinates)};break;case"MultiPoint":t={type:"MultiPoint",coordinates:e.coordinates.map(p)};break;default:return e}return null!=e.id&&(t.id=e.id),null!=e.bbox&&(t.bbox=e.bbox),null!=e.properties&&(t.properties=e.properties),t}for(l in d)h[l]=v(d[l]);return{type:"Topology",bbox:s,transform:t,objects:h,arcs:e.arcs.map(function(e){var t,n=0,r=1,i=e.length,a=new Array(i);for(a[0]=f(e[0],0);++n<i;)((t=f(e[n],n))[0]||t[1])&&(a[r++]=t);return 1===r&&(a[r++]=[0,0]),a.length=r,a})}},e.transform=n,e.untransform=c,Object.defineProperty(e,"__esModule",{value:!0})}(t)},2877:function(e,t,n){!function(e,t,n,r,i){"use strict";function a(e){return e&&e.length?1===e.length?e[0]:(t=e,function(e){for(var n=t.length,r=1,i=String(t[0](e));r<n;++r)i+="|"+t[r](e);return i}):function(){return""};var t}function o(e,t,n){return n||e+(t?"_"+t:"")}var u={values:c({name:"values",init:"cell.store = true;",set:"cell.data.values()",idx:-1}),count:c({name:"count",set:"cell.num"}),__count__:c({name:"count",set:"this.missing + this.valid"}),missing:c({name:"missing",set:"this.missing"}),valid:c({name:"valid",set:"this.valid"}),sum:c({name:"sum",init:"this.sum = 0;",add:"this.sum += +v;",rem:"this.sum -= v;",set:"this.sum"}),mean:c({name:"mean",init:"this.mean = 0;",add:"var d = v - this.mean; this.mean += d / this.valid;",rem:"var d = v - this.mean; this.mean -= this.valid ? d / this.valid : this.mean;",set:"this.valid ? this.mean : undefined"}),average:c({name:"average",set:"this.valid ? this.mean : undefined",req:["mean"],idx:1}),variance:c({name:"variance",init:"this.dev = 0;",add:"this.dev += d * (v - this.mean);",rem:"this.dev -= d * (v - this.mean);",set:"this.valid > 1 ? this.dev / (this.valid-1) : undefined",req:["mean"],idx:1}),variancep:c({name:"variancep",set:"this.valid > 1 ? this.dev / this.valid : undefined",req:["variance"],idx:2}),stdev:c({name:"stdev",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid-1)) : undefined",req:["variance"],idx:2}),stdevp:c({name:"stdevp",set:"this.valid > 1 ? Math.sqrt(this.dev / this.valid) : undefined",req:["variance"],idx:2}),stderr:c({name:"stderr",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid * (this.valid-1))) : undefined",req:["variance"],idx:2}),distinct:c({name:"distinct",set:"cell.data.distinct(this.get)",req:["values"],idx:3}),ci0:c({name:"ci0",set:"cell.data.ci0(this.get)",req:["values"],idx:3}),ci1:c({name:"ci1",set:"cell.data.ci1(this.get)",req:["values"],idx:3}),median:c({name:"median",set:"cell.data.q2(this.get)",req:["values"],idx:3}),q1:c({name:"q1",set:"cell.data.q1(this.get)",req:["values"],idx:3}),q3:c({name:"q3",set:"cell.data.q3(this.get)",req:["values"],idx:3}),argmin:c({name:"argmin",init:"this.argmin = undefined;",add:"if (v < this.min) this.argmin = t;",rem:"if (v <= this.min) this.argmin = undefined;",set:"this.argmin || cell.data.argmin(this.get)",req:["min"],str:["values"],idx:3}),argmax:c({name:"argmax",init:"this.argmax = undefined;",add:"if (v > this.max) this.argmax = t;",rem:"if (v >= this.max) this.argmax = undefined;",set:"this.argmax || cell.data.argmax(this.get)",req:["max"],str:["values"],idx:3}),min:c({name:"min",init:"this.min = undefined;",add:"if (v < this.min || this.min === undefined) this.min = v;",rem:"if (v <= this.min) this.min = NaN;",set:"this.min = (Number.isNaN(this.min) ? cell.data.min(this.get) : this.min)",str:["values"],idx:4}),max:c({name:"max",init:"this.max = undefined;",add:"if (v > this.max || this.max === undefined) this.max = v;",rem:"if (v >= this.max) this.max = NaN;",set:"this.max = (Number.isNaN(this.max) ? cell.data.max(this.get) : this.max)",str:["values"],idx:4})},s=Object.keys(u);function l(e,t){return u[e](t)}function c(e){return function(n){var r=t.extend({init:"",add:"",rem:"",idx:0},e);return r.out=n||e.name,r}}function f(e,t){return e.idx-t.idx}function d(e,n){var r=n||t.identity,i=function(e,t){var n,r=e.reduce(function e(n,r){function i(t){n[t]||e(n,n[t]=u[t]())}return r.req&&r.req.forEach(i),t&&r.str&&r.str.forEach(i),n},e.reduce(function(e,t){return e[t.name]=t,e},{})),i=[];for(n in r)i.push(r[n]);return i.sort(f)}(e,!0),a="var cell = this.cell; this.valid = 0; this.missing = 0;",o="this.cell = cell; this.init();",s="if(v==null){++this.missing; return;} if(v!==v) return; ++this.valid;",l="if(v==null){--this.missing; return;} if(v!==v) return; --this.valid;",c="var cell = this.cell;";return i.forEach(function(e){a+=e.init,s+=e.add,l+=e.rem}),e.slice().sort(f).forEach(function(e){c+="t["+t.stringValue(e.out)+"]="+e.set+";"}),c+="return t;",(o=Function("cell",o)).prototype.init=Function(a),o.prototype.add=Function("v","t",s),o.prototype.rem=Function("v","t",l),o.prototype.set=Function("t",c),o.prototype.get=r,o.fields=e.map(function(e){return e.out}),o}function h(e){this._key=e?t.field(e):n.tupleid,this.reset()}var p=h.prototype;function v(e){n.Transform.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}p.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},p.add=function(e){this._add.push(e)},p.rem=function(e){this._rem.push(e)},p.values=function(){if(this._get=null,0===this._rem.length)return this._add;var e,t,n,r=this._add,i=this._rem,a=this._key,o=r.length,u=i.length,s=Array(o-u),l={};for(e=0;e<u;++e)l[a(i[e])]=1;for(e=0,t=0;e<o;++e)l[a(n=r[e])]?l[a(n)]=0:s[t++]=n;return this._rem=[],this._add=s},p.distinct=function(e){for(var n,r=this.values(),i=r.length,a={},o=0;--i>=0;)n=e(r[i])+"",t.hasOwnProperty(a,n)||(a[n]=1,++o);return o},p.extent=function(e){if(this._get!==e||!this._ext){var n=this.values(),r=t.extentIndex(n,e);this._ext=[n[r[0]],n[r[1]]],this._get=e}return this._ext},p.argmin=function(e){return this.extent(e)[0]||{}},p.argmax=function(e){return this.extent(e)[1]||{}},p.min=function(e){var t=this.extent(e)[0];return null!=t?e(t):void 0},p.max=function(e){var t=this.extent(e)[1];return null!=t?e(t):void 0},p.quartile=function(e){return this._get===e&&this._q||(this._q=r.quartiles(this.values(),e),this._get=e),this._q},p.q1=function(e){return this.quartile(e)[0]},p.q2=function(e){return this.quartile(e)[1]},p.q3=function(e){return this.quartile(e)[2]},p.ci=function(e){return this._get===e&&this._ci||(this._ci=r.bootstrapCI(this.values(),1e3,.05,e),this._get=e),this._ci},p.ci0=function(e){return this.ci(e)[0]},p.ci1=function(e){return this.ci(e)[1]},v.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:s},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};var m=t.inherits(v,n.Transform);function g(e){n.Transform.call(this,null,e)}m.transform=function(e,t){var n=this,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return n.stamp=r.stamp,n.value&&(i||t.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(e):{},t.visit(t.SOURCE,function(e){return n.add(e)})):(n.value=n.value||n.init(e),t.visit(t.REM,function(e){return n.rem(e)}),t.visit(t.ADD,function(e){return n.add(e)})),r.modifies(n._outputs),n._drop=!1!==e.drop,e.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),n.changes(r)},m.cross=function(){var e=this,t=e.value,n=e._dnames,r=n.map(function(){return{}}),i=n.length;function a(e){var t,a,o,u;for(t in e)for(o=e[t].tuple,a=0;a<i;++a)r[a][u=o[n[a]]]=u}a(e._prev),a(t),function a(o,u,s){var l,c,f=n[s],d=r[s++];for(l in d)u[f]=d[l],c=o?o+"|"+l:l,s<i?a(c,u,s):t[c]||e.cell(c,u)}("",{},0)},m.init=function(e){var n=this._inputs=[],r=this._outputs=[],i={};function u(e){for(var r,a=t.array(t.accessorFields(e)),o=0,u=a.length;o<u;++o)i[r=a[o]]||(i[r]=1,n.push(r))}this._dims=t.array(e.groupby),this._dnames=this._dims.map(function(e){var n=t.accessorName(e);return u(e),r.push(n),n}),this.cellkey=e.key?e.key:a(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];var s,c,f,h,p,v,m=e.fields||[null],g=e.ops||["count"],y=e.as||[],b=m.length,x={};for(b!==g.length&&t.error("Unmatched number of fields and aggregate ops."),v=0;v<b;++v)s=m[v],c=g[v],null==s&&"count"!==c&&t.error("Null aggregate field specified."),p=o(c,h=t.accessorName(s),y[v]),r.push(p),"count"!==c?((f=x[h])||(u(s),(f=x[h]=[]).field=s,this._measures.push(f)),"count"!==c&&(this._countOnly=!1),f.push(l(c,p))):this._counts.push(p);return this._measures=this._measures.map(function(e){return d(e,e.field)}),{}},m.cellkey=a(),m.cell=function(e,t){var n=this.value[e];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},m.newcell=function(e,t){var n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){var r,i=this._measures,a=i.length;for(n.agg=Array(a),r=0;r<a;++r)n.agg[r]=new i[r](n)}return n.store&&(n.data=new h),n},m.newtuple=function(e,t){var r,i,a=this._dnames,o=this._dims,u={};for(r=0,i=o.length;r<i;++r)u[a[r]]=o[r](e);return t?n.replace(t.tuple,u):n.ingest(u)},m.add=function(e){var t,n,r,i=this.cellkey(e),a=this.cell(i,e);if(a.num+=1,!this._countOnly)for(a.store&&a.data.add(e),n=0,r=(t=a.agg).length;n<r;++n)t[n].add(t[n].get(e),e)},m.rem=function(e){var t,n,r,i=this.cellkey(e),a=this.cell(i,e);if(a.num-=1,!this._countOnly)for(a.store&&a.data.rem(e),n=0,r=(t=a.agg).length;n<r;++n)t[n].rem(t[n].get(e),e)},m.celltuple=function(e){var t,n,r,i=e.tuple,a=this._counts;for(e.store&&e.data.values(),n=0,r=a.length;n<r;++n)i[a[n]]=e.num;if(!this._countOnly)for(n=0,r=(t=e.agg).length;n<r;++n)t[n].set(i);return i},m.changes=function(e){var t,n,r,i,a=this._adds,o=this._mods,u=this._prev,s=this._drop,l=e.add,c=e.rem,f=e.mod;if(u)for(n in u)t=u[n],s&&!t.num||c.push(t.tuple);for(r=0,i=this._alen;r<i;++r)l.push(this.celltuple(a[r])),a[r]=null;for(r=0,i=this._mlen;r<i;++r)(0===(t=o[r]).num&&s?c:f).push(this.celltuple(t)),o[r]=null;return this._alen=this._mlen=0,this._prev=null,e},g.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};var y=t.inherits(g,n.Transform);function b(e,n,r){var i=e,a=n||[],o=r||[],u={},s=0;return{add:function(e){o.push(e)},remove:function(e){u[i(e)]=++s},size:function(){return a.length},data:function(e,n){return s&&(a=a.filter(function(e){return!u[i(e)]}),u={},s=0),n&&e&&a.sort(e),o.length&&(a=e?t.merge(e,a,o.sort(e)):a.concat(o),o=[]),a}}}function x(e){n.Transform.call(this,[],e)}function w(e){n.Operator.call(this,null,k,e)}function k(e){return this.value&&!e.modified()?this.value:t.compare(e.fields,e.orders)}function A(e){n.Transform.call(this,null,e)}y.transform=function(e,n){var r,i=this._bins(e),a=i.start,o=i.step,u=e.as||["bin0","bin1"],s=u[0],l=u[1];return r=e.modified()?(n=n.reflow(!0)).SOURCE:n.modified(t.accessorFields(e.field))?n.ADD_MOD:n.ADD,n.visit(r,function(e){var t=i(e);e[s]=t,e[l]=null==t?null:a+o*(1+(t-a)/o)}),n.modifies(u)},y._bins=function(e){if(this.value&&!e.modified())return this.value;var n,i,a=e.field,o=r.bin(e),u=o.start,s=o.stop,l=o.step;null!=(n=e.anchor)&&(i=n-(u+l*Math.floor((n-u)/l)),u+=i,s+=i);var c=function(e){var t=a(e);return null==t?null:(t=Math.max(u,Math.min(+t,s-l)),u+l*Math.floor(1e-14+(t-u)/l))};return c.start=u,c.stop=s,c.step=l,this.value=t.accessor(c,t.accessorFields(a),e.name||"bin_"+t.accessorName(a))},x.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},t.inherits(x,n.Transform).transform=function(e,t){var r=t.fork(t.ALL),i=b(n.tupleid,this.value,r.materialize(r.ADD).add),a=e.sort,o=t.changed()||a&&(e.modified("sort")||t.modified(a.fields));return r.visit(r.REM,i.remove),this.modified(o),this.value=r.source=i.data(n.stableCompare(a),o),t.source&&t.source.root&&(this.value.root=t.source.root),r},t.inherits(w,n.Operator),A.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};var E=t.inherits(A,n.Transform);function D(e){n.Transform.call(this,null,e)}E.transform=function(e,t){function n(t){return function(n){for(var r,i=function(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e.match(n)}(u(n),e.case,a)||[],s=0,l=i.length;s<l;++s)o.test(r=i[s])||t(r)}}var r=this._parameterCheck(e,t),i=this._counts,a=this._match,o=this._stop,u=e.field,s=e.as||["text","count"],l=n(function(e){i[e]=1+(i[e]||0)}),c=n(function(e){i[e]-=1});return r?t.visit(t.SOURCE,l):(t.visit(t.ADD,l),t.visit(t.REM,c)),this._finish(t,s)},E._parameterCheck=function(e,t){var n=!1;return!e.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),!e.modified("pattern")&&this._match||(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},E._finish=function(e,t){var r,i,a,o=this._counts,u=this._tuples||(this._tuples={}),s=t[0],l=t[1],c=e.fork(e.NO_SOURCE|e.NO_FIELDS);for(r in o)i=u[r],a=o[r]||0,!i&&a?(u[r]=i=n.ingest({}),i[s]=r,i[l]=a,c.add.push(i)):0===a?(i&&c.rem.push(i),o[r]=null,u[r]=null):i[l]!==a&&(i[l]=a,c.mod.push(i));return c.modifies(t)},D.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},t.inherits(D,n.Transform).transform=function(e,r){var i=r.fork(r.NO_SOURCE),a=this.value,o=e.as||["a","b"],u=o[0],s=o[1];return!a||r.changed(r.ADD_REM)||e.modified("as")||e.modified("filter")?(a&&(i.rem=a),a=r.materialize(r.SOURCE).source,i.add=this.value=function(e,t,r,i){for(var a,o,u=[],s={},l=e.length,c=0;c<l;++c)for(s[t]=o=e[c],a=0;a<l;++a)s[r]=e[a],i(s)&&(u.push(n.ingest(s)),(s={})[t]=o);return u}(a,u,s,e.filter||t.truthy)):i.mod=a,i.source=this.value,i.modifies(o)};var C={kde:r.randomKDE,mixture:r.randomMixture,normal:r.randomNormal,lognormal:r.randomLogNormal,uniform:r.randomUniform},O="distributions",F="function",_="field";function S(e){n.Transform.call(this,null,e)}var M=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],j={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:M},{name:"weights",type:"number",array:!0}]};function T(e,n){return e?e.map(function(e,r){return n[r]||t.accessorName(e)}):null}function N(e,t,n){var r,i,a,o,u,s,l=[],c=function(e){return e(o)};if(null==t)l.push(e.map(n));else for(r={},i=0,a=e.length;i<a;++i)o=e[i],(s=r[u=t.map(c)])||(r[u]=s=[],s.dims=u,l.push(s)),s.push(n(o));return l}function B(e){n.Transform.call(this,null,e)}function R(e){n.Operator.call(this,null,z,e),this.modified(!0)}function z(e){var n=e.expr;return this.value&&!e.modified("expr")?this.value:t.accessor(function(t){return n(t,e)},t.accessorFields(n),t.accessorName(n))}function P(e){n.Transform.call(this,[void 0,void 0],e)}function L(e,t){n.Operator.call(this,e),this.parent=t}S.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:M.concat(j)},{name:"as",type:"string",array:!0,default:["value","density"]}]},t.inherits(S,n.Transform).transform=function(e,i){var a=i.fork(i.NO_SOURCE|i.NO_FIELDS);if(!this.value||i.changed()||e.modified()){var o=function e(n,r){var i=n[F];t.hasOwnProperty(C,i)||t.error("Unknown distribution function: "+i);var a=C[i]();for(var o in n)o===_?a.data((n.from||r()).map(n[o])):o===O?a[o](n[o].map(function(t){return e(t,r)})):typeof a[o]===F&&a[o](n[o]);return a}(e.distribution,function(e){return function(){return e.materialize(e.SOURCE).source}}(i)),u=e.steps||e.minsteps||25,s=e.steps||e.maxsteps||200,l=e.method||"pdf";"pdf"!==l&&"cdf"!==l&&t.error("Invalid density method: "+l),e.extent||o.data||t.error("Missing density extent parameter."),l=o[l];var c=e.as||["value","density"],f=e.extent||t.extent(o.data()),d=r.sampleCurve(l,f,u,s).map(function(e){var t={};return t[c[0]]=e[0],t[c[1]]=e[1],n.ingest(t)});this.value&&(a.rem=this.value),this.value=a.add=a.source=d}return a},B.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]},t.inherits(B,n.Transform).transform=function(e,i){if(this.value&&!e.modified()&&!i.changed())return i;for(var a,o=i.materialize(i.SOURCE).source,u=N(i.source,e.groupby,t.identity),s=e.smooth||!1,l=e.field,c=e.step||function(e,n){return t.span(t.extent(e,n))/30}(o,l),f=n.stableCompare(function(e,t){return l(e)-l(t)}),d=e.as||"bin",h=u.length,p=1/0,v=-1/0,m=0;m<h;++m){var g=u[m].sort(f);a=-1;var y=!0,b=!1,x=void 0;try{for(var w,k=r.dotbin(g,c,s,l)[Symbol.iterator]();!(y=(w=k.next()).done);y=!0){var A=w.value;A<p&&(p=A),A>v&&(v=A),g[++a][d]=A}}catch(E){b=!0,x=E}finally{try{y||null==k.return||k.return()}finally{if(b)throw x}}}return this.value={start:p,stop:v,step:c},i.reflow(!0).modifies(d)},t.inherits(R,n.Operator),P.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},t.inherits(P,n.Transform).transform=function(e,n){var r,i=this.value,a=e.field,o=i[0],u=i[1];if(((r=n.changed()||n.modified(a.fields)||e.modified("field"))||null==o)&&(o=1/0,u=-1/0),n.visit(r?n.SOURCE:n.ADD,function(e){var t=a(e);null!=t&&((t=+t)<o&&(o=t),t>u&&(u=t))}),!Number.isFinite(o)||!Number.isFinite(u)){var s=t.accessorName(a);s&&(s=' for field "'.concat(s,'"')),n.dataflow.warn("Infinite extent".concat(s,": [").concat(o,", ").concat(u,"]")),o=u=void 0}this.value=[o,u]};var I=t.inherits(L,n.Operator);function U(e){n.Transform.call(this,{},e),this._keys=t.fastmap();var r=this._targets=[];r.active=0,r.forEach=function(e){for(var t=0,n=r.active;t<n;++t)e(r[t],t,r)}}I.connect=function(e){return this.targets().add(e),e.source=this},I.add=function(e){this.value.add.push(e)},I.rem=function(e){this.value.rem.push(e)},I.mod=function(e){this.value.mod.push(e)},I.init=function(e){this.value.init(e,e.NO_SOURCE)},I.evaluate=function(){return this.value};var q=t.inherits(U,n.Transform);function W(e){n.Operator.call(this,null,H,e)}function H(e){return this.value&&!e.modified()?this.value:t.isArray(e.name)?t.array(e.name).map(function(e){return t.field(e)}):t.field(e.name,e.as)}function V(e){n.Transform.call(this,t.fastmap(),e)}function G(e){n.Transform.call(this,[],e)}function $(e){n.Transform.call(this,[],e)}function Y(e){n.Transform.call(this,null,e)}function X(e){n.Transform.call(this,[],e)}q.activate=function(e){this._targets[this._targets.active++]=e},q.subflow=function(e,n,r,i){var a,o,u=this.value,s=t.hasOwnProperty(u,e)&&u[e];return s?s.value.stamp<r.stamp&&(s.init(r),this.activate(s)):(o=i||(o=this._group[e])&&o.tuple,s=(a=r.dataflow).add(new L(r.fork(r.NO_SOURCE),this)).connect(n(a,e,o)),u[e]=s,this.activate(s)),s},q.transform=function(e,t){var r=t.dataflow,i=this,a=e.key,o=e.subflow,u=this._keys,s=e.modified("key");function l(e){return i.subflow(e,o,t)}return this._group=e.group||{},this._targets.active=0,t.visit(t.REM,function(e){var t=n.tupleid(e),r=u.get(t);void 0!==r&&(u.delete(t),l(r).rem(e))}),t.visit(t.ADD,function(e){var t=a(e);u.set(n.tupleid(e),t),l(t).add(e)}),s||t.modified(a.fields)?t.visit(t.MOD,function(e){var t=n.tupleid(e),r=u.get(t),i=a(e);r===i?l(i).mod(e):(u.set(t,i),l(r).rem(e),l(i).add(e))}):t.changed(t.MOD)&&t.visit(t.MOD,function(e){l(u.get(n.tupleid(e))).mod(e)}),s&&t.visit(t.REFLOW,function(e){var t=n.tupleid(e),r=u.get(t),i=a(e);r!==i&&(u.set(t,i),l(r).rem(e),l(i).add(e))}),u.empty>r.cleanThreshold&&r.runAfter(u.clean),t},t.inherits(W,n.Operator),V.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},t.inherits(V,n.Transform).transform=function(e,t){var r=t.dataflow,i=this.value,a=t.fork(),o=a.add,u=a.rem,s=a.mod,l=e.expr,c=!0;function f(t){var r=n.tupleid(t),a=l(t,e),f=i.get(r);a&&f?(i.delete(r),o.push(t)):a||f?c&&a&&!f&&s.push(t):(i.set(r,1),u.push(t))}return t.visit(t.REM,function(e){var t=n.tupleid(e);i.has(t)?i.delete(t):u.push(e)}),t.visit(t.ADD,function(t){l(t,e)?o.push(t):i.set(n.tupleid(t),1)}),t.visit(t.MOD,f),e.modified()&&(c=!1,t.visit(t.REFLOW,f)),i.empty>r.cleanThreshold&&r.runAfter(i.clean),a},G.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0}]},t.inherits(G,n.Transform).transform=function(e,t){var r=t.fork(t.NO_SOURCE),i=e.fields,a=T(i,e.as||[]),o=a.length;return r.rem=this.value,t.visit(t.SOURCE,function(e){for(var t,u,s,l=i.map(function(t){return t(e)}),c=l.reduce(function(e,t){return Math.max(e,t.length)},0),f=0;f<c;++f){for(u=n.derive(e),t=0;t<o;++t)u[a[t]]=null==(s=l[t][f])?null:s;r.add.push(u)}}),this.value=r.source=r.add,r.modifies(a)},$.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},t.inherits($,n.Transform).transform=function(e,r){var i=r.fork(r.NO_SOURCE),a=e.fields,o=a.map(t.accessorName),u=e.as||["key","value"],s=u[0],l=u[1],c=a.length;return i.rem=this.value,r.visit(r.SOURCE,function(e){for(var t,r=0;r<c;++r)(t=n.derive(e))[s]=o[r],t[l]=a[r](e),i.add.push(t)}),this.value=i.source=i.add,i.modifies(u)},Y.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},t.inherits(Y,n.Transform).transform=function(e,t){var n=e.expr,r=e.as,i=e.modified(),a=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(a,function(t){return t[r]=n(t,e)})},t.inherits(X,n.Transform).transform=function(e,t){var r,i,a,o=this.value,u=t.fork(t.ALL),s=e.size-o.length,l=e.generator;if(s>0){for(r=[];--s>=0;)r.push(a=n.ingest(l(e))),o.push(a);u.add=u.add.length?u.materialize(u.ADD).add.concat(r):r}else i=o.slice(0,-s),u.rem=u.rem.length?u.materialize(u.REM).rem.concat(i):i,o=o.slice(-s);return u.source=this.value=o,u};var J={value:"value",median:i.median,mean:i.mean,min:i.min,max:i.max},Q=[];function K(e){n.Transform.call(this,[],e)}function Z(e){v.call(this,e)}K.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},t.inherits(K,n.Transform).transform=function(e,r){var i,a,o,u,s,l,c,f,d,h,p=r.fork(r.ALL),v=function(e){var n,r=e.method||J.value;if(null!=J[r])return r===J.value?(n=void 0!==e.value?e.value:0,function(){return n}):J[r];t.error("Unrecognized imputation method: "+r)}(e),m=function(e){var t=e.field;return function(e){return e?t(e):NaN}}(e),g=t.accessorName(e.field),y=t.accessorName(e.key),b=(e.groupby||[]).map(t.accessorName),x=function(e,t,n,r){var i,a,o,u,s,l,c,f,d=function(e){return e(f)},h=[],p=r?r.slice():[],v={},m={};for(p.forEach(function(e,t){v[e]=t+1}),u=0,c=e.length;u<c;++u)l=n(f=e[u]),s=v[l]||(v[l]=p.push(l)),(o=m[a=(i=t?t.map(d):Q)+""])||(o=m[a]=[],h.push(o),o.values=i),o[s-1]=f;return h.domain=p,h}(r.source,e.groupby,e.key,e.keyvals),w=[],k=this.value,A=x.domain.length;for(s=0,f=x.length;s<f;++s)for(o=(i=x[s]).values,a=NaN,c=0;c<A;++c)if(null==i[c]){for(u=x.domain[c],h={_impute:!0},l=0,d=o.length;l<d;++l)h[b[l]]=o[l];h[y]=u,h[g]=Number.isNaN(a)?a=v(i,m):a,w.push(n.ingest(h))}return w.length&&(p.add=p.materialize(p.ADD).add.concat(w)),k.length&&(p.rem=p.materialize(p.REM).rem.concat(k)),this.value=w,p},Z.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:s},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};var ee=t.inherits(Z,v);function te(e){n.Transform.call(this,null,e)}function ne(e){n.Operator.call(this,null,re,e)}function re(e){return this.value&&!e.modified()?this.value:t.key(e.fields,e.flat)}function ie(e){n.Transform.call(this,[],e)}function ae(e,t,r){r.forEach(n.ingest);var i=t.fork(t.NO_FIELDS&t.NO_SOURCE);return i.rem=e.value,e.value=i.add=i.source=r,i}function oe(e){n.Transform.call(this,{},e)}function ue(e){n.Operator.call(this,null,se,e)}function se(e){if(this.value&&!e.modified())return this.value;var t,n,r,i=1/0,a=-1/0,o=e.extents;for(t=0,n=o.length;t<n;++t)(r=o[t])[0]<i&&(i=r[0]),r[1]>a&&(a=r[1]);return[i,a]}function le(e){n.Operator.call(this,null,ce,e)}function ce(e){return this.value&&!e.modified()?this.value:e.values.reduce(function(e,t){return e.concat(t)},[])}function fe(e){n.Transform.call(this,null,e)}function de(e){v.call(this,e)}ee.transform=function(e,n){var r,i=this,a=e.modified();return i.value&&(a||n.modified(i._inputs,!0))?(r=i.value=a?i.init(e):{},n.visit(n.SOURCE,function(e){i.add(e)})):(r=i.value=i.value||this.init(e),n.visit(n.REM,function(e){i.rem(e)}),n.visit(n.ADD,function(e){i.add(e)})),i.changes(),n.visit(n.SOURCE,function(e){t.extend(e,r[i.cellkey(e)].tuple)}),n.reflow(a).modifies(this._outputs)},ee.changes=function(){var e,t,n=this._adds,r=this._mods;for(e=0,t=this._alen;e<t;++e)this.celltuple(n[e]),n[e]=null;for(e=0,t=this._mlen;e<t;++e)this.celltuple(r[e]),r[e]=null;this._alen=this._mlen=0},te.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},t.inherits(te,n.Transform).transform=function(e,i){var a=i.fork(i.NO_SOURCE|i.NO_FIELDS);if(!this.value||i.changed()||e.modified()){var o=i.materialize(i.SOURCE).source,u=N(o,e.groupby,e.field),s=(e.groupby||[]).map(t.accessorName),l=e.bandwidth,c=e.cumulative?"cdf":"pdf",f=e.as||["value","density"],d=[],h=e.extent,p=e.steps||e.minsteps||25,v=e.steps||e.maxsteps||200;"pdf"!==c&&"cdf"!==c&&t.error("Invalid density method: "+c),"shared"===e.resolve&&(h||(h=t.extent(o,e.field)),p=v=e.steps||v),u.forEach(function(i){var a=r.randomKDE(i,l)[c],o=e.counts?i.length:1,u=h||t.extent(i);r.sampleCurve(a,u,p,v).forEach(function(e){for(var t={},r=0;r<s.length;++r)t[s[r]]=i.dims[r];t[f[0]]=e[0],t[f[1]]=e[1]*o,d.push(n.ingest(t))})}),this.value&&(a.rem=this.value),this.value=a.add=a.source=d}return a},t.inherits(ne,n.Operator),t.inherits(ie,n.Transform).transform=function(e,n){var r=this,i=n.dataflow;return e.values?ae(this,n,i.parse(e.values,e.format)):i.request(e.url,e.format).then(function(e){return ae(r,n,t.array(e.data))})},oe.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},t.inherits(oe,n.Transform).transform=function(e,n){var r,i,a=n,o=e.as,u=e.fields,s=e.index,l=e.values,c=null==e.default?null:e.default,f=e.modified(),d=f?n.SOURCE:n.ADD,h=u.length;return l?(i=l.length,h>1&&!o&&t.error('Multi-field lookup requires explicit "as" parameter.'),o&&o.length!==h*i&&t.error('The "as" parameter has too few output field names.'),o=o||l.map(t.accessorName),r=function(e){for(var t,n,r=0,a=0;r<h;++r)if(null==(n=s.get(u[r](e))))for(t=0;t<i;++t,++a)e[o[a]]=c;else for(t=0;t<i;++t,++a)e[o[a]]=l[t](n)}):(o||t.error("Missing output field names."),r=function(e){for(var t,n=0;n<h;++n)t=s.get(u[n](e)),e[o[n]]=null==t?c:t}),f?a=n.reflow(!0):d|=u.some(function(e){return n.modified(e.fields)})?n.MOD:0,n.visit(d,r),a.modifies(o)},t.inherits(ue,n.Operator),t.inherits(le,n.Operator),t.inherits(fe,n.Transform),fe.prototype.transform=function(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)},de.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:s,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};var he=t.inherits(de,v);function pe(e,n){var r=e.field,i=e.value,a=("count"===e.op?"__count__":e.op)||"sum",o=t.accessorFields(r).concat(t.accessorFields(i)),u=function(e,t,n){var r={},i=[];return n.visit(n.SOURCE,function(t){var n=e(t);r[n]||(r[n]=1,i.push(n))}),i.sort(function(e,t){return(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0)}),t?i.slice(0,t):i}(r,e.limit||0,n);return n.changed()&&e.set("__pivot__",null,null,!0),{key:e.key,groupby:e.groupby,ops:u.map(function(){return a}),fields:u.map(function(e){return function(e,n,r,i){return t.accessor(function(t){return n(t)===e?r(t):NaN},i,e+"")}(e,r,i,o)}),as:u.map(function(e){return e+""}),modified:e.modified.bind(e)}}function ve(e){U.call(this,e)}function me(e){n.Transform.call(this,null,e)}function ge(e){n.Transform.call(this,null,e)}function ye(e){n.Transform.call(this,null,e)}he._transform=he.transform,he.transform=function(e,t){return this._transform(pe(e,t),t)},t.inherits(ve,U).transform=function(e,r){var i=this,a=e.subflow,o=e.field;return(e.modified("field")||o&&r.modified(t.accessorFields(o)))&&t.error("PreFacet does not support field modification."),this._targets.active=0,r.visit(r.MOD,function(e){var t=i.subflow(n.tupleid(e),a,r,e);o?o(e).forEach(function(e){t.mod(e)}):t.mod(e)}),r.visit(r.ADD,function(e){var t=i.subflow(n.tupleid(e),a,r,e);o?o(e).forEach(function(e){t.add(n.ingest(e))}):t.add(e)}),r.visit(r.REM,function(e){var t=i.subflow(n.tupleid(e),a,r,e);o?o(e).forEach(function(e){t.rem(e)}):t.rem(e)}),r},me.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},t.inherits(me,n.Transform).transform=function(e,t){var r,i,a=e.fields,o=T(e.fields,e.as||[]),u=a?function(e,t){return function(e,t,n,r){for(var i=0,a=n.length;i<a;++i)t[r[i]]=n[i](e);return t}(e,t,a,o)}:n.rederive;return this.value?i=this.value:(t=t.addAll(),i=this.value={}),r=t.fork(t.NO_SOURCE),t.visit(t.REM,function(e){var t=n.tupleid(e);r.rem.push(i[t]),i[t]=null}),t.visit(t.ADD,function(e){var t=u(e,n.ingest({}));i[n.tupleid(e)]=t,r.add.push(t)}),t.visit(t.MOD,function(e){r.mod.push(u(e,i[n.tupleid(e)]))}),r},t.inherits(ge,n.Transform).transform=function(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation},ye.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};var be=t.inherits(ye,n.Transform);function xe(e){n.Transform.call(this,null,e)}function we(e){n.Transform.call(this,[],e),this.count=0}function ke(e){n.Transform.call(this,null,e)}function Ae(e){n.Transform.call(this,null,e),this.modified(!0)}function Ee(e){n.Transform.call(this,t.fastmap(),e)}function De(e){n.Transform.call(this,null,e)}be.transform=function(e,a){var o=a.fork(a.NO_SOURCE|a.NO_FIELDS),u=e.as||["prob","value"];if(this.value&&!e.modified()&&!a.changed())return o.source=this.value,o;var s=N(a.materialize(a.SOURCE).source,e.groupby,e.field),l=(e.groupby||[]).map(t.accessorName),c=[],f=e.step||.01,d=e.probs||i.range(f/2,1-1e-14,f),h=d.length;return s.forEach(function(e){for(var t=r.quantiles(e,d),i=0;i<h;++i){for(var a={},o=0;o<l.length;++o)a[l[o]]=e.dims[o];a[u[0]]=d[i],a[u[1]]=t[i],c.push(n.ingest(a))}}),this.value&&(o.rem=this.value),this.value=o.add=o.source=c,o},t.inherits(xe,n.Transform).transform=function(e,t){var r,i;return this.value?i=this.value:(r=t=t.addAll(),i=this.value={}),e.derive&&(r=t.fork(t.NO_SOURCE),t.visit(t.REM,function(e){var t=n.tupleid(e);r.rem.push(i[t]),i[t]=null}),t.visit(t.ADD,function(e){var t=n.derive(e);i[n.tupleid(e)]=t,r.add.push(t)}),t.visit(t.MOD,function(e){var t,a=i[n.tupleid(e)];for(t in e)a[t]=e[t],r.modifies(t);r.mod.push(a)})),r},we.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},t.inherits(we,n.Transform).transform=function(e,t){var i=t.fork(t.NO_SOURCE),a=e.modified("size"),o=e.size,u=this.value,s=this.count,l=0,c=u.reduce(function(e,t){return e[n.tupleid(t)]=1,e},{});function f(e){var t,a;u.length<o?u.push(e):(a=~~((s+1)*r.random()))<u.length&&a>=l&&(t=u[a],c[n.tupleid(t)]&&i.rem.push(t),u[a]=e),++s}if(t.rem.length&&(t.visit(t.REM,function(e){var t=n.tupleid(e);c[t]&&(c[t]=-1,i.rem.push(e)),--s}),u=u.filter(function(e){return-1!==c[n.tupleid(e)]})),(t.rem.length||a)&&u.length<o&&t.source&&(l=s=u.length,t.visit(t.SOURCE,function(e){c[n.tupleid(e)]||f(e)}),l=-1),a&&u.length>o){for(var d=0,h=u.length-o;d<h;++d)c[n.tupleid(u[d])]=-1,i.rem.push(u[d]);u=u.slice(h)}return t.mod.length&&t.visit(t.MOD,function(e){c[n.tupleid(e)]&&i.mod.push(e)}),t.add.length&&t.visit(t.ADD,f),(t.add.length||l<0)&&(i.add=u.filter(function(e){return!c[n.tupleid(e)]})),this.count=s,this.value=i.source=u,i},ke.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},t.inherits(ke,n.Transform).transform=function(e,t){if(!this.value||e.modified()){var r=t.materialize().fork(t.MOD),a=e.as||"data";return r.rem=this.value?t.rem.concat(this.value):t.rem,this.value=i.range(e.start,e.stop,e.step||1).map(function(e){var t={};return t[a]=e,n.ingest(t)}),r.add=t.add.concat(this.value),r}},t.inherits(Ae,n.Transform).transform=function(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation},t.inherits(Ee,n.Transform).transform=function(e,t){var n=t.dataflow,r=e.field,i=this.value,a=!0;function o(e){i.set(r(e),e)}return e.modified("field")||t.modified(r.fields)?(i.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,function(e){i.delete(r(e))}),t.visit(t.ADD,o)):a=!1,this.modified(a),i.empty>n.cleanThreshold&&n.runAfter(i.clean),t.fork()},t.inherits(De,n.Transform).transform=function(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(n.stableCompare(e.sort)):t.source).map(e.field))};var Ce={row_number:function(){return{next:function(e){return e.index+1}}},rank:function(){var e;return{init:function(){return e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){var e;return{init:function(){return e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){var e=Ce.rank(),t=e.next;return{init:e.init,next:function(e){return(t(e)-1)/(e.data.length-1)}}},cume_dist:function(){var e;return{init:function(){return e=0},next:function(t){var n=t.index,r=t.data,i=t.compare;if(e<n){for(;n+1<r.length&&!i(r[n],r[n+1]);)++n;e=n}return(1+e)/r.length}}},ntile:function(e,n){(n=+n)>0||t.error("ntile num must be greater than zero.");var r=Ce.cume_dist(),i=r.next;return{init:r.init,next:function(e){return Math.ceil(n*i(e))}}},lag:function(e,t){return t=+t||1,{next:function(n){var r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:function(n){var r=n.index+t,i=n.data;return r<i.length?e(i[r]):null}}},first_value:function(e){return{next:function(t){return e(t.data[t.i0])}}},last_value:function(e){return{next:function(t){return e(t.data[t.i1-1])}}},nth_value:function(e,n){return(n=+n)>0||t.error("nth_value nth must be greater than zero."),{next:function(t){var r=t.i0+(n-1);return r<t.i1?e(t.data[r]):null}}},prev_value:function(e){var t=null;return{next:function(n){var r=e(n.data[n.index]);return null!=r?t=r:t}}},next_value:function(e){var t=null,n=-1;return{next:function(r){var i=r.data;return r.index<=n?t:(n=function(e,t,n){for(var r=t.length;n<r;++n)if(null!=e(t[n]))return n;return-1}(e,i,r.index))<0?(n=i.length,t=null):t=e(i[n])}}}},Oe=Object.keys(Ce);function Fe(e){var n=t.array(e.ops),r=t.array(e.fields),i=t.array(e.params),a=t.array(e.as),u=this.outputs=[],s=this.windows=[],c={},f={},p=!0,v=[],m=[];function g(e){t.array(t.accessorFields(e)).forEach(function(e){return c[e]=1})}g(e.sort),n.forEach(function(e,n){var c=r[n],d=t.accessorName(c),h=o(e,d,a[n]);if(g(c),u.push(h),t.hasOwnProperty(Ce,e))s.push(function(e,n,r,i){var a=Ce[e](n,r);return{init:a.init||t.zero,update:function(e,t){t[i]=a.next(e)}}}(e,r[n],i[n],h));else{if(null==c&&"count"!==e&&t.error("Null aggregate field specified."),"count"===e)return void v.push(h);p=!1;var y=f[d];y||((y=f[d]=[]).field=c,m.push(y)),y.push(l(e,h))}}),(v.length||m.length)&&(this.cell=function(e,t,n){e=e.map(function(e){return d(e,e.field)});var r={num:0,agg:null,store:!1,count:t};if(!n)for(var i=e.length,a=r.agg=Array(i),o=0;o<i;++o)a[o]=new e[o](r);if(r.store)var u=r.data=new h;return r.add=function(e){if(r.num+=1,!n){u&&u.add(e);for(var t=0;t<i;++t)a[t].add(a[t].get(e),e)}},r.rem=function(e){if(r.num-=1,!n){u&&u.rem(e);for(var t=0;t<i;++t)a[t].rem(a[t].get(e),e)}},r.set=function(e){var i,o;for(u&&u.values(),i=0,o=t.length;i<o;++i)e[t[i]]=r.num;if(!n)for(i=0,o=a.length;i<o;++i)a[i].set(e)},r.init=function(){r.num=0,u&&u.reset();for(var e=0;e<i;++e)a[e].init()},r}(m,v,p)),this.inputs=Object.keys(c)}var _e=Fe.prototype;function Se(e){n.Transform.call(this,{},e),this._mlen=0,this._mods=[]}_e.init=function(){this.windows.forEach(function(e){return e.init()}),this.cell&&this.cell.init()},_e.update=function(e,t){var n,r=this.cell,i=this.windows,a=e.data,o=i&&i.length;if(r){for(n=e.p0;n<e.i0;++n)r.rem(a[n]);for(n=e.p1;n<e.i1;++n)r.add(a[n]);r.set(t)}for(n=0;n<o;++n)i[n].update(e,t)},Se.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Oe.concat(s)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};var Me=t.inherits(Se,n.Transform);function je(e,n,r,a){var o=a.sort,u=o&&!a.ignorePeers,s=a.frame||[null,0],l=e.data(r),c=l.length,f=0,d=u?i.bisector(o):null,h={i0:0,i1:0,p0:0,p1:0,index:0,data:l,compare:o||t.constant(-1)};for(n.init();f<c;++f)Te(h,s,f,c),u&&Ne(h,d),n.update(h,l[f])}function Te(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:Math.max(0,n-Math.abs(t[0])),e.i1=null==t[1]?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function Ne(e,t){var n=e.i0,r=e.i1-1,i=e.compare,a=e.data,o=a.length-1;n>0&&!i(a[n],a[n-1])&&(e.i0=t.left(a,a[n])),r<o&&!i(a[r],a[r+1])&&(e.i1=t.right(a,a[r]))}Me.transform=function(e,t){var r,i,o=this,u=o.state,s=e.modified(),l=n.stableCompare(e.sort);this.stamp=t.stamp,u&&!s||(u=o.state=new Fe(e));var c=a(e.groupby);function f(e){return o.group(c(e))}for(s||t.modified(u.inputs)?(o.value={},t.visit(t.SOURCE,function(e){f(e).add(e)})):(t.visit(t.REM,function(e){f(e).remove(e)}),t.visit(t.ADD,function(e){f(e).add(e)})),r=0,i=o._mlen;r<i;++r)je(o._mods[r],u,l,e);return o._mlen=0,o._mods=[],t.reflow(s).modifies(u.outputs)},Me.group=function(e){var t=this.value[e];return t||((t=this.value[e]=b(n.tupleid)).stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t},e.aggregate=v,e.bin=g,e.collect=x,e.compare=w,e.countpattern=A,e.cross=D,e.density=S,e.dotbin=B,e.expression=R,e.extent=P,e.facet=U,e.field=W,e.filter=V,e.flatten=G,e.fold=$,e.formula=Y,e.generate=X,e.impute=K,e.joinaggregate=Z,e.kde=te,e.key=ne,e.load=ie,e.lookup=oe,e.multiextent=ue,e.multivalues=le,e.params=fe,e.pivot=de,e.prefacet=ve,e.project=me,e.proxy=ge,e.quantile=ye,e.relay=xe,e.sample=we,e.sequence=ke,e.sieve=Ae,e.subflow=L,e.tupleindex=Ee,e.values=De,e.window=Se,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1469),n(1476),n(1623),n(1508))},2878:function(e,t,n){var r=n(311);!function(e,t,n,i){"use strict";var a="top",o="left",u="right",s="bottom",l="top-left",c="top-right",f="bottom-left",d="bottom-right",h="start",p="middle",v="end",m="x",g="y",y="group",b="axis",x="title",w="frame",k="scope",A="legend",E="row-header",D="row-footer",C="row-title",O="column-header",F="column-footer",_="column-title",S="padding",M="symbol",j="fit",T="fit-x",N="fit-y",B="pad",R="none",z="all",P="each",L="flush",I="column",U="row";function q(e){t.Transform.call(this,null,e)}function W(e,t,n){return t(e.bounds.clear(),e,n)}i.inherits(q,t.Transform).transform=function(e,t){var r,i=t.dataflow,a=e.mark,o=a.marktype,u=n.Marks[o],s=u.bound,l=a.bounds;if(u.nested)a.items.length&&i.dirty(a.items[0]),l=W(a,s),a.items.forEach(function(e){e.bounds.clear().union(l)});else if(o===y||e.modified())switch(t.visit(t.MOD,function(e){i.dirty(e)}),l.clear(),a.items.forEach(function(e){l.union(W(e,s))}),a.role){case b:case A:case x:t.reflow()}else r=t.changed(t.REM),t.visit(t.ADD,function(e){l.union(W(e,s))}),t.visit(t.MOD,function(e){r=r||l.alignsWith(e.bounds),i.dirty(e),l.union(W(e,s))}),r&&(l.clear(),a.items.forEach(function(e){l.union(e.bounds)}));return n.boundClip(a),t.modifies("bounds")};var H=":vega_identifier:";function V(e){t.Transform.call(this,0,e)}function G(e){t.Transform.call(this,null,e)}function $(e){t.Transform.call(this,null,e)}V.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},i.inherits(V,t.Transform).transform=function(e,t){var n=function(e){var t=e._signals[H];return t||(e._signals[H]=t=e.add(0)),t}(t.dataflow),r=n.value,i=e.as;return t.visit(t.ADD,function(e){e[i]||(e[i]=++r)}),n.set(this.value=r),t},i.inherits(G,t.Transform).transform=function(e,t){var r=this.value;r||((r=t.dataflow.scenegraph().mark(e.markdef,function(e){var t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}(e),e.index)).group.context=e.context,e.context.group||(e.context.group=r.group),r.source=this.source,r.clip=e.clip,r.interactive=e.interactive,this.value=r);var i=r.marktype===y?n.GroupItem:n.Item;return t.visit(t.ADD,function(e){i.call(e,r)}),(e.modified("clip")||e.modified("interactive"))&&(r.clip=e.clip,r.interactive=!!e.interactive,r.zdirty=!0,t.reflow()),r.items=t.source,t};var Y=i.inherits($,t.Transform),X={parity:function(e){return e.filter(function(e,t){return t%2?e.opacity=0:1})},greedy:function(e,t){var n;return e.filter(function(e,r){return r&&J(n.bounds,e.bounds,t)?e.opacity=0:(n=e,1)})}};function J(e,t,n){return n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2)}function Q(e,t){for(var n,r=1,i=e.length,a=e[0].bounds;r<i;a=n,++r)if(J(a,n=e[r].bounds,t))return!0}function K(e){var t=e.bounds;return t.width()>1&&t.height()>1}function Z(e){return e.forEach(function(e){return e.opacity=1}),e}function ee(e,t){return e.reflow(t.modified()).modifies("opacity")}function te(e){t.Transform.call(this,null,e)}Y.transform=function(e,t){var r,o,u,l=X[e.method]||X.parity,c=t.materialize(t.SOURCE).source,f=e.separation||0;if(c&&c.length){if(!e.method)return e.modified("method")&&(Z(c),t=ee(t,e)),t;if(e.sort&&(c=c.slice().sort(e.sort)),r=Z(c=c.filter(K)),t=ee(t,e),r.length>=3&&Q(r,f)){do{r=l(r,f)}while(r.length>=3&&Q(r,f));r.length<3&&!i.peek(c).opacity&&(r.length>1&&(i.peek(r).opacity=0),i.peek(c).opacity=1)}return e.boundScale&&e.boundTolerance>=0&&(o=function(e,t,r){var i=e.range(),o=new n.Bounds;return t===a||t===s?o.set(i[0],-1/0,i[1],1/0):o.set(-1/0,i[0],1/0,i[1]),o.expand(r||1),function(e){return o.encloses(e.bounds)}}(e.boundScale,e.boundOrient,+e.boundTolerance),c.forEach(function(e){o(e)||(e.opacity=0)})),u=r[0].mark.bounds.clear(),c.forEach(function(e){e.opacity&&u.union(e.bounds)}),t}},i.inherits(te,t.Transform).transform=function(e,t){var n=t.dataflow;if(t.visit(t.ALL,function(e){n.dirty(e)}),t.fields&&t.fields.zindex){var r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}};var ne=new n.Bounds;function re(e,t,n){return e[t]===n?0:(e[t]=n,1)}var ie=.5;function ae(e){var t=e.items[0].datum.orient;return t===o||t===u}function oe(e,t,r,i){var l,c,f=t.items[0],d=f.datum,h=d.orient,p=function(e){var t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}(d),v=f.range,m=f.offset,g=f.position,y=f.minExtent,b=f.maxExtent,x=d.title&&f.items[p[2]].items[0],w=f.titlePadding,k=f.bounds,A=x&&n.multiLineOffset(x),E=0,D=0;switch(ne.clear().union(k),k.clear(),(l=p[0])>-1&&k.union(f.items[l].bounds),(l=p[1])>-1&&k.union(f.items[l].bounds),h){case a:E=g||0,D=-m,c=Math.max(y,Math.min(b,-k.y1)),x&&(c=ue(e,x,c,w,A,0,-1,k)),k.add(0,-c).add(v,0);break;case o:E=-m,D=g||0,c=Math.max(y,Math.min(b,-k.x1)),x&&(c=ue(e,x,c,w,A,1,-1,k)),k.add(-c,0).add(0,v);break;case u:E=r+m,D=g||0,c=Math.max(y,Math.min(b,k.x2)),x&&(c=ue(e,x,c,w,A,1,1,k)),k.add(0,0).add(c,v);break;case s:E=g||0,D=i+m,c=Math.max(y,Math.min(b,k.y2)),x&&(c=ue(e,x,c,w,0,0,1,k)),k.add(0,0).add(v,c);break;default:E=f.x,D=f.y}return n.boundStroke(k.translate(E,D),f),re(f,"x",E+ie)|re(f,"y",D+ie)&&(f.bounds=ne,e.dirty(f),f.bounds=k,e.dirty(f)),f.mark.bounds.clear().union(k)}function ue(e,t,n,r,i,a,o,u){var s=t.bounds,l=0,c=0;return t.auto?(e.dirty(t),n+=r,a?l=(t.x||0)-(t.x=o*(n+i)):c=(t.y||0)-(t.y=o*(n+i)),t.mark.bounds.clear().union(s.translate(-l,-c)),e.dirty(t),a?(u.add(0,s.y1).add(0,s.y2),n+=s.width()):(u.add(s.x1,0).add(s.x2,0),n+=s.height())):u.union(s),n}function se(e){return(new n.Bounds).set(0,0,e.width||0,e.height||0)}function le(e){var t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function ce(e,t,n){var r=i.isObject(e)?e[t]:e;return null!=r?r:void 0!==n?n:0}function fe(e){return e<0?Math.ceil(-e):0}function de(e,t,n){var r,i,a,o,u,s,l,c,f,d,h,y=!n.nodirty,b=n.bounds===L?se:le,x=ne.set(0,0,0,0),w=ce(n.align,I),k=ce(n.align,U),A=ce(n.padding,I),E=ce(n.padding,U),D=n.columns||t.length,C=D<0?1:Math.ceil(t.length/D),O=t.length,F=Array(O),_=Array(D),S=0,M=Array(O),j=Array(C),T=0,N=Array(O),B=Array(O),R=Array(O);for(i=0;i<D;++i)_[i]=0;for(i=0;i<C;++i)j[i]=0;for(i=0;i<O;++i)s=t[i],u=R[i]=b(s),s.x=s.x||0,N[i]=0,s.y=s.y||0,B[i]=0,a=i%D,o=~~(i/D),S=Math.max(S,l=Math.ceil(u.x2)),T=Math.max(T,c=Math.ceil(u.y2)),_[a]=Math.max(_[a],l),j[o]=Math.max(j[o],c),F[i]=A+fe(u.x1),M[i]=E+fe(u.y1),y&&e.dirty(t[i]);for(i=0;i<O;++i)i%D===0&&(F[i]=0),i<D&&(M[i]=0);if(w===P)for(a=1;a<D;++a){for(h=0,i=a;i<O;i+=D)h<F[i]&&(h=F[i]);for(i=a;i<O;i+=D)F[i]=h+_[a-1]}else if(w===z){for(h=0,i=0;i<O;++i)i%D&&h<F[i]&&(h=F[i]);for(i=0;i<O;++i)i%D&&(F[i]=h+S)}else for(w=!1,a=1;a<D;++a)for(i=a;i<O;i+=D)F[i]+=_[a-1];if(k===P)for(o=1;o<C;++o){for(h=0,r=(i=o*D)+D;i<r;++i)h<M[i]&&(h=M[i]);for(i=o*D;i<r;++i)M[i]=h+j[o-1]}else if(k===z){for(h=0,i=D;i<O;++i)h<M[i]&&(h=M[i]);for(i=D;i<O;++i)M[i]=h+T}else for(k=!1,o=1;o<C;++o)for(r=(i=o*D)+D;i<r;++i)M[i]+=j[o-1];for(f=0,i=0;i<O;++i)f=F[i]+(i%D?f:0),N[i]+=f-t[i].x;for(a=0;a<D;++a)for(d=0,i=a;i<O;i+=D)d+=M[i],B[i]+=d-t[i].y;if(w&&ce(n.center,I)&&C>1)for(i=0;i<O;++i)(f=(u=w===z?S:_[i%D])-R[i].x2-t[i].x-N[i])>0&&(N[i]+=f/2);if(k&&ce(n.center,U)&&1!==D)for(i=0;i<O;++i)(d=(u=k===z?T:j[~~(i/D)])-R[i].y2-t[i].y-B[i])>0&&(B[i]+=d/2);for(i=0;i<O;++i)x.union(R[i].translate(N[i],B[i]));switch(f=ce(n.anchor,m),d=ce(n.anchor,g),ce(n.anchor,I)){case v:f-=x.width();break;case p:f-=x.width()/2}switch(ce(n.anchor,U)){case v:d-=x.height();break;case p:d-=x.height()/2}for(f=Math.round(f),d=Math.round(d),x.clear(),i=0;i<O;++i)t[i].mark.bounds.clear();for(i=0;i<O;++i)(s=t[i]).x+=N[i]+=f,s.y+=B[i]+=d,x.union(s.mark.bounds.union(s.bounds.translate(N[i],B[i]))),y&&e.dirty(s);return x}function he(e,t,n){var i,a,o,u,s,l,c,f=function(e){for(var t,n,i,a,o,u,s,l=e.items,c=l.length,f=0,d={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};f<c;++f)if(s=(u=l[f]).items,u.marktype===y)switch(u.role){case b:case A:case x:break;case E:(t=d.rowheaders).push.apply(t,r(s));break;case D:(n=d.rowfooters).push.apply(n,r(s));break;case O:(i=d.colheaders).push.apply(i,r(s));break;case F:(a=d.colfooters).push.apply(a,r(s));break;case C:d.rowtitle=s[0];break;case _:d.coltitle=s[0];break;default:(o=d.marks).push.apply(o,r(s))}return d}(t),d=f.marks,h=n.bounds===L?pe:ve,p=n.offset,m=n.columns||d.length,g=m<0?1:Math.ceil(d.length/m),w=g*m,k=de(e,d,n);f.rowheaders&&(l=ce(n.headerBand,U,null),i=ye(e,f.rowheaders,d,0,g,-ce(p,"rowHeader"),me,0,h,"x1",0,m,1,l)),f.colheaders&&(l=ce(n.headerBand,I,null),a=ye(e,f.colheaders,d,0,m,-ce(p,"columnHeader"),me,1,h,"y1",0,1,m,l)),f.rowfooters&&(l=ce(n.footerBand,U,null),o=ye(e,f.rowfooters,d,0,g,ce(p,"rowFooter"),ge,0,h,"x2",m-1,m,1,l)),f.colfooters&&(l=ce(n.footerBand,I,null),u=ye(e,f.colfooters,d,0,m,ce(p,"columnFooter"),ge,1,h,"y2",w-m,1,m,l)),f.rowtitle&&(s=ce(n.titleAnchor,U),c=ce(p,"rowTitle"),c=s===v?o+c:i-c,l=ce(n.titleBand,U,.5),be(e,f.rowtitle,c,0,k,l)),f.coltitle&&(s=ce(n.titleAnchor,I),c=ce(p,"columnTitle"),c=s===v?u+c:a-c,l=ce(n.titleBand,I,.5),be(e,f.coltitle,c,1,k,l))}function pe(e,t){return"x1"===t?e.x||0:"y1"===t?e.y||0:"x2"===t?(e.x||0)+(e.width||0):"y2"===t?(e.y||0)+(e.height||0):void 0}function ve(e,t){return e.bounds[t]}function me(e,t){return Math.floor(Math.min(e,t))}function ge(e,t){return Math.ceil(Math.max(e,t))}function ye(e,t,n,r,i,a,o,u,s,l,c,f,d,h){var p,v,m,g,y,b,x,w,k,A=n.length,E=0,D=0;if(!A)return E;for(p=c;p<A;p+=f)n[p]&&(E=o(E,s(n[p],l)));if(!t.length)return E;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),E+=a,v=0,g=t.length;v<g;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(p=c,v=0,g=t.length;v<g;++v,p+=f){for(y=(b=t[v]).mark.bounds,m=p;m>=0&&null==(x=n[m]);m-=d);u?(w=null==h?x.x:Math.round(x.bounds.x1+h*x.bounds.width()),k=E):(w=E,k=null==h?x.y:Math.round(x.bounds.y1+h*x.bounds.height())),y.union(b.bounds.translate(w-(b.x||0),k-(b.y||0))),b.x=w,b.y=k,e.dirty(b),D=o(D,y[l])}return D}function be(e,t,n,r,i,a){if(t){e.dirty(t);var o=n,u=n;r?o=Math.round(i.x1+a*i.width()):u=Math.round(i.y1+a*i.height()),t.bounds.translate(o-(t.x||0),u-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=u,e.dirty(t)}}function xe(e,t,n,r,i,m,g){var y=function(e,t){var n=e[t]||{};return function(t,r){return null!=n[t]?n[t]:null!=e[t]?e[t]:r}}(n,t),b=function(e,t){var n=-1/0;return e.forEach(function(e){null!=e.offset&&(n=Math.max(n,e.offset))}),n>-1/0?n:t}(e,y("offset",0)),x=y("anchor",h),w=x===v?1:x===p?.5:0,k={align:P,bounds:y("bounds",L),columns:"vertical"===y("direction")?1:e.length,padding:y("margin",8),center:y("center"),nodirty:!0};switch(t){case o:k.anchor={x:Math.floor(r.x1)-b,column:v,y:w*(g||r.height()+2*r.y1),row:x};break;case u:k.anchor={x:Math.ceil(r.x2)+b,y:w*(g||r.height()+2*r.y1),row:x};break;case a:k.anchor={y:Math.floor(i.y1)-b,row:v,x:w*(m||i.width()+2*i.x1),column:x};break;case s:k.anchor={y:Math.ceil(i.y2)+b,x:w*(m||i.width()+2*i.x1),column:x};break;case l:k.anchor={x:b,y:b};break;case c:k.anchor={x:m-b,y:b,column:v};break;case f:k.anchor={x:b,y:g-b,row:v};break;case d:k.anchor={x:m-b,y:g-b,column:v,row:v}}return k}function we(e,t){var r,i,a=t.items[0],l=a.datum,c=a.orient,f=a.bounds,d=a.x,h=a.y;return a._bounds?a._bounds.clear().union(f):a._bounds=f.clone(),f.clear(),function(e,t,n){var r=t.padding,i=r-n.x,a=r-n.y;if(t.datum.title){var l=t.items[1].items[0],c=l.anchor,f=t.titlePadding||0,d=r-l.x,h=r-l.y;switch(l.orient){case o:i+=Math.ceil(l.bounds.width())+f;break;case u:case s:break;default:a+=l.bounds.height()+f}switch((i||a)&&Ae(e,n,i,a),l.orient){case o:h+=ke(t,n,l,c,1,1);break;case u:d+=ke(t,n,l,v,0,0)+f,h+=ke(t,n,l,c,1,1);break;case s:d+=ke(t,n,l,c,0,0),h+=ke(t,n,l,v,-1,0,1)+f;break;default:d+=ke(t,n,l,c,0,0)}(d||h)&&Ae(e,l,d,h),(d=Math.round(l.bounds.x1-r))<0&&(Ae(e,n,-d,0),Ae(e,l,-d,0))}else(i||a)&&Ae(e,n,i,a)}(e,a,a.items[0].items[0]),f=function(e,t){return e.items.forEach(function(e){return t.union(e.bounds)}),t.x1=e.padding,t.y1=e.padding,t}(a,f),r=2*a.padding,i=2*a.padding,f.empty()||(r=Math.ceil(f.width()+r),i=Math.ceil(f.height()+i)),l.type===M&&function(e){var t=e.reduce(function(e,t){return e[t.column]=Math.max(t.bounds.x2-t.x,e[t.column]||0),e},{});e.forEach(function(e){e.width=t[e.column],e.height=e.bounds.y2-e.y})}(a.items[0].items[0].items[0].items),c!==R&&(a.x=d=0,a.y=h=0),a.width=r,a.height=i,n.boundStroke(f.set(d,h,d+r,h+i),a),a.mark.bounds.clear().union(f),a}function ke(e,t,r,i,a,o,u){var s="symbol"!==e.datum.type,l=r.datum.vgrad,c=(!s||!o&&l||u?t:t.items[0]).bounds[a?"y2":"x2"]-e.padding,f=l&&o?c:0,d=l&&o?0:c,p=a<=0?0:n.multiLineOffset(r);return Math.round(i===h?f:i===v?d-p:.5*(c-p))}function Ae(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function Ee(e){t.Transform.call(this,null,e)}function De(e,t,r){var i,l,c,f,d,p=t.items,m=Math.max(0,t.width||0),g=Math.max(0,t.height||0),M=(new n.Bounds).set(0,0,m,g),z=M.clone(),P=M.clone(),L=[];for(f=0,d=p.length;f<d;++f)switch((l=p[f]).role){case b:(ae(l)?z:P).union(oe(e,l,m,g));break;case x:i=l;break;case A:L.push(we(e,l));break;case w:case k:case E:case D:case C:case O:case F:case _:z.union(l.bounds),P.union(l.bounds);break;default:M.union(l.bounds)}if(L.length){var I={};for(var U in L.forEach(function(e){(c=e.orient||u)!==R&&(I[c]||(I[c]=[])).push(e)}),I){var q=I[U];de(e,q,xe(q,U,r.legends,z,P,m,g))}L.forEach(function(t){var n=t.bounds;if(n.equals(t._bounds)||(t.bounds=t._bounds,e.dirty(t),t.bounds=n,e.dirty(t)),r.autosize&&r.autosize.type===j)switch(t.orient){case o:case u:M.add(n.x1,0).add(n.x2,0);break;case a:case s:M.add(0,n.y1).add(0,n.y2)}else M.union(n)})}M.union(z).union(P),i&&M.union(function(e,t,n,r,i){var l,c=t.items[0],f=c.frame,d=c.orient,p=c.anchor,m=c.offset,g=c.padding,b=c.items[0].items[0],x=c.items[1]&&c.items[1].items[0],w=d===o||d===u?r:n,k=0,A=0,E=0,D=0,C=0;if(f!==y?d===o?(k=i.y2,w=i.y1):d===u?(k=i.y1,w=i.y2):(k=i.x1,w=i.x2):d===o&&(k=r,w=0),l=p===h?k:p===v?w:(k+w)/2,x&&x.text){switch(d){case a:case s:C=b.bounds.height()+g;break;case o:D=b.bounds.width()+g;break;case u:D=-b.bounds.width()-g}ne.clear().union(x.bounds),ne.translate(D-(x.x||0),C-(x.y||0)),re(x,"x",D)|re(x,"y",C)&&(e.dirty(x),x.bounds.clear().union(ne),x.mark.bounds.clear().union(ne),e.dirty(x)),ne.clear().union(x.bounds)}else ne.clear();switch(ne.union(b.bounds),d){case a:A=l,E=i.y1-ne.height()-m;break;case o:A=i.x1-ne.width()-m,E=l;break;case u:A=i.x2+ne.width()+m,E=l;break;case s:A=l,E=i.y2+m;break;default:A=c.x,E=c.y}return re(c,"x",A)|re(c,"y",E)&&(ne.translate(A,E),e.dirty(c),c.bounds.clear().union(ne),t.bounds.clear().union(ne),e.dirty(c)),c.bounds}(e,i,m,g,M)),t.clip&&M.set(0,0,t.width||0,t.height||0),function(e,t,n,r){var i=r.autosize||{},a=i.type,o=e._width,u=e._height,s=e.padding();if(!(e._autosize<1)&&a){var l=Math.max(0,t.width||0),c=Math.max(0,Math.ceil(-n.x1)),f=Math.max(0,Math.ceil(n.x2-l)),d=Math.max(0,t.height||0),h=Math.max(0,Math.ceil(-n.y1)),p=Math.max(0,Math.ceil(n.y2-d));i.contains===S&&(o-=s.left+s.right,u-=s.top+s.bottom),a===R?(c=0,h=0,l=o,d=u):a===j?(l=Math.max(0,o-c-f),d=Math.max(0,u-h-p)):a===T?(l=Math.max(0,o-c-f),u=d+h+p):a===N?(o=l+c+f,d=Math.max(0,u-h-p)):a===B&&(o=l+c+f,u=d+h+p),e._resizeView(o,u,l,d,[c,h],i.resize)}}(e,t,M,r)}i.inherits(Ee,t.Transform).transform=function(e,t){var n=t.dataflow;return e.mark.items.forEach(function(t){e.layout&&he(n,t,e.layout),De(n,t,e)}),e.modified()&&t.reflow(),t},e.bound=q,e.identifier=V,e.mark=G,e.overlap=$,e.render=te,e.viewlayout=Ee,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1476),n(1693),n(1469))},2879:function(e,t,n){var r=n(135);!function(e,t,n,i,a,o,u,s){"use strict";var l,c;function f(e,r,i){var a;return n.isNumber(r)&&(e.bins&&(r=Math.max(r,e.bins.length)),null!=i&&(r=Math.min(r,~~(n.span(e.domain())/i)||1))),n.isObject(r)&&(a=r.step,r=r.interval),n.isString(r)&&(r=t.timeInterval(r,e.type)||n.error("Only time and utc scales accept interval strings."),a&&(r=r.every(a))),r}function d(e,t,r){var i=e.range(),a=Math.floor(i[0]),o=Math.ceil(n.peek(i));if(a>o&&(i=o,o=a,a=i),t=t.filter(function(t){return t=e(t),a<=t&&t<=o}),r>0&&t.length>1){for(var u=[t[0],n.peek(t)];t.length>r&&t.length>=3;)t=t.filter(function(e,t){return!(t%2)});t.length<3&&(t=u)}return t}function h(e,t){return e.bins?d(e,e.bins):e.ticks?e.ticks(t):e.domain()}function p(e,n,r,o){var u,s,l=e.tickFormat?e.tickFormat(n,r):r&&o===t.Time?i.timeFormat(r):r?a.format(r):String;if(t.isLogarithmic(e.type)){var c=function(e){var t,n,r=a.formatSpecifier(e||",");if(null==r.precision){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1}return t=a.format(r),n=a.format(".1f")(1)[1],function(e){var r,i,a=t(e),o=a.indexOf(n);if(o<0)return a;for(i=(r=function(e,t){var n,r=e.lastIndexOf("e");if(r>0)return r;for(r=e.length;--r>t;)if((n=e.charCodeAt(r))>=48&&n<=57)return r+1}(a,o))<a.length?a.slice(r):"";--r>o;)if("0"!==a[r]){++r;break}return a.slice(0,r)+i}}return a.format(r)}(r);l=e.bins?c:(u=l,s=c,function(e){return u(e)?s(e):""})}return l}function v(e){o.Transform.call(this,null,e)}function m(e){o.Transform.call(this,null,e)}function g(){return o.ingest({})}function y(e){return e.exit}function b(e){o.Transform.call(this,null,e)}n.inherits(v,o.Transform).transform=function(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=this.value,i=e.scale,a=f(i,null==e.count?e.values?e.values.length:10:e.count,e.minstep),u=e.format||p(i,a,e.formatSpecifier,e.formatType),s=e.values?d(i,e.values,a):h(i,a);return r&&(n.rem=r),r=s.map(function(e,t){return o.ingest({index:t/(s.length-1||1),value:e,label:u(e)})}),e.extra&&r.length&&r.push(o.ingest({index:-1,extra:{value:r[0].value},label:""})),n.source=r,n.add=r,this.value=r,n},n.inherits(m,o.Transform).transform=function(e,t){var r=t.dataflow,i=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=e.item||g,u=e.key||o.tupleid,s=this.value;return n.isArray(i.encode)&&(i.encode=null),s&&(e.modified("key")||t.modified(u))&&n.error("DataJoin does not support modified key function or fields."),s||(t=t.addAll(),this.value=s=n.fastmap().test(y),s.lookup=function(e){return s.get(u(e))}),t.visit(t.ADD,function(e){var t=u(e),n=s.get(t);n?n.exit?(s.empty--,i.add.push(n)):i.mod.push(n):(s.set(t,n=a(e)),i.add.push(n)),n.datum=e,n.exit=!1}),t.visit(t.MOD,function(e){var t=u(e),n=s.get(t);n&&(n.datum=e,i.mod.push(n))}),t.visit(t.REM,function(e){var t=u(e),n=s.get(t);e!==n.datum||n.exit||(i.rem.push(n),n.exit=!0,++s.empty)}),t.changed(t.ADD_MOD)&&i.modifies("datum"),e.clean&&s.empty>r.cleanThreshold&&r.runAfter(s.clean),i},n.inherits(b,o.Transform).transform=function(e,t){var r=t.fork(t.ADD_REM),i=e.mod||!1,a=e.encoders,o=t.encode;if(n.isArray(o)){if(!r.changed()&&!o.every(function(e){return a[e]}))return t.StopPropagation;o=o[0],r.encode=null}var u="enter"===o,s=a.update||n.falsy,l=a.enter||n.falsy,c=a.exit||n.falsy,f=(o&&!u?a[o]:s)||n.falsy;if(t.changed(t.ADD)&&(t.visit(t.ADD,function(t){l(t,e),s(t,e)}),r.modifies(l.output),r.modifies(s.output),f!==n.falsy&&f!==s&&(t.visit(t.ADD,function(t){f(t,e)}),r.modifies(f.output))),t.changed(t.REM)&&c!==n.falsy&&(t.visit(t.REM,function(t){c(t,e)}),r.modifies(c.output)),u||f!==n.falsy){var d=t.MOD|(e.modified()?t.REFLOW:0);u?(t.visit(d,function(t){var n=l(t,e)||i;(f(t,e)||n)&&r.mod.push(t)}),r.mod.length&&r.modifies(l.output)):t.visit(d,function(t){(f(t,e)||i)&&r.mod.push(t)}),r.mod.length&&r.modifies(f.output)}return r.changed()?r:t.StopPropagation};var x="symbol",w="discrete",k=(r(l={},t.Quantile,"quantiles"),r(l,t.Quantize,"thresholds"),r(l,t.Threshold,"domain"),l),A=(r(c={},t.Quantile,"quantiles"),r(c,t.Quantize,"domain"),c);function E(e,t){return e.bins?function(e){var t=e.slice(0,-1);return t.max=n.peek(e),t}(e.bins):k[e.type]?function(e){var t=[-1/0].concat(e);return t.max=1/0,t}(e[k[e.type]]()):h(e,t)}function D(e,n,r,i,a){var o=A[e.type]&&a!==t.Time?function(e,n){var r,i=e[A[e.type]](),a=i.length,o=a>1?i[1]-i[0]:i[0];for(r=1;r<a;++r)o=Math.min(o,i[r]-i[r-1]);return t.tickFormat(0,o,30,n)}(e,i):p(e,n,i,a);return r===x&&function(e){return k[e.type]||e.bins}(e)?function(e){return function(t,n,r){var i=r[n+1]||r.max||1/0,a=C(t,e),o=C(i,e);return a&&o?a+"\u2013"+o:o?"< "+o:"\u2265 "+a}}(o):r===w?function(e){return function(t,n){return n?e(t):null}}(o):function(e){return function(t){return e(t)}}(o)}function C(e,t){return Number.isFinite(e)?t(e):null}function O(e){o.Transform.call(this,[],e)}n.inherits(O,o.Transform).transform=function(e,r){if(null!=this.value&&!e.modified())return r.StopPropagation;var i,a,u,s,l,c=r.fork(r.NO_SOURCE|r.NO_FIELDS),d=this.value,h=e.type||x,p=e.scale,v=+e.limit,m=f(p,null==e.count?5:e.count,e.minstep),g=e.format||D(p,m,h,e.formatSpecifier,e.formatType),y=e.values||E(p,m);return d&&(c.rem=d),h===x?(v&&y.length>v?(r.dataflow.warn("Symbol legend count exceeds limit, filtering items."),d=y.slice(0,v-1),l=!0):d=y,n.isFunction(u=e.size)?(e.values||0!==p(d[0])||(d=d.slice(1)),s=d.reduce(function(t,n){return Math.max(t,u(n,e))},0)):u=n.constant(s=u||8),d=d.map(function(t,n){return o.ingest({index:n,label:g(t,n,y),value:t,offset:s,size:u(t,e)})}),l&&(l=y[d.length],d.push(o.ingest({index:d.length,label:"\u2026".concat(y.length-d.length," entries"),value:l,offset:s,size:u(l,e)})))):"gradient"===h?(i=p.domain(),a=t.scaleFraction(p,i[0],n.peek(i)),y.length<3&&!e.values&&i[0]!==n.peek(i)&&(y=[i[0],n.peek(i)]),d=y.map(function(e,t){return o.ingest({index:t,label:g(e,t,y),value:e,perc:a(e)})})):(u=y.length-1,a=function(e){var r=e.domain(),i=r.length-1,a=+r[0],o=+n.peek(r),u=o-a;if(e.type===t.Threshold){var s=i?u/i:.1;u=(o+=s)-(a-=s)}return function(e){return(e-a)/u}}(p),d=y.map(function(e,t){return o.ingest({index:t,label:g(e,t,y),value:e,perc:t?a(e):0,perc2:t===u?1:a(y[t+1])})})),c.source=d,c.add=d,this.value=d,c};var F=n.fastmap({line:N,"line-radial":function(e,t,n,r){return N(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))},arc:B,"arc-radial":function(e,t,n,r){return B(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))},curve:R,"curve-radial":function(e,t,n,r){return R(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))},"orthogonal-horizontal":function(e,t,n,r){return"M"+e+","+t+"V"+r+"H"+n},"orthogonal-vertical":function(e,t,n,r){return"M"+e+","+t+"H"+n+"V"+r},"orthogonal-radial":function(e,t,n,r){var i=Math.cos(e),a=Math.sin(e),o=Math.cos(n),u=Math.sin(n),s=Math.abs(n-e)>Math.PI?n<=e:n>e;return"M"+t*i+","+t*a+"A"+t+","+t+" 0 0,"+(s?1:0)+" "+t*o+","+t*u+"L"+r*o+","+r*u},"diagonal-horizontal":function(e,t,n,r){var i=(e+n)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+r+" "+n+","+r},"diagonal-vertical":function(e,t,n,r){var i=(t+r)/2;return"M"+e+","+t+"C"+e+","+i+" "+n+","+i+" "+n+","+r},"diagonal-radial":function(e,t,n,r){var i=Math.cos(e),a=Math.sin(e),o=Math.cos(n),u=Math.sin(n),s=(t+r)/2;return"M"+t*i+","+t*a+"C"+s*i+","+s*a+" "+s*o+","+s*u+" "+r*o+","+r*u}});function _(e){return e.source.x}function S(e){return e.source.y}function M(e){return e.target.x}function j(e){return e.target.y}function T(e){o.Transform.call(this,{},e)}function N(e,t,n,r){return"M"+e+","+t+"L"+n+","+r}function B(e,t,n,r){var i=n-e,a=r-t,o=Math.sqrt(i*i+a*a)/2;return"M"+e+","+t+"A"+o+","+o+" "+180*Math.atan2(a,i)/Math.PI+" 0 1 "+n+","+r}function R(e,t,n,r){var i=n-e,a=r-t,o=.2*(i+a),u=.2*(a-i);return"M"+e+","+t+"C"+(e+o)+","+(t+u)+" "+(n+u)+","+(r-o)+" "+n+","+r}function z(e){o.Transform.call(this,null,e)}T.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},n.inherits(T,o.Transform).transform=function(e,t){var r=e.sourceX||_,i=e.sourceY||S,a=e.targetX||M,o=e.targetY||j,u=e.as||"path",s=e.orient||"vertical",l=e.shape||"line",c=F.get(l+"-"+s)||F.get(l);return c||n.error("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,function(e){e[u]=c(r(e),i(e),a(e),o(e))}),t.reflow(e.modified()).modifies(u)},z.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},n.inherits(z,o.Transform).transform=function(e,t){var r,i,a,o=e.as||["startAngle","endAngle"],s=o[0],l=o[1],c=e.field||n.one,f=e.startAngle||0,d=null!=e.endAngle?e.endAngle:2*Math.PI,h=t.source,p=h.map(c),v=p.length,m=f,g=(d-f)/u.sum(p),y=u.range(v);for(e.sort&&y.sort(function(e,t){return p[e]-p[t]}),r=0;r<v;++r)a=p[y[r]],(i=h[y[r]])[s]=m,i[l]=m+=a*g;return this.value=p,t.reflow(e.modified()).modifies(o)};var P=5;function L(e){return t.isContinuous(e)&&e!==t.Sequential}var I=n.toSet(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function U(e){o.Transform.call(this,null,e),this.modified(!0)}function q(e){var r,i=e.type,a="";return i===t.Sequential?t.Sequential+"-"+t.Linear:(function(e){var r=e.type;return t.isContinuous(r)&&r!==t.Time&&r!==t.UTC&&(e.scheme||e.range&&e.range.length&&e.range.every(n.isString))}(e)&&(a=2===(r=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0)?t.Sequential+"-":3===r?t.Diverging+"-":""),(a+i||t.Linear).toLowerCase())}function W(e,r,i){var a=function(e,t,n){return t?(e.domain(H(e.type,t,n)),t.length):-1}(e,r.domainRaw,i);if(a>-1)return a;var o,u,s=r.domain,l=e.type,c=r.zero||void 0===r.zero&&function(e){var n=e.type;return!e.bins&&(n===t.Linear||n===t.Pow||n===t.Sqrt)}(e);return s?(L(l)&&r.padding&&s[0]!==n.peek(s)&&(s=function(e,r,i,a,o,u){var s=Math.abs(n.peek(i)-i[0]),l=s/(s-2*a),c=e===t.Log?n.zoomLog(r,null,l):e===t.Sqrt?n.zoomPow(r,null,l,.5):e===t.Pow?n.zoomPow(r,null,l,o||1):e===t.Symlog?n.zoomSymlog(r,null,l,u||1):n.zoomLinear(r,null,l);return(r=r.slice())[0]=c[0],r[r.length-1]=c[1],r}(l,s,r.range,r.padding,r.exponent,r.constant)),(c||null!=r.domainMin||null!=r.domainMax||null!=r.domainMid)&&(o=(s=s.slice()).length-1||1,c&&(s[0]>0&&(s[0]=0),s[o]<0&&(s[o]=0)),null!=r.domainMin&&(s[0]=r.domainMin),null!=r.domainMax&&(s[o]=r.domainMax),null!=r.domainMid&&(((u=r.domainMid)<s[0]||u>s[o])&&i.warn("Scale domainMid exceeds domain min or max.",u),s.splice(o,0,u))),e.domain(H(l,s,i)),l===t.Ordinal&&e.unknown(r.domainImplicit?t.scaleImplicit:void 0),r.nice&&e.nice&&e.nice(!0!==r.nice&&f(e,r.nice)||null),s.length):0}function H(e,r,i){return t.isLogarithmic(e)&&Math.abs(r.reduce(function(e,t){return e+(t<0?-1:t>0?1:0)},0))!==r.length&&i.warn("Log scale domain includes zero: "+n.stringValue(r)),r}function V(e,r,i){var a=e.type,o=r.round||!1,u=r.range;if(null!=r.rangeStep)u=function(e,r,i){e!==t.Band&&e!==t.Point&&n.error("Only band and point scales support rangeStep.");var a=(null!=r.paddingOuter?r.paddingOuter:r.padding)||0,o=e===t.Point?1:(null!=r.paddingInner?r.paddingInner:r.padding)||0;return[0,r.rangeStep*t.bandSpace(i,o,a)]}(a,r,i);else if(r.scheme&&(u=function(e,r,i){var a,o,u=r.schemeExtent;return n.isArray(r.scheme)?o=t.interpolateColors(r.scheme,r.interpolate,r.interpolateGamma):(a=r.scheme.toLowerCase(),(o=t.scheme(a))||n.error("Unrecognized scheme name: ".concat(r.scheme))),i=e===t.Threshold?i+1:e===t.BinOrdinal?i-1:e===t.Quantile||e===t.Quantize?+r.schemeCount||P:i,t.isInterpolating(e)?G(o,u,r.reverse):n.isFunction(o)?t.quantizeInterpolator(G(o,u),i):e===t.Ordinal?o:o.slice(0,i)}(a,r,i),n.isFunction(u))){if(e.interpolator)return e.interpolator(u);n.error("Scale type ".concat(a," does not support interpolating color schemes."))}if(u&&t.isInterpolating(a))return e.interpolator(t.interpolateColors($(u,r.reverse),r.interpolate,r.interpolateGamma));u&&r.interpolate&&e.interpolate?e.interpolate(t.interpolate(r.interpolate,r.interpolateGamma)):n.isFunction(e.round)?e.round(o):n.isFunction(e.rangeRound)&&e.interpolate(o?s.interpolateRound:s.interpolate),u&&e.range($(u,r.reverse))}function G(e,r,i){return n.isFunction(e)&&(r||i)?t.interpolateRange(e,$(r||[0,1],i)):e}function $(e,t){return t?e.slice().reverse():e}function Y(e){o.Transform.call(this,null,e)}n.inherits(U,o.Transform).transform=function(e,r){var i=r.dataflow,a=this.value,o=q(e);for(o in a&&o===a.type||(this.value=a=t.scale(o)()),e)if(!I[o]){if("padding"===o&&L(a.type))continue;n.isFunction(a[o])?a[o](e[o]):i.warn("Unsupported scale property: "+o)}return V(a,e,function(e,r,i){var a=r.bins;if(a&&!n.isArray(a)){var o=e.domain(),s=o[0],l=n.peek(o),c=null==a.start?s:a.start,f=null==a.stop?l:a.stop,d=a.step;d||n.error("Scale bins parameter missing step property."),c<s&&(c=d*Math.ceil(s/d)),f>l&&(f=d*Math.floor(l/d)),a=u.range(c,f+d/2,d)}return a?e.bins=a:e.bins&&delete e.bins,e.type===t.BinOrdinal&&(a?r.domain||r.domainRaw||(e.domain(a),i=a.length):e.bins=e.domain()),i}(a,e,W(a,e,i))),r.fork(r.NO_SOURCE|r.NO_FIELDS)},n.inherits(Y,o.Transform).transform=function(e,t){var n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(o.stableCompare(e.sort)),this.modified(n),t};var X=["y0","y1"];function J(e){o.Transform.call(this,null,e)}function Q(e,t,n,r,i){for(var a,o=(t-e.sum)/2,u=e.length,s=0;s<u;++s)(a=e[s])[r]=o,a[i]=o+=Math.abs(n(a))}function K(e,t,n,r,i){for(var a,o=1/e.sum,u=0,s=e.length,l=0,c=0;l<s;++l)(a=e[l])[r]=u,a[i]=u=o*(c+=Math.abs(n(a)))}function Z(e,t,n,r,i){for(var a,o,u=0,s=0,l=e.length,c=0;c<l;++c)(a=+n(o=e[c]))<0?(o[r]=s,o[i]=s+=a):(o[r]=u,o[i]=u+=a)}J.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:"zero",values:["zero","center","normalize"]},{name:"as",type:"string",array:!0,length:2,default:X}]},n.inherits(J,o.Transform).transform=function(e,t){var r,i,a,u,s=e.as||X,l=s[0],c=s[1],f=o.stableCompare(e.sort),d=e.field||n.one,h="center"===e.offset?Q:"normalize"===e.offset?K:Z;for(r=function(e,t,n,r){var i,a,o,u,s,l,c,f,d,h=[],p=function(e){return e(s)};if(null==t)h.push(e.slice());else for(i={},a=0,o=e.length;a<o;++a)s=e[a],(c=i[l=t.map(p)])||(i[l]=c=[],h.push(c)),c.push(s);for(l=0,d=0,u=h.length;l<u;++l){for(a=0,f=0,o=(c=h[l]).length;a<o;++a)f+=Math.abs(r(c[a]));c.sum=f,f>d&&(d=f),n&&c.sort(n)}return h.max=d,h}(t.source,e.groupby,f,d),i=0,a=r.length,u=r.max;i<a;++i)h(r[i],u,d,l,c);return t.reflow(e.modified()).modifies(s)},e.axisticks=v,e.datajoin=m,e.encode=b,e.legendentries=O,e.linkpath=T,e.pie=z,e.scale=U,e.sortitems=Y,e.stack=J,e.validTicks=d,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1624),n(1469),n(588),n(587),n(1476),n(1508),n(585))},2880:function(e,t,n){!function(e){"use strict";var t=new Date,n=new Date;function r(e,i,a,o){function u(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return u.floor=function(t){return e(t=new Date(+t)),t},u.ceil=function(t){return e(t=new Date(t-1)),i(t,1),e(t),t},u.round=function(e){var t=u(e),n=u.ceil(e);return e-t<n-e?t:n},u.offset=function(e,t){return i(e=new Date(+e),null==t?1:Math.floor(t)),e},u.range=function(t,n,r){var a,o=[];if(t=u.ceil(t),r=null==r?1:Math.floor(r),!(t<n)||!(r>0))return o;do{o.push(a=new Date(+t)),i(t,r),e(t)}while(a<t&&t<n);return o},u.filter=function(t){return r(function(n){if(n>=n)for(;e(n),!t(n);)n.setTime(n-1)},function(e,n){if(e>=e)if(n<0)for(;++n<=0;)for(;i(e,-1),!t(e););else for(;--n>=0;)for(;i(e,1),!t(e););})},a&&(u.count=function(r,i){return t.setTime(+r),n.setTime(+i),e(t),e(n),Math.floor(a(t,n))},u.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?u.filter(o?function(t){return o(t)%e===0}:function(t){return u.count(0,t)%e===0}):u:null}),u}var i=r(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?r(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):i:null};var a=i.range,o=6e4,u=6048e5,s=r(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+1e3*t)},function(e,t){return(t-e)/1e3},function(e){return e.getUTCSeconds()}),l=s.range,c=r(function(e){e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds())},function(e,t){e.setTime(+e+t*o)},function(e,t){return(t-e)/o},function(e){return e.getMinutes()}),f=c.range,d=r(function(e){e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds()-e.getMinutes()*o)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getHours()}),h=d.range,p=r(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*o)/864e5},function(e){return e.getDate()-1}),v=p.range;function m(e){return r(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*o)/u})}var g=m(0),y=m(1),b=m(2),x=m(3),w=m(4),k=m(5),A=m(6),E=g.range,D=y.range,C=b.range,O=x.range,F=w.range,_=k.range,S=A.range,M=r(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}),j=M.range,T=r(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});T.every=function(e){return isFinite(e=Math.floor(e))&&e>0?r(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)}):null};var N=T.range,B=r(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*o)},function(e,t){return(t-e)/o},function(e){return e.getUTCMinutes()}),R=B.range,z=r(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getUTCHours()}),P=z.range,L=r(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/864e5},function(e){return e.getUTCDate()-1}),I=L.range;function U(e){return r(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/u})}var q=U(0),W=U(1),H=U(2),V=U(3),G=U(4),$=U(5),Y=U(6),X=q.range,J=W.range,Q=H.range,K=V.range,Z=G.range,ee=$.range,te=Y.range,ne=r(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),re=ne.range,ie=r(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});ie.every=function(e){return isFinite(e=Math.floor(e))&&e>0?r(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};var ae=ie.range;e.timeDay=p,e.timeDays=v,e.timeFriday=k,e.timeFridays=_,e.timeHour=d,e.timeHours=h,e.timeInterval=r,e.timeMillisecond=i,e.timeMilliseconds=a,e.timeMinute=c,e.timeMinutes=f,e.timeMonday=y,e.timeMondays=D,e.timeMonth=M,e.timeMonths=j,e.timeSaturday=A,e.timeSaturdays=S,e.timeSecond=s,e.timeSeconds=l,e.timeSunday=g,e.timeSundays=E,e.timeThursday=w,e.timeThursdays=F,e.timeTuesday=b,e.timeTuesdays=C,e.timeWednesday=x,e.timeWednesdays=O,e.timeWeek=g,e.timeWeeks=E,e.timeYear=T,e.timeYears=N,e.utcDay=L,e.utcDays=I,e.utcFriday=$,e.utcFridays=ee,e.utcHour=z,e.utcHours=P,e.utcMillisecond=i,e.utcMilliseconds=a,e.utcMinute=B,e.utcMinutes=R,e.utcMonday=W,e.utcMondays=J,e.utcMonth=ne,e.utcMonths=re,e.utcSaturday=Y,e.utcSaturdays=te,e.utcSecond=s,e.utcSeconds=l,e.utcSunday=q,e.utcSundays=X,e.utcThursday=G,e.utcThursdays=Z,e.utcTuesday=H,e.utcTuesdays=Q,e.utcWednesday=V,e.utcWednesdays=K,e.utcWeek=q,e.utcWeeks=X,e.utcYear=ie,e.utcYears=ae,Object.defineProperty(e,"__esModule",{value:!0})}(t)},2881:function(e,t,n){var r=n(309);!function(e,t,n,i,a,o){"use strict";function u(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function s(e,t){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(t).domain(e)}return this}var l=Symbol("implicit");function c(){var e=new Map,t=[],n=[],r=l;function i(i){var a=i+"",o=e.get(a);if(!o){if(r!==l)return r;e.set(a,o=t.push(i))}return n[(o-1)%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Map;var r=!0,a=!1,o=void 0;try{for(var u,s=n[Symbol.iterator]();!(r=(u=s.next()).done);r=!0){var l=u.value,c=l+"";e.has(c)||e.set(c,t.push(l))}}catch(f){a=!0,o=f}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return c(t,n).unknown(r)},u.apply(i,arguments),i}function f(){var e,n,i=c().unknown(void 0),a=i.domain,o=i.range,s=0,l=1,d=!1,h=0,p=0,v=.5;function m(){var r=a().length,i=l<s,u=i?l:s,c=i?s:l;e=(c-u)/Math.max(1,r-h+2*p),d&&(e=Math.floor(e)),u+=(c-u-e*(r-h))*v,n=e*(1-h),d&&(u=Math.round(u),n=Math.round(n));var f=t.range(r).map(function(t){return u+e*t});return o(i?f.reverse():f)}return delete i.unknown,i.domain=function(e){return arguments.length?(a(e),m()):a()},i.range=function(e){var t;return arguments.length?(t=r(e,2),s=t[0],l=t[1],s=+s,l=+l,m()):[s,l]},i.rangeRound=function(e){var t;return t=r(e,2),s=t[0],l=t[1],s=+s,l=+l,d=!0,m()},i.bandwidth=function(){return n},i.step=function(){return e},i.round=function(e){return arguments.length?(d=!!e,m()):d},i.padding=function(e){return arguments.length?(h=Math.min(1,p=+e),m()):h},i.paddingInner=function(e){return arguments.length?(h=Math.min(1,e),m()):h},i.paddingOuter=function(e){return arguments.length?(p=+e,m()):p},i.align=function(e){return arguments.length?(v=Math.max(0,Math.min(1,e)),m()):v},i.copy=function(){return f(a(),[s,l]).round(d).paddingInner(h).paddingOuter(p).align(v)},u.apply(m(),arguments)}function d(e){return+e}var h=[0,1];function p(e){return e}function v(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function m(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];return i<r?(r=v(i,r),a=n(o,a)):(r=v(r,i),a=n(a,o)),function(e){return a(r(e))}}function g(e,n,r){var i=Math.min(e.length,n.length)-1,a=new Array(i),o=new Array(i),u=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),n=n.slice().reverse());++u<i;)a[u]=v(e[u],e[u+1]),o[u]=r(n[u],n[u+1]);return function(n){var r=t.bisect(e,n,1,i)-1;return o[r](a[r](n))}}function y(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function b(){var e,t,r,i,a,o,u=h,s=h,l=n.interpolate,c=p;function f(){var e=Math.min(u.length,s.length);return c!==p&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(u[0],u[e-1])),i=e>2?g:m,a=o=null,v}function v(t){return isNaN(t=+t)?r:(a||(a=i(u.map(e),s,l)))(e(c(t)))}return v.invert=function(r){return c(t((o||(o=i(s,u.map(e),n.interpolateNumber)))(r)))},v.domain=function(e){return arguments.length?(u=Array.from(e,d),f()):u.slice()},v.range=function(e){return arguments.length?(s=Array.from(e),f()):s.slice()},v.rangeRound=function(e){return s=Array.from(e),l=n.interpolateRound,f()},v.clamp=function(e){return arguments.length?(c=!!e||p,f()):c!==p},v.interpolate=function(e){return arguments.length?(l=e,f()):l},v.unknown=function(e){return arguments.length?(r=e,v):r},function(n,r){return e=n,t=r,f()}}function x(){return b()(p,p)}function w(e,n,r,a){var o,u=t.tickStep(e,n,r);switch((a=i.formatSpecifier(null==a?",f":a)).type){case"s":var s=Math.max(Math.abs(e),Math.abs(n));return null!=a.precision||isNaN(o=i.precisionPrefix(u,s))||(a.precision=o),i.formatPrefix(a,s);case"":case"e":case"g":case"p":case"r":null!=a.precision||isNaN(o=i.precisionRound(u,Math.max(Math.abs(e),Math.abs(n))))||(a.precision=o-("e"===a.type));break;case"f":case"%":null!=a.precision||isNaN(o=i.precisionFixed(u))||(a.precision=o-2*("%"===a.type))}return i.format(a)}function k(e){var n=e.domain;return e.ticks=function(e){var r=n();return t.ticks(r[0],r[r.length-1],null==e?10:e)},e.tickFormat=function(e,t){var r=n();return w(r[0],r[r.length-1],null==e?10:e,t)},e.nice=function(r){null==r&&(r=10);var i,a=n(),o=0,u=a.length-1,s=a[o],l=a[u];return l<s&&(i=s,s=l,l=i,i=o,o=u,u=i),(i=t.tickIncrement(s,l,r))>0?(s=Math.floor(s/i)*i,l=Math.ceil(l/i)*i,i=t.tickIncrement(s,l,r)):i<0&&(s=Math.ceil(s*i)/i,l=Math.floor(l*i)/i,i=t.tickIncrement(s,l,r)),i>0?(a[o]=Math.floor(s/i)*i,a[u]=Math.ceil(l/i)*i,n(a)):i<0&&(a[o]=Math.ceil(s*i)/i,a[u]=Math.floor(l*i)/i,n(a)),e},e}function A(e,t){var n,r=0,i=(e=e.slice()).length-1,a=e[r],o=e[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),e[r]=t.floor(a),e[i]=t.ceil(o),e}function E(e){return Math.log(e)}function D(e){return Math.exp(e)}function C(e){return-Math.log(-e)}function O(e){return-Math.exp(-e)}function F(e){return isFinite(e)?+("1e"+e):e<0?0:e}function _(e){return function(t){return-e(-t)}}function S(e){var n,r,a=e(E,D),o=a.domain,u=10;function s(){return n=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(u),r=function(e){return 10===e?F:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(u),o()[0]<0?(n=_(n),r=_(r),e(C,O)):e(E,D),a}return a.base=function(e){return arguments.length?(u=+e,s()):u},a.domain=function(e){return arguments.length?(o(e),s()):o()},a.ticks=function(e){var i,a=o(),s=a[0],l=a[a.length-1];(i=l<s)&&(h=s,s=l,l=h);var c,f,d,h=n(s),p=n(l),v=null==e?10:+e,m=[];if(!(u%1)&&p-h<v){if(h=Math.floor(h),p=Math.ceil(p),s>0){for(;h<=p;++h)for(f=1,c=r(h);f<u;++f)if(!((d=c*f)<s)){if(d>l)break;m.push(d)}}else for(;h<=p;++h)for(f=u-1,c=r(h);f>=1;--f)if(!((d=c*f)<s)){if(d>l)break;m.push(d)}m.length||(m=t.ticks(s,l,v))}else m=t.ticks(h,p,Math.min(p-h,v)).map(r);return i?m.reverse():m},a.tickFormat=function(e,t){if(null==t&&(t=10===u?".0e":","),"function"!==typeof t&&(t=i.format(t)),e===1/0)return t;null==e&&(e=10);var o=Math.max(1,u*e/a.ticks().length);return function(e){var i=e/r(Math.round(n(e)));return i*u<u-.5&&(i*=u),i<=o?t(e):""}},a.nice=function(){return o(A(o(),{floor:function(e){return r(Math.floor(n(e)))},ceil:function(e){return r(Math.ceil(n(e)))}}))},a}function M(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function j(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function T(e){var t=1,n=e(M(t),j(t));return n.constant=function(n){return arguments.length?e(M(t=+n),j(t)):t},k(n)}function N(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function B(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function R(e){return e<0?-e*e:e*e}function z(e){var t=e(p,p),n=1;function r(){return 1===n?e(p,p):.5===n?e(B,R):e(N(n),N(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,r()):n},k(t)}function P(){var e=z(b());return e.copy=function(){return y(e,P()).exponent(e.exponent())},u.apply(e,arguments),e}function L(e){return Math.sign(e)*e*e}var I=1e3,U=60*I,q=60*U,W=24*q,H=7*W,V=30*W,G=365*W;function $(e){return new Date(e)}function Y(e){return e instanceof Date?+e:+new Date(+e)}function X(e,n,r,i,a,o,u,s,l){var c=x(),f=c.invert,d=c.domain,h=l(".%L"),p=l(":%S"),v=l("%I:%M"),m=l("%I %p"),g=l("%a %d"),b=l("%b %d"),w=l("%B"),k=l("%Y"),E=[[u,1,I],[u,5,5*I],[u,15,15*I],[u,30,30*I],[o,1,U],[o,5,5*U],[o,15,15*U],[o,30,30*U],[a,1,q],[a,3,3*q],[a,6,6*q],[a,12,12*q],[i,1,W],[i,2,2*W],[r,1,H],[n,1,V],[n,3,3*V],[e,1,G]];function D(t){return(u(t)<t?h:o(t)<t?p:a(t)<t?v:i(t)<t?m:n(t)<t?r(t)<t?g:b:e(t)<t?w:k)(t)}function C(n,r,i){if(null==n&&(n=10),"number"===typeof n){var a,o=Math.abs(i-r)/n,u=t.bisector(function(e){return e[2]}).right(E,o);return u===E.length?(a=t.tickStep(r/G,i/G,n),n=e):u?(a=(u=E[o/E[u-1][2]<E[u][2]/o?u-1:u])[1],n=u[0]):(a=Math.max(t.tickStep(r,i,n),1),n=s),n.every(a)}return n}return c.invert=function(e){return new Date(f(e))},c.domain=function(e){return arguments.length?d(Array.from(e,Y)):d().map($)},c.ticks=function(e){var t,n=d(),r=n[0],i=n[n.length-1],a=i<r;return a&&(t=r,r=i,i=t),t=(t=C(e,r,i))?t.range(r,i+1):[],a?t.reverse():t},c.tickFormat=function(e,t){return null==t?D:l(t)},c.nice=function(e){var t=d();return(e=C(e,t[0],t[t.length-1]))?d(A(t,e)):c},c.copy=function(){return y(c,X(e,n,r,i,a,o,u,s,l))},c}function J(){var e,t,n,i,a,o=0,u=1,s=p,l=!1;function c(t){return isNaN(t=+t)?a:s(0===n?.5:(t=(i(t)-e)*n,l?Math.max(0,Math.min(1,t)):t))}return c.domain=function(a){var s;return arguments.length?(s=r(a,2),o=s[0],u=s[1],e=i(o=+o),t=i(u=+u),n=e===t?0:1/(t-e),c):[o,u]},c.clamp=function(e){return arguments.length?(l=!!e,c):l},c.interpolator=function(e){return arguments.length?(s=e,c):s},c.range=function(){return[s(0),s(1)]},c.unknown=function(e){return arguments.length?(a=e,c):a},function(r){return i=r,e=r(o),t=r(u),n=e===t?0:1/(t-e),c}}function Q(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function K(){var e=z(J());return e.copy=function(){return Q(e,K()).exponent(e.exponent())},s.apply(e,arguments)}function Z(){var e,t,n,i,a,o,u,s=0,l=.5,c=1,f=1,d=p,h=!1;function v(e){return isNaN(e=+e)?u:(e=.5+((e=+o(e))-t)*(f*e<f*t?i:a),d(h?Math.max(0,Math.min(1,e)):e))}return v.domain=function(u){var d;return arguments.length?(d=r(u,3),s=d[0],l=d[1],c=d[2],e=o(s=+s),t=o(l=+l),n=o(c=+c),i=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),f=t<e?-1:1,v):[s,l,c]},v.clamp=function(e){return arguments.length?(h=!!e,v):h},v.interpolator=function(e){return arguments.length?(d=e,v):d},v.range=function(){return[d(0),d(.5),d(1)]},v.unknown=function(e){return arguments.length?(u=e,v):u},function(r){return o=r,e=r(s),t=r(l),n=r(c),i=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),f=t<e?-1:1,v}}function ee(){var e=z(Z());return e.copy=function(){return Q(e,ee()).exponent(e.exponent())},s.apply(e,arguments)}e.scaleBand=f,e.scaleDiverging=function e(){var t=k(Z()(p));return t.copy=function(){return Q(t,e())},s.apply(t,arguments)},e.scaleDivergingLog=function e(){var t=S(Z()).domain([.1,1,10]);return t.copy=function(){return Q(t,e()).base(t.base())},s.apply(t,arguments)},e.scaleDivergingPow=ee,e.scaleDivergingSqrt=function(){return ee.apply(null,arguments).exponent(.5)},e.scaleDivergingSymlog=function e(){var t=T(Z());return t.copy=function(){return Q(t,e()).constant(t.constant())},s.apply(t,arguments)},e.scaleIdentity=function e(t){var n;function r(e){return isNaN(e=+e)?n:e}return r.invert=r,r.domain=r.range=function(e){return arguments.length?(t=Array.from(e,d),r):t.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,d):[0,1],k(r)},e.scaleImplicit=l,e.scaleLinear=function e(){var t=x();return t.copy=function(){return y(t,e())},u.apply(t,arguments),k(t)},e.scaleLog=function e(){var t=S(b()).domain([1,10]);return t.copy=function(){return y(t,e()).base(t.base())},u.apply(t,arguments),t},e.scaleOrdinal=c,e.scalePoint=function(){return function e(t){var n=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return e(n())},t}(f.apply(null,arguments).paddingInner(1))},e.scalePow=P,e.scaleQuantile=function e(){var n,r=[],i=[],a=[];function o(){var e=0,n=Math.max(1,i.length);for(a=new Array(n-1);++e<n;)a[e-1]=t.quantile(r,e/n);return s}function s(e){return isNaN(e=+e)?n:i[t.bisect(a,e)]}return s.invertExtent=function(e){var t=i.indexOf(e);return t<0?[NaN,NaN]:[t>0?a[t-1]:r[0],t<a.length?a[t]:r[r.length-1]]},s.domain=function(e){if(!arguments.length)return r.slice();r=[];var n=!0,i=!1,a=void 0;try{for(var u,s=e[Symbol.iterator]();!(n=(u=s.next()).done);n=!0){var l=u.value;null==l||isNaN(l=+l)||r.push(l)}}catch(c){i=!0,a=c}finally{try{n||null==s.return||s.return()}finally{if(i)throw a}}return r.sort(t.ascending),o()},s.range=function(e){return arguments.length?(i=Array.from(e),o()):i.slice()},s.unknown=function(e){return arguments.length?(n=e,s):n},s.quantiles=function(){return a.slice()},s.copy=function(){return e().domain(r).range(i).unknown(n)},u.apply(s,arguments)},e.scaleQuantize=function e(){var n,i=0,a=1,o=1,s=[.5],l=[0,1];function c(e){return e<=e?l[t.bisect(s,e,0,o)]:n}function f(){var e=-1;for(s=new Array(o);++e<o;)s[e]=((e+1)*a-(e-o)*i)/(o+1);return c}return c.domain=function(e){var t;return arguments.length?(t=r(e,2),i=t[0],a=t[1],i=+i,a=+a,f()):[i,a]},c.range=function(e){return arguments.length?(o=(l=Array.from(e)).length-1,f()):l.slice()},c.invertExtent=function(e){var t=l.indexOf(e);return t<0?[NaN,NaN]:t<1?[i,s[0]]:t>=o?[s[o-1],a]:[s[t-1],s[t]]},c.unknown=function(e){return arguments.length?(n=e,c):c},c.thresholds=function(){return s.slice()},c.copy=function(){return e().domain([i,a]).range(l).unknown(n)},u.apply(k(c),arguments)},e.scaleRadial=function e(){var t,n=x(),r=[0,1],i=!1;function a(e){var r=function(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}(n(e));return isNaN(r)?t:i?Math.round(r):r}return a.invert=function(e){return n.invert(L(e))},a.domain=function(e){return arguments.length?(n.domain(e),a):n.domain()},a.range=function(e){return arguments.length?(n.range((r=Array.from(e,d)).map(L)),a):r.slice()},a.rangeRound=function(e){return a.range(e).round(!0)},a.round=function(e){return arguments.length?(i=!!e,a):i},a.clamp=function(e){return arguments.length?(n.clamp(e),a):n.clamp()},a.unknown=function(e){return arguments.length?(t=e,a):t},a.copy=function(){return e(n.domain(),r).round(i).clamp(n.clamp()).unknown(t)},u.apply(a,arguments),k(a)},e.scaleSequential=function e(){var t=k(J()(p));return t.copy=function(){return Q(t,e())},s.apply(t,arguments)},e.scaleSequentialLog=function e(){var t=S(J()).domain([1,10]);return t.copy=function(){return Q(t,e()).base(t.base())},s.apply(t,arguments)},e.scaleSequentialPow=K,e.scaleSequentialQuantile=function e(){var n=[],r=p;function i(e){if(!isNaN(e=+e))return r((t.bisect(n,e,1)-1)/(n.length-1))}return i.domain=function(e){if(!arguments.length)return n.slice();n=[];var r=!0,a=!1,o=void 0;try{for(var u,s=e[Symbol.iterator]();!(r=(u=s.next()).done);r=!0){var l=u.value;null==l||isNaN(l=+l)||n.push(l)}}catch(c){a=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n.sort(t.ascending),i},i.interpolator=function(e){return arguments.length?(r=e,i):r},i.range=function(){return n.map(function(e,t){return r(t/(n.length-1))})},i.copy=function(){return e(r).domain(n)},s.apply(i,arguments)},e.scaleSequentialSqrt=function(){return K.apply(null,arguments).exponent(.5)},e.scaleSequentialSymlog=function e(){var t=T(J());return t.copy=function(){return Q(t,e()).constant(t.constant())},s.apply(t,arguments)},e.scaleSqrt=function(){return P.apply(null,arguments).exponent(.5)},e.scaleSymlog=function e(){var t=T(b());return t.copy=function(){return y(t,e()).constant(t.constant())},u.apply(t,arguments)},e.scaleThreshold=function e(){var n,r=[.5],i=[0,1],a=1;function o(e){return e<=e?i[t.bisect(r,e,0,a)]:n}return o.domain=function(e){return arguments.length?(r=Array.from(e),a=Math.min(r.length,i.length-1),o):r.slice()},o.range=function(e){return arguments.length?(i=Array.from(e),a=Math.min(r.length,i.length-1),o):i.slice()},o.invertExtent=function(e){var t=i.indexOf(e);return[r[t-1],r[t]]},o.unknown=function(e){return arguments.length?(n=e,o):n},o.copy=function(){return e().domain(r).range(i).unknown(n)},u.apply(o,arguments)},e.scaleTime=function(){return u.apply(X(a.timeYear,a.timeMonth,a.timeWeek,a.timeDay,a.timeHour,a.timeMinute,a.timeSecond,a.timeMillisecond,o.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},e.scaleUtc=function(){return u.apply(X(a.utcYear,a.utcMonth,a.utcWeek,a.utcDay,a.utcHour,a.utcMinute,a.utcSecond,a.utcMillisecond,o.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},e.tickFormat=w,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1508),n(585),n(587),n(2882),n(588))},2882:function(e,t,n){!function(e){"use strict";var t=new Date,n=new Date;function r(e,i,a,o){function u(t){return e(t=new Date(+t)),t}return u.floor=u,u.ceil=function(t){return e(t=new Date(t-1)),i(t,1),e(t),t},u.round=function(e){var t=u(e),n=u.ceil(e);return e-t<n-e?t:n},u.offset=function(e,t){return i(e=new Date(+e),null==t?1:Math.floor(t)),e},u.range=function(t,n,r){var a,o=[];if(t=u.ceil(t),r=null==r?1:Math.floor(r),!(t<n)||!(r>0))return o;do{o.push(a=new Date(+t)),i(t,r),e(t)}while(a<t&&t<n);return o},u.filter=function(t){return r(function(n){if(n>=n)for(;e(n),!t(n);)n.setTime(n-1)},function(e,n){if(e>=e)if(n<0)for(;++n<=0;)for(;i(e,-1),!t(e););else for(;--n>=0;)for(;i(e,1),!t(e););})},a&&(u.count=function(r,i){return t.setTime(+r),n.setTime(+i),e(t),e(n),Math.floor(a(t,n))},u.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?u.filter(o?function(t){return o(t)%e===0}:function(t){return u.count(0,t)%e===0}):u:null}),u}var i=r(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?r(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):i:null};var a=i.range,o=6e4,u=6048e5,s=r(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+1e3*t)},function(e,t){return(t-e)/1e3},function(e){return e.getUTCSeconds()}),l=s.range,c=r(function(e){e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds())},function(e,t){e.setTime(+e+t*o)},function(e,t){return(t-e)/o},function(e){return e.getMinutes()}),f=c.range,d=r(function(e){e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds()-e.getMinutes()*o)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getHours()}),h=d.range,p=r(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*o)/864e5},function(e){return e.getDate()-1}),v=p.range;function m(e){return r(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*o)/u})}var g=m(0),y=m(1),b=m(2),x=m(3),w=m(4),k=m(5),A=m(6),E=g.range,D=y.range,C=b.range,O=x.range,F=w.range,_=k.range,S=A.range,M=r(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}),j=M.range,T=r(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});T.every=function(e){return isFinite(e=Math.floor(e))&&e>0?r(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)}):null};var N=T.range,B=r(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*o)},function(e,t){return(t-e)/o},function(e){return e.getUTCMinutes()}),R=B.range,z=r(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getUTCHours()}),P=z.range,L=r(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/864e5},function(e){return e.getUTCDate()-1}),I=L.range;function U(e){return r(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/u})}var q=U(0),W=U(1),H=U(2),V=U(3),G=U(4),$=U(5),Y=U(6),X=q.range,J=W.range,Q=H.range,K=V.range,Z=G.range,ee=$.range,te=Y.range,ne=r(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),re=ne.range,ie=r(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});ie.every=function(e){return isFinite(e=Math.floor(e))&&e>0?r(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};var ae=ie.range;e.timeInterval=r,e.timeMillisecond=i,e.timeMilliseconds=a,e.utcMillisecond=i,e.utcMilliseconds=a,e.timeSecond=s,e.timeSeconds=l,e.utcSecond=s,e.utcSeconds=l,e.timeMinute=c,e.timeMinutes=f,e.timeHour=d,e.timeHours=h,e.timeDay=p,e.timeDays=v,e.timeWeek=g,e.timeWeeks=E,e.timeSunday=g,e.timeSundays=E,e.timeMonday=y,e.timeMondays=D,e.timeTuesday=b,e.timeTuesdays=C,e.timeWednesday=x,e.timeWednesdays=O,e.timeThursday=w,e.timeThursdays=F,e.timeFriday=k,e.timeFridays=_,e.timeSaturday=A,e.timeSaturdays=S,e.timeMonth=M,e.timeMonths=j,e.timeYear=T,e.timeYears=N,e.utcMinute=B,e.utcMinutes=R,e.utcHour=z,e.utcHours=P,e.utcDay=L,e.utcDays=I,e.utcWeek=q,e.utcWeeks=X,e.utcSunday=q,e.utcSundays=X,e.utcMonday=W,e.utcMondays=J,e.utcTuesday=H,e.utcTuesdays=Q,e.utcWednesday=V,e.utcWednesdays=K,e.utcThursday=G,e.utcThursdays=Z,e.utcFriday=$,e.utcFridays=ee,e.utcSaturday=Y,e.utcSaturdays=te,e.utcMonth=ne,e.utcMonths=re,e.utcYear=ie,e.utcYears=ae,Object.defineProperty(e,"__esModule",{value:!0})}(t)},2883:function(e,t,n){!function(e,t,n,r,i,a,o){"use strict";var u=["size","smooth"],s=["x","y","weight","size","cellSize","bandwidth"];function l(e){t.Transform.call(this,null,e)}l.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"smooth",type:"boolean"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0}]},n.inherits(l,t.Transform).transform=function(e,n){if(this.value&&!n.changed()&&!e.modified())return n.StopPropagation;var a,o,l,c,f=n.fork(n.NO_SOURCE|n.NO_FIELDS),d=e.count||10;return e.values?(a=i.contours(),o=u,l=e.values):(a=i.contourDensity(),o=s,l=n.materialize(n.SOURCE).source),a.thresholds(e.thresholds||(e.nice?d:(c=d,function(e){for(var t=r.extent(e),n=t[0],i=t[1]-n,a=[],o=1;o<=c;++o)a.push(n+i*o/(c+1));return a}))),o.forEach(function(t){null!=e[t]&&a[t](e[t])}),this.value&&(f.rem=this.value),l=l&&l.length?a(l).map(t.ingest):[],this.value=f.source=f.add=l,f};var c="Feature",f="FeatureCollection";function d(e){t.Transform.call(this,null,e)}function h(e){t.Transform.call(this,null,e)}function p(e){t.Transform.call(this,null,e)}function v(e){t.Transform.call(this,null,e)}function m(e){t.Transform.call(this,[],e),this.generator=o.geoGraticule()}function g(e){t.Transform.call(this,null,e),this.modified(!0)}function y(e,t){var r=function(e){return 1===(e=n.array(e)).length?e[0]:{type:f,features:e.reduce(function(e,t){return e.concat(function(e){return e.type===f?e.features:n.array(e).filter(function(e){return null!=e}).map(function(e){return e.type===c?e:{type:c,geometry:e}})}(t))},[])}}(t.fit);t.extent?e.fitExtent(t.extent,r):t.size&&e.fitSize(t.size,r)}function b(e,t,r){n.isFunction(e[t])&&e[t](r)}d.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},n.inherits(d,t.Transform).transform=function(e,t){var r,i=this._features,a=this._points,o=e.fields,u=o&&o[0],s=o&&o[1],l=e.geojson||!o&&n.identity,d=t.ADD;r=e.modified()||t.changed(t.REM)||t.modified(n.accessorFields(l))||u&&t.modified(n.accessorFields(u))||s&&t.modified(n.accessorFields(s)),this.value&&!r||(d=t.SOURCE,this._features=i=[],this._points=a=[]),l&&t.visit(d,function(e){i.push(l(e))}),u&&s&&(t.visit(d,function(e){var t=u(e),n=s(e);null!=t&&null!=n&&(t=+t)===t&&(n=+n)===n&&a.push([t,n])}),i=i.concat({type:c,geometry:{type:"MultiPoint",coordinates:a}})),this.value={type:f,features:i}},h.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},n.inherits(h,t.Transform).transform=function(e,t){var r=t.fork(t.ALL),i=this.value,o=e.field||n.identity,u=e.as||"path",s=r.SOURCE;!i||e.modified()?(this.value=i=a.getProjectionPath(e.projection),r.materialize().reflow()):s=o===n.identity||t.modified(o.fields)?r.ADD_MOD:r.ADD;var l=function(e,t){var n=e.pointRadius();return e.context(null),null!=t&&e.pointRadius(t),n}(i,e.pointRadius);return r.visit(s,function(e){e[u]=i(o(e))}),i.pointRadius(l),r.modifies(u)},p.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},n.inherits(p,t.Transform).transform=function(e,t){var n,r=e.projection,i=e.fields[0],a=e.fields[1],o=e.as||["x","y"],u=o[0],s=o[1];function l(e){var t=r([i(e),a(e)]);t?(e[u]=t[0],e[s]=t[1]):(e[u]=void 0,e[s]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,l):(n=t.modified(i.fields)||t.modified(a.fields),t.visit(n?t.ADD_MOD:t.ADD,l)),t.modifies(o)},v.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},n.inherits(v,t.Transform).transform=function(e,t){var r=t.fork(t.ALL),i=this.value,o=e.as||"shape",u=r.ADD;return i&&!e.modified()||(this.value=i=function(e,t,n){var r=null==n?function(n){return e(t(n))}:function(r){var i=e.pointRadius(),a=e.pointRadius(n)(t(r));return e.pointRadius(i),a};return r.context=function(t){return e.context(t),r},r}(a.getProjectionPath(e.projection),e.field||n.field("datum"),e.pointRadius),r.materialize().reflow(),u=r.SOURCE),r.visit(u,function(e){e[o]=i}),r.modifies(o)},m.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},n.inherits(m,t.Transform).transform=function(e,r){var i,a=this.value,o=this.generator;if(!a.length||e.modified())for(var u in e)n.isFunction(o[u])&&o[u](e[u]);return i=o(),a.length?r.mod.push(t.replace(a[0],i)):r.add.push(t.ingest(i)),a[0]=i,r},n.inherits(g,t.Transform).transform=function(e,t){var r=this.value;return!r||e.modified("type")?(this.value=r=function(e){var t=a.projection((e||"mercator").toLowerCase());return t||n.error("Unrecognized projection type: "+e),t()}(e.type),a.projectionProperties.forEach(function(t){null!=e[t]&&b(r,t,e[t])})):a.projectionProperties.forEach(function(t){e.modified(t)&&b(r,t,e[t])}),null!=e.pointRadius&&r.path.pointRadius(e.pointRadius),e.fit&&y(r,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)},e.contour=l,e.geojson=d,e.geopath=h,e.geopoint=p,e.geoshape=v,e.graticule=m,e.projection=g,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1476),n(1469),n(1508),n(2066),n(2073),n(1692))},2884:function(e,t,n){!function(e,t,n,r){"use strict";var i={center:r.forceCenter,collide:r.forceCollide,nbody:r.forceManyBody,link:r.forceLink,x:r.forceX,y:r.forceY},a="forces",o=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],u=["static","iterations"],s=["x","y","vx","vy"];function l(e){t.Transform.call(this,null,e)}l.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:s}]};var c=n.inherits(l,t.Transform);function f(e,t,r,i){var u,s,l,c,f=n.array(t.forces);for(u=0,s=o.length;u<s;++u)(l=o[u])!==a&&t.modified(l)&&e[l](t[l]);for(u=0,s=f.length;u<s;++u)c=a+u,(l=r||t.modified(a,u)?h(f[u]):i&&d(f[u],i)?e.force(c):null)&&e.force(c,l);for(s=e.numForces||0;u<s;++u)e.force(a+u,null);return e.numForces=f.length,e}function d(e,t){var r,i;for(r in e)if(n.isFunction(i=e[r])&&t.modified(n.accessorFields(i)))return 1;return 0}function h(e){var t,r;for(r in n.hasOwnProperty(i,e.force)||n.error("Unrecognized force: "+e.force),t=i[e.force](),e)n.isFunction(t[r])&&p(t[r],e[r],e);return t}function p(e,t,r){e(n.isFunction(t)?function(e){return t(e,r)}:t)}c.transform=function(e,t){var n,i,a=this.value,s=t.changed(t.ADD_REM),l=e.modified(o),c=e.iterations||300;if(a?(s&&(t.modifies("index"),a.nodes(t.source)),(l||t.changed(t.MOD))&&f(a,e,0,t)):(this.value=a=function(e,t){var n=r.forceSimulation(e),i=!1,a=n.stop,o=n.restart;return n.stopped=function(){return i},n.restart=function(){return i=!1,o()},n.stop=function(){return i=!0,a()},f(n,t,!0).on("end",function(){i=!0})}(t.source,e),a.on("tick",(n=t.dataflow,i=this,function(){n.touch(i).run()})),e.static||(s=!0,a.tick()),t.modifies("index")),l||s||e.modified(u)||t.changed()&&e.restart)if(a.alpha(Math.max(a.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(a.alphaMin(),1/c)),e.static)for(a.stop();--c>=0;)a.tick();else if(a.stopped()&&a.restart(),!s)return t.StopPropagation;return this.finish(e,t)},c.finish=function(e,t){for(var n,r=t.dataflow,i=this._argops,o=0,u=i.length;o<u;++o)if((n=i[o]).name===a&&"link"===n.op._argval.force)for(var l,c=n.op._argops,f=0,d=c.length;f<d;++f)if("links"===c[f].name&&(l=c[f].op.source)){r.pulse(l,r.changeset().reflow());break}return t.reflow(e.modified()).modifies(s)},e.force=l,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1476),n(1469),n(2885))},2885:function(e,t,n){!function(e,t,n,r){"use strict";function i(e){return function(){return e}}function a(){return 1e-6*(Math.random()-.5)}function o(e){return e.x+e.vx}function u(e){return e.y+e.vy}function s(e){return e.index}function l(e,t){var n=e.get(t);if(!n)throw new Error("missing: "+t);return n}function c(e){return e.x}function f(e){return e.y}var d=10,h=Math.PI*(3-Math.sqrt(5));e.forceCenter=function(e,t){var n;function r(){var r,i,a=n.length,o=0,u=0;for(r=0;r<a;++r)o+=(i=n[r]).x,u+=i.y;for(o=o/a-e,u=u/a-t,r=0;r<a;++r)(i=n[r]).x-=o,i.y-=u}return null==e&&(e=0),null==t&&(t=0),r.initialize=function(e){n=e},r.x=function(t){return arguments.length?(e=+t,r):e},r.y=function(e){return arguments.length?(t=+e,r):t},r},e.forceCollide=function(e){var n,r,s=1,l=1;function c(){for(var e,i,c,d,h,p,v,m=n.length,g=0;g<l;++g)for(i=t.quadtree(n,o,u).visitAfter(f),e=0;e<m;++e)c=n[e],p=r[c.index],v=p*p,d=c.x+c.vx,h=c.y+c.vy,i.visit(y);function y(e,t,n,r,i){var o=e.data,u=e.r,l=p+u;if(!o)return t>d+l||r<d-l||n>h+l||i<h-l;if(o.index>c.index){var f=d-o.x-o.vx,m=h-o.y-o.vy,g=f*f+m*m;g<l*l&&(0===f&&(g+=(f=a())*f),0===m&&(g+=(m=a())*m),g=(l-(g=Math.sqrt(g)))/g*s,c.vx+=(f*=g)*(l=(u*=u)/(v+u)),c.vy+=(m*=g)*l,o.vx-=f*(l=1-l),o.vy-=m*l)}}}function f(e){if(e.data)return e.r=r[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function d(){if(n){var t,i,a=n.length;for(r=new Array(a),t=0;t<a;++t)i=n[t],r[i.index]=+e(i,t,n)}}return"function"!==typeof e&&(e=i(null==e?1:+e)),c.initialize=function(e){n=e,d()},c.iterations=function(e){return arguments.length?(l=+e,c):l},c.strength=function(e){return arguments.length?(s=+e,c):s},c.radius=function(t){return arguments.length?(e="function"===typeof t?t:i(+t),d(),c):e},c},e.forceLink=function(e){var t,n,r,o,u,c=s,f=function(e){return 1/Math.min(o[e.source.index],o[e.target.index])},d=i(30),h=1;function p(r){for(var i=0,o=e.length;i<h;++i)for(var s,l,c,f,d,p,v,m=0;m<o;++m)l=(s=e[m]).source,f=(c=s.target).x+c.vx-l.x-l.vx||a(),d=c.y+c.vy-l.y-l.vy||a(),f*=p=((p=Math.sqrt(f*f+d*d))-n[m])/p*r*t[m],d*=p,c.vx-=f*(v=u[m]),c.vy-=d*v,l.vx+=f*(v=1-v),l.vy+=d*v}function v(){if(r){var i,a,s=r.length,f=e.length,d=new Map(r.map(function(e,t){return[c(e,t,r),e]}));for(i=0,o=new Array(s);i<f;++i)(a=e[i]).index=i,"object"!==typeof a.source&&(a.source=l(d,a.source)),"object"!==typeof a.target&&(a.target=l(d,a.target)),o[a.source.index]=(o[a.source.index]||0)+1,o[a.target.index]=(o[a.target.index]||0)+1;for(i=0,u=new Array(f);i<f;++i)a=e[i],u[i]=o[a.source.index]/(o[a.source.index]+o[a.target.index]);t=new Array(f),m(),n=new Array(f),g()}}function m(){if(r)for(var n=0,i=e.length;n<i;++n)t[n]=+f(e[n],n,e)}function g(){if(r)for(var t=0,i=e.length;t<i;++t)n[t]=+d(e[t],t,e)}return null==e&&(e=[]),p.initialize=function(e){r=e,v()},p.links=function(t){return arguments.length?(e=t,v(),p):e},p.id=function(e){return arguments.length?(c=e,p):c},p.iterations=function(e){return arguments.length?(h=+e,p):h},p.strength=function(e){return arguments.length?(f="function"===typeof e?e:i(+e),m(),p):f},p.distance=function(e){return arguments.length?(d="function"===typeof e?e:i(+e),g(),p):d},p},e.forceManyBody=function(){var e,n,r,o,u=i(-30),s=1,l=1/0,d=.81;function h(i){var a,o=e.length,u=t.quadtree(e,c,f).visitAfter(v);for(r=i,a=0;a<o;++a)n=e[a],u.visit(m)}function p(){if(e){var t,n,r=e.length;for(o=new Array(r),t=0;t<r;++t)n=e[t],o[n.index]=+u(n,t,e)}}function v(e){var t,n,r,i,a,u=0,s=0;if(e.length){for(r=i=a=0;a<4;++a)(t=e[a])&&(n=Math.abs(t.value))&&(u+=t.value,s+=n,r+=n*t.x,i+=n*t.y);e.x=r/s,e.y=i/s}else{(t=e).x=t.data.x,t.y=t.data.y;do{u+=o[t.data.index]}while(t=t.next)}e.value=u}function m(e,t,i,u){if(!e.value)return!0;var c=e.x-n.x,f=e.y-n.y,h=u-t,p=c*c+f*f;if(h*h/d<p)return p<l&&(0===c&&(p+=(c=a())*c),0===f&&(p+=(f=a())*f),p<s&&(p=Math.sqrt(s*p)),n.vx+=c*e.value*r/p,n.vy+=f*e.value*r/p),!0;if(!(e.length||p>=l)){(e.data!==n||e.next)&&(0===c&&(p+=(c=a())*c),0===f&&(p+=(f=a())*f),p<s&&(p=Math.sqrt(s*p)));do{e.data!==n&&(h=o[e.data.index]*r/p,n.vx+=c*h,n.vy+=f*h)}while(e=e.next)}}return h.initialize=function(t){e=t,p()},h.strength=function(e){return arguments.length?(u="function"===typeof e?e:i(+e),p(),h):u},h.distanceMin=function(e){return arguments.length?(s=e*e,h):Math.sqrt(s)},h.distanceMax=function(e){return arguments.length?(l=e*e,h):Math.sqrt(l)},h.theta=function(e){return arguments.length?(d=e*e,h):Math.sqrt(d)},h},e.forceRadial=function(e,t,n){var r,a,o,u=i(.1);function s(e){for(var i=0,u=r.length;i<u;++i){var s=r[i],l=s.x-t||1e-6,c=s.y-n||1e-6,f=Math.sqrt(l*l+c*c),d=(o[i]-f)*a[i]*e/f;s.vx+=l*d,s.vy+=c*d}}function l(){if(r){var t,n=r.length;for(a=new Array(n),o=new Array(n),t=0;t<n;++t)o[t]=+e(r[t],t,r),a[t]=isNaN(o[t])?0:+u(r[t],t,r)}}return"function"!==typeof e&&(e=i(+e)),null==t&&(t=0),null==n&&(n=0),s.initialize=function(e){r=e,l()},s.strength=function(e){return arguments.length?(u="function"===typeof e?e:i(+e),l(),s):u},s.radius=function(t){return arguments.length?(e="function"===typeof t?t:i(+t),l(),s):e},s.x=function(e){return arguments.length?(t=+e,s):t},s.y=function(e){return arguments.length?(n=+e,s):n},s},e.forceSimulation=function(e){var t,i=1,a=.001,o=1-Math.pow(a,1/300),u=0,s=.6,l=new Map,c=r.timer(p),f=n.dispatch("tick","end");function p(){v(),f.call("tick",t),i<a&&(c.stop(),f.call("end",t))}function v(n){var r,a,c=e.length;void 0===n&&(n=1);for(var f=0;f<n;++f)for(i+=(u-i)*o,l.forEach(function(e){e(i)}),r=0;r<c;++r)null==(a=e[r]).fx?a.x+=a.vx*=s:(a.x=a.fx,a.vx=0),null==a.fy?a.y+=a.vy*=s:(a.y=a.fy,a.vy=0);return t}function m(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var i=d*Math.sqrt(n),a=n*h;t.x=i*Math.cos(a),t.y=i*Math.sin(a)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function g(t){return t.initialize&&t.initialize(e),t}return null==e&&(e=[]),m(),t={tick:v,restart:function(){return c.restart(p),t},stop:function(){return c.stop(),t},nodes:function(n){return arguments.length?(e=n,m(),l.forEach(g),t):e},alpha:function(e){return arguments.length?(i=+e,t):i},alphaMin:function(e){return arguments.length?(a=+e,t):a},alphaDecay:function(e){return arguments.length?(o=+e,t):+o},alphaTarget:function(e){return arguments.length?(u=+e,t):u},velocityDecay:function(e){return arguments.length?(s=1-e,t):1-s},force:function(e,n){return arguments.length>1?(null==n?l.delete(e):l.set(e,g(n)),t):l.get(e)},find:function(t,n,r){var i,a,o,u,s,l=0,c=e.length;for(null==r?r=1/0:r*=r,l=0;l<c;++l)(o=(i=t-(u=e[l]).x)*i+(a=n-u.y)*a)<r&&(s=u,r=o);return s},on:function(e,n){return arguments.length>1?(f.on(e,n),t):f.on(e)}}},e.forceX=function(e){var t,n,r,a=i(.1);function o(e){for(var i,a=0,o=t.length;a<o;++a)(i=t[a]).vx+=(r[a]-i.x)*n[a]*e}function u(){if(t){var i,o=t.length;for(n=new Array(o),r=new Array(o),i=0;i<o;++i)n[i]=isNaN(r[i]=+e(t[i],i,t))?0:+a(t[i],i,t)}}return"function"!==typeof e&&(e=i(null==e?0:+e)),o.initialize=function(e){t=e,u()},o.strength=function(e){return arguments.length?(a="function"===typeof e?e:i(+e),u(),o):a},o.x=function(t){return arguments.length?(e="function"===typeof t?t:i(+t),u(),o):e},o},e.forceY=function(e){var t,n,r,a=i(.1);function o(e){for(var i,a=0,o=t.length;a<o;++a)(i=t[a]).vy+=(r[a]-i.y)*n[a]*e}function u(){if(t){var i,o=t.length;for(n=new Array(o),r=new Array(o),i=0;i<o;++i)n[i]=isNaN(r[i]=+e(t[i],i,t))?0:+a(t[i],i,t)}}return"function"!==typeof e&&(e=i(null==e?0:+e)),o.initialize=function(e){t=e,u()},o.strength=function(e){return arguments.length?(a="function"===typeof e?e:i(+e),u(),o):a},o.y=function(t){return arguments.length?(e="function"===typeof t?t:i(+t),u(),o):e},o},Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1796),n(1522),n(1575))},2886:function(e,t,n){!function(e,t,n,r){"use strict";function i(e,t,n){var r={};return e.each(function(e){var i=e.data;n(i)&&(r[t(i)]=e)}),e.lookup=r,e}function a(e){t.Transform.call(this,null,e)}function o(e){return e.values}function u(){var e,t=[];return e={entries:function(e){return function e(n,r){if(++r>t.length)return n;var i,a=[];for(i in n)a.push({key:i,values:e(n[i],r)});return a}(function e(n,r){if(r>=t.length)return n;for(var i,a,o,u=-1,s=n.length,l=t[r++],c={},f={};++u<s;)(o=c[i=l(a=n[u])+""])?o.push(a):c[i]=[a];for(i in c)f[i]=e(c[i],r);return f}(e,0),0)},key:function(n){return t.push(n),e}}}function s(e){t.Transform.call(this,null,e)}function l(e,t){return e.parent===t.parent?1:2}a.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]},n.inherits(a,t.Transform).transform=function(e,a){a.source||n.error("Nest transform requires an upstream data source.");var s=e.generate,l=e.modified(),c=a.clone(),f=this.value;return(!f||l||a.changed())&&(f&&f.each(function(e){e.children&&t.isTuple(e.data)&&c.rem.push(e.data)}),this.value=f=r.hierarchy({values:n.array(e.keys).reduce(function(e,t){return e.key(t),e},u()).entries(c.source)},o),s&&f.each(function(e){e.children&&(e=t.ingest(e.data),c.add.push(e),c.source.push(e))}),i(f,t.tupleid,t.tupleid)),c.source.root=f,c},n.inherits(s,t.Transform).transform=function(e,r){r.source&&r.source.root||n.error(this.constructor.name+" transform requires a backing tree data source.");var i=this.layout(e.method),a=this.fields,o=r.source.root,u=e.as||a;e.field?o.sum(e.field):o.count(),e.sort&&o.sort(t.stableCompare(e.sort,function(e){return e.data})),function(e,t,n){for(var r,i=0,a=t.length;i<a;++i)(r=t[i])in n&&e[r](n[r])}(i,this.params,e),i.separation&&i.separation(!1!==e.separation?l:n.one);try{this.value=i(o)}catch(s){n.error(s)}return o.each(function(e){!function(e,t,n){for(var r=e.data,i=0,a=t.length-1;i<a;++i)r[n[i]]=e[t[i]];r[n[a]]=e.children?e.children.length:0}(e,a,u)}),r.reflow(e.modified()).modifies(u).modifies("leaf")};var c=["x","y","r","depth","children"];function f(e){s.call(this,e)}f.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:c.length,default:c}]};var d=n.inherits(f,s);d.layout=r.pack,d.params=["radius","size","padding"],d.fields=c;var h=["x0","y0","x1","y1","depth","children"];function p(e){s.call(this,e)}p.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:h.length,default:h}]};var v=n.inherits(p,s);function m(e){t.Transform.call(this,null,e)}v.layout=r.partition,v.params=["size","round","padding"],v.fields=h,m.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},n.inherits(m,t.Transform).transform=function(e,t){t.source||n.error("Stratify transform requires an upstream data source.");var a=this.value,o=e.modified(),u=t.fork(t.ALL).materialize(t.SOURCE),s=!this.value||o||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return u.source=u.source.slice(),s&&(a=u.source.length?i(r.stratify().id(e.key).parentId(e.parentKey)(u.source),e.key,n.truthy):i(r.stratify()([{}]),e.key,e.key)),u.source.root=this.value=a,u};var g={tidy:r.tree,cluster:r.cluster},y=["x","y","depth","children"];function b(e){s.call(this,e)}b.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:y.length,default:y}]};var x=n.inherits(b,s);function w(e){t.Transform.call(this,[],e)}x.layout=function(e){var t=e||"tidy";if(n.hasOwnProperty(g,t))return g[t]();n.error("Unrecognized Tree layout method: "+t)},x.params=["size","nodeSize"],x.fields=y,w.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},n.inherits(w,t.Transform).transform=function(e,r){var i=this.value,a=r.source&&r.source.root,o=r.fork(r.NO_SOURCE),u={};return a||n.error("TreeLinks transform requires a tree data source."),r.changed(r.ADD_REM)?(o.rem=i,r.visit(r.SOURCE,function(e){u[t.tupleid(e)]=1}),a.each(function(e){var n=e.data,r=e.parent&&e.parent.data;r&&u[t.tupleid(n)]&&u[t.tupleid(r)]&&o.add.push(t.ingest({source:r,target:n}))}),this.value=o.add):r.changed(r.MOD)&&(r.visit(r.MOD,function(e){u[t.tupleid(e)]=1}),i.forEach(function(e){(u[t.tupleid(e.source)]||u[t.tupleid(e.target)])&&o.mod.push(e)})),o};var k={binary:r.treemapBinary,dice:r.treemapDice,slice:r.treemapSlice,slicedice:r.treemapSliceDice,squarify:r.treemapSquarify,resquarify:r.treemapResquarify},A=["x0","y0","x1","y1","depth","children"];function E(e){s.call(this,e)}E.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:A.length,default:A}]};var D=n.inherits(E,s);D.layout=function(){var e=r.treemap();return e.ratio=function(t){var n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=function(t){n.hasOwnProperty(k,t)?e.tile(k[t]):n.error("Unrecognized Treemap layout method: "+t)},e},D.params=["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],D.fields=A,e.nest=a,e.pack=f,e.partition=p,e.stratify=m,e.tree=b,e.treelinks=w,e.treemap=E,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1476),n(1469),n(2067))},2887:function(e,t,n){!function(e,t,n,r){"use strict";function i(e,t){var n,r,i,a,o,u,s=[],l=function(e){return e(a)};if(null==t)s.push(e);else for(n={},r=0,i=e.length;r<i;++r)a=e[r],(u=n[o=t.map(l)])||(n[o]=u=[],u.dims=o,s.push(u)),u.push(a);return s}function a(e){n.Transform.call(this,null,e)}a.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},r.inherits(a,n.Transform).transform=function(e,a){var o=a.fork(a.NO_SOURCE|a.NO_FIELDS);if(!this.value||a.changed()||e.modified()){var u=i(a.materialize(a.SOURCE).source,e.groupby),s=(e.groupby||[]).map(r.accessorName),l=s.length,c=e.as||[r.accessorName(e.x),r.accessorName(e.y)],f=[];u.forEach(function(r){t.regressionLoess(r,e.x,e.y,e.bandwidth||.3).forEach(function(e){for(var t={},i=0;i<l;++i)t[s[i]]=r.dims[i];t[c[0]]=e[0],t[c[1]]=e[1],f.push(n.ingest(t))})}),this.value&&(o.rem=this.value),this.value=o.add=o.source=f}return o};var o={linear:t.regressionLinear,log:t.regressionLog,exp:t.regressionExp,pow:t.regressionPow,quad:t.regressionQuad,poly:t.regressionPoly};function u(e){n.Transform.call(this,null,e)}u.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(o)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},r.inherits(u,n.Transform).transform=function(e,a){var u=a.fork(a.NO_SOURCE|a.NO_FIELDS);if(!this.value||a.changed()||e.modified()){var s=i(a.materialize(a.SOURCE).source,e.groupby),l=(e.groupby||[]).map(r.accessorName),c=e.method||"linear",f=e.order||3,d=function(e,t){return"poly"===e?t:"quad"===e?2:1}(c,f),h=e.as||[r.accessorName(e.x),r.accessorName(e.y)],p=o[c],v=[],m=e.extent;r.hasOwnProperty(o,c)||r.error("Invalid regression method: "+c),null!=m&&"log"===c&&m[0]<=0&&(a.dataflow.warn("Ignoring extent with values <= 0 for log regression."),m=null),s.forEach(function(i){if(i.length<=d)a.dataflow.warn("Skipping regression with more parameters than data points.");else{var o=p(i,e.x,e.y,f);if(e.params)v.push(n.ingest({keys:i.dims,coef:o.coef,rSquared:o.rSquared}));else{var u=m||r.extent(i,e.x),s=function(e){for(var t={},r=0;r<l.length;++r)t[l[r]]=i.dims[r];t[h[0]]=e[0],t[h[1]]=e[1],v.push(n.ingest(t))};"linear"===c?u.forEach(function(e){return s([e,o.predict(e)])}):t.sampleCurve(o.predict,u,25,200).forEach(s)}}}),this.value&&(u.rem=this.value),this.value=u.add=u.source=v}return u},e.loess=a,e.regression=u,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1623),n(1476),n(1469))},2888:function(e,t,n){!function(e,t,n,r){"use strict";function i(e){t.Transform.call(this,null,e)}i.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};var a=n.inherits(i,t.Transform),o=[-1e5,-1e5,1e5,1e5];function u(e){for(var t=e[0][0],n=e[0][1],r=e.length-1;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}a.transform=function(e,t){var n=e.as||"path",i=t.source;if(!i||!i.length)return t;var a=e.size;a=a?[0,0,a[0],a[1]]:(a=e.extent)?[a[0][0],a[0][1],a[1][0],a[1][1]]:o;for(var s=this.value=r.Delaunay.from(i,e.x,e.y).voronoi(a),l=0,c=i.length;l<c;++l){var f=s.cellPolygon(l);i[l][n]=f?u(f):null}return t.reflow(e.modified()).modifies(n)},e.voronoi=i,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1476),n(1469),n(2889))},2889:function(e,t,n){var r=n(21),i=n(309),a=n(14),o=n(15);!function(e){"use strict";var t=r.mark(O),n=Math.pow(2,-52),u=new Uint32Array(512),s=function(){function e(t){a(this,e);var n=t.length>>1;if(n>0&&"number"!==typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;var r=Math.max(2*n-5,0);this._triangles=new Uint32Array(3*r),this._halfedges=new Int32Array(3*r),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}return o(e,null,[{key:"from",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g,i=t.length,a=new Float64Array(2*i),o=0;o<i;o++){var u=t[o];a[2*o]=n(u),a[2*o+1]=r(u)}return new e(a)}}]),o(e,[{key:"update",value:function(){for(var e=this.coords,t=this._hullPrev,r=this._hullNext,i=this._hullTri,a=this._hullHash,o=e.length>>1,u=1/0,s=1/0,c=-1/0,d=-1/0,v=0;v<o;v++){var m=e[2*v],g=e[2*v+1];m<u&&(u=m),g<s&&(s=g),m>c&&(c=m),g>d&&(d=g),this._ids[v]=v}for(var y,b,x,w=(u+c)/2,k=(s+d)/2,A=1/0,E=0;E<o;E++){var D=l(w,k,e[2*E],e[2*E+1]);D<A&&(y=E,A=D)}var C=e[2*y],O=e[2*y+1];A=1/0;for(var F=0;F<o;F++)if(F!==y){var _=l(C,O,e[2*F],e[2*F+1]);_<A&&_>0&&(b=F,A=_)}for(var S=e[2*b],M=e[2*b+1],j=1/0,T=0;T<o;T++)if(T!==y&&T!==b){var N=h(C,O,S,M,e[2*T],e[2*T+1]);N<j&&(x=T,j=N)}var B=e[2*x],R=e[2*x+1];if(j===1/0){for(var z=0;z<o;z++)this._dists[z]=e[2*z]-e[0]||e[2*z+1]-e[1];p(this._ids,this._dists,0,o-1);for(var P=new Uint32Array(o),L=0,I=0,U=-1/0;I<o;I++){var q=this._ids[I];this._dists[q]>U&&(P[L++]=q,U=this._dists[q])}return this.hull=P.subarray(0,L),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(f(C,O,S,M,B,R)){var W=b,H=S,V=M;b=x,S=B,M=R,x=W,B=H,R=V}var G=function(e,t,n,r,i,a){var o=n-e,u=r-t,s=i-e,l=a-t,c=o*o+u*u,f=s*s+l*l,d=.5/(o*l-u*s);return{x:e+(l*c-u*f)*d,y:t+(o*f-s*c)*d}}(C,O,S,M,B,R);this._cx=G.x,this._cy=G.y;for(var $=0;$<o;$++)this._dists[$]=l(e[2*$],e[2*$+1],G.x,G.y);p(this._ids,this._dists,0,o-1),this._hullStart=y;var Y=3;r[y]=t[x]=b,r[b]=t[y]=x,r[x]=t[b]=y,i[y]=0,i[b]=1,i[x]=2,a.fill(-1),a[this._hashKey(C,O)]=y,a[this._hashKey(S,M)]=b,a[this._hashKey(B,R)]=x,this.trianglesLen=0,this._addTriangle(y,b,x,-1,-1,-1);for(var X,J,Q=0;Q<this._ids.length;Q++){var K=this._ids[Q],Z=e[2*K],ee=e[2*K+1];if(!(Q>0&&Math.abs(Z-X)<=n&&Math.abs(ee-J)<=n)&&(X=Z,J=ee,K!==y&&K!==b&&K!==x)){for(var te=0,ne=0,re=this._hashKey(Z,ee);ne<this._hashSize&&(-1===(te=a[(re+ne)%this._hashSize])||te===r[te]);ne++);for(var ie=te=t[te],ae=void 0;ae=r[ie],!f(Z,ee,e[2*ie],e[2*ie+1],e[2*ae],e[2*ae+1]);)if((ie=ae)===te){ie=-1;break}if(-1!==ie){var oe=this._addTriangle(ie,K,r[ie],-1,-1,i[ie]);i[K]=this._legalize(oe+2),i[ie]=oe,Y++;for(var ue=r[ie];ae=r[ue],f(Z,ee,e[2*ue],e[2*ue+1],e[2*ae],e[2*ae+1]);)oe=this._addTriangle(ue,K,ae,i[K],-1,i[ue]),i[K]=this._legalize(oe+2),r[ue]=ue,Y--,ue=ae;if(ie===te)for(;f(Z,ee,e[2*(ae=t[ie])],e[2*ae+1],e[2*ie],e[2*ie+1]);)oe=this._addTriangle(ae,K,ie,-1,i[ie],i[ae]),this._legalize(oe+2),i[ae]=oe,r[ie]=ie,Y--,ie=ae;this._hullStart=t[K]=ie,r[ie]=t[ue]=K,r[K]=ue,a[this._hashKey(Z,ee)]=K,a[this._hashKey(e[2*ie],e[2*ie+1])]=ie}}}this.hull=new Uint32Array(Y);for(var se=0,le=this._hullStart;se<Y;se++)this.hull[se]=le,le=r[le];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}},{key:"_hashKey",value:function(e,t){return Math.floor(function(e,t){var n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}},{key:"_legalize",value:function(e){for(var t=this._triangles,n=this._halfedges,r=this.coords,i=0,a=0;;){var o=n[e],s=e-e%3;if(a=s+(e+2)%3,-1!==o){var l=o-o%3,c=s+(e+1)%3,f=l+(o+2)%3,h=t[a],p=t[e],v=t[c],m=t[f];if(d(r[2*h],r[2*h+1],r[2*p],r[2*p+1],r[2*v],r[2*v+1],r[2*m],r[2*m+1])){t[e]=m,t[o]=h;var g=n[f];if(-1===g){var y=this._hullStart;do{if(this._hullTri[y]===f){this._hullTri[y]=e;break}y=this._hullPrev[y]}while(y!==this._hullStart)}this._link(e,g),this._link(o,n[a]),this._link(a,f);var b=l+(o+1)%3;i<u.length&&(u[i++]=b)}else{if(0===i)break;e=u[--i]}}else{if(0===i)break;e=u[--i]}}return a}},{key:"_link",value:function(e,t){this._halfedges[e]=t,-1!==t&&(this._halfedges[t]=e)}},{key:"_addTriangle",value:function(e,t,n,r,i,a){var o=this.trianglesLen;return this._triangles[o]=e,this._triangles[o+1]=t,this._triangles[o+2]=n,this._link(o,r),this._link(o+1,i),this._link(o+2,a),this.trianglesLen+=3,o}}]),e}();function l(e,t,n,r){var i=e-n,a=t-r;return i*i+a*a}function c(e,t,n,r,i,a){var o=(r-t)*(i-e),u=(n-e)*(a-t);return Math.abs(o-u)>=33306690738754716e-32*Math.abs(o+u)?o-u:0}function f(e,t,n,r,i,a){return(c(i,a,e,t,n,r)||c(e,t,n,r,i,a)||c(n,r,i,a,e,t))<0}function d(e,t,n,r,i,a,o,u){var s=e-o,l=t-u,c=n-o,f=r-u,d=i-o,h=a-u,p=c*c+f*f,v=d*d+h*h;return s*(f*v-p*h)-l*(c*v-p*d)+(s*s+l*l)*(c*h-f*d)<0}function h(e,t,n,r,i,a){var o=n-e,u=r-t,s=i-e,l=a-t,c=o*o+u*u,f=s*s+l*l,d=.5/(o*l-u*s),h=(l*c-u*f)*d,p=(o*f-s*c)*d;return h*h+p*p}function p(e,t,n,r){if(r-n<=20)for(var i=n+1;i<=r;i++){for(var a=e[i],o=t[a],u=i-1;u>=n&&t[e[u]]>o;)e[u+1]=e[u--];e[u+1]=a}else{var s=n+1,l=r;v(e,n+r>>1,s),t[e[n]]>t[e[r]]&&v(e,n,r),t[e[s]]>t[e[r]]&&v(e,s,r),t[e[n]]>t[e[s]]&&v(e,n,s);for(var c=e[s],f=t[c];;){do{s++}while(t[e[s]]<f);do{l--}while(t[e[l]]>f);if(l<s)break;v(e,s,l)}e[n+1]=e[l],e[l]=c,r-s+1>=l-n?(p(e,t,s,r),p(e,t,n,l-1)):(p(e,t,n,l-1),p(e,t,s,r))}}function v(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function m(e){return e[0]}function g(e){return e[1]}var y=function(){function e(){a(this,e),this._x0=this._y0=this._x1=this._y1=null,this._=""}return o(e,[{key:"moveTo",value:function(e,t){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t)}},{key:"closePath",value:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}},{key:"lineTo",value:function(e,t){this._+="L".concat(this._x1=+e,",").concat(this._y1=+t)}},{key:"arc",value:function(e,t,n){var r=(e=+e)+(n=+n),i=t=+t;if(n<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(i):(Math.abs(this._x1-r)>1e-6||Math.abs(this._y1-i)>1e-6)&&(this._+="L"+r+","+i),n&&(this._+="A".concat(n,",").concat(n,",0,1,1,").concat(e-n,",").concat(t,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=r,",").concat(this._y1=i))}},{key:"rect",value:function(e,t,n,r){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t,"h").concat(+n,"v").concat(+r,"h").concat(-n,"Z")}},{key:"value",value:function(){return this._||null}}]),e}(),b=function(){function e(){a(this,e),this._=[]}return o(e,[{key:"moveTo",value:function(e,t){this._.push([e,t])}},{key:"closePath",value:function(){this._.push(this._[0].slice())}},{key:"lineTo",value:function(e,t){this._.push([e,t])}},{key:"value",value:function(){return this._.length?this._:null}}]),e}(),x=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500],r=i(n,4),o=r[0],u=r[1],s=r[2],l=r[3];if(a(this,e),!((s=+s)>=(o=+o))||!((l=+l)>=(u=+u)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=s,this.xmin=o,this.ymax=l,this.ymin=u,this._init()}return o(e,[{key:"update",value:function(){return this.delaunay.update(),this._init(),this}},{key:"_init",value:function(){for(var e,t,n=this.delaunay,r=n.points,i=n.hull,a=n.triangles,o=this.vectors,u=this.circumcenters=this._circumcenters.subarray(0,a.length/3*2),s=0,l=0,c=a.length;s<c;s+=3,l+=2){var f=2*a[s],d=2*a[s+1],h=2*a[s+2],p=r[f],v=r[f+1],m=r[d],g=r[d+1],y=r[h],b=r[h+1],x=m-p,w=g-v,k=y-p,A=b-v,E=x*x+w*w,D=k*k+A*A,C=2*(x*A-w*k);if(C)if(Math.abs(C)<1e-8)e=(p+y)/2,t=(v+b)/2;else{var O=1/C;e=p+(A*E-w*D)*O,t=v+(x*D-k*E)*O}else e=(p+y)/2-1e8*A,t=(v+b)/2+1e8*k;u[l]=e,u[l+1]=t}var F,_,S,M=i[i.length-1],j=4*M,T=r[2*M],N=r[2*M+1];o.fill(0);for(var B=0;B<i.length;++B)F=j,_=T,S=N,j=4*(M=i[B]),T=r[2*M],N=r[2*M+1],o[F+2]=o[j]=S-N,o[F+3]=o[j+1]=T-_}},{key:"render",value:function(e){var t=null==e?e=new y:void 0,n=this.delaunay,r=n.halfedges,i=n.inedges,a=n.hull,o=this.circumcenters,u=this.vectors;if(a.length<=1)return null;for(var s=0,l=r.length;s<l;++s){var c=r[s];if(!(c<s)){var f=2*Math.floor(s/3),d=2*Math.floor(c/3),h=o[f],p=o[f+1],v=o[d],m=o[d+1];this._renderSegment(h,p,v,m,e)}}for(var g,b=a[a.length-1],x=0;x<a.length;++x){g=b,b=a[x];var w=2*Math.floor(i[b]/3),k=o[w],A=o[w+1],E=4*g,D=this._project(k,A,u[E+2],u[E+3]);D&&this._renderSegment(k,A,D[0],D[1],e)}return t&&t.value()}},{key:"renderBounds",value:function(e){var t=null==e?e=new y:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}},{key:"renderCell",value:function(e,t){var n=null==t?t=new y:void 0,r=this._clip(e);if(null!==r){t.moveTo(r[0],r[1]);for(var i=r.length;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(var a=2;a<i;a+=2)r[a]===r[a-2]&&r[a+1]===r[a-1]||t.lineTo(r[a],r[a+1]);return t.closePath(),n&&n.value()}}},{key:"cellPolygons",value:r.mark(function e(){var t,n,i,a;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.delaunay.points,n=0,i=t.length/2;case 2:if(!(n<i)){e.next=10;break}if(!(a=this.cellPolygon(n))){e.next=7;break}return e.next=7,a;case 7:++n,e.next=2;break;case 10:case"end":return e.stop()}},e,this)})},{key:"cellPolygon",value:function(e){var t=new b;return this.renderCell(e,t),t.value()}},{key:"_renderSegment",value:function(e,t,n,r,i){var a,o=this._regioncode(e,t),u=this._regioncode(n,r);0===o&&0===u?(i.moveTo(e,t),i.lineTo(n,r)):(a=this._clipSegment(e,t,n,r,o,u))&&(i.moveTo(a[0],a[1]),i.lineTo(a[2],a[3]))}},{key:"contains",value:function(e,t,n){return(t=+t)===t&&(n=+n)===n&&this.delaunay._step(e,t,n)===e}},{key:"_cell",value:function(e){var t=this.circumcenters,n=this.delaunay,r=n.inedges,i=n.halfedges,a=n.triangles,o=r[e];if(-1===o)return null;var u=[],s=o;do{var l=Math.floor(s/3);if(u.push(t[2*l],t[2*l+1]),a[s=s%3===2?s-2:s+1]!==e)break;s=i[s]}while(s!==o&&-1!==s);return u}},{key:"_clip",value:function(e){if(0===e&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];var t=this._cell(e);if(null===t)return null;var n=this.vectors,r=4*e;return n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t)}},{key:"_clipFinite",value:function(e,t){for(var n,r,a,o,u,s=t.length,l=null,c=t[s-2],f=t[s-1],d=this._regioncode(c,f),h=0;h<s;h+=2)if(n=c,r=f,c=t[h],f=t[h+1],a=d,d=this._regioncode(c,f),0===a&&0===d)o=u,u=0,l?l.push(c,f):l=[c,f];else{var p=void 0,v=void 0,m=void 0,g=void 0,y=void 0;if(0===a){if(null===(p=this._clipSegment(n,r,c,f,a,d)))continue;var b=i(p,4);v=b[0],m=b[1],g=b[2],y=b[3]}else{if(null===(p=this._clipSegment(c,f,n,r,d,a)))continue;var x=i(p,4);g=x[0],y=x[1],v=x[2],m=x[3],o=u,u=this._edgecode(v,m),o&&u&&this._edge(e,o,u,l,l.length),l?l.push(v,m):l=[v,m]}o=u,u=this._edgecode(g,y),o&&u&&this._edge(e,o,u,l,l.length),l?l.push(g,y):l=[g,y]}if(l)o=u,u=this._edgecode(l[0],l[1]),o&&u&&this._edge(e,o,u,l,l.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return l}},{key:"_clipSegment",value:function(e,t,n,r,i,a){for(;;){if(0===i&&0===a)return[e,t,n,r];if(i&a)return null;var o=void 0,u=void 0,s=i||a;8&s?(o=e+(n-e)*(this.ymax-t)/(r-t),u=this.ymax):4&s?(o=e+(n-e)*(this.ymin-t)/(r-t),u=this.ymin):2&s?(u=t+(r-t)*(this.xmax-e)/(n-e),o=this.xmax):(u=t+(r-t)*(this.xmin-e)/(n-e),o=this.xmin),i?(e=o,t=u,i=this._regioncode(e,t)):(n=o,r=u,a=this._regioncode(n,r))}}},{key:"_clipInfinite",value:function(e,t,n,r,i,a){var o,u=Array.from(t);if((o=this._project(u[0],u[1],n,r))&&u.unshift(o[0],o[1]),(o=this._project(u[u.length-2],u[u.length-1],i,a))&&u.push(o[0],o[1]),u=this._clipFinite(e,u))for(var s,l=0,c=u.length,f=this._edgecode(u[c-2],u[c-1]);l<c;l+=2)s=f,f=this._edgecode(u[l],u[l+1]),s&&f&&(l=this._edge(e,s,f,u,l),c=u.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(u=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return u}},{key:"_edge",value:function(e,t,n,r,i){for(;t!==n;){var a=void 0,o=void 0;switch(t){case 5:t=4;continue;case 4:t=6,a=this.xmax,o=this.ymin;break;case 6:t=2;continue;case 2:t=10,a=this.xmax,o=this.ymax;break;case 10:t=8;continue;case 8:t=9,a=this.xmin,o=this.ymax;break;case 9:t=1;continue;case 1:t=5,a=this.xmin,o=this.ymin}r[i]===a&&r[i+1]===o||!this.contains(e,a,o)||(r.splice(i,0,a,o),i+=2)}if(r.length>4)for(var u=0;u<r.length;u+=2){var s=(u+2)%r.length,l=(u+4)%r.length;(r[u]===r[s]&&r[s]===r[l]||r[u+1]===r[s+1]&&r[s+1]===r[l+1])&&(r.splice(s,2),u-=2)}return i}},{key:"_project",value:function(e,t,n,r){var i,a,o,u=1/0;if(r<0){if(t<=this.ymin)return null;(i=(this.ymin-t)/r)<u&&(o=this.ymin,a=e+(u=i)*n)}else if(r>0){if(t>=this.ymax)return null;(i=(this.ymax-t)/r)<u&&(o=this.ymax,a=e+(u=i)*n)}if(n>0){if(e>=this.xmax)return null;(i=(this.xmax-e)/n)<u&&(a=this.xmax,o=t+(u=i)*r)}else if(n<0){if(e<=this.xmin)return null;(i=(this.xmin-e)/n)<u&&(a=this.xmin,o=t+(u=i)*r)}return[a,o]}},{key:"_edgecode",value:function(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}},{key:"_regioncode",value:function(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}}]),e}(),w=2*Math.PI;function k(e){return e[0]}function A(e){return e[1]}function E(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}var D=function(){function e(t){a(this,e),this._delaunator=new s(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}return o(e,[{key:"update",value:function(){return this._delaunator.update(),this._init(),this}},{key:"_init",value:function(){var e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&function(e){for(var t=e.triangles,n=e.coords,r=0;r<t.length;r+=3){var i=2*t[r],a=2*t[r+1],o=2*t[r+2];if((n[o]-n[i])*(n[a+1]-n[i+1])-(n[a]-n[i])*(n[o+1]-n[i+1])>1e-10)return!1}return!0}(e)){this.collinear=Int32Array.from({length:t.length/2},function(e,t){return t}).sort(function(e,n){return t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]});for(var n=this.collinear[0],r=this.collinear[this.collinear.length-1],i=[t[2*n],t[2*n+1],t[2*r],t[2*r+1]],a=1e-8*Math.sqrt(Math.pow(i[3]-i[1],2)+Math.pow(i[2]-i[0],2)),o=0,u=t.length/2;o<u;++o){var l=E(t[2*o],t[2*o+1],a);t[2*o]=l[0],t[2*o+1]=l[1]}this._delaunator=new s(t)}else delete this.collinear;for(var c=this.halfedges=this._delaunator.halfedges,f=this.hull=this._delaunator.hull,d=this.triangles=this._delaunator.triangles,h=this.inedges.fill(-1),p=this._hullIndex.fill(-1),v=0,m=c.length;v<m;++v){var g=d[v%3===2?v-2:v+1];-1!==c[v]&&-1!==h[g]||(h[g]=v)}for(var y=0,b=f.length;y<b;++y)p[f[y]]=y;f.length<=2&&f.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=f[0],this.triangles[1]=f[1],this.triangles[2]=f[1],h[f[0]]=1,2===f.length&&(h[f[1]]=0))}},{key:"voronoi",value:function(e){return new x(this,e)}},{key:"neighbors",value:r.mark(function e(t){var n,i,a,o,u,s,l,c,f,d;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.inedges,i=this.hull,a=this._hullIndex,o=this.halfedges,u=this.triangles,!this.collinear){e.next=10;break}if(!((s=this.collinear.indexOf(t))>0)){e.next=6;break}return e.next=6,this.collinear[s-1];case 6:if(!(s<this.collinear.length-1)){e.next=9;break}return e.next=9,this.collinear[s+1];case 9:return e.abrupt("return");case 10:if(-1!==(l=n[t])){e.next=13;break}return e.abrupt("return");case 13:c=l,f=-1;case 14:return e.next=16,f=u[c];case 16:if(u[c=c%3===2?c-2:c+1]===t){e.next=19;break}return e.abrupt("return");case 19:if(-1!==(c=o[c])){e.next=26;break}if((d=i[(a[t]+1)%i.length])===f){e.next=25;break}return e.next=25,d;case 25:return e.abrupt("return");case 26:if(c!==l){e.next=14;break}case 27:case"end":return e.stop()}},e,this)})},{key:"find",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((e=+e)!==e||(t=+t)!==t)return-1;for(var r,i=n;(r=this._step(n,e,t))>=0&&r!==n&&r!==i;)n=r;return r}},{key:"_step",value:function(e,t,n){var r=this.inedges,i=this.hull,a=this._hullIndex,o=this.halfedges,u=this.triangles,s=this.points;if(-1===r[e]||!s.length)return(e+1)%(s.length>>1);var l=e,c=Math.pow(t-s[2*e],2)+Math.pow(n-s[2*e+1],2),f=r[e],d=f;do{var h=u[d],p=Math.pow(t-s[2*h],2)+Math.pow(n-s[2*h+1],2);if(p<c&&(c=p,l=h),u[d=d%3===2?d-2:d+1]!==e)break;if(-1===(d=o[d])){if((d=i[(a[e]+1)%i.length])!==h&&Math.pow(t-s[2*d],2)+Math.pow(n-s[2*d+1],2)<c)return d;break}}while(d!==f);return l}},{key:"render",value:function(e){for(var t=null==e?e=new y:void 0,n=this.points,r=this.halfedges,i=this.triangles,a=0,o=r.length;a<o;++a){var u=r[a];if(!(u<a)){var s=2*i[a],l=2*i[u];e.moveTo(n[s],n[s+1]),e.lineTo(n[l],n[l+1])}}return this.renderHull(e),t&&t.value()}},{key:"renderPoints",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=null==e?e=new y:void 0,r=this.points,i=0,a=r.length;i<a;i+=2){var o=r[i],u=r[i+1];e.moveTo(o+t,u),e.arc(o,u,t,0,w)}return n&&n.value()}},{key:"renderHull",value:function(e){var t=null==e?e=new y:void 0,n=this.hull,r=this.points,i=2*n[0],a=n.length;e.moveTo(r[i],r[i+1]);for(var o=1;o<a;++o){var u=2*n[o];e.lineTo(r[u],r[u+1])}return e.closePath(),t&&t.value()}},{key:"hullPolygon",value:function(){var e=new b;return this.renderHull(e),e.value()}},{key:"renderTriangle",value:function(e,t){var n=null==t?t=new y:void 0,r=this.points,i=this.triangles,a=2*i[e*=3],o=2*i[e+1],u=2*i[e+2];return t.moveTo(r[a],r[a+1]),t.lineTo(r[o],r[o+1]),t.lineTo(r[u],r[u+1]),t.closePath(),n&&n.value()}},{key:"trianglePolygons",value:r.mark(function e(){var t,n,i;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.triangles,n=0,i=t.length/3;case 2:if(!(n<i)){e.next=8;break}return e.next=5,this.trianglePolygon(n);case 5:++n,e.next=2;break;case 8:case"end":return e.stop()}},e,this)})},{key:"trianglePolygon",value:function(e){var t=new b;return this.renderTriangle(e,t),t.value()}}]),e}();function C(e,t,n,r){for(var i=e.length,a=new Float64Array(2*i),o=0;o<i;++o){var u=e[o];a[2*o]=t.call(r,u,o,e),a[2*o+1]=n.call(r,u,o,e)}return a}function O(e,n,i,a){var o,u,s,l,c,f,d;return r.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:o=0,u=!0,s=!1,l=void 0,t.prev=4,c=e[Symbol.iterator]();case 6:if(u=(f=c.next()).done){t.next=16;break}return d=f.value,t.next=10,n.call(a,d,o,e);case 10:return t.next=12,i.call(a,d,o,e);case 12:++o;case 13:u=!0,t.next=6;break;case 16:t.next=22;break;case 18:t.prev=18,t.t0=t.catch(4),s=!0,l=t.t0;case 22:t.prev=22,t.prev=23,u||null==c.return||c.return();case 25:if(t.prev=25,!s){t.next=28;break}throw l;case 28:return t.finish(25);case 29:return t.finish(22);case 30:case"end":return t.stop()}},t,null,[[4,18,22,30],[23,,25,29]])}D.from=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:A,r=arguments.length>3?arguments[3]:void 0;return new D("length"in e?C(e,t,n,r):Float64Array.from(O(e,t,n,r)))},e.Delaunay=D,e.Voronoi=x,Object.defineProperty(e,"__esModule",{value:!0})}(t)},2890:function(e,t,n){!function(e,t,n,r,i,a){"use strict";var o=Math.PI/180,u=64,s=2048;function l(){var e,n,r,i,a,o,l,m=[256,256],g=h,y=[],b=Math.random,x={};function w(e,t,n){for(var r,i,a,o,u,s=t.x,l=t.y,c=Math.sqrt(m[0]*m[0]+m[1]*m[1]),d=g(m),h=b()<.5?1:-1,p=-h;(r=d(p+=h))&&(i=~~r[0],a=~~r[1],!(Math.min(Math.abs(i),Math.abs(a))>=c));)if(t.x=s+i,t.y=l+a,!(t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>m[0]||t.y+t.y1>m[1])&&(!n||!f(t,e,m[0]))&&(!n||(u=n,(o=t).x+o.x1>u[0].x&&o.x+o.x0<u[1].x&&o.y+o.y1>u[0].y&&o.y+o.y0<u[1].y))){for(var v,y=t.sprite,x=t.width>>5,w=m[0]>>5,k=t.x-(x<<4),A=127&k,E=32-A,D=t.y1-t.y0,C=(t.y+t.y0)*w+(k>>5),O=0;O<D;O++){v=0;for(var F=0;F<=x;F++)e[C+F]|=v<<E|(F<x?(v=y[O*x+F])>>>A:0);C+=w}return t.sprite=null,!0}return!1}return x.layout=function(){for(var f=function(e){e.width=e.height=1;var t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2);e.width=(u<<5)/t,e.height=s/t;var n=e.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:t}}(t.canvas()),h=function(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}((m[0]>>5)*m[1]),p=null,v=y.length,g=-1,x=[],k=y.map(function(t){return{text:e(t),font:n(t),style:i(t),weight:a(t),rotate:o(t),size:~~r(t),padding:l(t),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:t}}).sort(function(e,t){return t.size-e.size});++g<v;){var A=k[g];A.x=m[0]*(b()+.5)>>1,A.y=m[1]*(b()+.5)>>1,c(f,A,k,g),A.hasText&&w(h,A,p)&&(x.push(A),p?d(p,A):p=[{x:A.x+A.x0,y:A.y+A.y0},{x:A.x+A.x1,y:A.y+A.y1}],A.x-=m[0]>>1,A.y-=m[1]>>1)}return x},x.words=function(e){return arguments.length?(y=e,x):y},x.size=function(e){return arguments.length?(m=[+e[0],+e[1]],x):m},x.font=function(e){return arguments.length?(n=p(e),x):n},x.fontStyle=function(e){return arguments.length?(i=p(e),x):i},x.fontWeight=function(e){return arguments.length?(a=p(e),x):a},x.rotate=function(e){return arguments.length?(o=p(e),x):o},x.text=function(t){return arguments.length?(e=p(t),x):e},x.spiral=function(e){return arguments.length?(g=v[e]||e,x):g},x.fontSize=function(e){return arguments.length?(r=p(e),x):r},x.padding=function(e){return arguments.length?(l=p(e),x):l},x.random=function(e){return arguments.length?(b=e,x):b},x}function c(e,t,n,r){if(!t.sprite){var i=e.context,a=e.ratio;i.clearRect(0,0,(u<<5)/a,s/a);var l,c,f,d,h,p=0,v=0,m=0,g=n.length;for(--r;++r<g;){if(t=n[r],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/a)+"px "+t.font,l=i.measureText(t.text+"m").width*a,f=t.size<<1,t.rotate){var y=Math.sin(t.rotate*o),b=Math.cos(t.rotate*o),x=l*b,w=l*y,k=f*b,A=f*y;l=Math.max(Math.abs(x+A),Math.abs(x-A))+31>>5<<5,f=~~Math.max(Math.abs(w+k),Math.abs(w-k))}else l=l+31>>5<<5;if(f>m&&(m=f),p+l>=u<<5&&(p=0,v+=m,m=0),v+f>=s)break;i.translate((p+(l>>1))/a,(v+(f>>1))/a),t.rotate&&i.rotate(t.rotate*o),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=l,t.height=f,t.xoff=p,t.yoff=v,t.x1=l>>1,t.y1=f>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,p+=l}for(var E=i.getImageData(0,0,(u<<5)/a,s/a).data,D=[];--r>=0;)if((t=n[r]).hasText){for(c=(l=t.width)>>5,f=t.y1-t.y0,d=0;d<f*c;d++)D[d]=0;if(null==(p=t.xoff))return;v=t.yoff;var C=0,O=-1;for(h=0;h<f;h++){for(d=0;d<l;d++){var F=c*h+(d>>5),_=E[(v+h)*(u<<5)+(p+d)<<2]?1<<31-d%32:0;D[F]|=_,C|=_}C?O=h:(t.y0++,f--,h--,v++)}t.y1=t.y0+O,t.sprite=D.slice(0,(t.y1-t.y0)*c)}}}function f(e,t,n){n>>=5;for(var r,i=e.sprite,a=e.width>>5,o=e.x-(a<<4),u=127&o,s=32-u,l=e.y1-e.y0,c=(e.y+e.y0)*n+(o>>5),f=0;f<l;f++){r=0;for(var d=0;d<=a;d++)if((r<<s|(d<a?(r=i[f*a+d])>>>u:0))&t[c+d])return!0;c+=n}return!1}function d(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function h(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function p(e){return"function"===typeof e?e:function(){return e}}var v={archimedean:h,rectangular:function(e){var t=4*e[0]/e[1],n=0,r=0;return function(e){var i=e<0?-1:1;switch(Math.sqrt(1+4*i*e)-i&3){case 0:n+=t;break;case 1:r+=4;break;case 2:n-=t;break;default:r-=4}return[n,r]}}},m=["x","y","font","fontSize","fontStyle","fontWeight","angle"],g=["text","font","rotate","fontSize","fontStyle","fontWeight"];function y(e){n.Transform.call(this,l(),e)}y.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:m}]},r.inherits(y,n.Transform).transform=function(e,t){!e.size||e.size[0]&&e.size[1]||r.error("Wordcloud size dimensions must be non-zero.");var n=e.modified();if(n||t.changed(t.ADD_REM)||g.some(function(n){var i=e[n];return r.isFunction(i)&&t.modified(i.fields)})){var o,u=t.materialize(t.SOURCE).source,s=this.value,l=e.as||m,c=e.fontSize||14;if(r.isFunction(c)?o=e.fontSizeRange:c=r.constant(c),o){var f=c,d=i.scale("sqrt")().domain(function(e,t){for(var n,r=1/0,i=-1/0,a=0,o=t.length;a<o;++a)(n=e(t[a]))<r&&(r=n),n>i&&(i=n);return[r,i]}(f,u)).range(o);c=function(e){return d(f(e))}}u.forEach(function(e){e[l[0]]=NaN,e[l[1]]=NaN,e[l[3]]=0});for(var h,p,v=s.words(u).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(c).random(a.random).layout(),y=s.size(),b=y[0]>>1,x=y[1]>>1,w=0,k=v.length;w<k;++w)(p=(h=v[w]).datum)[l[0]]=h.x+b,p[l[1]]=h.y+x,p[l[2]]=h.font,p[l[3]]=h.size,p[l[4]]=h.style,p[l[5]]=h.weight,p[l[6]]=h.rotate;return t.reflow(n).modifies(l)}},e.wordcloud=y,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(2072),n(1476),n(1469),n(1624),n(1623))},2891:function(e,t,n){!function(e,t,n,r){"use strict";function i(e){return new Uint8Array(e)}function a(e){return new Uint16Array(e)}function o(e){return new Uint32Array(e)}function u(e,t,n){var r=(t<257?i:t<65537?a:o)(e);return n&&r.set(n),r}function s(e,t,n){var r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd:function(e,t){var n,i=this.bisect(this.range,e.value),a=e.index,o=i[0],u=i[1],s=a.length;for(n=0;n<o;++n)t[a[n]]|=r;for(n=u;n<s;++n)t[a[n]]|=r;return this}}}function l(){var e=o(0),n=[],r=0;return{insert:function(i,a,u){if(!a.length)return[];var s,l,c,f,d,h=r,p=a.length,v=Array(p),m=o(p);for(c=0;c<p;++c)v[c]=i(a[c]),m[c]=c;if(d=m,(f=v).sort.call(d,function(e,t){var n=f[e],r=f[t];return n<r?-1:n>r?1:0}),v=t.permute(f,d),h)s=n,l=e,n=Array(h+p),e=o(h+p),function(e,t,n,r,i,a,o,u,s){var l,c=0,f=0;for(l=0;c<r&&f<o;++l)t[c]<i[f]?(u[l]=t[c],s[l]=n[c++]):(u[l]=i[f],s[l]=a[f++]+e);for(;c<r;++c,++l)u[l]=t[c],s[l]=n[c];for(;f<o;++f,++l)u[l]=i[f],s[l]=a[f]+e}(u,s,l,h,v,m,p,n,e);else{if(u>0)for(c=0;c<p;++c)m[c]+=u;n=v,e=m}return r=h+p,{index:m,value:v}},remove:function(t,i){var a,o,u,s=r;for(o=0;!i[e[o]]&&o<s;++o);for(u=o;o<s;++o)i[a=e[o]]||(e[u]=a,n[u]=n[o],++u);r=s-t},bisect:function(e,i){var a;return i?a=i.length:(i=n,a=r),[t.bisectLeft(i,e[0],0,a),t.bisectRight(i,e[1],0,a)]},reindex:function(t){for(var n=0,i=r;n<i;++n)e[n]=t[e[n]]},index:function(){return e},size:function(){return r}}}function c(e){n.Transform.call(this,function(){var e=8,t=[],n=o(0),r=u(0,e),i=u(0,e);return{data:function(){return t},seen:function(){return n=function(e,t,n){return e.length>=t?e:((n=n||new e.constructor(t)).set(e),n)}(n,t.length)},add:function(e){for(var n,r=0,i=t.length,a=e.length;r<a;++r)(n=e[r])._index=i++,t.push(n)},remove:function(e,n){var a,o,u,s=t.length,l=Array(s-e),c=t;for(o=0;!n[o]&&o<s;++o)l[o]=t[o],c[o]=o;for(u=o;o<s;++o)a=t[o],n[o]?c[o]=-1:(c[o]=u,r[u]=r[o],i[u]=i[o],l[u]=a,a._index=u++),r[o]=0;return t=l,c},size:function(){return t.length},curr:function(){return r},prev:function(){return i},reset:function(e){i[e]=r[e]},all:function(){return e<257?255:e<65537?65535:4294967295},set:function(e,t){r[e]|=t},clear:function(e,t){r[e]&=~t},resize:function(t,n){(t>r.length||n>e)&&(e=Math.max(n,e),r=u(t,e,r),i=u(t,e))}}}(),e),this._indices=null,this._dims=null}c.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};var f=r.inherits(c,n.Transform);function d(e){n.Transform.call(this,null,e)}f.transform=function(e,t){return this._dims?e.modified("fields")||e.fields.some(function(e){return t.modified(e.fields)})?this.reinit(e,t):this.eval(e,t):this.init(e,t)},f.init=function(e,t){for(var n,r,i=e.fields,a=e.query,o=this._indices={},u=this._dims=[],c=a.length,f=0;f<c;++f)r=o[n=i[f].fname]||(o[n]=l()),u.push(s(r,f,a[f]));return this.eval(e,t)},f.reinit=function(e,t){var n,r,i,a,o,u,c,f,d,h=t.materialize().fork(),p=e.fields,v=e.query,m=this._indices,g=this._dims,y=this.value,b=y.curr(),x=y.prev(),w=y.all(),k=h.rem=h.add,A=h.mod,E=v.length,D={};if(x.set(b),t.rem.length&&(o=this.remove(e,t,h)),t.add.length&&y.add(t.add),t.mod.length)for(u={},c=0,f=(a=t.mod).length;c<f;++c)u[a[c]._index]=1;for(c=0;c<E;++c)d=p[c],(!g[c]||e.modified("fields",c)||t.modified(d.fields))&&((n=D[i=d.fname])||(m[i]=r=l(),D[i]=n=r.insert(d,t.source,0)),g[c]=s(r,c,v[c]).onAdd(n,b));for(c=0,f=y.data().length;c<f;++c)o[c]||(x[c]!==b[c]?k.push(c):u[c]&&b[c]!==w&&A.push(c));return y.mask=(1<<E)-1,h},f.eval=function(e,t){var n=t.materialize().fork(),r=this._dims.length,i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<r)-1),t.mod.length&&(this.modify(t,n),i|=(1<<r)-1),this.value.mask=i,n},f.insert=function(e,t,n){var r,i,a,o=t.add,u=this.value,s=this._dims,l=this._indices,c=e.fields,f={},d=n.add,h=u.size(),p=h+o.length,v=s.length;u.resize(p,v),u.add(o);var m=u.curr(),g=u.prev(),y=u.all();for(r=0;r<v;++r)a=f[i=c[r].fname]||(f[i]=l[i].insert(c[r],o,h)),s[r].onAdd(a,m);for(;h<p;++h)g[h]=y,m[h]!==y&&d.push(h)},f.modify=function(e,t){var n,r,i,a=t.mod,o=this.value,u=o.curr(),s=o.all(),l=e.mod;for(n=0,r=l.length;n<r;++n)u[i=l[n]._index]!==s&&a.push(i)},f.remove=function(e,t,n){var r,i,a,o,u=this._indices,s=this.value,l=s.curr(),c=s.prev(),f=s.all(),d={},h=n.rem,p=t.rem;for(r=0,i=p.length;r<i;++r)d[a=p[r]._index]=1,c[a]=o=l[a],l[a]=f,o!==f&&h.push(a);for(a in u)u[a].remove(i,d);return this.reindex(t,i,d),d},f.reindex=function(e,t,n){var r=this._indices,i=this.value;e.runAfter(function(){var e=i.remove(t,n);for(var a in r)r[a].reindex(e)})},f.update=function(e,t,n){var r,i,a=this._dims,o=e.query,u=t.stamp,s=a.length,l=0;for(n.filters=0,i=0;i<s;++i)e.modified("query",i)&&(r=i,++l);if(1===l)l=a[r].one,this.incrementOne(a[r],o[r],n.add,n.rem);else for(i=0,l=0;i<s;++i)e.modified("query",i)&&(l|=a[i].one,this.incrementAll(a[i],o[i],u,n.add),n.rem=n.add);return l},f.incrementAll=function(e,t,n,r){var i,a,o,u=this.value,s=u.seen(),l=u.curr(),c=u.prev(),f=e.index(),d=e.bisect(e.range),h=e.bisect(t),p=h[0],v=h[1],m=d[0],g=d[1],y=e.one;if(p<m)for(i=p,a=Math.min(m,v);i<a;++i)s[o=f[i]]!==n&&(c[o]=l[o],s[o]=n,r.push(o)),l[o]^=y;else if(p>m)for(i=m,a=Math.min(p,g);i<a;++i)s[o=f[i]]!==n&&(c[o]=l[o],s[o]=n,r.push(o)),l[o]^=y;if(v>g)for(i=Math.max(p,g),a=v;i<a;++i)s[o=f[i]]!==n&&(c[o]=l[o],s[o]=n,r.push(o)),l[o]^=y;else if(v<g)for(i=Math.max(m,v),a=g;i<a;++i)s[o=f[i]]!==n&&(c[o]=l[o],s[o]=n,r.push(o)),l[o]^=y;e.range=t.slice()},f.incrementOne=function(e,t,n,r){var i,a,o,u=this.value.curr(),s=e.index(),l=e.bisect(e.range),c=e.bisect(t),f=c[0],d=c[1],h=l[0],p=l[1],v=e.one;if(f<h)for(i=f,a=Math.min(h,d);i<a;++i)u[o=s[i]]^=v,n.push(o);else if(f>h)for(i=h,a=Math.min(f,p);i<a;++i)u[o=s[i]]^=v,r.push(o);if(d>p)for(i=Math.max(f,p),a=d;i<a;++i)u[o=s[i]]^=v,n.push(o);else if(d<p)for(i=Math.max(h,d),a=p;i<a;++i)u[o=s[i]]^=v,r.push(o);e.range=t.slice()},d.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},r.inherits(d,n.Transform).transform=function(e,t){var n=~(e.ignore||0),r=e.filter,i=r.mask;if(0===(i&n))return t.StopPropagation;var a=t.fork(t.ALL),o=r.data(),u=r.curr(),s=r.prev(),l=function(e){return u[e]&n?null:o[e]};return a.filter(a.MOD,l),i&i-1?(a.filter(a.ADD,function(e){var t=u[e]&n;return!t&&t^s[e]&n?o[e]:null}),a.filter(a.REM,function(e){var t=u[e]&n;return!t||t^t^s[e]&n?null:o[e]})):(a.filter(a.ADD,l),a.filter(a.REM,function(e){return(u[e]&n)===i?o[e]:null})),a.filter(a.SOURCE,function(e){return l(e._index)})},e.crossfilter=c,e.resolvefilter=d,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1508),n(1476),n(1469))},2892:function(e,t,n){var r=n(21),i=n(1622);!function(e,t,n,a,o,u,s,l){"use strict";var c="default";function f(e){var n=e._signals.cursor;n||(e._signals.cursor=n=e.add({user:c,item:null})),e.on(e.events("view","mousemove"),n,function(e,r){var i=n.value,a=i?t.isString(i)?i:i.user:c,o=r.item&&r.item.cursor||null;return i&&a===i.user&&o==i.item?i:{user:a,item:o}}),e.add(null,function(e){var n=e.cursor,r=this.value;return t.isString(n)||(r=n.item,n=n.user),function(e){"undefined"!==typeof document&&document.body&&(document.body.style.cursor=e)}(n&&n!==c?n:r||n),r},{cursor:n})}function d(e,n){var r=e._runtime.data;return t.hasOwnProperty(r,n)||t.error("Unrecognized data set: "+n),r[n]}function h(e,r){n.isChangeSet(r)||t.error("Second argument to changes must be a changeset.");var i=d(this,e);return i.modified=!0,this.pulse(i.input,r)}function p(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function v(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function m(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function g(e){var t=m(e),n=p(e),r=v(e);e._renderer.background(e._background),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach(function(t){try{t(n,r)}catch(i){e.error(i)}})}function y(e,n,r){var i,o,u,s=e._renderer,l=s&&s.canvas();return l&&(u=m(e),o=n.changedTouches?n.changedTouches[0]:n,(i=a.point(o,l))[0]-=u[0],i[1]-=u[1]),n.dataflow=e,n.item=r,n.vega=function(e,n,r){var i=n?"group"===n.mark.marktype?n:n.mark.group:null;function a(e){var t,r=i;if(e)for(t=n;t;t=t.mark.group)if(t.mark.name===e){r=t;break}return r&&r.mark&&r.mark.interactive?r:{}}function o(e){if(!e)return r;t.isString(e)&&(e=a(e));for(var n=r.slice();e;)n[0]-=e.x||0,n[1]-=e.y||0,e=e.mark&&e.mark.group;return n}return{view:t.constant(e),item:t.constant(n||{}),group:a,xy:o,x:function(e){return o(e)[0]},y:function(e){return o(e)[1]}}}(e,r,i),n}var b="view",x="timer",w="window",k={trap:!1};function A(e,n,r){var i=e._eventConfig&&e._eventConfig[n];return!(!1===i||t.isObject(i)&&!i[r])||(e.warn("Blocked ".concat(n," ").concat(r," event listener.")),!1)}function E(e){return e.item}function D(e){return e.item.mark.source}function C(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function O(e,t,n){var r=document.createElement(e);for(var i in t)r.setAttribute(i,t[i]);return null!=n&&(r.textContent=n),r}var F="vega-bind",_="vega-bind-name",S="vega-bind-radio",M="vega-option-";function j(e,n,r){if(n){var i=r.param,a=r.state;return a||(a=r.state={elements:null,active:!1,set:null,update:function(t){t!==e.signal(i.signal)&&e.runAsync(null,function(){a.source=!0,e.signal(i.signal,t)})}},i.debounce&&(a.update=t.debounce(i.debounce,a.update))),function(e,t,n,r){var i=O("div",{class:F});i.appendChild(O("span",{class:_},n.name||n.signal)),t.appendChild(i);var a=T;switch(n.input){case"checkbox":a=N;break;case"select":a=B;break;case"radio":a=R;break;case"range":a=z}a(e,i,n,r)}(a,n,i,e.signal(i.signal)),a.active||(e.on(e._signals[i.signal],null,function(){a.source?a.source=!1:a.set(e.signal(i.signal))}),a.active=!0),a}}function T(e,t,n,r){var i=O("input");for(var a in n)"signal"!==a&&"element"!==a&&i.setAttribute("input"===a?"type":a,n[a]);i.setAttribute("name",n.signal),i.value=r,t.appendChild(i),i.addEventListener("input",function(){e.update(i.value)}),e.elements=[i],e.set=function(e){i.value=e}}function N(e,t,n,r){var i={type:"checkbox",name:n.signal};r&&(i.checked=!0);var a=O("input",i);t.appendChild(a),a.addEventListener("change",function(){e.update(a.checked)}),e.elements=[a],e.set=function(e){a.checked=!!e||null}}function B(e,t,n,r){var i=O("select",{name:n.signal});n.options.forEach(function(e){var t={value:e};P(e,r)&&(t.selected=!0),i.appendChild(O("option",t,e+""))}),t.appendChild(i),i.addEventListener("change",function(){e.update(n.options[i.selectedIndex])}),e.elements=[i],e.set=function(e){for(var t=0,r=n.options.length;t<r;++t)if(P(n.options[t],e))return void(i.selectedIndex=t)}}function R(e,t,n,r){var i=O("span",{class:S});t.appendChild(i),e.elements=n.options.map(function(t){var a=M+n.signal+"-"+t,o={id:a,type:"radio",name:n.signal,value:t};P(t,r)&&(o.checked=!0);var u=O("input",o);return u.addEventListener("change",function(){e.update(t)}),i.appendChild(u),i.appendChild(O("label",{for:a},t+"")),u}),e.set=function(t){for(var n=e.elements,r=0,i=n.length;r<i;++r)P(n[r].value,t)&&(n[r].checked=!0)}}function z(e,t,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;var i=null!=n.max?n.max:Math.max(100,+r)||100,a=n.min||Math.min(0,i,+r)||0,u=n.step||o.tickStep(a,i,100),s=O("input",{type:"range",name:n.signal,min:a,max:i,step:u});s.value=r;var l=O("label",{},+r);function c(){l.textContent=s.value,e.update(+s.value)}t.appendChild(s),t.appendChild(l),s.addEventListener("input",c),s.addEventListener("change",c),e.elements=[s],e.set=function(e){s.value=e,l.textContent=e}}function P(e,t){return e===t||e+""===t+""}function L(e,t,n,r,i,a){return(t=t||new r(e.loader())).initialize(n,p(e),v(e),m(e),i,a).background(e._background)}function I(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function U(e,t){if("string"===typeof t){if("undefined"===typeof document)return e.error("DOM document instance not found."),null;if(!(t=document.querySelector(t)))return e.error("Signal bind element not found: "+t),null}if(t)try{t.innerHTML=""}catch(n){t=null,e.error(n)}return t}function q(e,t,n,r){return W.apply(this,arguments)}function W(){return(W=i(r.mark(function e(n,i,o,u){var s,l;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=a.renderModule(i),(l=s&&s.headless)||t.error("Unrecognized renderer type: "+i),e.next=4,n.runAsync();case 4:return e.abrupt("return",L(n,null,null,l,o,u).renderAsync(n._scenegraph.root));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function H(){return(H=i(r.mark(function e(n,i){var o;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n!==a.RenderType.Canvas&&n!==a.RenderType.SVG&&n!==a.RenderType.PNG&&t.error("Unrecognized image type: "+n),e.next=3,q(this,n,i);case 3:return o=e.sent,e.abrupt("return",n===a.RenderType.SVG?V(o.svg(),"image/svg+xml"):o.canvas().toDataURL("image/png"));case 5:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function V(e,t){var n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}function G(){return(G=i(r.mark(function e(t,n){var i;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q(this,a.RenderType.Canvas,t,n);case 2:return i=e.sent,e.abrupt("return",i.canvas());case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function $(){return($=i(r.mark(function e(t){var n;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q(this,a.RenderType.SVG,t);case 2:return n=e.sent,e.abrupt("return",n.svg());case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var Y="width",X="height",J="padding",Q={skip:!0};function K(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===J?r.left+r.right:0)}function Z(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===J?r.top+r.bottom:0)}function ee(e,n){return n.modified&&t.isArray(n.input.value)&&e.indexOf("_:vega:_")}function te(e,t){return!("parent"===e||t instanceof n.transforms.proxy)}function ne(e,n,r,i){var a=e.element();a&&a.setAttribute("title",function(e){return null==e?"":t.isArray(e)?re(e):t.isObject(e)&&!t.isDate(e)?(n=e,Object.keys(n).map(function(e){var r=n[e];return e+": "+(t.isArray(r)?re(r):ie(r))}).join("\n")):e+"";var n}(i))}function re(e){return"["+e.map(ie).join(", ")+"]"}function ie(e){return t.isArray(e)?"[\u2026]":t.isObject(e)&&!t.isDate(e)?"{\u2026}":e}function ae(e,r){r=r||{},n.Dataflow.call(this),r.loader&&this.loader(r.loader),r.logger&&this.logger(r.logger),null!=r.logLevel&&this.logLevel(r.logLevel),this._el=null,this._elBind=null,this._renderType=r.renderer||a.RenderType.Canvas,this._scenegraph=new a.Scenegraph;var i=this._scenegraph.root;this._renderer=null,this._tooltip=r.tooltip||ne,this._redraw=!0,this._handler=(new a.CanvasHandler).scene(i),this._preventDefault=!1,this._timers=[],this._eventListeners=[],this._resizeListeners=[],this._eventConfig=function(e){var n=t.extend({defaults:{}},e),r=function(e,n){n.forEach(function(n){t.isArray(e[n])&&(e[n]=t.toSet(e[n]))})};return r(n.defaults,["prevent","allow"]),r(n,["view","window","selector"]),n}(e.eventConfig);var o=function(e,t,r){var i=r||u.functionContext;return s.parse(t,s.context(e,n.transforms,i))}(this,e,r.functions);this._runtime=o,this._signals=o.signals,this._bind=(e.bindings||[]).map(function(e){return{state:null,param:t.extend({},e)}}),o.root&&o.root.set(i),i.source=o.data.root.input,this.pulse(o.data.root.input,this.changeset().insert(i.items)),this._background=r.background||o.background||null,this._width=this.width(),this._height=this.height(),this._viewWidth=K(this,this._width),this._viewHeight=Z(this,this._height),this._origin=[0,0],this._resize=0,this._autosize=1,function(e){var t=e._signals,n=t[Y],r=t[X],i=t[J];function a(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,function(t){e._width=t.size,e._viewWidth=K(e,t.size),a()},{size:n}),e._resizeHeight=e.add(null,function(t){e._height=t.size,e._viewHeight=Z(e,t.size),a()},{size:r});var o=e.add(null,a,{pad:i});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,o.rank=i.rank+1}(this),f(this),r.hover&&this.hover(),r.container&&this.initialize(r.container,r.bind)}var oe=t.inherits(ae,n.Dataflow);function ue(e,n){return t.hasOwnProperty(e._signals,n)?e._signals[n]:t.error("Unrecognized signal name: "+t.stringValue(n))}function se(e,t){var n=(e._targets||[]).filter(function(e){var n=e._update;return n&&n.handler===t});return n.length?n[0]:null}function le(e,t,n,r){var i=se(n,r);return i||((i=I(this,function(){r(t,n.value)})).handler=r,e.on(n,null,i)),e}function ce(e,t,n){var r=se(t,n);return r&&t._targets.remove(r),e}oe.evaluate=function(){var e=i(r.mark(function e(t,i,a){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.Dataflow.prototype.evaluate.call(this,t,i);case 2:if(!this._redraw&&!this._resize){e.next=14;break}if(e.prev=3,!this._renderer){e.next=8;break}return this._resize&&(this._resize=0,g(this)),e.next=8,this._renderer.renderAsync(this._scenegraph.root);case 8:this._redraw=!1,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),this.error(e.t0);case 14:return a&&n.asyncCallback(this,a),e.abrupt("return",this);case 16:case"end":return e.stop()}},e,this,[[3,11]])}));return function(t,n,r){return e.apply(this,arguments)}}(),oe.dirty=function(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},oe.container=function(){return this._el},oe.scenegraph=function(){return this._scenegraph},oe.origin=function(){return this._origin.slice()},oe.signal=function(e,t,n){var r=ue(this,e);return 1===arguments.length?r.value:this.update(r,t,n)},oe.background=function(e){return arguments.length?(this._background=e,this._resize=1,this):this._background},oe.width=function(e){return arguments.length?this.signal("width",e):this.signal("width")},oe.height=function(e){return arguments.length?this.signal("height",e):this.signal("height")},oe.padding=function(e){return arguments.length?this.signal("padding",e):this.signal("padding")},oe.autosize=function(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},oe.renderer=function(e){return arguments.length?(a.renderModule(e)||t.error("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},oe.tooltip=function(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},oe.loader=function(e){return arguments.length?(e!==this._loader&&(n.Dataflow.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},oe.resize=function(){return this._autosize=1,this.touch(ue(this,"autosize"))},oe._resetRenderer=function(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},oe._resizeView=function(e,t,n,r,i,a){this.runAfter(function(o){var u=0;o._autosize=0,o.width()!==n&&(u=1,o.signal(Y,n,Q),o._resizeWidth.skip(!0)),o.height()!==r&&(u=1,o.signal(X,r,Q),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),o._origin[0]===i[0]&&o._origin[1]===i[1]||(o._resize=1,o._origin=i),u&&o.run("enter"),a&&o.runAfter(function(e){return e.resize()})},!1,1)},oe.addEventListener=function(e,t,n){var r=t;return n&&!1===n.trap||((r=I(this,t)).raw=t),this._handler.on(e,r),this},oe.removeEventListener=function(e,t){for(var n,r,i=this._handler.handlers(e),a=i.length;--a>=0;)if(r=i[a].type,n=i[a].handler,e===r&&(t===n||t===n.raw)){this._handler.off(r,n);break}return this},oe.addResizeListener=function(e){var t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},oe.removeResizeListener=function(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},oe.addSignalListener=function(e,t){return le(this,e,ue(this,e),t)},oe.removeSignalListener=function(e,t){return ce(this,ue(this,e),t)},oe.addDataListener=function(e,t){return le(this,e,d(this,e).values,t)},oe.removeDataListener=function(e,t){return ce(this,d(this,e).values,t)},oe.preventDefault=function(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},oe.timer=function(e,t){this._timers.push(l.interval(function(t){e({timestamp:Date.now(),elapsed:t})},t))},oe.events=function(e,t,r){var i,a=this,o=new n.EventStream(r),u=function(n,r){a.runAsync(null,function(){e===b&&function(e,t){var n=e._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[t]:i?!i[t]:e.preventDefault()))}(a,t)&&n.preventDefault(),o.receive(y(a,n,r))})};if(e===x)A(a,"timer",t)&&a.timer(u,t);else if(e===b)A(a,"view",t)&&a.addEventListener(t,u,k);else if(e===w?A(a,"window",t)&&"undefined"!==typeof window&&(i=[window]):"undefined"!==typeof document&&A(a,"selector",t)&&(i=document.querySelectorAll(e)),i){for(var s=0,l=i.length;s<l;++s)i[s].addEventListener(t,u);a._eventListeners.push({type:t,sources:i,handler:u})}else a.warn("Can not resolve event source: "+e);return o},oe.finalize=function(){var e,t,n,r=this._tooltip,i=this._timers,a=this._eventListeners;for(e=i.length;--e>=0;)i[e].stop();for(e=a.length;--e>=0;)for(t=(n=a[e]).sources.length;--t>=0;)n.sources[t].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},oe.hover=function(e,t){return t=[t||"update",(e=[e||"hover"])[0]],this.on(this.events("view","mouseover",E),D,C(e)),this.on(this.events("view","mouseout",E),D,C(t)),this},oe.data=function(e,r){return arguments.length<2?d(this,e).values.value:h.call(this,e,n.changeset().remove(t.truthy).insert(r))},oe.change=h,oe.insert=function(e,t){return h.call(this,e,n.changeset().insert(t))},oe.remove=function(e,t){return h.call(this,e,n.changeset().remove(t))},oe.scale=function(e){var n=this._runtime.scales;return t.hasOwnProperty(n,e)||t.error("Unrecognized scale or projection: "+e),n[e].value},oe.initialize=function(e,t){var n,r,i=this,o=i._renderType,u=i._eventConfig.bind,s=a.renderModule(o);return e=i._el=e?U(i,e):null,s||i.error("Unrecognized renderer type: "+o),n=s.handler||a.CanvasHandler,r=e?s.renderer:s.headless,i._renderer=r?L(i,i._renderer,e,r):null,i._handler=function(e,t,n,r){var i=new r(e.loader(),I(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,m(e),e);return t&&t.handlers().forEach(function(e){i.on(e.type,e.handler)}),i}(i,i._handler,e,n),i._redraw=!0,e&&"none"!==u&&(t=t?i._elBind=U(i,t):e.appendChild(O("div",{class:"vega-bindings"})),i._bind.forEach(function(e){e.param.element&&"container"!==u&&(e.element=U(i,e.param.element))}),i._bind.forEach(function(e){j(i,e.element||t,e)})),i},oe.toImageURL=function(e,t){return H.apply(this,arguments)},oe.toCanvas=function(e,t){return G.apply(this,arguments)},oe.toSVG=function(e){return $.apply(this,arguments)},oe.getState=function(e){return this._runtime.getState(e||{data:ee,signals:te,recurse:!0})},oe.setState=function(e){return this.runAsync(null,function(t){t._trigger=!1,t._runtime.setState(e)},function(e){e._trigger=!0}),this},e.View=ae,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1469),n(1476),n(1693),n(1508),n(1798),n(2074),n(1575))},2893:function(e,t,n){!function(e,t,n){"use strict";var r="intersect",i="union",a="E",o="R",u="R-E",s="R-LE",l="R-RE",c="index:unit";function f(e,n){for(var r,i,c=n.fields,f=n.values,d=c.length,h=0;h<d;++h)if((i=c[h]).getter=t.field.getter||t.field(i.field),r=i.getter(e),t.isDate(r)&&(r=t.toNumber(r)),t.isDate(f[h])&&(f[h]=t.toNumber(f[h])),t.isDate(f[h][0])&&(f[h]=f[h].map(t.toNumber)),i.type===a){if(t.isArray(f[h])?f[h].indexOf(r)<0:r!==f[h])return!1}else if(i.type===o){if(!t.inrange(r,f[h]))return!1}else if(i.type===l){if(!t.inrange(r,f[h],!0,!1))return!1}else if(i.type===u){if(!t.inrange(r,f[h],!1,!1))return!1}else if(i.type===s&&!t.inrange(r,f[h],!1,!0))return!1;return!0}var d={E_union:function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e},E_intersect:function(e,t){return e.length?e.filter(function(e){return t.indexOf(e)>=0}):t},R_union:function(e,n){var r=t.toNumber(n[0]),i=t.toNumber(n[1]);return r>i&&(r=n[1],i=n[0]),e.length?(e[0]>r&&(e[0]=r),e[1]<i&&(e[1]=i),e):[r,i]},R_intersect:function(e,n){var r=t.toNumber(n[0]),i=t.toNumber(n[1]);return r>i&&(r=n[1],i=n[0]),e.length?i<e[0]||e[1]<r?[]:(e[0]<r&&(e[0]=r),e[1]>i&&(e[1]=i),e):[r,i]}},h=":",p="@";e.selectionResolve=function(e,n){for(var r,a,o,u,s,l,c,f,h,p,v,m=this.context.data[e],g=m?m.values.value:[],y={},b={},x=g.length,w=0;w<x;++w)for(u=(r=g[w]).unit,a=r.fields,o=r.values,p=0,v=a.length;p<v;++p)s=a[p],c=(l=y[s.field]||(y[s.field]={}))[u]||(l[u]=[]),b[s.field]=f=s.type.charAt(0),h=d[f+"_union"],l[u]=h(c,t.array(o[p]));return n=n||i,Object.keys(y).forEach(function(e){y[e]=Object.keys(y[e]).map(function(t){return y[e][t]}).reduce(function(t,r){return void 0===t?r:d[b[e]+"_"+n](t,r)})}),y},e.selectionTest=function(e,t,n){for(var i,a,o,u,s,l=this.context.data[e],d=l?l.values.value:[],h=l?l[c]&&l[c].value:void 0,p=n===r,v=d.length,m=0;m<v;++m)if(i=d[m],h&&p){if(-1===(o=(a=a||{})[u=i.unit]||0))continue;if(s=f(t,i),a[u]=s?-1:++o,s&&1===h.size)return!0;if(!s&&o===h.get(u).count)return!1}else if(p^(s=f(t,i)))return s;return v&&p},e.selectionVisitor=function(e,i,a,o){i[0].type!==n.Literal&&t.error("First argument to selection functions must be a string literal.");var u=i[0].value,s=i.length>=2&&t.peek(i).value,l=p+"unit",c=h+u;s!==r||t.hasOwnProperty(o,l)||(o[l]=a.getData(u).indataRef(a,"unit")),t.hasOwnProperty(o,c)||(o[c]=a.getData(u).tuplesRef())},Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1469),n(1799))},2894:function(e,t,n){!function(e){"use strict";function t(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function n(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function r(){}var i="\\s*([+-]?\\d+)\\s*",a="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",o="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",u=/^#([0-9a-f]{3,8})$/,s=new RegExp("^rgb\\("+[i,i,i]+"\\)$"),l=new RegExp("^rgb\\("+[o,o,o]+"\\)$"),c=new RegExp("^rgba\\("+[i,i,i,a]+"\\)$"),f=new RegExp("^rgba\\("+[o,o,o,a]+"\\)$"),d=new RegExp("^hsl\\("+[a,o,o]+"\\)$"),h=new RegExp("^hsla\\("+[a,o,o,a]+"\\)$"),p={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function v(){return this.rgb().formatHex()}function m(){return this.rgb().formatRgb()}function g(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=u.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?y(t):3===n?new k(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?new k(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?new k(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=s.exec(e))?new k(t[1],t[2],t[3],1):(t=l.exec(e))?new k(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=c.exec(e))?b(t[1],t[2],t[3],t[4]):(t=f.exec(e))?b(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=d.exec(e))?C(t[1],t[2]/100,t[3]/100,1):(t=h.exec(e))?C(t[1],t[2]/100,t[3]/100,t[4]):p.hasOwnProperty(e)?y(p[e]):"transparent"===e?new k(NaN,NaN,NaN,0):null}function y(e){return new k(e>>16&255,e>>8&255,255&e,1)}function b(e,t,n,r){return r<=0&&(e=t=n=NaN),new k(e,t,n,r)}function x(e){return e instanceof r||(e=g(e)),e?new k((e=e.rgb()).r,e.g,e.b,e.opacity):new k}function w(e,t,n,r){return 1===arguments.length?x(e):new k(e,t,n,null==r?1:r)}function k(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function A(){return"#"+D(this.r)+D(this.g)+D(this.b)}function E(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function D(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function C(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new _(e,t,n,r)}function O(e){if(e instanceof _)return new _(e.h,e.s,e.l,e.opacity);if(e instanceof r||(e=g(e)),!e)return new _;if(e instanceof _)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,a=Math.min(t,n,i),o=Math.max(t,n,i),u=NaN,s=o-a,l=(o+a)/2;return s?(u=t===o?(n-i)/s+6*(n<i):n===o?(i-t)/s+2:(t-n)/s+4,s/=l<.5?o+a:2-o-a,u*=60):s=l>0&&l<1?0:u,new _(u,s,l,e.opacity)}function F(e,t,n,r){return 1===arguments.length?O(e):new _(e,t,n,null==r?1:r)}function _(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function S(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}t(r,g,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:v,formatHex:v,formatHsl:function(){return O(this).formatHsl()},formatRgb:m,toString:m}),t(k,w,n(r,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new k(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new k(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:A,formatHex:A,formatRgb:E,toString:E})),t(_,F,n(r,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new _(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new _(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new k(S(e>=240?e-240:e+120,i,r),S(e,i,r),S(e<120?e+240:e-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var M=Math.PI/180,j=180/Math.PI,T=.96422,N=1,B=.82521,R=4/29,z=6/29,P=3*z*z,L=z*z*z;function I(e){if(e instanceof q)return new q(e.l,e.a,e.b,e.opacity);if(e instanceof X)return J(e);e instanceof k||(e=x(e));var t,n,r=G(e.r),i=G(e.g),a=G(e.b),o=W((.2225045*r+.7168786*i+.0606169*a)/N);return r===i&&i===a?t=n=o:(t=W((.4360747*r+.3850649*i+.1430804*a)/T),n=W((.0139322*r+.0971045*i+.7141733*a)/B)),new q(116*o-16,500*(t-o),200*(o-n),e.opacity)}function U(e,t,n,r){return 1===arguments.length?I(e):new q(e,t,n,null==r?1:r)}function q(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function W(e){return e>L?Math.pow(e,1/3):e/P+R}function H(e){return e>z?e*e*e:P*(e-R)}function V(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function G(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function $(e){if(e instanceof X)return new X(e.h,e.c,e.l,e.opacity);if(e instanceof q||(e=I(e)),0===e.a&&0===e.b)return new X(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*j;return new X(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Y(e,t,n,r){return 1===arguments.length?$(e):new X(e,t,n,null==r?1:r)}function X(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function J(e){if(isNaN(e.h))return new q(e.l,0,0,e.opacity);var t=e.h*M;return new q(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}t(q,U,n(r,{brighter:function(e){return new q(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new q(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new k(V(3.1338561*(t=T*H(t))-1.6168667*(e=N*H(e))-.4906146*(n=B*H(n))),V(-.9787684*t+1.9161415*e+.033454*n),V(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),t(X,Y,n(r,{brighter:function(e){return new X(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new X(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return J(this).rgb()}}));var Q=-.14861,K=1.78277,Z=-.29227,ee=-.90649,te=1.97294,ne=te*ee,re=te*K,ie=K*Z-ee*Q;function ae(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof oe)return new oe(e.h,e.s,e.l,e.opacity);e instanceof k||(e=x(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(ie*r+ne*t-re*n)/(ie+ne-re),a=r-i,o=(te*(n-i)-Z*a)/ee,u=Math.sqrt(o*o+a*a)/(te*i*(1-i)),s=u?Math.atan2(o,a)*j-120:NaN;return new oe(s<0?s+360:s,u,i,e.opacity)}(e):new oe(e,t,n,null==r?1:r)}function oe(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}t(oe,ae,n(r,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new oe(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new oe(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*M,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new k(255*(t+n*(Q*r+K*i)),255*(t+n*(Z*r+ee*i)),255*(t+n*(te*r)),this.opacity)}})),e.color=g,e.cubehelix=ae,e.gray=function(e,t){return new q(e,0,0,null==t?1:t)},e.hcl=Y,e.hsl=F,e.lab=U,e.lch=function(e,t,n,r){return 1===arguments.length?$(e):new X(n,t,e,null==r?1:r)},e.rgb=w,Object.defineProperty(e,"__esModule",{value:!0})}(t)},2895:function(e,t,n){var r=n(135);!function(e,t,n,i,a,o,u){"use strict";function s(e){return+e||0}var l="outer",c=["value","update","init","react","bind"];function f(e,n){t.error(e+' for "outer" push: '+t.stringValue(n))}function d(e,t){var n=e.name;if(e.push===l)t.signals[n]||f("No prior signal definition",n),c.forEach(function(t){void 0!==e[t]&&f("Invalid property ",t)});else{var r=t.addSignal(n,e.value);!1===e.react&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function h(e,r,a){var o,u,s={};try{e=t.isString(e)?e:t.stringValue(e)+"",o=n.parse(e)}catch(l){t.error("Expression parse error: "+e)}return o.visit(function(e){if(e.type===n.CallExpression){var t=e.callee.name,a=i.codegenParams.visitors[t];a&&a(t,e.arguments,r,s)}}),(u=i.codeGenerator(o)).globals.forEach(function(e){var n=i.SignalPrefix+e;!t.hasOwnProperty(s,n)&&r.getSignal(e)&&(s[n]=r.signalRef(e))}),{$expr:a?a+"return("+u.code+");":u.code,$fields:u.fields,$params:s}}function p(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function v(e,t,n,r){return new p(e,t,n,r)}function m(e,t){return v("operator",e,t)}function g(e){var t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function y(e,t){return t?{$field:e,$name:t}:{$field:e}}var b=y("key");function x(e,t){return{$compare:e,$order:t}}var w="descending";function k(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}var A="scope",E="view";function D(e){return e&&e.signal}function C(e){if(D(e))return!0;if(t.isObject(e))for(var n in e)if(C(e[n]))return!0;return!1}function O(e,t){return null!=e?e:t}function F(e){return e&&e.signal||e}var _="timer";function S(e,n){return(e.merge?M:e.stream?j:e.type?T:t.error("Invalid stream specification: "+t.stringValue(e)))(e,n)}function M(e,t){var n=N({merge:e.merge.map(function(e){return S(e,t)})},e,t);return t.addStream(n).id}function j(e,t){var n=N({stream:S(e.stream,t)},e,t);return t.addStream(n).id}function T(e,t){var n,r,i;return e.type===_?(n=t.event(_,e.throttle),e={between:e.between,filter:e.filter}):n=t.event((i=e.source)===A?E:i||E,e.type),r=N({stream:n},e,t),1===Object.keys(r).length?n:t.addStream(r).id}function N(e,n,r){var i=n.between;return i&&(2!==i.length&&t.error('Stream "between" parameter must have 2 entries: '+t.stringValue(n)),e.between=[S(i[0],r),S(i[1],r)]),i=n.filter?[].concat(n.filter):[],(n.marktype||n.markname||n.markrole)&&i.push(function(e,t,n){var r="event.item";return r+(e&&"*"!==e?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}(n.marktype,n.markname,n.markrole)),n.source===A&&i.push("inScope(event.item)"),i.length&&(e.filter=h("("+i.join(")&&(")+")").$expr),null!=(i=n.throttle)&&(e.throttle=+i),null!=(i=n.debounce)&&(e.debounce=+i),n.consume&&(e.consume=!0),e}var B="var datum=event.item&&event.item.datum;";function R(e,n,r){var i=e.events,o=e.update,u=e.encode,s=[],l={target:r};i||t.error("Signal update missing events specification."),t.isString(i)&&(i=a.selector(i,n.isSubscope()?A:E)),i=t.array(i).filter(function(e){return e.signal||e.scale?(s.push(e),0):1}),s.length>1&&(s=[z(s)]),i.length&&s.push(i.length>1?{merge:i}:i[0]),null!=u&&(o&&t.error("Signal encode and update are mutually exclusive."),o="encode(item(),"+t.stringValue(u)+")"),l.update=t.isString(o)?h(o,n,B):null!=o.expr?h(o.expr,n,B):null!=o.value?o.value:null!=o.signal?{$expr:"_.value",$params:{value:n.signalRef(o.signal)}}:t.error("Invalid signal update specification."),e.force&&(l.options={force:!0}),s.forEach(function(e){n.addUpdate(t.extend(function(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):S(e,t)}}(e,n),l))})}function z(e){return{signal:"["+e.map(function(e){return e.scale?'scale("'+e.scale+'")':e.signal})+"]"}}function P(e,n){var r=n.getSignal(e.name),i=e.update;e.init&&(i?t.error("Signals can not include both init and update expressions."):(i=e.init,r.initonly=!0)),i&&(i=h(i,n),r.update=i.$expr,r.params=i.$params),e.on&&e.on.forEach(function(e){R(e,n,r.id)})}function L(e){return function(t,n,r){return v(e,n,t||void 0,r)}}var I=L("aggregate"),U=L("axisticks"),q=L("bound"),W=L("collect"),H=L("compare"),V=L("datajoin"),G=L("encode"),$=L("expression"),Y=L("facet"),X=L("field"),J=L("key"),Q=L("legendentries"),K=L("load"),Z=L("mark"),ee=L("multiextent"),te=L("multivalues"),ne=L("overlap"),re=L("params"),ie=L("prefacet"),ae=L("projection"),oe=L("proxy"),ue=L("relay"),se=L("render"),le=L("scale"),ce=L("sieve"),fe=L("sortitems"),de=L("viewlayout"),he=L("values"),pe=0,ve={min:"min",max:"max",count:"sum"};function me(e,n){var r,i,a=n.getScale(e.name).params;for(r in a.domain=xe(e.domain,e,n),null!=e.range&&(a.range=function e(n,r,i){var a=n.range,u=r.config.range;if(a.signal)return r.signalRef(a.signal);if(t.isString(a)){if(u&&t.hasOwnProperty(u,a))return n=t.extend({},n,{range:u[a]}),e(n,r,i);"width"===a?a=[0,{signal:"width"}]:"height"===a?a=o.isDiscrete(n.type)?[0,{signal:"height"}]:[{signal:"height"},0]:t.error("Unrecognized scale range value: "+t.stringValue(a))}else{if(a.scheme)return i.scheme=t.isArray(a.scheme)?ye(a.scheme,r):ge(a.scheme,r),a.extent&&(i.schemeExtent=ye(a.extent,r)),void(a.count&&(i.schemeCount=ge(a.count,r)));if(a.step)return void(i.rangeStep=ge(a.step,r));if(o.isDiscrete(n.type)&&!t.isArray(a))return xe(a,n,r);t.isArray(a)||t.error("Unsupported range type: "+t.stringValue(a))}return a.map(function(e){return(t.isArray(e)?ye:ge)(e,r)})}(e,n,a)),null!=e.interpolate&&function(e,t){t.interpolate=ge(e.type||e),null!=e.gamma&&(t.interpolateGamma=ge(e.gamma))}(e.interpolate,a),null!=e.nice&&(a.nice=(i=e.nice,t.isObject(i)?{interval:ge(i.interval),step:ge(i.step)}:ge(i))),null!=e.bins&&(a.bins=function(e,n){return e.signal||t.isArray(e)?ye(e,n):n.objectProperty(e)}(e.bins,n)),e)t.hasOwnProperty(a,r)||"name"===r||(a[r]=ge(e[r],n))}function ge(e,n){return t.isObject(e)?e.signal?n.signalRef(e.signal):t.error("Unsupported object: "+t.stringValue(e)):e}function ye(e,t){return e.signal?t.signalRef(e.signal):e.map(function(e){return ge(e,t)})}function be(e){t.error("Can not find data set: "+t.stringValue(e))}function xe(e,n,r){if(e)return e.signal?r.signalRef(e.signal):(t.isArray(e)?we:e.fields?Ae:ke)(e,n,r);null==n.domainMin&&null==n.domainMax||t.error("No scale domain defined for domainMin/domainMax to override.")}function we(e,t,n){return e.map(function(e){return ge(e,n)})}function ke(e,t,n){var r=n.getData(e.data);return r||be(e.data),o.isDiscrete(t.type)?r.valuesRef(n,e.field,De(e.sort,!1)):o.isQuantile(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function Ae(e,n,r){var i=e.data,a=e.fields.reduce(function(e,n){return n=t.isString(n)?{data:i,field:n}:t.isArray(n)||n.signal?function(e,n){var r="_:vega:_"+pe++,i=W({});if(t.isArray(e))i.value={$ingest:e};else if(e.signal){var a="setdata("+t.stringValue(r)+","+e.signal+")";i.params.input=n.signalRef(a)}return n.addDataPipeline(r,[i,ce({})]),{data:r,field:"data"}}(n,r):n,e.push(n),e},[]);return(o.isDiscrete(n.type)?Ee:o.isQuantile(n.type)?Ce:Oe)(e,r,a)}function Ee(e,t,n){var r,i,a,o,u,s=De(e.sort,!0);return r=n.map(function(e){var n=t.getData(e.data);return n||be(e.data),n.countsRef(t,e.field,s)}),i={groupby:b,pulse:r},s&&(a=s.op||"count",u=s.field?k(a,s.field):"count",i.ops=[ve[a]],i.fields=[t.fieldRef(u)],i.as=[u]),a=t.add(I(i)),o=t.add(W({pulse:g(a)})),u=t.add(he({field:b,sort:t.sortRef(s),pulse:g(o)})),g(u)}function De(e,n){return e&&(e.field||e.op?e.field||"count"===e.op?n&&e.field&&e.op&&!ve[e.op]&&t.error("Multiple domain scales can not be sorted using "+e.op):t.error("No field provided for sort aggregate op: "+e.op):t.isObject(e)?e.field="key":e={field:"key"}),e}function Ce(e,t,n){var r=n.map(function(e){var n=t.getData(e.data);return n||be(e.data),n.domainRef(t,e.field)});return g(t.add(te({values:r})))}function Oe(e,t,n){var r=n.map(function(e){var n=t.getData(e.data);return n||be(e.data),n.extentRef(t,e.field)});return g(t.add(ee({extents:r})))}function Fe(e,n,r){return t.isArray(e)?e.map(function(e){return Fe(e,n,r)}):t.isObject(e)?e.signal?r.signalRef(e.signal):"fit"===n?e:t.error("Unsupported parameter object: "+t.stringValue(e)):e}var _e="top",Se="left",Me="right",je="bottom",Te="vertical",Ne="start",Be="end",Re="index",ze="label",Pe="offset",Le="perc",Ie="perc2",Ue="size",qe="value",We="guide-label",He="guide-title",Ve="group-title",Ge="group-subtitle",$e="symbol",Ye="gradient",Xe="discrete",Je=["size","shape","fill","stroke","strokeWidth","strokeDash","opacity"],Qe={name:1,style:1,interactive:1},Ke={value:0},Ze={value:1},et=t.toSet(["rule"]),tt=t.toSet(["group","image","rect"]);function nt(e,n,r,i){var a=h(e,n);return a.$fields.forEach(function(e){i[e]=1}),t.extend(r,a.$params),a.$expr}function rt(e,n,r,i){return function e(n,r,i,a){var o,u,s;if(n.signal)o="datum",s=nt(n.signal,r,i,a);else if(n.group||n.parent){for(u=Math.max(1,n.level||1),o="item";u-- >0;)o+=".mark.group";n.parent?(s=n.parent,o+=".datum"):s=n.group}else n.datum?(o="datum",s=n.datum):t.error("Invalid field reference: "+t.stringValue(n));return n.signal||(t.isString(s)?(a[s]=1,s=t.splitAccessPath(s).map(t.stringValue).join("][")):s=e(s,r,i,a)),o+"["+s+"]"}(t.isObject(e)?e:{datum:e},n,r,i)}function it(e,n,r,i,a){var o,u,s,l=at(e.scale,r,i,a);return null!=e.range?(u=l+".range()",n=0===(o=+e.range)?u+"[0]":"($="+u+","+(1===o?"$[$.length-1]":"$[0]+"+o+"*($[$.length-1]-$[0])")+")"):(void 0!==n&&(n=l+"("+n+")"),e.band&&(s=function(e,n){if(!t.isString(e))return-1;var r=n.scaleType(e);return"band"===r||"point"===r?1:0}(e.scale,r))&&(o=(u=l+".bandwidth")+"()"+(1===(o=+e.band)?"":"*"+o),s<0&&(o="("+u+"?"+o+":0)"),n=(n?n+"+":"")+o,e.extra&&(n="(datum.extra?"+l+"(datum.extra.value):"+n+")")),null==n&&(n="0")),n}function at(e,n,r,a){var o;if(t.isString(e))o=i.ScalePrefix+e,t.hasOwnProperty(r,o)||(r[o]=n.scaleRef(e)),o=t.stringValue(o);else{for(o in n.scales)r[i.ScalePrefix+o]=n.scaleRef(o);o=t.stringValue(i.ScalePrefix)+"+"+(e.signal?"("+nt(e.signal,n,r,a)+")":rt(e,n,r,a))}return"_["+o+"]"}function ot(e,n,r,i){return t.isObject(e)?"("+ut(0,e,n,r,i)+")":e}function ut(e,n,r,i,a){if(null!=n.gradient)return function(e,n,r,i){return"this.gradient("+at(e.gradient,n,r,i)+","+t.stringValue(e.start)+","+t.stringValue(e.stop)+","+t.stringValue(e.count)+")"}(n,r,i,a);var o=n.signal?nt(n.signal,r,i,a):n.color?function(e,t,n,r){function i(e,i,a,o){return"this."+e+"("+[ut(0,i,t,n,r),ut(0,a,t,n,r),ut(0,o,t,n,r)].join(",")+").toString()"}return e.c?i("hcl",e.h,e.c,e.l):e.h||e.s?i("hsl",e.h,e.s,e.l):e.l||e.a?i("lab",e.l,e.a,e.b):e.r||e.g||e.b?i("rgb",e.r,e.g,e.b):null}(n.color,r,i,a):null!=n.field?rt(n.field,r,i,a):void 0!==n.value?t.stringValue(n.value):void 0;return null!=n.scale&&(o=it(n,o,r,i,a)),void 0===o&&(o=null),null!=n.exponent&&(o="Math.pow("+o+","+ot(n.exponent,r,i,a)+")"),null!=n.mult&&(o+="*"+ot(n.mult,r,i,a)),null!=n.offset&&(o+="+"+ot(n.offset,r,i,a)),n.round&&(o="Math.round("+o+")"),o}function st(e,n,r){var i=e+"["+t.stringValue(n)+"]";return"$=".concat(r,";if(").concat(i,"!==$)").concat(i,"=$,m=1;")}function lt(e,n,r,i,a){var o="";return n.forEach(function(e){var t=ut(0,e,r,i,a);o+=e.test?nt(e.test,r,i,a)+"?"+t+":":t}),":"===t.peek(o)&&(o+="null"),st("o",e,o)}function ct(e,n,r,i){var a,o,u={},s="var o=item,datum=o.datum,m=0,$;";for(a in e)o=e[a],t.isArray(o)?s+=lt(a,o,i,r,u):s+=st("o",a,ut(0,o,i,r,u));return s+=function(e,t){var n="";return et[t]?n:(e.x2&&(e.x?(tt[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(tt[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;"),n)}(e,n),{$expr:s+="return m;",$fields:Object.keys(u),$output:Object.keys(e)}}var ft="mark",dt="frame",ht="scope",pt="axis",vt="axis-domain",mt="axis-grid",gt="axis-label",yt="axis-tick",bt="axis-title",xt="legend",wt="legend-band",kt="legend-entry",At="legend-gradient",Et="legend-label",Dt="legend-symbol",Ct="legend-title",Ot="title",Ft="title-text",_t="title-subtitle";function St(e){return t.isObject(e)&&!t.isArray(e)?t.extend({},e):{value:e}}function Mt(e,n,r,i){return null!=r?(t.isObject(r)&&!t.isArray(r)?e.update[n]=r:e[i||"enter"][n]={value:r},1):0}function jt(e,t,n){for(var r in t)Mt(e,r,t[r]);for(var i in n)Mt(e,i,n[i],"update")}function Tt(e,n,r){for(var i in n)r&&t.hasOwnProperty(r,i)||(e[i]=t.extend(e[i]||{},n[i]));return e}function Nt(e,n,r,i,a,o){var u,s;for(s in(o=o||{}).encoders={$encode:u={}},e=function(e,n,r,i,a){var o,u,s,l={},c={};for(u in"legend"!=r&&0!==String(r).indexOf("axis")||(r=null),s=r===dt?a.group:r===ft?t.extend({},a.mark,a[n]):null)Rt(u,e)||("fill"===u||"stroke"===u)&&(Rt("fill",e)||Rt("stroke",e))||Bt(l,u,s[u]);for(u in t.array(i).forEach(function(t){var n=a.style&&a.style[t];for(var r in n)Rt(r,e)||Bt(l,r,n[r])}),e=t.extend({},e),l)(s=l[u]).signal?(o=o||{})[u]=s:c[u]=s;return e.enter=t.extend(c,e.enter),o&&(e.update=t.extend(o,e.update)),e}(e,n,r,i,a.config))u[s]=ct(e[s],n,o,a);return o}function Bt(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}function Rt(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}function zt(e,t,n,r,i,a,o){return{type:e,name:o?o.name:void 0,role:t,style:o&&o.style||n,key:r,from:i,interactive:!(!o||!o.interactive),encode:Tt(a,o,Qe)}}function Pt(e,t){var n=function(n){return O(e[n],t[n])};return n.isVertical=function(n){return Te===O(e.direction,t.direction||(n?t.symbolDirection:t.gradientDirection))},n.gradientLength=function(){return O(e.gradientLength,t.gradientLength||t.gradientWidth)},n.gradientThickness=function(){return O(e.gradientThickness,t.gradientThickness||t.gradientHeight)},n.entryColumns=function(){return O(e.columns,O(t.columns,+n.isVertical(!0)))},n}function Lt(e,t){var n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function It(e,t,n){return'item.anchor === "'.concat(Ne,'" ? ').concat(e,' : item.anchor === "').concat(Be,'" ? ').concat(t," : ").concat(n)}var Ut=It(t.stringValue(Se),t.stringValue(Me),t.stringValue("center")),qt="group",Wt="rect",Ht="rule",Vt="symbol",Gt="text";function $t(e,n,r,i){var a,o,u,s,l,c,f=Pt(e,r),d=f.isVertical(),h=f.gradientThickness(),p=f.gradientLength();return d?(u=[0,1],s=[0,0],l=h,c=p):(u=[0,0],s=[1,0],l=p,c=h),jt(a={enter:o={opacity:Ke,x:Ke,y:Ke,width:St(l),height:St(c)},update:t.extend({},o,{opacity:Ze,fill:{gradient:n,start:u,stop:s}}),exit:{opacity:Ke}},{stroke:f("gradientStrokeColor"),strokeWidth:f("gradientStrokeWidth")},{opacity:f("gradientOpacity")}),zt(Wt,At,null,void 0,void 0,a,i)}function Yt(e,n,r,i,a){var o,u,s,l,c,f,d=Pt(e,r),h=d.isVertical(),p=d.gradientThickness(),v=d.gradientLength(),m="";return h?(s="y",c="y2",l="x",f="width",m="1-"):(s="x",c="x2",l="y",f="height"),(u={opacity:Ke,fill:{scale:n,field:qe}})[s]={signal:m+"datum."+Le,mult:v},u[l]=Ke,u[c]={signal:m+"datum."+Ie,mult:v},u[f]=St(p),jt(o={enter:u,update:t.extend({},u,{opacity:Ze}),exit:{opacity:Ke}},{stroke:d("gradientStrokeColor"),strokeWidth:d("gradientStrokeWidth")},{opacity:d("gradientOpacity")}),zt(Wt,wt,null,qe,a,o,i)}var Xt="datum.".concat(Le,'<=0?"').concat(Se,'":datum.').concat(Le,'>=1?"').concat(Me,'":"').concat("center",'"'),Jt="datum.".concat(Le,'<=0?"').concat(je,'":datum.').concat(Le,'>=1?"').concat(_e,'":"').concat("middle",'"');function Qt(e,t,n,r){var i,a,o,u,s,l=Pt(e,t),c=l.isVertical(),f=St(l.gradientThickness()),d=l.gradientLength(),h=l("labelOverlap"),p=l("labelSeparation"),v="";return jt(i={enter:a={opacity:Ke},update:o={opacity:Ze,text:{field:ze}},exit:{opacity:Ke}},{fill:l("labelColor"),fillOpacity:l("labelOpacity"),font:l("labelFont"),fontSize:l("labelFontSize"),fontStyle:l("labelFontStyle"),fontWeight:l("labelFontWeight"),limit:O(e.labelLimit,t.gradientLabelLimit)}),c?(a.align={value:"left"},a.baseline=o.baseline={signal:Jt},u="y",s="x",v="1-"):(a.align=o.align={signal:Xt},a.baseline={value:"top"},u="x",s="y"),a[u]=o[u]={signal:v+"datum."+Le,mult:d},a[s]=o[s]=f,f.offset=O(e.labelOffset,t.gradientLabelOffset)||0,e=zt(Gt,Et,We,qe,r,i,n),h&&(e.overlap={separation:p,method:h,order:"datum."+Re}),e}function Kt(e,t,n,r,i,a,o,u){return{type:qt,name:n,role:e,style:t,from:r,interactive:i||!1,encode:a,marks:o,layout:u}}function Zt(e,t,n,r,i){var a,o,u,s,l,c,f,d=Pt(e,t),h=n.entries,p=!(!h||!h.interactive),v=h?h.name:void 0,m=d("clipHeight"),g=d("symbolOffset"),y={data:"value"},b={},x="".concat(i," ? datum.").concat(Pe," : datum.").concat(Ue),w=m?St(m):{field:Ue},k="datum.".concat(Re),A="max(1, ".concat(i,")");return w.mult=.5,b={enter:a={opacity:Ke,x:{signal:x,mult:.5,offset:g},y:w},update:o={opacity:Ze,x:a.x,y:a.y},exit:{opacity:Ke}},e.fill||jt(b,{fill:t.symbolBaseFillColor,stroke:t.symbolBaseStrokeColor}),jt(b,{fill:d("symbolFillColor"),shape:d("symbolType"),size:d("symbolSize"),stroke:d("symbolStrokeColor"),strokeDash:d("symbolDash"),strokeDashOffset:d("symbolDashOffset"),strokeWidth:d("symbolStrokeWidth")},{opacity:d("symbolOpacity")}),Je.forEach(function(t){e[t]&&(o[t]=a[t]={scale:e[t],field:qe})}),s=zt(Vt,Dt,null,qe,y,b,n.symbols),m&&(s.clip=!0),(u=St(g)).offset=d("labelOffset"),jt(b={enter:a={opacity:Ke,x:{signal:x,offset:u},y:w},update:o={opacity:Ze,text:{field:ze},x:a.x,y:a.y},exit:{opacity:Ke}},{align:d("labelAlign"),baseline:d("labelBaseline"),fill:d("labelColor"),fillOpacity:d("labelOpacity"),font:d("labelFont"),fontSize:d("labelFontSize"),fontStyle:d("labelFontStyle"),fontWeight:d("labelFontWeight"),limit:d("labelLimit")}),l=zt(Gt,Et,We,qe,y,b,n.labels),b={enter:{noBound:{value:!m},width:Ke,height:m?St(m):Ke,opacity:Ke},exit:{opacity:Ke},update:o={opacity:Ze,row:{signal:null},column:{signal:null}}},d.isVertical(!0)?(c="ceil(item.mark.items.length / ".concat(A,")"),o.row.signal="".concat(k,"%").concat(c),o.column.signal="floor(".concat(k," / ").concat(c,")"),f={field:["row",k]}):(o.row.signal="floor(".concat(k," / ").concat(A,")"),o.column.signal="".concat(k," % ").concat(A),f={field:k}),o.column.signal="".concat(i,"?").concat(o.column.signal,":").concat(k),(e=Kt(ht,null,v,r={facet:{data:r,name:"value",groupby:Re}},p,Tt(b,h,Qe),[s,l])).sort=f,e}var en='item.orient === "left"',tn='item.orient === "right"',nn="(".concat(en," || ").concat(tn,")"),rn="datum.vgrad && ".concat(nn),an=It('"top"','"bottom"','"middle"'),on=It('"right"','"left"','"center"'),un="datum.vgrad && ".concat(tn," ? (").concat(on,") : (").concat(nn," && !(datum.vgrad && ").concat(en,')) ? "left" : ').concat(Ut),sn="item._anchor || (".concat(nn,' ? "middle" : "start")'),ln="".concat(rn," ? (").concat(en," ? -90 : 90) : 0"),cn="".concat(nn," ? (datum.vgrad ? (").concat(tn,' ? "bottom" : "top") : ').concat(an,') : "top"');function fn(e,n){var r;return t.isObject(e)&&(e.signal?r=e.signal:e.path?r="pathShape("+dn(e.path)+")":e.sphere&&(r="geoShape("+dn(e.sphere)+', {type: "Sphere"})')),r?n.signalRef(r):!!e}function dn(e){return t.isObject(e)&&e.signal?e.signal:t.stringValue(e)}function hn(e){var t=e.role||"";return t.indexOf("axis")&&t.indexOf("legend")&&t.indexOf("title")?e.type===qt?ht:t||ft:t}function pn(e){return{marktype:e.type,name:e.name||void 0,role:e.role||hn(e),zindex:+e.zindex||void 0}}function vn(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e}function mn(e,n){var r=u.definition(e.type);r||t.error("Unrecognized transform type: "+t.stringValue(e.type));var i=v(r.type.toLowerCase(),null,gn(r,e,n));return e.signal&&n.addSignal(e.signal,n.proxy(i)),i.metadata=r.metadata||{},i}function gn(e,t,n){var r,i,a,o={};for(i=0,a=e.params.length;i<a;++i)o[(r=e.params[i]).name]=yn(r,t,n);return o}function yn(e,n,r){var i=e.type,a=n[e.name];return"index"===i?function(e,n,r){return t.isString(n.from)||t.error('Lookup "from" parameter must be a string literal.'),r.getData(n.from).lookupRef(r,n.key)}(0,n,r):void 0!==a?"param"===i?function(e,n,r){var i=n[e.name];return e.array?(t.isArray(i)||t.error("Expected an array of sub-parameters. Instead: "+t.stringValue(i)),i.map(function(t){return xn(e,t,r)})):xn(e,i,r)}(e,n,r):"projection"===i?r.projectionRef(n[e.name]):e.array&&!D(a)?a.map(function(t){return bn(e,t,r)}):bn(e,a,r):void(e.required&&t.error("Missing required "+t.stringValue(n.type)+" parameter: "+t.stringValue(e.name)))}function bn(e,n,r){var i=e.type;if(D(n))return wn(i)?t.error("Expression references can not be signals."):kn(i)?r.fieldRef(n):An(i)?r.compareRef(n):r.signalRef(n.signal);var a,o=e.expr||kn(i);return o&&(a=n)&&a.expr?r.exprRef(n.expr,n.as):o&&function(e){return e&&e.field}(n)?y(n.field,n.as):wn(i)?h(n,r):function(e){return"data"===e}(i)?g(r.getData(n).values):kn(i)?y(n):An(i)?r.compareRef(n):n}function xn(e,n,r){var i,a,o,u,s;for(u=0,s=e.params.length;u<s;++u){for(o in(a=e.params[u]).key)if(a.key[o]!==n[o]){a=null;break}if(a)break}return a||t.error("Unsupported parameter: "+t.stringValue(n)),i=t.extend(gn(a,n,r),a.key),g(r.add(re(i)))}function wn(e){return"expr"===e}function kn(e){return"field"===e}function An(e){return"compare"===e}function En(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:g(t.getData(e.data).output)}function Dn(e,t,n,r,i){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=i,this.index={}}Dn.fromEntries=function(e,t){var n=t.length,r=1,i=t[0],a=t[n-1],o=t[n-2],u=null;for(i&&"load"===i.type&&(i=t[1]),e.add(t[0]);r<n;++r)t[r].params.pulse=g(t[r-1]),e.add(t[r]),"aggregate"===t[r].type&&(u=t[r]);return new Dn(e,i,o,a,u)};var Cn=Dn.prototype;function On(e){return t.isString(e)?e:null}function Fn(e,t,n){var r,i=k(n.op,n.field);if(t.ops){for(var a=0,o=t.as.length;a<o;++a)if(t.as[a]===i)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(i))}function _n(e,n,r,i,a,o,u){var s,l,c=n[r]||(n[r]={}),f=function(e){return t.isObject(e)?(e.order===w?"-":"+")+k(e.op,e.field):""}(o),d=On(a);if(null!=d&&(e=n.scope,s=c[d+=f?"|"+f:""]),!s){var h=o?{field:b,pulse:n.countsRef(e,a,o)}:{field:e.fieldRef(a),pulse:g(n.output)};f&&(h.sort=e.sortRef(o)),l=e.add(v(i,void 0,h)),u&&(n.index[a]=l),s=g(l),null!=d&&(c[d]=s)}return s}function Sn(e,t,n){var r,i=e.remove,a=e.insert,o=e.toggle,u=e.modify,s=e.values,l=t.add(m());r=h("if("+e.trigger+',modify("'+n+'",'+[a,i,o,u,s].map(function(e){return null==e?"null":e}).join(",")+"),0)",t),l.update=r.$expr,l.params=r.$params}function Mn(e,n){var r,i,a,o,u,s,l,c,f,d,h,p,v,m,b=hn(e),x=e.type===qt,w=e.from&&e.from.facet,k=e.layout||b===ht||b===dt,A=b===ft||k||w,E=e.overlap;a=function(e,n,r){var i,a,o,u,s;return e?(i=e.facet)&&(n||t.error("Only group marks can be faceted."),null!=i.field?u=s=En(i,r):(e.data?s=g(r.getData(e.data).aggregate):((o=mn(t.extend({type:"aggregate",groupby:t.array(i.groupby)},i.aggregate),r)).params.key=r.keyRef(i.groupby),o.params.pulse=En(i,r),u=s=g(r.add(o))),a=r.keyRef(i.groupby,!0))):u=g(r.add(W(null,[{}]))),u||(u=En(e,r)),{key:a,pulse:u,parent:s}}(e.from,x,n),d=g(i=n.add(V({key:a.key||(e.key?y(e.key):void 0),pulse:a.pulse,clean:!x}))),i=o=n.add(W({pulse:d})),i=n.add(Z({markdef:pn(e),interactive:vn(e.interactive,n),clip:fn(e.clip,n),context:{$context:!0},groups:n.lookup(),parent:n.signals.parent?n.signalRef("parent"):null,index:n.markpath(),pulse:g(i)})),h=g(i),(i=u=n.add(G(Nt(e.encode,e.type,b,e.style,n,{mod:!1,pulse:h})))).params.parent=n.encode(),e.transform&&e.transform.forEach(function(e){var r=mn(e,n),a=r.metadata;(a.generates||a.changes)&&t.error("Mark transforms should not generate new data."),a.nomod||(u.params.mod=!0),r.params.pulse=g(i),n.add(i=r)}),e.sort&&(i=n.add(fe({sort:n.compareRef(e.sort),pulse:g(i)}))),p=g(i),(w||k)&&(v=g(k=n.add(de({layout:n.objectProperty(e.layout),legends:n.legends,mark:h,pulse:p})))),m=g(s=n.add(q({mark:h,pulse:v||p}))),x&&(A&&((r=n.operators).pop(),k&&r.pop()),n.pushState(p,v||m,d),w?function(e,n,r){var i,a,o,u,s=e.from.facet,l=s.name,c=En(s,n);s.name||t.error("Facet must have a name: "+t.stringValue(s)),s.data||t.error("Facet must reference a data set: "+t.stringValue(s)),s.field?u=n.add(ie({field:n.fieldRef(s.field),pulse:c})):s.groupby?u=n.add(Y({key:n.keyRef(s.groupby),group:g(n.proxy(r.parent)),pulse:c})):t.error("Facet must specify groupby or field: "+t.stringValue(s)),a=(i=n.fork()).add(W()),o=i.add(ce({pulse:g(a)})),i.addData(l,new Dn(i,a,a,o)),i.addSignal("parent",null),u.params.subflow={$subflow:Wn(e,i).toRuntime()}}(e,n,a):A?function(e,t,n){var r=t.add(ie({pulse:n.pulse})),i=t.fork();i.add(ce()),i.addSignal("parent",null),r.params.subflow={$subflow:Wn(e,i).toRuntime()}}(e,n,a):Wn(e,n),n.popState(),A&&(k&&r.push(k),r.push(s))),E&&(m=function(e,t,n){var r,i=e.method,a=e.bound,o=e.separation,u={separation:D(o)?n.signalRef(o.signal):o,method:D(i)?n.signalRef(i.signal):i,pulse:t};return e.order&&(u.sort=n.compareRef({field:e.order})),a&&(r=a.tolerance,u.boundTolerance=D(r)?n.signalRef(r.signal):+r,u.boundScale=n.scaleRef(a.scale),u.boundOrient=a.orient),g(n.add(ne(u)))}(E,m,n)),l=n.add(se({pulse:m})),c=n.add(ce({pulse:g(l)},void 0,n.parent())),null!=e.name&&(f=e.name,n.addData(f,new Dn(n,o,l,c)),e.on&&e.on.forEach(function(e){(e.insert||e.remove||e.toggle)&&t.error("Marks only support modify triggers."),Sn(e,n,f)}))}function jn(e,n){var r,i,a,u,s,l,c,f,d,p=n.config.legend,v=e.encode||{},m=v.legend||{},y=m.name||void 0,b=m.interactive,x=m.style,w=Pt(e,p),k=Je.reduce(function(t,n){return t||e[n]},0);return k||t.error("Missing valid scale for legend."),s=function(e,t){var n=e.type||$e;return e.type||1!==function(e){return Je.reduce(function(t,n){return t+(e[n]?1:0)},0)}(e)||!e.fill&&!e.stroke||(n=o.isContinuous(t)?Ye:o.isDiscretizing(t)?Xe:$e),n!==Ye?n:o.isDiscretizing(t)?Xe:Ye}(e,n.scaleType(k)),l={title:null!=e.title,type:s,vgrad:"symbol"!==s&&w.isVertical()},c=g(n.add(W(null,[l]))),m=Tt(function(e,t){var n={enter:{},update:{}};return jt(n,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:t.strokeWidth,strokeDash:t.strokeDash,x:e("legendX"),y:e("legendY")}),n}(w,p),m,Qe),r={enter:{x:{value:0},y:{value:0}}},f=g(n.add(Q(a={type:s,scale:n.scaleRef(k),count:n.objectProperty(w("tickCount")),limit:n.property(w("symbolLimit")),values:n.objectProperty(e.values),minstep:n.property(e.tickMinStep),formatType:n.property(e.formatType),formatSpecifier:n.property(e.format)}))),s===Ye?(u=[$t(e,k,p,v.gradient),Qt(e,p,v.labels,f)],a.count=a.count||n.signalRef("max(2,2*floor((".concat(F(w.gradientLength()),")/100))"))):s===Xe?u=[Yt(e,k,p,v.gradient,f),Qt(e,p,v.labels,f)]:(i=function(e,t){var n=Pt(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(e,p),u=[Zt(e,p,v,f,F(i.columns))],a.size=function(e,t,n){var r=F(Tn("size",e,n)),i=F(Tn("strokeWidth",e,n)),a=F(function(e,t,n){return Lt("fontSize",e)||function(e,t,n){var r=t.config.style[n];return r&&r[e]}("fontSize",t,n)}(n[1].encode,t,We));return h("max(ceil(sqrt(".concat(r,")+").concat(i,"),").concat(a,")"),t)}(e,n,u[0].marks)),u=[Kt(kt,null,null,c,b,r,u,i)],l.title&&u.push(function(e,t,n,r){var i,a=Pt(e,t);return jt(i={enter:{opacity:Ke},update:{opacity:Ze,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Ke}},{orient:a("titleOrient"),_anchor:a("titleAnchor"),anchor:{signal:sn},angle:{signal:ln},align:{signal:un},baseline:{signal:cn},text:e.title,fill:a("titleColor"),fillOpacity:a("titleOpacity"),font:a("titleFont"),fontSize:a("titleFontSize"),fontStyle:a("titleFontStyle"),fontWeight:a("titleFontWeight"),limit:a("titleLimit"),lineHeight:a("titleLineHeight")},{align:a("titleAlign"),baseline:a("titleBaseline")}),zt(Gt,Ct,He,null,r,i,n)}(e,p,v.title,c)),d=Kt(xt,x,y,c,b,m,u),e.zindex&&(d.zindex=e.zindex),Mn(d,n)}function Tn(e,t,n){return t[e]?'scale("'.concat(t[e],'",datum)'):Lt(e,n[0].encode)}Cn.countsRef=function(e,t,n){var r,i,a,o=this.counts||(this.counts={}),u=On(t);return null!=u&&(e=this.scope,r=o[u]),r?n&&n.field&&Fn(e,r.agg.params,n):(a={groupby:e.fieldRef(t,"key"),pulse:g(this.output)},n&&n.field&&Fn(e,a,n),i=e.add(I(a)),r=e.add(W({pulse:g(i)})),r={agg:i,ref:g(r)},null!=u&&(o[u]=r)),r.ref},Cn.tuplesRef=function(){return g(this.values)},Cn.extentRef=function(e,t){return _n(e,this,"extent","extent",t,!1)},Cn.domainRef=function(e,t){return _n(e,this,"domain","values",t,!1)},Cn.valuesRef=function(e,t,n){return _n(e,this,"vals","values",t,n||!0)},Cn.lookupRef=function(e,t){return _n(e,this,"lookup","tupleindex",t,!1)},Cn.indataRef=function(e,t){return _n(e,this,"indata","tupleindex",t,!0,!0)};var Nn='item.orient==="'.concat(Se,'"?-90:item.orient==="').concat(Me,'"?90:0');function Bn(e,n){var r,i,a=Pt(e=t.isString(e)?{text:e}:e,n.config.title),o=e.encode||{},u=o.group||{},s=u.name||void 0,l=u.interactive,c=u.style,f=[];return r=g(n.add(W(null,[{}]))),f.push(function(e,t,n,r){var i={value:0},a=e.text,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return jt(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),zt(Gt,Ft,Ve,null,r,o,n)}(e,a,function(e){var n=e.encode;return n&&n.title||t.extend({name:e.name,interactive:e.interactive,style:e.style},n)}(e),r)),e.subtitle&&f.push(function(e,t,n,r){var i={value:0},a=e.subtitle,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return jt(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),zt(Gt,_t,Ge,null,r,o,n)}(e,a,o.subtitle,r)),i=Kt(Ot,c,s,r,l,function(e,t){var n={enter:{},update:{}};return jt(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:Ut},angle:{signal:Nn},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),Tt(n,t,Qe)}(a,u),f),e.zindex&&(i.zindex=e.zindex),Mn(i,n)}function Rn(e,n){var r=[];e.transform&&e.transform.forEach(function(e){r.push(mn(e,n))}),e.on&&e.on.forEach(function(t){Sn(t,n,e.name)}),n.addDataPipeline(e.name,function(e,n,r){var i,a,o,u,s,l=[],c=null,f=!1,d=!1;for(e.values?C(e.values)||C(e.format)?(l.push(Pn(n,e)),l.push(c=zn())):l.push(c=zn({$ingest:e.values,$format:e.format})):e.url?C(e.url)||C(e.format)?(l.push(Pn(n,e)),l.push(c=zn())):l.push(c=zn({$request:e.url,$format:e.format})):e.source&&(c=i=t.array(e.source).map(function(e){return g(n.getData(e).output)}),l.push(null)),a=0,o=r.length;a<o;++a)u=r[a],s=u.metadata,c||s.source||l.push(c=zn()),l.push(u),s.generates&&(d=!0),s.modifies&&!d&&(f=!0),s.source?c=u:s.changes&&(c=null);return i&&(o=i.length-1,l[0]=ue({derive:f,pulse:o?i:i[0]}),(f||o)&&l.splice(1,0,zn())),c||l.push(zn()),l.push(ce({})),l}(e,n,r))}function zn(e){var t=W({},e);return t.metadata={source:!0},t}function Pn(e,t){return K({url:t.url?e.property(t.url):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}function Ln(e,t){return{scale:e.scale,range:t}}function In(e,n,r,i){var a,o,u,s,l,c,f,d,h,p=Pt(e,n),v=e.orient,m=e.gridScale,g=v===Se||v===_e?1:-1,y=function(e,n){if(1===n);else if(t.isObject(e)){for(var r=e=t.extend({},e);null!=r.mult;){if(!t.isObject(r.mult))return r.mult*=n,e;r=r.mult=t.extend({},r.mult)}r.mult=n}else e=n*(e||0);return e}(e.offset,g);return jt(a={enter:o={opacity:Ke},update:s={opacity:Ze},exit:u={opacity:Ke}},{stroke:p("gridColor"),strokeDash:p("gridDash"),strokeDashOffset:p("gridDashOffset"),strokeOpacity:p("gridOpacity"),strokeWidth:p("gridWidth")}),l={scale:e.scale,field:qe,band:p("bandPosition"),round:p("tickRound"),extra:p("tickExtra"),offset:p("tickOffset")},v===_e||v===je?(c="x",f="y",h="height"):(c="y",f="x",h="width"),d=f+"2",s[c]=o[c]=u[c]=l,m?(s[f]=o[f]={scale:m,range:0,mult:g,offset:y},s[d]=o[d]={scale:m,range:1,mult:g,offset:y}):(s[f]=o[f]={value:0,offset:y},s[d]=o[d]={signal:h,mult:g,offset:y}),zt(Ht,mt,null,qe,i,a,r)}function Un(e,t,n,r,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+i+")"}}function qn(e,n){var i,a,o,u,s,l,c=function(e,n){var r=n.config,i=e.orient,a=i===_e||i===je?r.axisX:r.axisY,o=r["axis"+i[0].toUpperCase()+i.slice(1)],u="band"===n.scaleType(e.scale)&&r.axisBand;return a||o||u?t.extend({},r.axis,a,o,u):r.axis}(e,n),f=e.encode||{},d=f.axis||{},h=d.name||void 0,p=d.interactive,v=d.style,m=Pt(e,c);return i={orient:e.orient,ticks:!!m("ticks"),labels:!!m("labels"),grid:!!m("grid"),domain:!!m("domain"),title:null!=e.title},a=g(n.add(W({},[i]))),d=Tt({update:{offset:St(m("offset")||0),position:St(O(e.position,0)),titlePadding:St(m("titlePadding")),minExtent:St(m("minExtent")),maxExtent:St(m("maxExtent")),range:{signal:'abs(span(range("'.concat(e.scale,'")))')}}},f.axis,Qe),o=g(n.add(U({scale:n.scaleRef(e.scale),extra:n.property(m("tickExtra")),count:n.objectProperty(e.tickCount),values:n.objectProperty(e.values),minstep:n.property(e.tickMinStep),formatType:n.property(e.formatType),formatSpecifier:n.property(e.format)}))),l=[],i.grid&&l.push(In(e,c,f.grid,o)),i.ticks&&(u=m("tickSize"),l.push(function(e,t,n,r,i){var a,o,u,s,l,c,f=Pt(e,t),d=e.orient,h=d===Se||d===_e?-1:1;return jt(a={enter:o={opacity:Ke},update:s={opacity:Ze},exit:u={opacity:Ke}},{stroke:f("tickColor"),strokeDash:f("tickDash"),strokeDashOffset:f("tickDashOffset"),strokeOpacity:f("tickOpacity"),strokeWidth:f("tickWidth")}),(l=St(i)).mult=h,c={scale:e.scale,field:qe,band:f("bandPosition"),round:f("tickRound"),extra:f("tickExtra"),offset:f("tickOffset")},d===_e||d===je?(s.y=o.y=Ke,s.y2=o.y2=l,s.x=o.x=u.x=c):(s.x=o.x=Ke,s.x2=o.x2=l,s.y=o.y=u.y=c),zt(Ht,yt,null,qe,r,a,n)}(e,c,f.ticks,o,u))),i.labels&&(u=i.ticks?u:0,l.push(function(e,t,n,i,a){var o,u,s,l,c,f,d,h,p,v,m,g=Pt(e,t),y=e.orient,b=y===Se||y===_e?-1:1,x=y===_e||y===je,w=e.scale,k=F(g("labelFlush")),A=F(g("labelFlushOffset")),E=0===k||!!k,D=g("labelAlign"),C=g("labelBaseline");return(l=St(a)).mult=b,l.offset=St(g("labelPadding")||0),l.offset.mult=b,c={scale:w,field:qe,band:.5,offset:g("tickOffset")},x?(f=D||(E?Un(w,k,'"left"','"right"','"center"'):"center"),d=C||(y===_e?"bottom":"top"),h=!D):(f=D||(y===Me?"left":"right"),d=C||(E?Un(w,k,'"top"','"bottom"','"middle"'):"middle"),h=!C),h=h&&E&&A?Un(w,k,"-("+A+")",A,0):null,jt(u={enter:s={opacity:Ke,x:x?c:l,y:x?l:c},update:{opacity:Ze,text:{field:ze},x:s.x,y:s.y},exit:{opacity:Ke,x:s.x,y:s.y}},(r(o={},x?"dx":"dy",h),r(o,"align",f),r(o,"baseline",d),r(o,"angle",g("labelAngle")),r(o,"fill",g("labelColor")),r(o,"fillOpacity",g("labelOpacity")),r(o,"font",g("labelFont")),r(o,"fontSize",g("labelFontSize")),r(o,"fontWeight",g("labelFontWeight")),r(o,"fontStyle",g("labelFontStyle")),r(o,"limit",g("labelLimit")),o)),p=g("labelBound"),v=g("labelOverlap"),m=g("labelSeparation"),e=zt(Gt,gt,We,qe,i,u,n),(v||p)&&(e.overlap={separation:m,method:v,order:"datum.index",bound:p?{scale:w,orient:y,tolerance:p}:null}),e}(e,c,f.labels,o,u))),i.domain&&l.push(function(e,t,n,r){var i,a,o,u,s,l,c=Pt(e,t),f=e.orient;return jt(i={enter:a={opacity:Ke},update:o={opacity:Ze},exit:{opacity:Ke}},{stroke:c("domainColor"),strokeDash:c("domainDash"),strokeDashOffset:c("domainDashOffset"),strokeWidth:c("domainWidth"),strokeOpacity:c("domainOpacity")}),f===_e||f===je?(u="x",l="y"):(u="y",l="x"),s=u+"2",a[l]=Ke,o[u]=a[u]=Ln(e,0),o[s]=a[s]=Ln(e,1),zt(Ht,vt,null,null,r,i,n)}(e,c,f.domain,a)),i.title&&l.push(function(e,n,r,i){var a,o,u,s,l=Pt(e,n),c=e.orient,f=c===Se||c===_e?-1:1,d=c===_e||c===je;return a={enter:o={opacity:Ke,anchor:St(l("titleAnchor")),align:{signal:Ut}},update:u=t.extend({},o,{opacity:Ze,text:St(e.title)}),exit:{opacity:Ke}},s={signal:'lerp(range("'.concat(e.scale,'"), ').concat(It(0,1,.5),")")},d?(u.x=s,o.angle={value:0},o.baseline={value:c===_e?"bottom":"top"}):(u.y=s,o.angle={value:90*f},o.baseline={value:"bottom"}),jt(a,{angle:l("titleAngle"),baseline:l("titleBaseline"),fill:l("titleColor"),fillOpacity:l("titleOpacity"),font:l("titleFont"),fontSize:l("titleFontSize"),fontStyle:l("titleFontStyle"),fontWeight:l("titleFontWeight"),limit:l("titleLimit"),lineHeight:l("titleLineHeight")},{align:l("titleAlign")}),!Mt(a,"x",l("titleX"),"update")&&!d&&!Rt("x",r)&&(a.enter.auto={value:!0}),!Mt(a,"y",l("titleY"),"update")&&d&&!Rt("y",r)&&(a.enter.auto={value:!0}),zt(Gt,bt,He,null,i,a,r)}(e,c,f.title,a)),s=Kt(pt,v,h,a,p,d,l),e.zindex&&(s.zindex=e.zindex),Mn(s,n)}function Wn(e,n,r){var i=t.array(e.signals),a=t.array(e.scales);return r||i.forEach(function(e){return d(e,n)}),t.array(e.projections).forEach(function(e){return function(e,t){var n=t.config.projection||{},r={};for(var i in e)"name"!==i&&(r[i]=Fe(e[i],i,t));for(i in n)null==r[i]&&(r[i]=Fe(n[i],i,t));t.addProjection(e.name,r)}(e,n)}),a.forEach(function(e){return function(e,n){var r=e.type||"linear";o.isValidScaleType(r)||t.error("Unrecognized scale type: "+t.stringValue(r)),n.addScale(e.name,{type:r,domain:void 0})}(e,n)}),t.array(e.data).forEach(function(e){return Rn(e,n)}),a.forEach(function(e){return me(e,n)}),(r||i).forEach(function(e){return P(e,n)}),t.array(e.axes).forEach(function(e){return qn(e,n)}),t.array(e.marks).forEach(function(e){return Mn(e,n)}),t.array(e.legends).forEach(function(e){return jn(e,n)}),e.title&&Bn(e.title,n),n.parseLambdas(),n}var Hn=t.toSet(["width","height","padding","autosize"]);function Vn(e,n){var r,i,a,o,u,l,c=n.config;return n.background=e.background||c.background,n.eventConfig=c.events,u=g(n.root=n.add(m())),n.addSignal("width",e.width||0),n.addSignal("height",e.height||0),n.addSignal("padding",function(e,n){return e=e||n.padding,t.isObject(e)?{top:s(e.top),bottom:s(e.bottom),left:s(e.left),right:s(e.right)}:{top:r=s(e),bottom:r,left:r,right:r};var r}(e.padding,c)),n.addSignal("autosize",function(e,n){return e=e||n.autosize,t.isObject(e)?e:{type:e||"pad"}}(e.autosize,c)),n.legends=n.objectProperty(c.legend&&c.legend.layout),l=function(e,n,r){if(t.array(n).forEach(function(t){Hn[t.name]||d(t,e)}),!r)return n;var i=t.array(n).slice();return t.array(r).forEach(function(t){e.hasOwnSignal(t.name)||(d(t,e),i.push(t))}),i}(n,e.signals,c.signals),i=n.add(W()),a=Tt({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e.encode),a=n.add(G(Nt(a,qt,dt,e.style,n,{pulse:g(i)}))),o=n.add(de({layout:n.objectProperty(e.layout),legends:n.legends,autosize:n.signalRef("autosize"),mark:u,pulse:g(a)})),n.operators.pop(),n.pushState(g(a),g(o),null),Wn(e,n,l),n.operators.push(o),r=n.add(q({mark:u,pulse:g(o)})),r=n.add(se({pulse:g(r)})),r=n.add(ce({pulse:g(r)})),n.addData("root",new Dn(n,i,i,r)),n}function Gn(e){this.config=e,this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.background=null,this.eventConfig=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function $n(e){this.config=e.config,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}var Yn=Gn.prototype=$n.prototype;function Xn(e){return(t.isArray(e)?Jn:Qn)(e)}function Jn(e){for(var n,r="[",i=0,a=e.length;i<a;++i)n=e[i],r+=(i>0?",":"")+(t.isObject(n)?n.signal||Xn(n):t.stringValue(n));return r+"]"}function Qn(e){var n,r,i="{",a=0;for(n in e)r=e[n],i+=(++a>1?",":"")+t.stringValue(n)+":"+(t.isObject(r)?r.signal||Xn(r):t.stringValue(r));return i+"}"}Yn.fork=function(){return new $n(this)},Yn.isSubscope=function(){return this._subid>0},Yn.toRuntime=function(){return this.finish(),{background:this.background,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig}},Yn.id=function(){return(this._subid?this._subid+":":0)+this._id++},Yn.add=function(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(function(t){t.$ref=e.id}),e.refs=null),e},Yn.proxy=function(e){var t=e instanceof p?g(e):e;return this.add(oe({value:t}))},Yn.addStream=function(e){return this.streams.push(e),e.id=this.id(),e},Yn.addUpdate=function(e){return this.updates.push(e),e},Yn.finish=function(){var e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(e,t,n){var r;e&&((r=e.data||(e.data={}))[t]||(r[t]=[])).push(n)}for(e in this.data)for(var r in n((t=this.data[e]).input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values"),t.index)n(t.index[r],e,"index:"+r);return this},Yn.pushState=function(e,t,n){this._encode.push(g(this.add(ce({pulse:e})))),this._parent.push(t),this._lookup.push(n?g(this.proxy(n)):null),this._markpath.push(-1)},Yn.popState=function(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},Yn.parent=function(){return t.peek(this._parent)},Yn.encode=function(){return t.peek(this._encode)},Yn.lookup=function(){return t.peek(this._lookup)},Yn.markpath=function(){var e=this._markpath;return++e[e.length-1]},Yn.fieldRef=function(e,n){if(t.isString(e))return y(e,n);e.signal||t.error("Unsupported field reference: "+t.stringValue(e));var r,i=e.signal,a=this.field[i];return a||(r={name:this.signalRef(i)},n&&(r.as=n),this.field[i]=a=g(this.add(X(r)))),a},Yn.compareRef=function(e){function n(e){return D(e)?(i=!0,r.signalRef(e.signal)):function(e){return e&&e.expr}(e)?(i=!0,r.exprRef(e.expr)):e}var r=this,i=!1,a=t.array(e.field).map(n),o=t.array(e.order).map(n);return i?g(this.add(H({fields:a,orders:o}))):x(a,o)},Yn.keyRef=function(e,n){var r=this.signals,i=!1;return e=t.array(e).map(function(e){return D(e)?(i=!0,g(r[e.signal])):e}),i?g(this.add(J({fields:e,flat:n}))):function(e,t){var n={$key:e};return t&&(n.$flat=!0),n}(e,n)},Yn.sortRef=function(e){if(!e)return e;var t=k(e.op,e.field),n=e.order||"ascending";return n.signal?g(this.add(H({fields:t,orders:this.signalRef(n.signal)}))):x(t,n)},Yn.event=function(e,t){var n=e+":"+t;if(!this.events[n]){var r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},Yn.hasOwnSignal=function(e){return t.hasOwnProperty(this.signals,e)},Yn.addSignal=function(e,n){this.hasOwnSignal(e)&&t.error("Duplicate signal name: "+t.stringValue(e));var r=n instanceof p?n:this.add(m(n));return this.signals[e]=r},Yn.getSignal=function(e){return this.signals[e]||t.error("Unrecognized signal name: "+t.stringValue(e)),this.signals[e]},Yn.signalRef=function(e){return this.signals[e]?g(this.signals[e]):(t.hasOwnProperty(this.lambdas,e)||(this.lambdas[e]=this.add(m(null))),g(this.lambdas[e]))},Yn.parseLambdas=function(){for(var e=Object.keys(this.lambdas),t=0,n=e.length;t<n;++t){var r=e[t],i=h(r,this),a=this.lambdas[r];a.params=i.$params,a.update=i.$expr}},Yn.property=function(e){return e&&e.signal?this.signalRef(e.signal):e},Yn.objectProperty=function(e){return e&&t.isObject(e)?this.signalRef(e.signal||Xn(e)):e},Yn.exprRef=function(e,t){var n={expr:h(e,this)};return t&&(n.expr.$name=t),g(this.add($(n)))},Yn.addBinding=function(e,n){this.bindings||t.error("Nested signals do not support binding: "+t.stringValue(e)),this.bindings.push(t.extend({signal:e},n))},Yn.addScaleProj=function(e,n){t.hasOwnProperty(this.scales,e)&&t.error("Duplicate scale or projection name: "+t.stringValue(e)),this.scales[e]=this.add(n)},Yn.addScale=function(e,t){this.addScaleProj(e,le(t))},Yn.addProjection=function(e,t){this.addScaleProj(e,ae(t))},Yn.getScale=function(e){return this.scales[e]||t.error("Unrecognized scale name: "+t.stringValue(e)),this.scales[e]},Yn.projectionRef=Yn.scaleRef=function(e){return g(this.getScale(e))},Yn.projectionType=Yn.scaleType=function(e){return this.getScale(e).params.type},Yn.addData=function(e,n){return t.hasOwnProperty(this.data,e)&&t.error("Duplicate data set name: "+t.stringValue(e)),this.data[e]=n},Yn.getData=function(e){return this.data[e]||t.error("Undefined data set name: "+t.stringValue(e)),this.data[e]},Yn.addDataPipeline=function(e,n){return t.hasOwnProperty(this.data,e)&&t.error("Duplicate data set name: "+t.stringValue(e)),this.addData(e,Dn.fromEntries(this,n))};var Kn="sans-serif",Zn=30,er=2,tr="#4c78a8",nr="#000",rr="#888",ir="#ddd";function ar(){return{padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:tr},area:{fill:tr},image:null,line:{stroke:tr,strokeWidth:er},path:{stroke:tr},rect:{fill:tr},rule:{stroke:nr},shape:{stroke:tr},symbol:{fill:tr,size:64},text:{fill:nr,font:Kn,fontSize:11},style:{"guide-label":{fill:nr,font:Kn,fontSize:10},"guide-title":{fill:nr,font:Kn,fontSize:11,fontWeight:"bold"},"group-title":{fill:nr,font:Kn,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:nr,font:Kn,fontSize:12},point:{size:Zn,strokeWidth:er,shape:"circle"},circle:{size:Zn,strokeWidth:er},square:{size:Zn,strokeWidth:er,shape:"square"},cell:{fill:"transparent",stroke:ir}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:rr,grid:!1,gridWidth:1,gridColor:ir,labels:!0,labelAngle:0,labelLimit:180,labelPadding:2,ticks:!0,tickColor:rr,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-1},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:ir,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:rr,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}e.AxisDomainRole=vt,e.AxisGridRole=mt,e.AxisLabelRole=gt,e.AxisRole=pt,e.AxisTickRole=yt,e.AxisTitleRole=bt,e.DataScope=Dn,e.FrameRole=dt,e.LegendEntryRole=kt,e.LegendLabelRole=Et,e.LegendRole=xt,e.LegendSymbolRole=Dt,e.LegendTitleRole=Ct,e.MarkRole=ft,e.Scope=Gn,e.ScopeRole=ht,e.config=ar,e.parse=function(e,n){return t.isObject(e)||t.error("Input Vega specification must be an object."),Vn(e,new Gn(n=t.mergeConfig(ar(),n,e.config))).toRuntime()},e.signal=d,e.signalUpdates=P,e.stream=S,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1469),n(1799),n(1798),n(2896),n(1624),n(1476))},2896:function(e,t,n){!function(e){"use strict";var t,n,r="view",i="[",a="]",o="{",u="}",s=":",l=",",c="@",f=">",d=/[[\]{}]/,h={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function p(e,t,n,r,i){for(var a,o=0,u=e.length;t<u;++t){if(a=e[t],!o&&a===n)return t;i&&i.indexOf(a)>=0?--o:r&&r.indexOf(a)>=0&&++o}return t}function v(e){for(var t=[],n=0,r=e.length,s=0;s<r;)s=p(e,s,l,i+o,a+u),t.push(e.substring(n,s).trim()),n=++s;if(0===t.length)throw"Empty event selector: "+e;return t}function m(e){return"["===e[0]?function(e){var t,n,r=e.length,o=1;if((o=p(e,o,a,i,a))===r)throw"Empty between selector: "+e;if(2!==(t=v(e.substring(1,o))).length)throw"Between selector must have two elements: "+e;if((e=e.slice(o+1).trim())[0]!==f)throw"Expected '>' after between selector: "+e;return t=t.map(m),(n=m(e.slice(1).trim())).between?{between:t,stream:n}:(n.between=t,n)}(e):function(e){var r,f,h,v={source:t},m=[],g=[0,0],y=0,b=0,x=e.length,w=0;if(e[x-1]===u){if(!((w=e.lastIndexOf(o))>=0))throw"Unmatched right brace: "+e;try{g=function(e){var t=e.split(l);if(!e.length||t.length>2)throw e;return t.map(function(t){var n=+t;if(n!==n)throw e;return n})}(e.substring(w+1,x-1))}catch(k){throw"Invalid throttle specification: "+e}e=e.slice(0,w).trim(),x=e.length,w=0}if(!x)throw e;if(e[0]===c&&(y=++w),(r=p(e,w,s))<x&&(m.push(e.substring(b,r).trim()),b=w=++r),(w=p(e,w,i))===x)m.push(e.substring(b,x).trim());else if(m.push(e.substring(b,w).trim()),f=[],(b=++w)===x)throw"Unmatched left bracket: "+e;for(;w<x;){if((w=p(e,w,a))===x)throw"Unmatched left bracket: "+e;if(f.push(e.substring(b,w).trim()),w<x-1&&e[++w]!==i)throw"Expected left bracket: "+e;b=++w}if(!(x=m.length)||d.test(m[x-1]))throw"Invalid event selector: "+e;return x>1?(v.type=m[1],y?v.markname=m[0].slice(1):(h=m[0],n[h]?v.marktype=m[0]:v.source=m[0])):v.type=m[0],"!"===v.type.slice(-1)&&(v.consume=!0,v.type=v.type.slice(0,-1)),null!=f&&(v.filter=f),g[0]&&(v.throttle=g[0]),g[1]&&(v.debounce=g[1]),v}(e)}e.selector=function(e,i,a){return t=i||r,n=a||h,v(e.trim()).map(m)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},2897:function(e,t,n){(function(e){var r=n(594),i=n(2898),a=n(83),o=n(74),u=n(314),s=n(84),l=n(135),c=n(14),f=n(15),d=n(309),h=n(311);!function(t){"use strict";var n="4.0.0-beta.10";function p(e,t,n){return e.fields=t||[],e.fname=n,e}function v(e){throw Error(e)}function m(e){var t,n,r,i=[],a=null,o=0,u=e.length,s="";function l(){i.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<u;++n)if("\\"===(r=e[n]))s+=e.substring(t,n),t=++n;else if(r===a)l(),a=null,o=-1;else{if(a)continue;t===o&&'"'===r?(t=n+1,a=r):t===o&&"'"===r?(t=n+1,a=r):"."!==r||o?"["===r?(n>t&&l(),o=t=n+1):"]"===r&&(o||v("Access path missing open bracket: "+e),o>0&&l(),o=0,t=n+1):n>t?l():t=n+1}return o&&v("Access path missing closing bracket: "+e),a&&v("Access path missing closing quote: "+e),n>t&&(n++,l()),i}var g=Array.isArray;function y(e){return e===Object(e)}function b(e){return"string"===typeof e}function x(e){return g(e)?"["+e.map(x)+"]":y(e)||b(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}var w=[],k=(function(e,t){var n=m(e),r="return _["+n.map(x).join("][")+"];";p(Function("_",r),[e=1===n.length?n[0]:e],t||e)}("id"),p(function(e){return e},w,"identity"));function A(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}p(function(){return 0},w,"zero"),p(function(){return 1},w,"one"),p(function(){return!0},w,"true"),p(function(){return!1},w,"false");var E=0,D=1,C=2,O=3,F=4;function _(e){return null!=e?g(e)?e:[e]:[]}var S=Object.prototype.hasOwnProperty;function M(e,t){return S.call(e,t)}function j(e){return"boolean"===typeof e}function T(e){return"number"===typeof e}function N(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var B=function(e,t){return e(t={exports:{}},t.exports),t.exports}(function(t){var n=function(){function t(e,t){return null!=t&&e instanceof t}var n,r,i;try{n=Map}catch(s){n=function(){}}try{r=Set}catch(s){r=function(){}}try{i=Promise}catch(s){i=function(){}}function a(o,s,l,c,f){"object"===typeof s&&(l=s.depth,c=s.prototype,f=s.includeNonEnumerable,s=s.circular);var d=[],h=[],p="undefined"!=typeof e;return"undefined"==typeof s&&(s=!0),"undefined"==typeof l&&(l=1/0),function o(l,v){if(null===l)return null;if(0===v)return l;var m,g;if("object"!=typeof l)return l;if(t(l,n))m=new n;else if(t(l,r))m=new r;else if(t(l,i))m=new i(function(e,t){l.then(function(t){e(o(t,v-1))},function(e){t(o(e,v-1))})});else if(a.__isArray(l))m=[];else if(a.__isRegExp(l))m=new RegExp(l.source,u(l)),l.lastIndex&&(m.lastIndex=l.lastIndex);else if(a.__isDate(l))m=new Date(l.getTime());else{if(p&&e.isBuffer(l))return m=e.allocUnsafe?e.allocUnsafe(l.length):new e(l.length),l.copy(m),m;t(l,Error)?m=Object.create(l):"undefined"==typeof c?(g=Object.getPrototypeOf(l),m=Object.create(g)):(m=Object.create(c),g=c)}if(s){var y=d.indexOf(l);if(-1!=y)return h[y];d.push(l),h.push(m)}for(var b in t(l,n)&&l.forEach(function(e,t){var n=o(t,v-1),r=o(e,v-1);m.set(n,r)}),t(l,r)&&l.forEach(function(e){var t=o(e,v-1);m.add(t)}),l){var x;g&&(x=Object.getOwnPropertyDescriptor(g,b)),x&&null==x.set||(m[b]=o(l[b],v-1))}if(Object.getOwnPropertySymbols){var w=Object.getOwnPropertySymbols(l);for(b=0;b<w.length;b++){var k=w[b];(!(E=Object.getOwnPropertyDescriptor(l,k))||E.enumerable||f)&&(m[k]=o(l[k],v-1),E.enumerable||Object.defineProperty(m,k,{enumerable:!1}))}}if(f){var A=Object.getOwnPropertyNames(l);for(b=0;b<A.length;b++){var E,D=A[b];(E=Object.getOwnPropertyDescriptor(l,D))&&E.enumerable||(m[D]=o(l[D],v-1),Object.defineProperty(m,D,{enumerable:!1}))}}return m}(o,l)}function o(e){return Object.prototype.toString.call(e)}function u(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return a.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},a.__objToStr=o,a.__isDate=function(e){return"object"===typeof e&&"[object Date]"===o(e)},a.__isArray=function(e){return"object"===typeof e&&"[object Array]"===o(e)},a.__isRegExp=function(e){return"object"===typeof e&&"[object RegExp]"===o(e)},a.__getRegExpFlags=u,a}();t.exports&&(t.exports=n)}),R=Array.isArray,z=Object.keys,P=Object.prototype.hasOwnProperty,L=function(e,t){t||(t={}),"function"===typeof t&&(t={cmp:t});var n,r="boolean"===typeof t.cycles&&t.cycles,i=t.cmp&&(n=t.cmp,function(e){return function(t,r){var i={key:t,value:e[t]},a={key:r,value:e[r]};return n(i,a)}}),a=[];return function e(t){if(t&&t.toJSON&&"function"===typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!==typeof t)return JSON.stringify(t);var n,o;if(Array.isArray(t)){for(o="[",n=0;n<t.length;n++)n&&(o+=","),o+=e(t[n])||"null";return o+"]"}if(null===t)return"null";if(-1!==a.indexOf(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=a.push(t)-1,s=Object.keys(t).sort(i&&i(t));for(o="",n=0;n<s.length;n++){var l=s[n],c=e(t[l]);c&&(o&&(o+=","),o+=JSON.stringify(l)+":"+c)}return a.splice(u,1),"{"+o+"}"}}(e)};function I(e){return!!e.or}function U(e){return!!e.and}function q(e){return!!e.not}function W(e,t){return q(e)?{not:W(e.not,t)}:U(e)?{and:e.and.map(function(e){return W(e,t)})}:I(e)?{or:e.or.map(function(e){return W(e,t)})}:t(e)}var H=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){var r,i,a,o=R(t),u=R(n);if(o&&u){if((i=t.length)!=n.length)return!1;for(r=i;0!==r--;)if(!e(t[r],n[r]))return!1;return!0}if(o!=u)return!1;var s=t instanceof Date,l=n instanceof Date;if(s!=l)return!1;if(s&&l)return t.getTime()==n.getTime();var c=t instanceof RegExp,f=n instanceof RegExp;if(c!=f)return!1;if(c&&f)return t.toString()==n.toString();var d=z(t);if((i=d.length)!==z(n).length)return!1;for(r=i;0!==r--;)if(!P.call(n,d[r]))return!1;for(r=i;0!==r--;)if(!e(t[a=d[r]],n[a]))return!1;return!0}return t!==t&&n!==n},V=B;function G(e,t){var n={},r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;M(e,s)&&(n[s]=e[s])}}catch(l){i=!0,a=l}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}function $(e,t){var n=Object.assign({},e),r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0)delete n[o.value]}catch(s){i=!0,a=s}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}Set.prototype.toJSON=function(){return"Set(".concat(h(this).map(function(e){return L(e)}).join(","),")")};var Y=L;function X(e){if(T(e))return e;var t=b(e)?e:L(e);if(t.length<250)return t;for(var n=0,r=0;r<t.length;r++)n=(n<<5)-n+t.charCodeAt(r),n&=n;return n}function J(e){return!1===e||null===e}function Q(e,t){return e.indexOf(t)>-1}function K(e,t){var n=0,r=!0,i=!1,a=void 0;try{for(var o,u=e.entries()[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=d(s,2),c=l[0];if(t(l[1],c,n++))return!0}}catch(f){i=!0,a=f}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return!1}function Z(e,t){var n=0,r=!0,i=!1,a=void 0;try{for(var o,u=e.entries()[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=d(s,2),c=l[0];if(!t(l[1],c,n++))return!1}}catch(f){i=!0,a=f}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return!0}function ee(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++)e=te(e,a[i]);return e}function te(e,t){if("object"!==typeof t||null===t)return e;for(var n in t)M(t,n)&&void 0!==t[n]&&("object"!==typeof t[n]||g(t[n])||null===t[n]?e[n]=t[n]:"object"!==typeof e[n]||null===e[n]?e[n]=ee(g(t[n].constructor)?[]:{},t[n]):ee(e[n],t[n]));return e}function ne(e,t){var n,r=[],i={},a=!0,o=!1,u=void 0;try{for(var s,l=e[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;(n=t(c))in i||(i[n]=1,r.push(c))}}catch(f){o=!0,u=f}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}return r}function re(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(t.has(u))return!0}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!1}function ie(e){var t=new Set,n=!0,r=!1,i=void 0;try{for(var a,o=function(){var e=m(a.value).map(function(e,t){return 0===t?e:"[".concat(e,"]")});e.map(function(t,n){return e.slice(0,n+1).join("")}).forEach(function(e){return t.add(e)})},u=e[Symbol.iterator]();!(n=(a=u.next()).done);n=!0)o()}catch(s){r=!0,i=s}finally{try{n||null==u.return||u.return()}finally{if(r)throw i}}return t}function ae(e,t){return void 0===e||void 0===t||re(ie(e),ie(t))}var oe=Object.keys;function ue(e){var t=[];for(var n in e)M(e,n)&&t.push(e[n]);return t}function se(e){return!0===e||!1===e}function le(e){var t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function ce(e,t){return q(e)?"!("+ce(e.not,t)+")":U(e)?"("+e.and.map(function(e){return ce(e,t)}).join(") && (")+")":I(e)?"("+e.or.map(function(e){return ce(e,t)}).join(") || (")+")":t(e)}function fe(e,t){if(0===t.length)return!0;var n=t.shift();return fe(e[n],t)&&delete e[n],0===oe(e).length}function de(e){return e.charAt(0).toUpperCase()+e.substr(1)}function he(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum",n=m(e),r=[],i=1;i<=n.length;i++){var a="[".concat(n.slice(0,i).map(x).join("]["),"]");r.push("".concat(t).concat(a))}return r.join(" && ")}function pe(e){return"".concat(m(e).map(function(e){return ve(e,".","\\.")}).join("\\."))}function ve(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function me(e){return"".concat(m(e).join("."))}function ge(e){return e?m(e).length:0}function ye(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var a=i[r];if(void 0!==a)return a}}var be=42;function xe(e){return(e%360+360)%360}var we="area",ke="bar",Ae="image",Ee="line",De="point",Ce="rect",Oe="rule",Fe="text",_e="tick",Se="trail",Me="circle",je="square",Te="geoshape";function Ne(e){return Q(["line","area","trail"],e)}function Be(e){return Q(["rect","bar","image"],e)}var Re=oe({area:1,bar:1,image:1,line:1,point:1,text:1,tick:1,trail:1,rect:1,geoshape:1,rule:1,circle:1,square:1});function ze(e){return e.type}N(Re);var Pe=[].concat(["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],["fill","fillOpacity"]),Le=["filled","color","tooltip","invalid","timeUnitBandPosition","timeUnitBand"],Ie={binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},Ue={binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5};function qe(e){return!!e.mark}var We=function(){function e(t,n){c(this,e),this.name=t,this.run=n}return f(e,[{key:"hasMatchingType",value:function(e){return!!qe(e)&&(ze(t=e.mark)?t.type:t)===this.name;var t}}]),e}();function He(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}var Ve={argmax:1,argmin:1,average:1,count:1,distinct:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},Ge={count:1,min:1,max:1};function $e(e){return!!e&&!!e.argmin}function Ye(e){return!!e&&!!e.argmax}function Xe(e){return b(e)&&!!Ve[e]}var Je=["count","valid","missing","distinct"];function Qe(e){return e&&b(e)&&Q(Je,e)}var Ke=["count","sum","distinct","valid","missing"],Ze=N(["mean","average","median","q1","q3","min","max"]),et="row",tt="column",nt="facet",rt="x",it="y",at="x2",ot="y2",ut="latitude",st="longitude",lt="latitude2",ct="longitude2",ft="color",dt="fill",ht="stroke",pt="shape",vt="size",mt="opacity",gt="fillOpacity",yt="strokeOpacity",bt="strokeWidth",xt="text",wt="order",kt="detail",At="key",Et="tooltip",Dt="href",Ct="url",Ot={longitude:1,longitude2:1,latitude:1,latitude2:1},Ft=oe(Ot),_t=Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),Ot),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,size:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1});function St(e){return"color"===e||"fill"===e||"stroke"===e}var Mt={row:1,column:1,facet:1},jt=oe(Mt),Tt=Object.assign(Object.assign({},_t),Mt),Nt=oe(Tt),Bt=He(Tt,["order","detail","tooltip"]),Rt=He(Bt,["row","column","facet"]);function zt(e){return!!Tt[e]}var Pt=["x2","y2","latitude2","longitude2"];function Lt(e){return It(e)!==e}function It(e){switch(e){case"x2":return"x";case"y2":return"y";case"latitude2":return"latitude";case"longitude2":return"longitude"}return e}function Ut(e){switch(e){case"x":return"x2";case"y":return"y2";case"latitude":return"latitude2";case"longitude":return"longitude2"}}var qt=He(_t,["x","y","x2","y2","latitude","longitude","latitude2","longitude2"]),Wt=oe(qt),Ht={x:1,y:1},Vt=oe(Ht);function Gt(e){return"x"===e?"width":"height"}function $t(e){return"width"===e?"x":"y"}var Yt=He(qt,["text","tooltip","href","url","detail","key","order"]),Xt=oe(Yt),Jt=Object.assign(Object.assign({},Ht),Yt),Qt=oe(Jt);function Kt(e){return!!Jt[e]}function Zt(e,t){return function(e){switch(e){case ft:case dt:case ht:case kt:case At:case Et:case Dt:case wt:case mt:case gt:case yt:case bt:case nt:case et:case tt:return en;case rt:case it:case ut:case st:return tn;case at:case ot:case lt:case ct:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case vt:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case pt:return{point:"always",geoshape:"always"};case xt:return{text:"always"};case Ct:return{image:"always"}}}(e)[t]}var en={area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},tn=He(en,["geoshape"]);function nn(e){switch(e){case rt:case it:case vt:case bt:case mt:case gt:case yt:case at:case ot:return;case nt:case et:case tt:case pt:case xt:case Et:case Dt:case Ct:return"discrete";case ft:case dt:case ht:return"flexible";case ut:case st:case lt:case ct:case kt:case At:case wt:return}}var rn=Object.freeze({__proto__:null,invalidSpec:function(e){return"Invalid specification ".concat(JSON.stringify(e),'.  Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".')},FIT_NON_SINGLE:'Autosize "fit" only works for single views and layered views.',containerSizeNonSingle:function(e){return"".concat("width"==e?"Width":"Height",' "container" only works for single views and layered views.')},containerSizeNotCompatibleWithAutosize:function(e){return"".concat("width"==e?"Width":"Height",' "container" only works well with autosize "fit" or "fit-x".')},droppingFit:function(e){return e?'Dropping "fit-'.concat(e,'" because spec has discrete ').concat(Gt(e),"."):'Dropping "fit" because spec has discrete size.'},cannotProjectOnChannelWithoutField:function(e){return'Cannot project a selection on encoding channel "'.concat(e,'", which has no field.')},nearestNotSupportForContinuous:function(e){return'The "nearest" transform is not supported for '.concat(e," marks.")},selectionNotSupported:function(e){return"Selection not supported for ".concat(e," yet.")},selectionNotFound:function(e){return'Cannot find a selection named "'.concat(e,'".')},SCALE_BINDINGS_CONTINUOUS:"Scale bindings are currently only supported for scales with unbinned, continuous domains.",noSuchRepeatedValue:function(e){return'Unknown repeated value "'.concat(e,'".')},columnsNotSupportByRowCol:function(e){return'The "columns" property cannot be used when "'.concat(e,'" has nested row/column.')},CONCAT_CANNOT_SHARE_AXIS:"Axes cannot be shared in concatenated views yet (https://github.com/vega/vega-lite/issues/2415).",REPEAT_CANNOT_SHARE_AXIS:"Axes cannot be shared in repeated views yet (https://github.com/vega/vega-lite/issues/2415).",unrecognizedParse:function(e){return'Unrecognized parse "'.concat(e,'".')},differentParse:function(e,t,n){return'An ancestor parsed field "'.concat(e,'" as ').concat(n," but a child wants to parse the field as ").concat(t,".")},invalidTransformIgnored:function(e){return"Ignoring an invalid transform: ".concat(Y(e),".")},NO_FIELDS_NEEDS_AS:'If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.',encodingOverridden:function(e){return"Layer's shared ".concat(e.join(",")," channel ").concat(1===e.length?"is":"are"," overriden.")},projectionOverridden:function(e){var t=e.parentProjection,n=e.projection;return"Layer's shared projection ".concat(Y(t)," is overridden by a child projection ").concat(Y(n),".")},primitiveChannelDef:function(e,t,n){return"Channel ".concat(e," is a ").concat(t,". Converted to {value: ").concat(Y(n),"}.")},invalidFieldType:function(e){return'Invalid field type "'.concat(e,'".')},nonZeroScaleUsedWithLengthMark:function(e,t,n){var r=n.scaleType?"".concat(n.scaleType," scale"):n.zeroFalse?"scale with zero=false":"scale with custom domain that excludes zero";return"A ".concat(r," is used to encode ").concat(e,"'s ").concat(t,". This can be misleading as the ").concat("x"===t?"width":"height"," of the ").concat(e," can be arbitrary based on the scale domain. You may want to use point mark instead.")},invalidFieldTypeForCountAggregate:function(e,t){return'Invalid field type "'.concat(e,'" for aggregate: "').concat(t,'", using "quantitative" instead.')},invalidAggregate:function(e){return'Invalid aggregation operator "'.concat(e,'".')},missingFieldType:function(e,t){return'Missing type for channel "'.concat(e,'", using "').concat(t,'" instead.')},droppingColor:function(e,t){var n=t.fill,r=t.stroke;return"Dropping color ".concat(e," as the plot also has ").concat(n&&r?"fill and stroke":n?"fill":"stroke",".")},emptyFieldDef:function(e,t){return"Dropping ".concat(Y(e),' from channel "').concat(t,'" since it does not contain data field or value.')},latLongDeprecated:function(e,t,n){return"".concat(e,"-encoding with type ").concat(t," is deprecated. Replacing with ").concat(n,"-encoding.")},LINE_WITH_VARYING_SIZE:"Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.",incompatibleChannel:function(e,t,n){return"".concat(e,' dropped as it is incompatible with "').concat(t,'"').concat(n?" when ".concat(n):"",".")},invalidEncodingChannel:function(e){return"".concat(e,"-encoding is dropped as ").concat(e," is not a valid encoding channel.")},facetChannelShouldBeDiscrete:function(e){return"".concat(e," encoding should be discrete (ordinal / nominal / binned).")},facetChannelDropped:function(e){return"Facet encoding dropped as ".concat(e.join(" and ")," ").concat(e.length>1?"are":"is"," also specified.")},discreteChannelCannotEncode:function(e,t){return'Using discrete channel "'.concat(e,'" to encode "').concat(t,'" field can be misleading as it does not encode ').concat("ordinal"===t?"order":"magnitude",".")},lineWithRange:function(e,t){return"Line mark is for continuous lines and thus cannot be used with ".concat(e&&t?"x2 and y2":e?"x2":"y2",". We will use the rule mark (line segments) instead.")},orientOverridden:function(e,t){return'Specified orient "'.concat(e,'" overridden with "').concat(t,'".')},CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN:"Custom domain scale cannot be unioned with default field-based domain.",RANGE_STEP_DEPRECATED:'Scale\'s "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.',cannotUseScalePropertyWithNonColor:function(e){return'Cannot use the scale property "'.concat(e,'" with non-color channel.')},unaggregateDomainHasNoEffectForRawField:function(e){return"Using unaggregated domain with raw field has no effect (".concat(Y(e),").")},unaggregateDomainWithNonSharedDomainOp:function(e){return'Unaggregated domain not applicable for "'.concat(e,'" since it produces values outside the origin domain of the source data.')},unaggregatedDomainWithLogScale:function(e){return"Unaggregated domain is currently unsupported for log scale (".concat(Y(e),").")},cannotApplySizeToNonOrientedMark:function(e){return'Cannot apply size to non-oriented mark "'.concat(e,'".')},scaleTypeNotWorkWithChannel:function(e,t,n){return'Channel "'.concat(e,'" does not work with "').concat(t,'" scale. We are using "').concat(n,'" scale instead.')},scaleTypeNotWorkWithFieldDef:function(e,t){return'FieldDef does not work with "'.concat(e,'" scale. We are using "').concat(t,'" scale instead.')},scalePropertyNotWorkWithScaleType:function(e,t,n){return"".concat(n,"-scale's \"").concat(t,'" is dropped as it does not work with ').concat(e," scale.")},scaleTypeNotWorkWithMark:function(e,t){return'Scale type "'.concat(t,'" does not work with mark "').concat(e,'".')},stepDropped:function(e){return'The step for "'.concat(e,'" is dropped because the ').concat("width"===e?"x":"y"," is continuous.")},mergeConflictingProperty:function(e,t,n,r){return"Conflicting ".concat(t.toString(),' property "').concat(e.toString(),'" (').concat(Y(n)," and ").concat(Y(r),"). Using ").concat(Y(n),".")},mergeConflictingDomainProperty:function(e,t,n,r){return"Conflicting ".concat(t.toString(),' property "').concat(e.toString(),'" (').concat(Y(n)," and ").concat(Y(r),"). Using the union of the two domains.")},independentScaleMeansIndependentGuide:function(e){return'Setting the scale to be independent for "'.concat(e,'" means we also have to set the guide (axis or legend) to be independent.')},domainSortDropped:function(e){return"Dropping sort property ".concat(Y(e),' as unioned domains only support boolean or op "count", "min", and "max".')},UNABLE_TO_MERGE_DOMAINS:"Unable to merge domains.",MORE_THAN_ONE_SORT:"Domains that should be unioned has conflicting sort properties. Sort will be set to true.",INVALID_CHANNEL_FOR_AXIS:"Invalid channel for axis.",cannotStackRangedMark:function(e){return'Cannot stack "'.concat(e,'" if there is already "').concat(e,'2".')},cannotStackNonLinearScale:function(e){return"Cannot stack non-linear scale (".concat(e,").")},stackNonSummativeAggregate:function(e){return'Stacking is applied even though the aggregate function is non-summative ("'.concat(e,'").')},invalidTimeUnit:function(e,t){return"Invalid ".concat(e,": ").concat(Y(t),".")},dayReplacedWithDate:function(e){return'Time unit "'.concat(e,'" is not supported. We are replacing it with ').concat(ve(e,"day","date"),".")},droppedDay:function(e){return"Dropping day from datetime ".concat(Y(e)," as day cannot be combined with other units.")},errorBarCenterAndExtentAreNotNeeded:function(e,t){return"".concat(t?"extent ":"").concat(t&&e?"and ":"").concat(e?"center ":"").concat(t&&e?"are ":"is ","not needed when data are aggregated.")},errorBarCenterIsUsedWithWrongExtent:function(e,t,n){return"".concat(e," is not usually used with ").concat(t," for ").concat(n,".")},errorBarContinuousAxisHasCustomizedAggregate:function(e,t){return"Continuous axis should not have customized aggregation function ".concat(e,"; ").concat(t," already agregates the axis.")},errorBarCenterIsNotNeeded:function(e,t){return"Center is not needed to be specified in ".concat(t," when extent is ").concat(e,".")},errorBand1DNotSupport:function(e){return"1D error band does not support ".concat(e,".")},channelRequiredForBinned:function(e){return"Channel ".concat(e,' is required for "binned" bin.')},domainRequiredForThresholdScale:function(e){return"Domain for ".concat(e," is required for threshold scale.")}}),an=function(e,t){var n=e||E;return{level:function(e){return arguments.length?(n=+e,this):n},error:function(){return n>=D&&A(t||"error","ERROR",arguments),this},warn:function(){return n>=C&&A(t||"warn","WARN",arguments),this},info:function(){return n>=O&&A(t||"log","INFO",arguments),this},debug:function(){return n>=F&&A(t||"log","DEBUG",arguments),this}}}(C),on=an;function un(){var e;(e=on).warn.apply(e,arguments)}var sn=2006;function ln(e){return!!e&&(!!e.year||!!e.quarter||!!e.month||!!e.date||!!e.day||!!e.hours||!!e.minutes||!!e.seconds||!!e.milliseconds)}var cn,fn=["january","february","march","april","may","june","july","august","september","october","november","december"],dn=fn.map(function(e){return e.substr(0,3)}),hn=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],pn=hn.map(function(e){return e.substr(0,3)});function vn(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];if(t&&void 0!==e.day&&oe(e).length>1&&(un(rn.droppedDay(e)),delete(e=V(e)).day),void 0!==e.year?r.push(e.year):void 0!==e.day?r.push(sn):r.push(0),void 0!==e.month){var i=t?function(e){if(T(e))return(e-1).toString();var t=e.toLowerCase(),n=fn.indexOf(t);if(-1!==n)return n+"";var r=t.substr(0,3),i=dn.indexOf(r);if(-1!==i)return i+"";throw new Error(rn.invalidTimeUnit("month",e))}(e.month):e.month;r.push(i)}else if(void 0!==e.quarter){var a=t?function(e){if(T(e))return e>4&&un(rn.invalidTimeUnit("quarter",e)),(e-1).toString();throw new Error(rn.invalidTimeUnit("quarter",e))}(e.quarter):e.quarter;r.push(a+"*3")}else r.push(0);if(void 0!==e.date)r.push(e.date);else if(void 0!==e.day){var o=t?function(e){if(T(e))return e%7+"";var t=e.toLowerCase(),n=hn.indexOf(t);if(-1!==n)return n+"";var r=t.substr(0,3),i=pn.indexOf(r);if(-1!==i)return i+"";throw new Error(rn.invalidTimeUnit("day",e))}(e.day):e.day;r.push(o+"+1")}else r.push(1);for(var u=0,s=["hours","minutes","seconds","milliseconds"];u<s.length;u++){var l=s[u];void 0!==e[l]?r.push(e[l]):r.push(0)}var c=r.join(", ");return n?e.utc?new Function("return +new Date(Date.UTC(".concat(c,"))"))():new Function("return +new Date(".concat(c,")"))():e.utc?"utc(".concat(c,")"):"datetime(".concat(c,")")}!function(e){e.YEAR="year",e.MONTH="month",e.DAY="day",e.DATE="date",e.HOURS="hours",e.MINUTES="minutes",e.SECONDS="seconds",e.MILLISECONDS="milliseconds",e.YEARMONTH="yearmonth",e.YEARMONTHDATE="yearmonthdate",e.YEARMONTHDATEHOURS="yearmonthdatehours",e.YEARMONTHDATEHOURSMINUTES="yearmonthdatehoursminutes",e.YEARMONTHDATEHOURSMINUTESSECONDS="yearmonthdatehoursminutesseconds",e.MONTHDATE="monthdate",e.MONTHDATEHOURS="monthdatehours",e.HOURSMINUTES="hoursminutes",e.HOURSMINUTESSECONDS="hoursminutesseconds",e.MINUTESSECONDS="minutesseconds",e.SECONDSMILLISECONDS="secondsmilliseconds",e.QUARTER="quarter",e.YEARQUARTER="yearquarter",e.QUARTERMONTH="quartermonth",e.YEARQUARTERMONTH="yearquartermonth",e.UTCYEAR="utcyear",e.UTCMONTH="utcmonth",e.UTCDAY="utcday",e.UTCDATE="utcdate",e.UTCHOURS="utchours",e.UTCMINUTES="utcminutes",e.UTCSECONDS="utcseconds",e.UTCMILLISECONDS="utcmilliseconds",e.UTCYEARMONTH="utcyearmonth",e.UTCYEARMONTHDATE="utcyearmonthdate",e.UTCYEARMONTHDATEHOURS="utcyearmonthdatehours",e.UTCYEARMONTHDATEHOURSMINUTES="utcyearmonthdatehoursminutes",e.UTCYEARMONTHDATEHOURSMINUTESSECONDS="utcyearmonthdatehoursminutesseconds",e.UTCMONTHDATE="utcmonthdate",e.UTCMONTHDATEHOURS="utcmonthdatehours",e.UTCHOURSMINUTES="utchoursminutes",e.UTCHOURSMINUTESSECONDS="utchoursminutesseconds",e.UTCMINUTESSECONDS="utcminutesseconds",e.UTCSECONDSMILLISECONDS="utcsecondsmilliseconds",e.UTCQUARTER="utcquarter",e.UTCYEARQUARTER="utcyearquarter",e.UTCQUARTERMONTH="utcquartermonth",e.UTCYEARQUARTERMONTH="utcyearquartermonth"}(cn||(cn={}));var mn={year:1,quarter:1,month:1,day:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},gn=oe(mn),yn={utcyear:1,utcquarter:1,utcmonth:1,utcday:1,utcdate:1,utchours:1,utcminutes:1,utcseconds:1,utcmilliseconds:1},bn={utcyearquarter:1,utcyearquartermonth:1,utcyearmonth:1,utcyearmonthdate:1,utcyearmonthdatehours:1,utcyearmonthdatehoursminutes:1,utcyearmonthdatehoursminutesseconds:1,utcquartermonth:1,utcmonthdate:1,utcmonthdatehours:1,utchoursminutes:1,utchoursminutesseconds:1,utcminutesseconds:1,utcsecondsmilliseconds:1},xn=Object.assign(Object.assign({},yn),bn);function wn(e,t){var n=e.indexOf(t);return n>-1&&(t!==cn.SECONDS||0===n||"i"!==e.charAt(n-1))}function kn(e,t){var n,r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!1}).end,i=he(t),a=xn[e]?"utc":"",o=gn.reduce(function(t,r){var o;return wn(e,r)&&(t[r]=(o=r)===cn.QUARTER?"(".concat(a,"quarter(").concat(i,")-1)"):"".concat(a).concat(o,"(").concat(i,")"),n=r),t},{});return r&&(o[n]+="+1"),vn(o)}function An(e,t){if(e){var n=[],r=wn(e,cn.YEAR);wn(e,cn.MONTH)&&n.push(!1!==t?"%b":"%B"),wn(e,cn.DAY)?n.push(t?"%a":"%A"):wn(e,cn.DATE)&&n.push("%d"+(r?",":"")),r&&n.push(t?"%y":"%Y");var i=[];wn(e,cn.HOURS)&&i.push("%H"),wn(e,cn.MINUTES)&&i.push("%M"),wn(e,cn.SECONDS)&&i.push("%S"),wn(e,cn.MILLISECONDS)&&i.push("%L");var a=[];return n.length>0&&a.push(n.join(" ")),i.length>0&&a.push(i.join(":")),a}}function En(e){return"day"!==e&&e.indexOf("day")>=0?(un(rn.dayReplacedWithDate(e)),ve(e,"day","date")):e}function Dn(e){return e&&!!e.field&&void 0!==e.equal}function Cn(e){return e&&!!e.field&&void 0!==e.lt}function On(e){return e&&!!e.field&&void 0!==e.lte}function Fn(e){return e&&!!e.field&&void 0!==e.gt}function _n(e){return e&&!!e.field&&void 0!==e.gte}function Sn(e){return!!(e&&e.field&&g(e.range)&&2===e.range.length)}function Mn(e){return e&&!!e.field&&(g(e.oneOf)||g(e.in))}function jn(e){return Mn(e)||Dn(e)||Sn(e)||Cn(e)||Fn(e)||On(e)||_n(e)}function Tn(e,t){return ci(e,{timeUnit:t,time:!0})}function Nn(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.field,r=e.timeUnit,i=r?"time("+kn(r,n)+")":Gr(e,{expr:"datum"});if(Dn(e))return i+"==="+Tn(e.equal,r);if(Cn(e)){var a=e.lt;return"".concat(i,"<").concat(Tn(a,r))}if(Fn(e)){var o=e.gt;return"".concat(i,">").concat(Tn(o,r))}if(On(e)){var u=e.lte;return"".concat(i,"<=").concat(Tn(u,r))}if(_n(e)){var s=e.gte;return"".concat(i,">=").concat(Tn(s,r))}if(Mn(e))return"indexof([".concat(function(e,t){return e.map(function(e){return Tn(e,t)})}(e.oneOf,r).join(","),"], ").concat(i,") !== -1");if(function(e){return e&&!!e.field&&void 0!==e.valid}(e))return Bn(i,e.valid);if(Sn(e)){var l=e.range[0],c=e.range[1];if(null!==l&&null!==c&&t)return"inrange("+i+", ["+Tn(l,r)+", "+Tn(c,r)+"])";var f=[];return null!==l&&f.push("".concat(i," >= ").concat(Tn(l,r))),null!==c&&f.push("".concat(i," <= ").concat(Tn(c,r))),f.length>0?f.join(" && "):"true"}throw new Error("Invalid field predicate: ".concat(JSON.stringify(e)))}function Bn(e){return arguments.length>1&&void 0!==arguments[1]&&!arguments[1]?"!isValid(".concat(e,") || !isFinite(+").concat(e,")"):"isValid(".concat(e,") && isFinite(+").concat(e,")")}function Rn(e){return jn(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:En(e.timeUnit)}):e}Object.assign(Object.assign(Object.assign(Object.assign({},mn),yn),{yearquarter:1,yearquartermonth:1,yearmonth:1,yearmonthdate:1,yearmonthdatehours:1,yearmonthdatehoursminutes:1,yearmonthdatehoursminutesseconds:1,quartermonth:1,monthdate:1,monthdatehours:1,hoursminutes:1,hoursminutesseconds:1,minutesseconds:1,secondsmilliseconds:1}),bn);var zn,Pn={quantitative:1,ordinal:1,temporal:1,nominal:1,geojson:1},Ln="quantitative",In="ordinal",Un="temporal",qn="nominal",Wn="geojson";!function(e){e.LINEAR="linear",e.LOG="log",e.POW="pow",e.SQRT="sqrt",e.SYMLOG="symlog",e.TIME="time",e.UTC="utc",e.QUANTILE="quantile",e.QUANTIZE="quantize",e.THRESHOLD="threshold",e.BIN_ORDINAL="bin-ordinal",e.ORDINAL="ordinal",e.POINT="point",e.BAND="band"}(zn||(zn={}));var Hn={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},Vn=oe(Hn),Gn={linear:0,log:1,pow:1,sqrt:1,symlog:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function $n(e){return Gn[e]}var Yn=["linear","log","pow","sqrt","symlog","time","utc"],Xn=N(Yn),Jn=N(["quantile","quantize","threshold"]),Qn=N(Yn.concat(["quantile","quantize","threshold"])),Kn=N(["ordinal","bin-ordinal","point","band"]);function Zn(e){return e in Kn}function er(e){return e in Qn}function tr(e){return e in Xn}function nr(e){return e in Jn}function rr(e){return e&&e.selection}var ir=He({type:1,domain:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},["type","domain","range","scheme"]),ar=oe(ir);function or(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!Q(["point","band","identity"],e);case"bins":return!Q(["point","band","identity","ordinal"],e);case"round":return tr(e)||"band"===e||"point"===e;case"padding":return tr(e)||Q(["point","band"],e);case"paddingOuter":case"align":return Q(["point","band"],e);case"paddingInner":return"band"===e;case"clamp":return tr(e);case"nice":return tr(e)||"quantize"===e||"threshold"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"constant":return"symlog"===e;case"zero":return er(e)&&!Q(["log","time","utc","threshold","quantile"],e)}}function ur(e,t){switch(t){case"interpolate":case"scheme":return St(e)?void 0:rn.cannotUseScalePropertyWithNonColor(e);case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function sr(e,t){return Q([In,qn],t)?void 0===e||Zn(e):t===Un?Q([zn.TIME,zn.UTC,void 0],e):t!==Ln||Q([zn.LOG,zn.POW,zn.SQRT,zn.SYMLOG,zn.QUANTILE,zn.QUANTIZE,zn.THRESHOLD,zn.LINEAR,void 0],e)}function lr(e,t){switch(e){case rt:case it:return tr(t)||Q(["band","point"],t);case vt:case bt:case mt:case gt:case yt:return tr(t)||nr(t)||Q(["band","point"],t);case ft:case dt:case ht:return"band"!==t;case pt:return"ordinal"===t}return!1}function cr(e,t){return e+"_"+t}function fr(e){return[].concat(e.type,e.style||[])}function dr(e,t,n){return ye(t[e],hr(e,t,n))}function hr(e,t,n){var r=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).vgChannel;return ye(r?pr(e,t,n.style):void 0,pr(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function pr(e,t,n){var r,i=fr(t),a=!0,o=!1,u=void 0;try{for(var s,l=i[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=n[s.value],f=e;c&&void 0!==c[f]&&(r=c[f])}}catch(d){o=!0,u=d}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}return r}function vr(e,t,n,r){if(li(e)){var i=Wr(e)&&e.scale&&e.scale.type===zn.UTC;return{signal:xr(Gr(e,{expr:n}),e.timeUnit,t,r.text.shortTimeLabels,r.timeFormat,i,!0)}}var a=mr(e,t,r);return pi(e.bin)?{signal:br(Gr(e,{expr:n}),Gr(e,{expr:n,binSuffix:"end"}),a,r)}:"quantitative"===e.type||a?{signal:"".concat(gr(Gr(e,{expr:n,binSuffix:"range"}),a))}:{signal:"''+".concat(Gr(e,{expr:n}))}}function mr(e,t,n){return t||(e.type===Ln?n.numberFormat:void 0)}function gr(e,t){return"format(".concat(e,', "').concat(t||"",'")')}function yr(e,t,n){return gr(e,t||n.numberFormat)}function br(e,t,n,r){return"".concat(Bn(e,!1),' ? "null" : ').concat(yr(e,n,r),' + " - " + ').concat(yr(t,n,r))}function xr(e,t,n,r,i,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return!t||n?(n=n||i)||o?"".concat(a?"utc":"time","Format(").concat(e,", '").concat(n,"')"):void 0:function(e,t,n,r){if(e){var i=An(e,n),a="";return wn(e,cn.QUARTER)&&(a="'Q' + quarter(".concat(t,")")),i.length>0&&(a&&(a+=" + ' ' + "),a+=r?"utcFormat(".concat(t,", '").concat(i.join(" "),"')"):"timeFormat(".concat(t,", '").concat(i.join(" "),"')")),a||void 0}}(t,e,r,a)}function wr(e,t){return _(e).reduce(function(e,n){return e.field.push(Gr(n,t)),e.order.push(n.sort||"ascending"),e},{field:[],order:[]})}function kr(e,t){var n=h(e);return t.forEach(function(e){var t=!0,r=!1,i=void 0;try{for(var a,o=n[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var u=a.value;if(Y(u)===Y(e))return}}catch(s){r=!0,i=s}finally{try{t||null==o.return||o.return()}finally{if(r)throw i}}n.push(e)}),n}function Ar(e,t){return e!==t&&t?e?e+", "+t:t:e}function Er(e,t){if(g(e.value)&&g(t.value))return{explicit:e.explicit,value:kr(e.value,t.value)};if(!g(e.value)&&!g(t.value))return{explicit:e.explicit,value:Ar(e.value,t.value)};throw new Error("It should never reach here")}!function(){var e={},t=!0,n=!1,r=void 0;try{for(var i,a=Nt[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,u=!0,s=!1,l=void 0;try{for(var c,f=oe(Pn)[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var d=c.value,h=!0,p=!1,v=void 0;try{for(var m,g=Vn[Symbol.iterator]();!(h=(m=g.next()).done);h=!0){var y=m.value,b=cr(o,d);lr(o,y)&&sr(y,d)&&(e[b]=e[b]||[],e[b].push(y))}}catch(x){p=!0,v=x}finally{try{h||null==g.return||g.return()}finally{if(p)throw v}}}}catch(x){s=!0,l=x}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}}}catch(x){n=!0,r=x}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}();var Dr="mean",Cr={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function Or(e){return!!Cr[e]}function Fr(e){return!!e&&!!e.encoding}function _r(e){return!!e&&("count"===e.op||!!e.field)}function Sr(e){return!!e&&g(e)}function Mr(e){return!!e.row||!!e.column}function jr(e){return void 0!==e.facet}function Tr(e){var t=e.field,n=e.timeUnit,r=e.bin,i=e.aggregate;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:t})}function Nr(e){return Ir(e)&&!!e.sort}function Br(e,t,n,r,i){var a=(arguments.length>5&&void 0!==arguments[5]?arguments[5]:{}).isMidPoint,o=t.timeUnit,u=t.bin;if(Q(["x","y"],e)){if(Hr(t)&&void 0!==t.band)return t.band;if(o&&!n)return a?hr("timeUnitBandPosition",r,i):Be(r.type)?hr("timeUnitBand",r,i):0;if(pi(u))return Be(r.type)&&!a?1:.5}}function Rr(e,t,n,r,i){return!!(pi(t.bin)||t.timeUnit&&Ir(t)&&"temporal"===t.type)&&!!Br(e,t,n,r,i)}function zr(e){return!!e&&!!e.condition}function Pr(e){return!!e&&!!e.condition&&!g(e.condition)&&Lr(e.condition)}function Lr(e){return!!e&&(!!e.field||"count"===e.aggregate)}function Ir(e){return!!e&&(!!e.field&&!!e.type||"count"===e.aggregate)}function Ur(e){return Lr(e)&&b(e.field)}function qr(e){return e&&"value"in e&&void 0!==e.value}function Wr(e){return!!e&&(!!e.scale||!!e.sort)}function Hr(e){return!!e&&(!!e.axis||!!e.stack||!!e.impute||void 0!==e.band)}function Vr(e){return!!e&&!!e.format}function Gr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.field,r=t.prefix,i=t.suffix,a="";if(function(e){return"count"===e.aggregate}(e))n=function(e){return function(e){return 0===e.indexOf("__")}(e)?e:"__".concat(e)}("count");else{var o;if(!t.nofn)if(function(e){return!!e.op}(e))o=e.op;else{var u=e.bin,s=e.aggregate,l=e.timeUnit;pi(u)?(o=hi(u),i=(t.binSuffix||"")+(t.suffix||"")):s?Ye(s)?(a=".".concat(n),n="argmax_".concat(s.argmax)):$e(s)?(a=".".concat(n),n="argmin_".concat(s.argmin)):o=String(s):l&&(o=String(l),i=(!Q(["range","mid"],t.binSuffix)&&t.binSuffix||"")+(t.suffix||""))}o&&(n=n?"".concat(o,"_").concat(n):o)}return i&&(n="".concat(n,"_").concat(i)),r&&(n="".concat(r,"_").concat(n)),t.forAs?n:t.expr?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum";return"".concat(t,"[").concat(x(m(e).join(".")),"]")}(n,t.expr)+a:pe(n)+a}function $r(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return!!e.bin;case"temporal":return!1}throw new Error(rn.invalidFieldType(e.type))}function Yr(e){return!$r(e)}function Xr(e,t){var n=e.field,r=e.bin,i=e.timeUnit,a=e.aggregate;if("count"===a)return t.countTitle;if(pi(r))return"".concat(n," (binned)");if(i){var o=function(e){return gn.reduce(function(t,n){return wn(e,n)?[].concat(h(t),[n]):t},[])}(i).join("-");return"".concat(n," (").concat(o,")")}return a?Ye(a)?"".concat(n," for max ").concat(a.argmax):$e(a)?"".concat(n," for min ").concat(a.argmin):"".concat(de(a)," of ").concat(n):n}var Jr=function(e,t){switch(t.fieldTitle){case"plain":return e.field;case"functional":return function(e){var t=e.aggregate,n=e.bin,r=e.timeUnit,i=e.field;if(Ye(t))return"".concat(i," for argmax(").concat(t.argmax,")");if($e(t))return"".concat(i," for argmin(").concat(t.argmin,")");var a=t||r||pi(n)&&"bin";return a?a.toUpperCase()+"("+i+")":i}(e);default:return Xr(e,t)}},Qr=Jr;function Kr(e){Qr=e}function Zr(e,t,n){var r=n.allowDisabling,i=n.includeDefault,a=void 0===i||i,o=(ei(e)||{}).title,u=a?ti(e,t):void 0;return r?ye(o,e.title,u):o||e.title||u}function ei(e){return Hr(e)&&e.axis?e.axis:(t=e)&&t.legend&&e.legend?e.legend:function(e){return!!e&&!!e.header}(e)&&e.header?e.header:void 0;var t}function ti(e,t){return Qr(e,t)}function ni(e){return Vr(e)&&e.format?e.format:(ei(e)||{}).format}function ri(e){return Lr(e)?e:Pr(e)?e.condition:void 0}function ii(e){return Lr(e)?e:Pr(e)?e.condition:void 0}function ai(e,t){if(b(e)||T(e)||j(e)){var n=b(e)?"string":T(e)?"number":"boolean";return un(rn.primitiveChannelDef(t,n,e)),{value:e}}return Lr(e)?oi(e,t):Pr(e)?Object.assign(Object.assign({},e),{condition:oi(e.condition,t)}):e}function oi(e,t){var n=e.aggregate,r=e.timeUnit,i=e.bin,a=e.field,o=Object.assign({},e);if(!n||Xe(n)||Ye(n)||$e(n)||(un(rn.invalidAggregate(n)),delete o.aggregate),r&&(o.timeUnit=En(r)),a&&(o.field="".concat(a)),pi(i)&&(o.bin=ui(i,t)),vi(i)&&!Q(Vt,t)&&un("Channel ".concat(t,' should not be used with "binned" bin')),Ir(o)){var u=o.type,s=function(e){if(e)switch(e=e.toLowerCase()){case"q":case Ln:return"quantitative";case"t":case Un:return"temporal";case"o":case In:return"ordinal";case"n":case qn:return"nominal";case Wn:return"geojson"}}(u);u!==s&&(o.type=s),"quantitative"!==u&&Qe(n)&&(un(rn.invalidFieldTypeForCountAggregate(u,n)),o.type="quantitative")}else if(!Lt(t)){var l=function(e,t){if(e.timeUnit)return"temporal";if(pi(e.bin))return"quantitative";switch(nn(t)){case"continuous":return"quantitative";case"discrete":case"flexible":return"nominal";default:return"quantitative"}}(o,t);un(rn.missingFieldType(t,l)),o.type=l}if(Ir(o)){var c=function(e,t){var n=e.type;if("geojson"===n&&"shape"!==t)return{compatible:!1,warning:"Channel ".concat(t," should not be used with a geojson data.")};switch(t){case"row":case"column":case"facet":return Yr(e)?{compatible:!1,warning:rn.facetChannelShouldBeDiscrete(t)}:si;case"x":case"y":case"color":case"fill":case"stroke":case"text":case"detail":case"key":case"tooltip":case"href":case"url":return si;case"longitude":case"longitude2":case"latitude":case"latitude2":return n!==Ln?{compatible:!1,warning:"Channel ".concat(t," should be used with a quantitative field only, not ").concat(e.type," field.")}:si;case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeWidth":case"size":case"x2":case"y2":return"nominal"!==n||e.sort?si:{compatible:!1,warning:"Channel ".concat(t," should not be used with an unsorted discrete field.")};case"shape":return Q(["ordinal","nominal","geojson"],e.type)?si:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case"order":return"nominal"!==e.type||"sort"in e?si:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}throw new Error("channelCompatability not implemented for channel "+t)}(o,t),f=c.compatible,d=c.warning;f||un(d)}if(Nr(o)&&b(o.sort)){var h=o.sort;if(Or(h))return Object.assign(Object.assign({},o),{sort:{encoding:h}});var p=h.substr(1);if("-"===h.charAt(0)&&Or(p))return Object.assign(Object.assign({},o),{sort:{encoding:p,order:"descending"}})}return o}function ui(e,t){return j(e)?{maxbins:gi(t)}:"binned"===e?{binned:!0}:e.maxbins||e.step?e:Object.assign(Object.assign({},e),{maxbins:gi(t)})}var si={compatible:!0};function li(e){var t=ei(e),n=t&&t.formatType||Vr(e)&&e.formatType;return"time"===n||!n&&function(e){return"temporal"===e.type||!!e.timeUnit}(e)}function ci(e,t){var n,r,i=t.timeUnit,a=t.type,o=t.time,u=t.undefinedIfExprNotRequired;return ln(e)?n=vn(e,!0):(b(e)||T(e))&&(i||"temporal"===a)&&(n=function(e){return!!mn[e]}(i)?vn(l({},i,e),!0):function(e){return!!yn[e]}(i)?ci(e,{timeUnit:(r=i,r.substr(3))}):"datetime(".concat(JSON.stringify(e),")")),n?o?"time(".concat(n,")"):n:u?void 0:JSON.stringify(e)}function fi(e,t){var n=e.timeUnit,r=e.type;return t.map(function(e){var t=ci(e,{timeUnit:n,type:r,undefinedIfExprNotRequired:!0});return void 0!==t?{signal:t}:e})}function di(e,t){return pi(e.bin)?Kt(t)&&Q(["ordinal","nominal"],e.type):(console.warn("Only use this method with binned field defs"),!1)}function hi(e){return j(e)&&(e=ui(e,void 0)),"bin"+oe(e).map(function(t){return le("_".concat(t,"_").concat(e[t]))}).join("")}function pi(e){return!0===e||mi(e)&&!e.binned}function vi(e){return"binned"===e||mi(e)&&e.binned}function mi(e){return y(e)}function gi(e){switch(e){case et:case tt:case vt:case ft:case dt:case ht:case bt:case mt:case gt:case yt:case pt:return 6;default:return 10}}function yi(e,t){var n=e&&e[t];return!!n&&(g(n)?K(n,function(e){return!!e.field}):Lr(n)||Pr(n))}function bi(e){return K(Nt,function(t){if(yi(e,t)){var n=e[t];if(g(n))return K(n,function(e){return!!e.aggregate});var r=ri(n);return r&&!!r.aggregate}return!1})}function xi(e,t){var n=[],r=[],i=[],a=[],o={};return Ai(e,function(u,s){if(Lr(u)){var l=u.field,c=u.aggregate,f=u.timeUnit,d=u.bin,h=He(u,["field","aggregate","timeUnit","bin"]);if(c||f||d){var p,v=ei(u),m=v&&v.title,g=Gr(u,{forAs:!0}),y=Object.assign(Object.assign(Object.assign({},m?[]:{title:Zr(u,t,{allowDisabling:!0})}),h),{field:g}),b="x"===s||"y"===s;if(c){if(Ye(c)?(p="argmax",g=Gr({op:"argmax",field:c.argmax},{forAs:!0}),y.field="".concat(g,".").concat(l)):$e(c)?(p="argmin",g=Gr({op:"argmin",field:c.argmin},{forAs:!0}),y.field="".concat(g,".").concat(l)):"boxplot"!==c&&"errorbar"!==c&&"errorband"!==c&&(p=c),p){var x={op:p,as:g};l&&(x.field=l),a.push(x)}}else if(n.push(g),Ir(u)&&pi(d)){if(r.push({bin:d,field:l,as:g}),n.push(Gr(u,{binSuffix:"end"})),di(u,s)&&n.push(Gr(u,{binSuffix:"range"})),b){var w={field:g+"_end"};o[s+"2"]=w}y.bin="binned",Lt(s)||(y.type="quantitative")}else if(f){i.push({timeUnit:f,field:l,as:g});var k=An(f,t.axis.shortTimeLabels).join(" "),A=Ir(u)&&u.type!==Un&&"time";"text"===s||"tooltip"===s?(y.format=y.format||k,A&&(y.formatType=A)):function(e){return!!qt[e]}(s)?y.legend=Object.assign(Object.assign({format:k},A?{formatType:A}:{}),y.legend):b&&(y.axis=Object.assign(Object.assign({format:k},A?{formatType:A}:{}),y.axis))}o[s]=y}else n.push(l),o[s]=e[s]}else o[s]=e[s]}),{bins:r,timeUnits:i,aggregate:a,groupby:n,encoding:o}}function wi(e,t){var n=t.type;return oe(e).reduce(function(r,i){if(!zt(i))return un(rn.invalidEncodingChannel(i)),r;if(!function(e,t,n){var r=Zt(t,n);if(!r)return!1;if("binned"===r){var i=e["x2"===t?"x":"y"];return!!(Lr(i)&&Lr(e[t])&&vi(i.bin))}return!0}(e,i,n))return un(rn.incompatibleChannel(i,n)),r;if("size"===i&&"line"===n){var a=ii(e[i]);if(a&&a.aggregate)return un(rn.LINE_WITH_VARYING_SIZE),r}if("color"===i&&(t.filled?"fill"in e:"stroke"in e))return un(rn.droppingColor("encoding",{fill:"fill"in e,stroke:"stroke"in e})),r;var o=e[i];if("detail"===i||"order"===i&&!g(o)&&!qr(o)||"tooltip"===i&&g(o))o&&(r[i]=(g(o)?o:[o]).reduce(function(e,t){return Lr(t)?e.push(oi(t,i)):un(rn.emptyFieldDef(t,i)),e},[]));else{if("tooltip"===i&&null===o)r[i]=null;else if(!Lr(o)&&!qr(o)&&!zr(o))return un(rn.emptyFieldDef(o,i)),r;r[i]=ai(o,i)}return r},{})}function ki(e){var t=[],n=!0,r=!1,i=void 0;try{for(var a,o=oe(e)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(yi(e,u)){var s=e[u],l=g(s)?s:[s],c=!0,f=!1,d=void 0;try{for(var h,p=l[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var v=h.value;Lr(v)?t.push(v):Pr(v)&&t.push(v.condition)}}catch(m){f=!0,d=m}finally{try{c||null==p.return||p.return()}finally{if(f)throw d}}}}}catch(m){r=!0,i=m}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return t}function Ai(e,t,n){if(e){var r=!0,i=!1,a=void 0;try{for(var o,u=function(){var r=o.value,i=e[r];g(i)?i.forEach(function(e){t.call(n,e,r)}):t.call(n,i,r)},s=oe(e)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)u()}catch(l){i=!0,a=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}}function Ei(e,t,n,r){return e?oe(e).reduce(function(n,i){var a=e[i];return g(a)?a.reduce(function(e,n){return t.call(r,e,n,i)},n):t.call(r,n,a,i)},n):n}function Di(e,t){return oe(t).reduce(function(n,r){switch(r){case"x":case"y":case"href":case"url":case"x2":case"y2":case"latitude":case"longitude":case"latitude2":case"longitude2":case"text":case"shape":case"tooltip":return n;case"order":if("line"===e||"trail"===e)return n;case"detail":case"key":var i=t[r];return(g(i)||Lr(i))&&(g(i)?i:[i]).forEach(function(e){e.aggregate||n.push(Gr(e,{}))}),n;case"size":if("trail"===e)return n;case"color":case"fill":case"stroke":case"opacity":case"fillOpacity":case"strokeOpacity":case"strokeWidth":var a=ii(t[r]);return a&&!a.aggregate&&n.push(Gr(a,{})),n}},[])}function Ci(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if("tooltip"in n)return{tooltip:n.tooltip};var i=e.map(function(e){var n=e.fieldPrefix,i=e.titlePrefix;return{field:n+t.field,type:t.type,title:i+(r?" of "+t.field:"")}});return{tooltip:[].concat(h(i),h(ki(n)))}}function Oi(e){var t=e.axis,n=e.title,r=e.field;return t&&void 0!==t.title?void 0:ye(n,r)}function Fi(e,t,n,r,i){var a=n.scale,o=n.axis;return function(u){var s=u.partName,c=u.mark,f=u.positionPrefix,d=u.endPositionPrefix,h=void 0===d?void 0:d,p=u.extraEncoding,v=void 0===p?{}:p,m=Oi(n);return _i(e,s,i,{mark:c,encoding:Object.assign(Object.assign(Object.assign(l({},t,Object.assign(Object.assign(Object.assign({field:f+"_"+n.field,type:n.type},void 0!==m?{title:m}:{}),void 0!==a?{scale:a}:{}),void 0!==o?{axis:o}:{})),b(h)?l({},t+"2",{field:h+"_"+n.field,type:n.type}):{}),r),v)})}}function _i(e,t,n,r){var i=e.clip,a=e.color,o=e.opacity,u=e.type;return e[t]||void 0===e[t]&&n[t]?[Object.assign(Object.assign({},r),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),i?{clip:i}:{}),a?{color:a}:{}),o?{opacity:o}:{}),ze(r.mark)?r.mark:{type:r.mark}),{style:"".concat(u,"-").concat(t)}),j(e[t])?{}:e[t])})]:[]}function Si(e,t,n){var r=e.encoding,i="vertical"===t?"y":"x",a=r[i],o=r[i+"2"],u=r[i+"Error"],s=r[i+"Error2"];return{continuousAxisChannelDef:Mi(a,n),continuousAxisChannelDef2:Mi(o,n),continuousAxisChannelDefError:Mi(u,n),continuousAxisChannelDefError2:Mi(s,n),continuousAxis:i}}function Mi(e,t){if(e&&e.aggregate){var n=e.aggregate,r=He(e,["aggregate"]);return n!==t&&un(rn.errorBarContinuousAxisHasCustomizedAggregate(n,t)),r}return e}function ji(e,t){var n=e.mark,r=e.encoding;if(Lr(r.x)&&Yr(r.x)){if(Lr(r.y)&&Yr(r.y)){if(void 0===r.x.aggregate&&r.y.aggregate===t)return"vertical";if(void 0===r.y.aggregate&&r.x.aggregate===t)return"horizontal";if(r.x.aggregate===t&&r.y.aggregate===t)throw new Error("Both x and y cannot have aggregate");return ze(n)&&n.orient?n.orient:"vertical"}return"horizontal"}if(Lr(r.y)&&Yr(r.y))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}var Ti="boxplot",Ni=oe({box:1,median:1,outliers:1,rule:1,ticks:1}),Bi=new We(Ti,zi);function Ri(e){return T(e)?"tukey":e}function zi(e,t){var n=t.config,r=e.mark,i=(e.encoding,e.selection),a=(e.projection,He(e,["mark","encoding","selection","projection"])),o=ze(r)?r:{type:r};i&&un(rn.selectionNotSupported("boxplot"));var u,s=o.extent||n.boxplot.extent,c=ye(o.size,n.boxplot.size),f=Ri(s),d=function(e,t,n){var r=ji(e,Ti),i=Si(e,r,Ti),a=i.continuousAxisChannelDef,o=i.continuousAxis,u=a.field,s=Ri(t),l=[].concat(h(Pi(u)),[{op:"median",field:u,as:"mid_box_"+u},{op:"min",field:u,as:("min-max"===s?"lower_whisker_":"min_")+u},{op:"max",field:u,as:("min-max"===s?"upper_whisker_":"max_")+u}]),c="min-max"===s||"tukey"===s?[]:[{calculate:'datum["upper_box_'.concat(u,'"] - datum["lower_box_').concat(u,'"]'),as:"iqr_"+u},{calculate:'min(datum["upper_box_'.concat(u,'"] + datum["iqr_').concat(u,'"] * ').concat(t,', datum["max_').concat(u,'"])'),as:"upper_whisker_"+u},{calculate:'max(datum["lower_box_'.concat(u,'"] - datum["iqr_').concat(u,'"] * ').concat(t,', datum["min_').concat(u,'"])'),as:"lower_whisker_"+u}],f=e.encoding,d=o,p=(f[d],function(e){var t,n,r=e.tooltip,i=He(e,["tooltip"]);return r?(g(r)?(r.forEach(function(e){e.aggregate?(t||(t=[]),t.push(e)):(n||(n=[]),n.push(e))}),t&&(i.tooltip=t)):r.aggregate?i.tooltip=r:n=r,g(n)&&1===n.length&&(n=n[0]),{customTooltipWithoutAggregatedField:n,filteredEncoding:i}):{filteredEncoding:e}}(He(f,["symbol"===typeof d?d:d+""]))),v=p.customTooltipWithoutAggregatedField,m=xi(p.filteredEncoding,n),y=m.bins,b=m.timeUnits,x=m.aggregate,w=m.groupby,k=m.encoding,A="vertical"===r?"horizontal":"vertical",E=r;return{transform:[].concat(h(y),h(b),[{aggregate:[].concat(h(x),h(l)),groupby:w}],c),groupby:w,aggregate:x,continuousAxisChannelDef:a,continuousAxis:o,encodingWithoutContinuousAxis:k,ticksOrient:A,boxOrient:E,customTooltipWithoutAggregatedField:v}}(e,s,n),p=d.transform,v=d.continuousAxisChannelDef,m=d.continuousAxis,b=d.groupby,x=d.aggregate,w=d.encodingWithoutContinuousAxis,k=d.ticksOrient,A=d.boxOrient,E=d.customTooltipWithoutAggregatedField,D=(w.color,w.size),C=He(w,["color","size"]),O=function(e){return Fi(o,m,v,e,n.boxplot)},F=O(C),_=O(w),S=O(Object.assign(Object.assign({},C),D?{size:D}:{})),M=Ci([{fieldPrefix:"min-max"===f?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===f?"lower_whisker_":"min_",titlePrefix:"Min"}],v,w),j={type:"tick",color:"black",opacity:1,orient:k,invalid:null},T="min-max"===f?M:Ci([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],v,w),N=[].concat(h(F({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:T})),h(F({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:T})),h(F({partName:"ticks",mark:j,positionPrefix:"lower_whisker",extraEncoding:T})),h(F({partName:"ticks",mark:j,positionPrefix:"upper_whisker",extraEncoding:T}))),B=[].concat(h("tukey"!==f?N:[]),h(_({partName:"box",mark:Object.assign(Object.assign({type:"bar"},c?{size:c}:{}),{orient:A,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:M})),h(S({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},y(n.boxplot.median)&&n.boxplot.median.color?{color:n.boxplot.median.color}:{}),c?{size:c}:{}),{orient:k}),positionPrefix:"mid_box",extraEncoding:M})));if("min-max"!==f){var R='datum["lower_box_'.concat(v.field,'"]'),z='datum["upper_box_'.concat(v.field,'"]'),P="(".concat(z," - ").concat(R,")"),L="".concat(R," - ").concat(s," * ").concat(P),I="".concat(z," + ").concat(s," * ").concat(P),U='datum["'.concat(v.field,'"]'),q={joinaggregate:Pi(v.field),groupby:b},W=void 0;"tukey"===f&&(W={transform:[{filter:"(".concat(L," <= ").concat(U,") && (").concat(U," <= ").concat(I,")")},{aggregate:[{op:"min",field:v.field,as:"lower_whisker_"+v.field},{op:"max",field:v.field,as:"upper_whisker_"+v.field},{op:"min",field:"lower_box_"+v.field,as:"lower_box_"+v.field},{op:"max",field:"upper_box_"+v.field,as:"upper_box_"+v.field}].concat(h(x)),groupby:b}],layer:N});var H=He(C,["tooltip"]),V=v.scale,G=v.axis,$=Oi(v),Y=_i(o,"outliers",n.boxplot,{transform:[{filter:"(".concat(U," < ").concat(L,") || (").concat(U," > ").concat(I,")")}],mark:"point",encoding:Object.assign(Object.assign(l({},m,Object.assign(Object.assign(Object.assign({field:v.field,type:v.type},void 0!==$?{title:$}:{}),void 0!==V?{scale:V}:{}),void 0!==G?{axis:G}:{})),H),E?{tooltip:E}:{})})[0];Y&&W?u={transform:[q],layer:[Y,W]}:Y?(u=Y).transform.unshift(q):W&&(u=W).transform.unshift(q)}return u?Object.assign(Object.assign({},a),{layer:[u,{transform:p,layer:B}]}):Object.assign(Object.assign({},a),{transform:(a.transform||[]).concat(p),layer:B})}function Pi(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}var Li="errorbar",Ii=oe({ticks:1,rule:1}),Ui=new We(Li,qi);function qi(e,t){var n=t.config,r=Hi(e,Li,n),i=r.transform,a=r.continuousAxisChannelDef,o=r.continuousAxis,u=r.encodingWithoutContinuousAxis,s=r.ticksOrient,l=r.markDef,c=r.outerSpec,f=r.tooltipEncoding,d=Fi(l,o,a,u,n.errorbar),p={type:"tick",orient:s};return Object.assign(Object.assign({},c),{transform:i,layer:[].concat(h(d({partName:"ticks",mark:p,positionPrefix:"lower",extraEncoding:f})),h(d({partName:"ticks",mark:p,positionPrefix:"upper",extraEncoding:f})),h(d({partName:"rule",mark:"rule",positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:f})))})}function Wi(e,t){var n=e.encoding;if(function(e){return(Lr(e.x)||Lr(e.y))&&!Lr(e.x2)&&!Lr(e.y2)&&!Lr(e.xError)&&!Lr(e.xError2)&&!Lr(e.yError)&&!Lr(e.yError2)}(n))return{orient:ji(e,t),inputType:"raw"};var r=function(e){return Lr(e.x2)||Lr(e.y2)}(n),i=function(e){return Lr(e.xError)||Lr(e.xError2)||Lr(e.yError)||Lr(e.yError2)}(n),a=n.x,o=n.y;if(r){if(i)throw new Error(t+" cannot be both type aggregated-upper-lower and aggregated-error");var u=n.x2,s=n.y2;if(Lr(u)&&Lr(s))throw new Error(t+" cannot have both x2 and y2");if(Lr(u)){if(Lr(a)&&Yr(a))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in "+t)}if(Lr(s)){if(Lr(o)&&Yr(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in "+t)}throw new Error("No ranged axis")}var l=n.xError,c=n.xError2,f=n.yError,d=n.yError2;if(Lr(c)&&!Lr(l))throw new Error(t+" cannot have xError2 without xError");if(Lr(d)&&!Lr(f))throw new Error(t+" cannot have yError2 without yError");if(Lr(l)&&Lr(f))throw new Error(t+" cannot have both xError and yError with both are quantiative");if(Lr(l)){if(Lr(a)&&Yr(a))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(Lr(f)){if(Lr(o)&&Yr(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}function Hi(e,t,n){var r=e.mark,i=e.encoding,a=e.selection,o=(e.projection,He(e,["mark","encoding","selection","projection"])),u=ze(r)?r:{type:r};a&&un(rn.selectionNotSupported(t));var s=Wi(e,t),l=s.orient,c=s.inputType,f=Si(e,l,t),d=f.continuousAxisChannelDef,p=f.continuousAxisChannelDef2,v=f.continuousAxisChannelDefError,m=f.continuousAxisChannelDefError2,g=f.continuousAxis,y=function(e,t,n,r,i,a,o,u){var s,l=[],c=[],f=t.field,d=!1;if("raw"===a){var h,p,v,m=e.center?e.center:e.extent?"iqr"===e.extent?"median":"mean":u.errorbar.center,g=e.extent?e.extent:"mean"===m?"stderr":"iqr";"median"===m!==("iqr"===g)&&un(rn.errorBarCenterIsUsedWithWrongExtent(m,g,o)),"stderr"===g||"stdev"===g?(l=[{op:g,field:f,as:"extent_"+f},{op:m,field:f,as:"center_"+f}],c=[{calculate:'datum["center_'.concat(f,'"] + datum["extent_').concat(f,'"]'),as:"upper_"+f},{calculate:'datum["center_'.concat(f,'"] - datum["extent_').concat(f,'"]'),as:"lower_"+f}],s=[{fieldPrefix:"center_",titlePrefix:de(m)},{fieldPrefix:"upper_",titlePrefix:Vi(m,g,"+")},{fieldPrefix:"lower_",titlePrefix:Vi(m,g,"-")}],d=!0):(e.center&&e.extent&&un(rn.errorBarCenterIsNotNeeded(e.extent,o)),"ci"===g?(h="mean",p="ci0",v="ci1"):(h="median",p="q1",v="q3"),l=[{op:p,field:f,as:"lower_"+f},{op:v,field:f,as:"upper_"+f},{op:h,field:f,as:"center_"+f}],s=[{fieldPrefix:"upper_",titlePrefix:Zr({field:f,aggregate:v,type:"quantitative"},u,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Zr({field:f,aggregate:p,type:"quantitative"},u,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Zr({field:f,aggregate:h,type:"quantitative"},u,{allowDisabling:!1})}])}else{(e.center||e.extent)&&un(rn.errorBarCenterAndExtentAreNotNeeded(e.center,e.extent)),"aggregated-upper-lower"===a?(s=[],c=[{calculate:'datum["'.concat(n.field,'"]'),as:"upper_"+f},{calculate:'datum["'.concat(f,'"]'),as:"lower_"+f}]):"aggregated-error"===a&&(s=[{fieldPrefix:"",titlePrefix:f}],c=[{calculate:'datum["'.concat(f,'"] + datum["').concat(r.field,'"]'),as:"upper_"+f}],i?c.push({calculate:'datum["'.concat(f,'"] + datum["').concat(i.field,'"]'),as:"lower_"+f}):c.push({calculate:'datum["'.concat(f,'"] - datum["').concat(r.field,'"]'),as:"lower_"+f}));var y=!0,b=!1,x=void 0;try{for(var w,k=c[Symbol.iterator]();!(y=(w=k.next()).done);y=!0){var A=w.value;s.push({fieldPrefix:A.as.substring(0,6),titlePrefix:ve(ve(A.calculate,'datum["',""),'"]',"")})}}catch(E){b=!0,x=E}finally{try{y||null==k.return||k.return()}finally{if(b)throw x}}}return{postAggregateCalculates:c,errorBarSpecificAggregate:l,tooltipSummary:s,tooltipTitleWithFieldName:d}}(u,d,p,v,m,c,t,n),b=y.errorBarSpecificAggregate,x=y.postAggregateCalculates,w=y.tooltipSummary,k=y.tooltipTitleWithFieldName,A=g,E=(i[A],"x"===g?"x2":"y2"),D=(i[E],"x"===g?"xError":"yError"),C=(i[D],"x"===g?"xError2":"yError2"),O=(i[C],xi(He(i,["symbol"===typeof A?A:A+"","symbol"===typeof E?E:E+"","symbol"===typeof D?D:D+"","symbol"===typeof C?C:C+""]),n)),F=O.bins,_=O.timeUnits,S=O.aggregate,M=O.groupby,j=O.encoding,T=[].concat(h(S),h(b)),N="raw"!==c?[]:M,B=Ci(w,d,j,k);return{transform:[].concat(h(o.transform||[]),h(F),h(_),h(T.length?[{aggregate:T,groupby:N}]:[]),h(x)),groupby:N,continuousAxisChannelDef:d,continuousAxis:g,encodingWithoutContinuousAxis:j,ticksOrient:"vertical"===l?"horizontal":"vertical",markDef:u,outerSpec:o,tooltipEncoding:B}}function Vi(e,t,n){return de(e)+" "+n+" "+t}var Gi="errorband",$i=oe({band:1,borders:1}),Yi=new We(Gi,Xi);function Xi(e,t){var n=t.config,r=Hi(e,Gi,n),i=r.transform,a=r.continuousAxisChannelDef,o=r.continuousAxis,u=r.encodingWithoutContinuousAxis,s=r.markDef,l=r.outerSpec,c=r.tooltipEncoding,f=s,d=Fi(f,o,a,u,n.errorband),p=void 0!==e.encoding.x&&void 0!==e.encoding.y,v={type:p?"area":"rect"},m={type:p?"line":"rule"},g=Object.assign(Object.assign({},f.interpolate?{interpolate:f.interpolate}:{}),f.tension&&f.interpolate?{interpolate:f.tension}:{});return p?(v=Object.assign(Object.assign({},v),g),m=Object.assign(Object.assign({},m),g)):f.interpolate?un(rn.errorBand1DNotSupport("interpolate")):f.tension&&un(rn.errorBand1DNotSupport("tension")),Object.assign(Object.assign({},l),{transform:i,layer:[].concat(h(d({partName:"band",mark:v,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c})),h(d({partName:"borders",mark:m,positionPrefix:"lower",extraEncoding:c})),h(d({partName:"borders",mark:m,positionPrefix:"upper",extraEncoding:c})))})}var Ji={};function Qi(e,t,n){var r=new We(e,t);Ji[e]={normalizer:r,parts:n}}Qi(Ti,zi,Ni),Qi(Li,qi,Ii),Qi(Gi,Xi,$i);var Ki=["shortTimeLabels"],Zi=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength"],ea="_vgsid_",ta={single:{on:"click",fields:[ea],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[ea],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function na(e){return void 0!==e.concat}function ra(e){return void 0!==e.vconcat}function ia(e){return void 0!==e.hconcat}function aa(e){return void 0!==e.repeat}function oa(e){return y(e)&&void 0!==e.step}var ua=oe({align:1,bounds:1,center:1,columns:1,spacing:1});function sa(e){var t=e.anchor,n=e.frame,r=e.offset,i=e.orient,a=e.color,o=He(e,["anchor","frame","offset","orient","color"]);return{mark:Object.assign(Object.assign({},o),a?{fill:a}:{}),nonMark:Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{})}}function la(e,t){return e["width"===t?"continuousWidth":"continuousHeight"]}function ca(e,t){var n=fa(e,t);return oa(n)?n.step:da}function fa(e,t){return ye(e["width"===t?"discreteWidth":"discreteHeight"],{step:e.step})}var da=20,ha={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:da},mark:{color:"#4c78a8",invalid:"filter",timeUnitBand:1},area:{},bar:Ie,circle:{},geoshape:{},image:{},line:{},point:{},rect:Ue,rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},axis:{},axisX:{},axisY:{},axisLeft:{},axisRight:{},axisTop:{},axisBottom:{},axisBand:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:ta,style:{},title:{},facet:{spacing:20},repeat:{spacing:20},concat:{spacing:20}};function pa(e){return ee(V(ha),e)}var va=["view"].concat(h(Re)),ma=["padding","facet","concat","repeat","numberFormat","timeFormat","countTitle","header","scale","selection","overlay"],ga=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},{area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],text:["shortTimeLabels"],tick:["bandSize","thickness"]});function ya(e){e=V(e);var t=!0,n=!1,r=void 0;try{for(var i,a=ma[Symbol.iterator]();!(t=(i=a.next()).done);t=!0)delete e[i.value]}catch(re){n=!0,r=re}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}if(e.axis){var o=!0,u=!1,s=void 0;try{for(var l,c=Ki[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value;delete e.axis[f]}}catch(re){u=!0,s=re}finally{try{o||null==c.return||c.return()}finally{if(u)throw s}}}if(e.legend){var d=!0,h=!1,p=void 0;try{for(var v,m=Ki[Symbol.iterator]();!(d=(v=m.next()).done);d=!0){var g=v.value;delete e.legend[g]}}catch(re){h=!0,p=re}finally{try{d||null==m.return||m.return()}finally{if(h)throw p}}var b=!0,x=!1,w=void 0;try{for(var k,A=Zi[Symbol.iterator]();!(b=(k=A.next()).done);b=!0){var E=k.value;delete e.legend[E]}}catch(re){x=!0,w=re}finally{try{b||null==A.return||A.return()}finally{if(x)throw w}}}if(e.mark){var D=!0,C=!1,O=void 0;try{for(var F,_=Le[Symbol.iterator]();!(D=(F=_.next()).done);D=!0){var S=F.value;delete e.mark[S]}}catch(re){C=!0,O=re}finally{try{D||null==_.return||_.return()}finally{if(C)throw O}}}var M=!0,j=!1,T=void 0;try{for(var N,B=va[Symbol.iterator]();!(M=(N=B.next()).done);M=!0){var R=N.value,z=!0,P=!1,L=void 0;try{for(var I,U=Le[Symbol.iterator]();!(z=(I=U.next()).done);z=!0){var q=I.value;delete e[R][q]}}catch(re){P=!0,L=re}finally{try{z||null==U.return||U.return()}finally{if(P)throw L}}var W=ga[R];if(W){var H=!0,G=!1,$=void 0;try{for(var Y,X=W[Symbol.iterator]();!(H=(Y=X.next()).done);H=!0){var J=Y.value;delete e[R][J]}}catch(re){G=!0,$=re}finally{try{H||null==X.return||X.return()}finally{if(G)throw $}}}ba(e,R)}}catch(re){j=!0,T=re}finally{try{M||null==B.return||B.return()}finally{if(j)throw T}}var Q=!0,K=!1,Z=void 0;try{for(var ee,te=oe(Ji)[Symbol.iterator]();!(Q=(ee=te.next()).done);Q=!0)delete e[ee.value]}catch(re){K=!0,Z=re}finally{try{Q||null==te.return||te.return()}finally{if(K)throw Z}}for(var ne in ba(e,"title","group-title"),e)y(e[ne])&&0===oe(e[ne]).length&&delete e[ne];return oe(e).length>0?e:void 0}function ba(e,t,n,r){var i="title"===t?sa(e.title).mark:r?e[t][r]:e[t];"view"===t&&(n="cell");var a=Object.assign(Object.assign({},i),e.style[t]);oe(a).length>0&&(e.style[n||t]=a),r||delete e[t]}function xa(e){return void 0!==e.layer}var wa=function(){function e(){c(this,e)}return f(e,[{key:"map",value:function(e,t){return jr(e)?this.mapFacet(e,t):aa(e)?this.mapRepeat(e,t):ia(e)?this.mapHConcat(e,t):ra(e)?this.mapVConcat(e,t):na(e)?this.mapConcat(e,t):this.mapLayerOrUnit(e,t)}},{key:"mapLayerOrUnit",value:function(e,t){if(xa(e))return this.mapLayer(e,t);if(qe(e))return this.mapUnit(e,t);throw new Error(rn.invalidSpec(e))}},{key:"mapLayer",value:function(e,t){var n=this;return Object.assign(Object.assign({},e),{layer:e.layer.map(function(e){return n.mapLayerOrUnit(e,t)})})}},{key:"mapHConcat",value:function(e,t){var n=this;return Object.assign(Object.assign({},e),{hconcat:e.hconcat.map(function(e){return n.map(e,t)})})}},{key:"mapVConcat",value:function(e,t){var n=this;return Object.assign(Object.assign({},e),{vconcat:e.vconcat.map(function(e){return n.map(e,t)})})}},{key:"mapConcat",value:function(e,t){var n=this,r=e.concat,i=He(e,["concat"]);return Object.assign(Object.assign({},i),{concat:r.map(function(e){return n.map(e,t)})})}},{key:"mapFacet",value:function(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}},{key:"mapRepeat",value:function(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}}]),e}(),ka={zero:1,center:1,normalize:1},Aa=[ke,we,Oe,De,Me,je,Ee,Fe,_e],Ea=[ke,we];function Da(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=ze(e)?e.type:e;if(!Q(Aa,r))return null;var i=function(e){var t=e.x,n=e.y;if(Lr(t)&&Lr(n))if("quantitative"===t.type&&"quantitative"===n.type){if(t.stack)return"x";if(n.stack)return"y";if(!!t.aggregate!==!!n.aggregate)return t.aggregate?"x":"y"}else{if("quantitative"===t.type)return"x";if("quantitative"===n.type)return"y"}else{if(Lr(t)&&"quantitative"===t.type)return"x";if(Lr(n)&&"quantitative"===n.type)return"y"}}(t);if(!i)return null;var a,o=t[i],u=Ur(o)?Gr(o,{}):void 0,s="x"===i?"y":"x",l=t[s],c=Ur(l)?Gr(l,{}):void 0,f=Wt.reduce(function(e,n){if("tooltip"!==n&&yi(t,n)){var r=t[n];(g(r)?r:[r]).forEach(function(t){var r=ii(t);if(!r.aggregate){var i=Ur(r)?Gr(r,{}):void 0;(!i||i!==c&&i!==u)&&e.push({channel:n,fieldDef:r})}})}return e},[]);if(void 0!==o.stack?a=j(o.stack)?o.stack?"zero":null:o.stack:f.length>0&&Q(Ea,r)&&(a="zero"),!a||!ka[a])return null;if(bi(t)&&0===f.length)return null;if(o.scale&&o.scale.type&&o.scale.type!==zn.LINEAR){if(n.disallowNonLinearStack)return null;un(rn.cannotStackNonLinearScale(o.scale.type))}return yi(t,i===rt?at:ot)?(void 0!==o.stack&&un(rn.cannotStackRangedMark(i)),null):(o.aggregate&&!Q(Ke,o.aggregate)&&un(rn.stackNonSummativeAggregate(o.aggregate)),{groupbyChannel:l?s:void 0,fieldChannel:i,impute:Ne(r),stackBy:f,offset:a})}function Ca(e){var t=He(e,["point","line"]);return oe(t).length>1?t:t.type}function Oa(e){for(var t=0,n=["line","area","rule","trail"];t<n.length;t++){var r=n[t];e[r]&&(e=Object.assign(Object.assign({},e),l({},r,$(e[r],["point","line"]))))}return e}function Fa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return"transparent"===e.point?{opacity:0}:e.point?y(e.point)?e.point:{}:void 0!==e.point?null:t.point||n.shape?y(t.point)?t.point:{}:void 0}function _a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.line?!0===e.line?{}:e.line:void 0!==e.line?null:t.line?!0===t.line?{}:t.line:void 0}var Sa=function(){function e(){c(this,e),this.name="path-overlay"}return f(e,[{key:"hasMatchingType",value:function(e,t){if(qe(e)){var n=e.mark,r=e.encoding,i=ze(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!Fa(i,t[i.type],r);case"area":return!!Fa(i,t[i.type],r)||!!_a(i,t[i.type])}}return!1}},{key:"run",value:function(e,t,n){var r=t.config,i=e.selection,a=e.projection,o=e.encoding,u=e.mark,s=He(e,["selection","projection","encoding","mark"]),c=ze(u)?u:{type:u},f=Fa(c,r[c.type],o),d="area"===c.type&&_a(c,r[c.type]),h=[Object.assign(Object.assign({},i?{selection:i}:{}),{mark:Ca(Object.assign(Object.assign({},c),"area"===c.type?{opacity:.7}:{})),encoding:$(o,["shape"])})],p=Da(c,o),v=o;if(p){var m=p.fieldChannel,g=p.offset;v=Object.assign(Object.assign({},o),l({},m,Object.assign(Object.assign({},o[m]),g?{stack:g}:{})))}return d&&h.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"line"},G(c,["clip","interpolate","tension","tooltip"])),d),encoding:v})),f&&h.push(Object.assign(Object.assign({},a?{projection:a}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},G(c,["clip","tooltip"])),f),encoding:v})),n(Object.assign(Object.assign({},s),{layer:h}),Object.assign(Object.assign({},t),{config:Oa(r)}))}}]),e}(),Ma=function(){function e(){c(this,e),this.name="RangeStep"}return f(e,[{key:"hasMatchingType",value:function(e){if(qe(e)&&e.encoding){var t=!0,n=!1,r=void 0;try{for(var i,a=Vt[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,u=e.encoding[o];if(u&&Lr(u)&&u&&u.scale&&u.scale.rangeStep)return!0}}catch(s){n=!0,r=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}return!1}},{key:"run",value:function(e){var t={},n=Object.assign({},e.encoding),r=!0,i=!1,a=void 0;try{for(var o,u=Vt[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,c=Gt(s),f=n[s];if(f&&Lr(f)&&f&&f.scale&&f.scale.rangeStep){var d=f.scale,h=He(f,["scale"]),p=He(d,["rangeStep"]);t[c]={step:d.rangeStep},un(rn.RANGE_STEP_DEPRECATED),n=Object.assign(Object.assign({},n),l({},s,Object.assign(Object.assign({},h),oe(p).length?{scale:p}:{})))}}}catch(v){i=!0,a=v}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return Object.assign(Object.assign(Object.assign({},t),e),{encoding:n})}}]),e}(),ja=function(){function e(){c(this,e),this.name="RuleForRangedLine"}return f(e,[{key:"hasMatchingType",value:function(e){if(qe(e)){var t=e.encoding;if("line"===e.mark){var n=!0,r=!1,i=void 0;try{for(var a,o=Pt[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value,s=t[It(u)];if(t[u]&&Lr(s)&&!vi(s.bin))return!0}}catch(l){r=!0,i=l}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}}return!1}},{key:"run",value:function(e,t,n){var r=e.encoding;return un(rn.lineWithRange(!!r.x2,!!r.y2)),n(Object.assign(Object.assign({},e),{mark:"rule"}),t)}}]),e}();function Ta(e){var t=e.parentEncoding,n=e.encoding;if(t&&n){var r=oe(t).reduce(function(e,t){return n[t]&&e.push(t),e},[]);r.length>0&&un(rn.encodingOverridden(r))}var i=Object.assign(Object.assign({},t||{}),n||{});return oe(i).length>0?i:void 0}function Na(e){var t=e.parentProjection,n=e.projection;return t&&n&&un(rn.projectionOverridden({parentProjection:t,projection:n})),n||t}function Ba(e,t){void 0===t&&(t=pa(e.config));var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ra.map(e,{config:t})}(e,t),r=e.width,i=e.height,a=e.autosize;return Object.assign(Object.assign({},n),{autosize:Pa(n,{width:r,height:i,autosize:a},t)})}var Ra=new(function(e){function t(){var e;return c(this,t),(e=a(this,o(t).apply(this,arguments))).nonFacetUnitNormalizers=[Bi,Ui,Yi,new Sa,new ja,new Ma],e}return s(t,wa),f(t,[{key:"map",value:function(e,n){if(qe(e)){var r=yi(e.encoding,et),i=yi(e.encoding,tt),a=yi(e.encoding,nt);if(r||i||a)return this.mapFacetedUnit(e,n)}return u(o(t.prototype),"map",this).call(this,e,n)}},{key:"mapUnit",value:function(e,t){var n=t.parentEncoding,r=t.parentProjection;if(n||r)return this.mapUnitWithParentEncodingOrProjection(e,t);var i=this.mapLayerOrUnit.bind(this),a=!0,o=!1,u=void 0;try{for(var s,l=this.nonFacetUnitNormalizers[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;if(c.hasMatchingType(e,t.config))return c.run(e,t,i)}}catch(f){o=!0,u=f}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}return e}},{key:"mapRepeat",value:function(e,t){var n=e.repeat;return!g(n)&&e.columns&&(e=$(e,["columns"]),un(rn.columnsNotSupportByRowCol("repeat"))),Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}},{key:"mapFacet",value:function(e,n){return Mr(e.facet)&&e.columns&&(e=$(e,["columns"]),un(rn.columnsNotSupportByRowCol("facet"))),u(o(t.prototype),"mapFacet",this).call(this,e,n)}},{key:"mapUnitWithParentEncodingOrProjection",value:function(e,t){var n=e.encoding,r=e.projection,i=t.parentEncoding,a=t.parentProjection,o=t.config,u=Na({parentProjection:a,projection:r}),s=Ta({parentEncoding:i,encoding:n});return this.mapUnit(Object.assign(Object.assign(Object.assign({},e),u?{projection:u}:{}),s?{encoding:s}:{}),{config:o})}},{key:"mapFacetedUnit",value:function(e,t){var n=e.encoding,r=n.row,i=n.column,a=n.facet,o=He(n,["row","column","facet"]),u=e.mark,s=e.width,l=e.projection,c=e.height,f=e.selection,d=(e.encoding,He(e,["mark","width","projection","height","selection","encoding"])),h=this.getFacetMappingAndLayout({row:r,column:i,facet:a}),p=h.facetMapping,v=h.layout;return this.mapFacet(Object.assign(Object.assign(Object.assign({},d),v),{facet:p,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l?{projection:l}:{}),{mark:u}),s?{width:s}:{}),c?{height:c}:{}),{encoding:o}),f?{selection:f}:{})}),t)}},{key:"getFacetMappingAndLayout",value:function(e){var t=e.row,n=e.column,r=e.facet;if(t||n){r&&un(rn.facetChannelDropped([].concat(h(t?[et]:[]),h(n?[tt]:[]))));for(var i={},a={},o=0,u=[et,tt];o<u.length;o++){var s=u[o],l=e[s];if(l){var c=He(l,["align","center","spacing","columns"]);i[s]=c;for(var f=0,d=["align","center","spacing"];f<d.length;f++){var p=d[f];void 0!==l[p]&&(a[p]=a[p]||{},a[p][s]=l[p])}}}return{facetMapping:i,layout:a}}var v=r.align,m=r.center,g=r.spacing,y=r.columns;return{facetMapping:He(r,["align","center","spacing","columns"]),layout:Object.assign(Object.assign(Object.assign(Object.assign({},v?{align:v}:{}),m?{center:m}:{}),g?{spacing:g}:{}),y?{columns:y}:{})}}},{key:"mapLayer",value:function(e,n){var r=n.parentEncoding,i=n.parentProjection,a=He(n,["parentEncoding","parentProjection"]),s=e.encoding,l=e.projection,c=He(e,["encoding","projection"]),f=Object.assign(Object.assign({},a),{parentEncoding:Ta({parentEncoding:r,encoding:s}),parentProjection:Na({parentProjection:i,projection:l})});return u(o(t.prototype),"mapLayer",this).call(this,c,f)}}]),t}());function za(e){return b(e)?{type:e}:e||{}}function Pa(e,t,n){var r=t.width,i=t.height,a=qe(e)||xa(e),o={};a?"container"==r&&"container"==i?(o.type="fit",o.contains="padding"):"container"==r?(o.type="fit-x",o.contains="padding"):"container"==i&&(o.type="fit-y",o.contains="padding"):("container"==r&&(un(rn.containerSizeNonSingle("width")),r=void 0),"container"==i&&(un(rn.containerSizeNonSingle("height")),i=void 0));var u=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?za(n.autosize):{}),za(e.autosize));return"fit"!==u.type||a||(un(rn.FIT_NON_SINGLE),u.type="pad"),"container"==r&&"fit"!=u.type&&"fit-x"!=u.type&&un(rn.containerSizeNotCompatibleWithAutosize("width")),"container"==i&&"fit"!=u.type&&"fit-y"!=u.type&&un(rn.containerSizeNotCompatibleWithAutosize("height")),u}var La=["background","padding"];function Ia(e){return La.reduce(function(t,n){return e&&void 0!==e[n]&&(t[n]=e[n]),t},{})}function Ua(e){return!!e.url}function qa(e){return!!e.values}function Wa(e){return!!e.name&&!Ua(e)&&!qa(e)&&!Ha(e)}function Ha(e){return e&&(Va(e)||Ga(e)||$a(e))}function Va(e){return!!e.sequence}function Ga(e){return!!e.sphere}function $a(e){return!!e.graticule}var Ya="main",Xa="raw";function Ja(e){return void 0!==e.filter}function Qa(e){return void 0!==e.pivot}function Ka(e){return void 0!==e.density}function Za(e){return void 0!==e.quantile}function eo(e){return void 0!==e.regression}function to(e){return void 0!==e.loess}function no(e){return void 0!==e.lookup}function ro(e){return void 0!==e.sample}function io(e){return void 0!==e.window}function ao(e){return void 0!==e.joinaggregate}function oo(e){return void 0!==e.flatten}function uo(e){return void 0!==e.calculate}function so(e){return!!e.bin}function lo(e){return void 0!==e.impute}function co(e){return void 0!==e.timeUnit}function fo(e){return void 0!==e.aggregate}function ho(e){return void 0!==e.stack}function po(e){return void 0!==e.fold}function vo(e){return!!e.signal}function mo(e){return!!e.step}function go(e){return!g(e)&&"field"in e&&"data"in e}var yo=oe({opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeMiterLimit:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,cursor:1,href:1,tooltip:1,cornerRadius:1,x:1,y:1,x2:1,y2:1,width:1,height:1,aspect:1}),bo={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickWidth:{part:"ticks",vgProp:"strokeWidth"}},xo=["domain","grid","labels","ticks","title"],wo={grid:"grid",gridColor:"grid",gridDash:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",domain:"main",domainColor:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontWeight:"main",labelLimit:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",maxExtent:"main",minExtent:"main",offset:"main",position:"main",tickColor:"main",tickExtra:"main",tickOffset:"both",tickOpacity:"main",tickRound:"main",ticks:"main",tickSize:"main",title:"main",titleAlign:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",tickWidth:"both",tickCount:"both",values:"both",scale:"both",zindex:"both"},ko={orient:1,bandPosition:1,domain:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,values:1,zindex:1},Ao=Object.assign(Object.assign({},ko),{labelExpr:1,encoding:1});function Eo(e,t,n){return Do=t||Oo,Co=n||zo,Lo(e.trim()).map(Io)}var Do,Co,Oo="view",Fo="[",_o="]",So="{",Mo="}",jo=":",To=",",No="@",Bo=">",Ro=/[[\]{}]/,zo={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function Po(e,t,n,r,i){for(var a,o=0,u=e.length;t<u;++t){if(a=e[t],!o&&a===n)return t;i&&i.indexOf(a)>=0?--o:r&&r.indexOf(a)>=0&&++o}return t}function Lo(e){for(var t=[],n=0,r=e.length,i=0;i<r;)i=Po(e,i,To,Fo+So,_o+Mo),t.push(e.substring(n,i).trim()),n=++i;if(0===t.length)throw"Empty event selector: "+e;return t}function Io(e){return"["===e[0]?function(e){var t,n,r=e.length,i=1;if((i=Po(e,i,_o,Fo,_o))===r)throw"Empty between selector: "+e;if(2!==(t=Lo(e.substring(1,i))).length)throw"Between selector must have two elements: "+e;if((e=e.slice(i+1).trim())[0]!==Bo)throw"Expected '>' after between selector: "+e;return t=t.map(Io),(n=Io(e.slice(1).trim())).between?{between:t,stream:n}:(n.between=t,n)}(e):function(e){var t,n,r={source:Do},i=[],a=[0,0],o=0,u=0,s=e.length,l=0;if(e[s-1]===Mo){if(!((l=e.lastIndexOf(So))>=0))throw"Unmatched right brace: "+e;try{a=function(e){var t=e.split(To);if(!e.length||t.length>2)throw e;return t.map(function(t){var n=+t;if(n!==n)throw e;return n})}(e.substring(l+1,s-1))}catch(c){throw"Invalid throttle specification: "+e}e=e.slice(0,l).trim(),s=e.length,l=0}if(!s)throw e;if(e[0]===No&&(o=++l),(t=Po(e,l,jo))<s&&(i.push(e.substring(u,t).trim()),u=l=++t),(l=Po(e,l,Fo))===s)i.push(e.substring(u,s).trim());else if(i.push(e.substring(u,l).trim()),n=[],(u=++l)===s)throw"Unmatched left bracket: "+e;for(;l<s;){if((l=Po(e,l,_o))===s)throw"Unmatched left bracket: "+e;if(n.push(e.substring(u,l).trim()),l<s-1&&e[++l]!==Fo)throw"Expected left bracket: "+e;u=++l}if(!(s=i.length)||Ro.test(i[s-1]))throw"Invalid event selector: "+e;return s>1?(r.type=i[1],o?r.markname=i[0].slice(1):function(e){return Co[e]}(i[0])?r.marktype=i[0]:r.source=i[0]):r.type=i[0],"!"===r.type.slice(-1)&&(r.consume=!0,r.type=r.type.slice(0,-1)),null!=n&&(r.filter=n),a[0]&&(r.throttle=a[0]),a[1]&&(r.debounce=a[1]),r}(e)}function Uo(e){var t=e.channel,n=e.channelDef,r=e.markDef,i=e.scale,a=Jo(e);return Lr(n)&&!Qe(n.aggregate)&&i&&tr(i.get("type"))&&!1===i.get("zero")?qo({fieldDef:n,channel:t,markDef:r,ref:a}):a}function qo(e){var t=e.fieldDef,n=e.channel,r=e.markDef,i=e.ref;return Ne(r.type)?i:[Wo(t,n),i]}function Wo(e,t){var n=Ho(e,!0),r="x"===It(t)?{value:0}:{field:{group:"height"}};return Object.assign({test:n},r)}function Ho(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Bn(b(e)?e:Gr(e,{expr:"datum"}),!t)}function Vo(e,t){var n=t[e+"Offset"];if(n)return n}function Go(e){var t=e.channel,n=e.fieldDef,r=e.scaleName;return qo({fieldDef:n,channel:t,markDef:e.markDef,ref:Xo({scaleName:r,fieldDef:n,band:e.band,offset:e.offset})})}function $o(e,t,n,r){var i=Object.assign(Object.assign({},t?{scale:t}:{}),{field:Gr(e,n)});if(r){var a=r.offset,o=r.band;return Object.assign(Object.assign(Object.assign({},i),a?{offset:a}:{}),o?{band:o}:{})}return i}function Yo(e){return{scale:e,band:!(arguments.length>1&&void 0!==arguments[1])||arguments[1]}}function Xo(e){var t=e.scaleName,n=e.fieldDef,r=e.fieldDef2,i=e.offset,a=e.startSuffix,o=e.band,u=void 0===o?.5:o,s=0<u&&u<1?"datum":void 0,l=Gr(n,{expr:s,suffix:a}),c=void 0!==r?Gr(r,{expr:s}):Gr(n,{suffix:"end",expr:s});if(0===u)return Object.assign({scale:t,field:l},i?{offset:i}:{});if(1===u)return Object.assign({scale:t,field:c},i?{offset:i}:{});var f="".concat(u," * ").concat(l," + ").concat(1-u," * ").concat(c);return Object.assign({signal:'scale("'.concat(t,'", ').concat(f,")")},i?{offset:i}:{})}function Jo(e){var t=e.channel,n=e.channelDef,r=e.channel2Def,i=e.markDef,a=e.config,o=e.scaleName,u=e.scale,s=e.stack,l=e.offset,c=e.defaultRef;if(n){if(Lr(n)){if(Ir(n)){var f=Br(t,n,r,i,a,{isMidPoint:!0});if(pi(n.bin)||f&&n.timeUnit)return Q([rt,it],t)&&Q([Ln,Un],n.type)?s&&s.impute?$o(n,o,{binSuffix:"mid"},{offset:l}):Xo({scaleName:o,fieldDef:n,band:f,offset:l}):$o(n,o,di(n,t)?{binSuffix:"range"}:{},{offset:l});if(vi(n.bin)){if(Lr(r))return Xo({scaleName:o,fieldDef:n,fieldDef2:r,band:f,offset:l});var d=t===rt?at:ot;un(rn.channelRequiredForBinned(d))}}if(u){var h=u.get("type");if(Zn(h))return $o(n,o,{binSuffix:"range"},"band"===h?{band:ye(Hr(n)?n.band:void 0,.5),offset:l}:{offset:l})}return $o(n,o,{},{offset:l})}if(qr(n)){var p=n.value,v=l?{offset:l}:{};return Object.assign(Object.assign({},Qo(t,p)),v)}}return"function"===typeof c?c():c}function Qo(e,t){return Q(["x","x2"],e)&&"width"===t?{field:{group:"width"}}:Q(["y","y2"],e)&&"height"===t?{field:{group:"height"}}:{value:t}}function Ko(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).reactiveGeom,r=[],i={},a={},o=n?"datum.datum":"datum",u=[];function s(n,r){var i=It(r),s=Ir(n)?n:Object.assign(Object.assign({},n),{type:e[i].type}),l=Zr(s,t,{allowDisabling:!1}),c=Zo(s,t,o).signal;if("x"===r||"y"===r){var f="x"===r?"x2":"y2",d=ri(e[f]);vi(s.bin)&&d&&(c=br(Gr(s,{expr:o}),Gr(d,{expr:o}),ni(s),t),a[f]=!0)}u.push({channel:r,key:l,value:c})}Ai(e,function(e,t){Lr(e)?s(e,t):Pr(e)&&s(e.condition,t)});for(var l=0,c=u;l<c.length;l++){var f=c[l],d=f.channel,h=f.key,p=f.value;a[d]||i[h]||(r.push("".concat(x(h),": ").concat(p)),i[h]=!0)}return r.length?{signal:"{".concat(r.join(", "),"}")}:void 0}function Zo(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"datum";if(e){if(qr(e))return{value:e.value};if(Ir(e))return vr(e,ni(e),n,t)}}function eu(e){return Object.assign(Object.assign({},e),{mult:.5})}function tu(e){var t=e.markDef,n=e.config,r=e.defaultRef,i=e.channel,a=e.scaleName,o=e.scale,u=e.mark,s=e.checkBarAreaWithoutZero;return function(){var e=It(i),l=ye(t[i],hr(i,t,n));if(void 0!==l)return Qo(i,l);if(b(r)){if(a){var c=o.get("type");if(Q([zn.LOG,zn.TIME,zn.UTC],c))!s||"bar"!==u&&"area"!==u||un(rn.nonZeroScaleUsedWithLengthMark(u,e,{scaleType:c}));else{if(o.domainDefinitelyIncludesZero())return{scale:a,value:0};!s||"bar"!==u&&"area"!==u||un(rn.nonZeroScaleUsedWithLengthMark(u,e,{zeroFalse:!1===o.explicit.zero}))}}return"zeroOrMin"===r?"x"===e?{value:0}:{field:{group:"height"}}:"x"===e?{field:{group:"width"}}:{value:0}}return r}}function nu(e){var t=e.markDef,n=e.encoding,r=e.config,i=t.filled,a=t.type,o={fill:hr("fill",t,r),stroke:hr("stroke",t,r),color:hr("color",t,r)},u=Q(["bar","point","circle","square","geoshape"],a)?"transparent":void 0,s=ye(t.fill,!0===i?t.color:void 0,o.fill,!0===i?o.color:void 0,u),l=ye(t.stroke,!1===i?t.color:void 0,o.stroke,!1===i?o.color:void 0),c=i?"fill":"stroke",f=Object.assign(Object.assign({},s?{fill:{value:s}}:{}),l?{stroke:{value:l}}:{});return t.color&&(i?t.fill:t.stroke)&&un(rn.droppingColor("property",{fill:"fill"in t,stroke:"stroke"in t})),Object.assign(Object.assign(Object.assign(Object.assign({},f),su("color",e,{vgChannel:c,defaultValue:i?s:l})),su("fill",e,{defaultValue:n.fill?s:void 0})),su("stroke",e,{defaultValue:n.stroke?l:void 0}))}function ru(e,t){var n="include"===t.color?nu(e):{},r=n.fill,i=void 0===r?void 0:r,a=n.stroke,o=void 0===a?void 0:a;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function(e,t){return yo.reduce(function(n,r){return void 0!==e[r]&&"ignore"!==t[r]&&(n[r]={value:e[r]}),n},{})}(e.markDef,t)),iu(e,"fill",i)),iu(e,"stroke",o)),su("opacity",e)),su("fillOpacity",e)),su("strokeOpacity",e)),su("strokeWidth",e)),cu(e)),fu(e,"href"))}function iu(e,t,n){var r=e.config,i=e.mark;if("hide"===dr("invalid",e.markDef,r)&&n&&!Ne(i)){var a=ou(e,{invalid:!0,channels:Qt});if(a)return l({},t,[{test:a,value:null}].concat(h(_(n))))}return n?l({},t,n):{}}function au(e,t){if(void 0!==t)return l({},e,{value:t})}function ou(e,t){var n=t.invalid,r=void 0!==n&&n,i=t.channels.reduce(function(t,n){var r=e.getScaleComponent(n);if(r){var i=r.get("type"),a=e.vgField(n,{expr:"datum"});a&&er(i)&&(t[a]=!0)}return t},{}),a=oe(i);if(a.length>0){var o=r?"||":"&&";return a.map(function(e){return Ho(e,r)}).join(" ".concat(o," "))}}function uu(e){var t=e.config;if(dr("invalid",e.markDef,t)){var n=ou(e,{channels:["x","y"]});if(n)return{defined:{signal:n}}}return{}}function su(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.markDef,i=t.encoding,a=t.config,o=n.vgChannel,u=void 0===o?e:o,s=n.defaultRef,l=n.defaultValue;void 0===s&&(l=l||(u===e?r[e]:ye(r[e],r[u],hr(e,r,a,{vgChannel:u}))),s=l?{value:l}:void 0);var c=i[e];return lu(t,c,u,function(n){return Jo({channel:e,channelDef:n,markDef:r,config:a,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:s})})}function lu(e,t,n,r){var i=t&&t.condition,a=r(t);if(i){var o=_(i).map(function(t){var n=r(t),i=function(e){return e.selection}(t)?as(e,t.selection):os(e,t.test);return Object.assign({test:i},n)});return l({},n,[].concat(h(o),h(void 0!==a?[a]:[])))}return void 0!==a?l({},n,a):{}}function cu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.encoding,r=e.markDef,i=e.config,a=n.tooltip;return g(a)?{tooltip:Ko({tooltip:a},i,t)}:lu(e,a,"tooltip",function(a){var o=Zo(a,e.config,t.reactiveGeom?"datum.datum":"datum");if(o)return o;if(null!==a){var u=ye(r.tooltip,hr("tooltip",r,i));return!0===u&&(u={content:"encoding"}),b(u)?{value:u}:y(u)?"encoding"===u.content?Ko(n,i,t):{signal:"datum"}:void 0}})}function fu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text",n=e.encoding[t];return lu(e,n,t,function(t){return Zo(t,e.config)})}function du(e,t,n){var r=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).vgChannel,i=t.encoding,a=t.mark,o=t.markDef,u=t.config,s=t.stack,c=i[e],f=i[e===rt?at:ot],d=t.scaleName(e),h=t.getScaleComponent(e),p=Vo(e,t.markDef),v=c||!i.latitude&&!i.longitude?function(e){var t=e.channel,n=e.channelDef,r=e.scaleName,i=e.stack,a=e.offset;return Lr(n)&&i&&t===i.fieldChannel?Hr(n)&&void 0!==n.band?Xo({scaleName:r,fieldDef:n,startSuffix:"start",band:n.band,offset:0}):$o(n,r,{suffix:"end"},{offset:a}):Uo(e)}({channel:e,channelDef:c,channel2Def:f,markDef:o,config:u,scaleName:d,scale:h,stack:s,offset:p,defaultRef:tu({markDef:o,config:u,defaultRef:n,channel:e,scaleName:d,scale:h,mark:a,checkBarAreaWithoutZero:!f})}):{field:t.getName(e)};return l({},r||e,v)}var hu={left:"x",center:"xc",right:"x2"},pu={top:"y",middle:"yc",bottom:"y2"};function vu(e,t,n){var r=n.defaultRef,i=n.defaultRef2;return n.range?mu(e,t,{defaultRef:r,defaultRef2:i}):du(e,t,r)}function mu(e,t,n){var r=n.defaultRef,i=n.defaultRef2,a=t.markDef,o=t.config,u="x"===e?"width":"height",s=function(e,t,n){var r,i=e.encoding,a=e.mark,o=e.markDef,u=e.stack,s=e.config,c="x2"===n?"x":"y",f="x2"===n?"width":"height",d=i[c],h=e.scaleName(c),p=e.getScaleComponent(c),v=Vo(n,e.markDef);if(!d&&(i.latitude||i.longitude))return l({},n,{field:e.getName(n)});var m=function(e){var t=e.channel,n=e.channelDef,r=e.channel2Def,i=e.markDef,a=e.config,o=e.scaleName,u=e.scale,s=e.stack,l=e.offset,c=e.defaultRef;return Lr(n)&&s&&t.charAt(0)===s.fieldChannel.charAt(0)?$o(n,o,{suffix:"start"},{offset:l}):Uo({channel:t,channelDef:r,scaleName:o,scale:u,stack:s,markDef:i,config:a,offset:l,defaultRef:c})}({channel:n,channelDef:d,channel2Def:i[n],markDef:o,config:s,scaleName:h,scale:p,stack:u,offset:v,defaultRef:void 0});return void 0!==m?l({},n,m):ye(gu(n,o),gu(n,(l(r={},n,pr(n,o,s.style)),l(r,f,pr(f,o,s.style)),r)),gu(n,s[a]),gu(n,s.mark),l({},n,tu({markDef:o,config:s,defaultRef:t,channel:n,scaleName:h,scale:p,mark:a,checkBarAreaWithoutZero:!i[n]})()))}(t,i,"x"===e?"x2":"y2"),c=s[u]?function(e,t,n){var r="x"===e?"align":"baseline",i=ye(t[r],hr(r,t,n));return"x"===e?hu[i||"center"]:pu[i||"middle"]}(e,a,o):e;return Object.assign(Object.assign({},du(e,t,r,{vgChannel:c})),s)}function gu(e,t){var n="x2"===e?"width":"height";return t[e]?l({},e,Qo(e,t[e])):t[n]?l({},n,{value:t[n]}):void 0}var yu={has:function(e){return"interval"!==e.type&&e.nearest},marks:function(e,t,n){var r=t.project.has,i=r.x,a=r.y,o=e.mark;if(Ne(o))return un(rn.nearestNotSupportForContinuous(o)),n;var u={name:e.getName("voronoi"),type:"path",from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},cu(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:i||!a?"datum.datum.x || 0":"0"},y:{expr:a||!i?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]},s=0,l=!1;return n.forEach(function(t,n){var r=t.name||"";r===e.component.mark[0].name?s=n:r.indexOf("voronoi")>=0&&(l=!0)}),l||n.splice(s+1,0,u),n}},bu=function(){function e(t,n){c(this,e),this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}return f(e,[{key:"clone",value:function(){throw new Error("Cannot clone node")}},{key:"numChildren",value:function(){return this._children.length}},{key:"addChild",value:function(e,t){this._children.indexOf(e)>-1?console.warn("Attempt to add the same child twice."):void 0!==t?this._children.splice(t,0,e):this._children.push(e)}},{key:"removeChild",value:function(e){var t=this._children.indexOf(e);return this._children.splice(t,1),t}},{key:"remove",value:function(){var e=this._parent.removeChild(this),t=!0,n=!1,r=void 0;try{for(var i,a=this._children[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;o._parent=this._parent,this._parent.addChild(o,e++)}}catch(u){n=!0,r=u}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}},{key:"insertAsParentOf",value:function(e){var t=e.parent;t.removeChild(this),this.parent=t,e.parent=this}},{key:"swapWithParent",value:function(){var e=this._parent,t=e.parent,n=!0,r=!1,i=void 0;try{for(var a,o=this._children[Symbol.iterator]();!(n=(a=o.next()).done);n=!0)a.value.parent=e}catch(u){r=!0,i=u}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}this._children=[],e.removeChild(this),e.parent.removeChild(e),this.parent=t,e.parent=this}},{key:"parent",get:function(){return this._parent},set:function(e){this._parent=e,e&&e.addChild(this)}},{key:"children",get:function(){return this._children}}]),e}(),xu=function(e){function t(e,n,r,i){var u;return c(this,t),(u=a(this,o(t).call(this,e,n))).type=r,u.refCounts=i,u._source=u._name=n,!u.refCounts||u._name in u.refCounts||(u.refCounts[u._name]=0),u}return s(t,bu),f(t,[{key:"clone",value:function(){var e=new this.constructor;return e.debugName="clone_"+this.debugName,e._source=this._source,e._name="clone_"+this._name,e.type=this.type,e.refCounts=this.refCounts,e.refCounts[e._name]=0,e}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return void 0===this._hash&&(this._hash="Output ".concat(function(e){var t=++be;return e?String(e)+t:t}())),this._hash}},{key:"getSource",value:function(){return this.refCounts[this._name]++,this._source}},{key:"isRequired",value:function(){return!!this.refCounts[this._name]}},{key:"setSource",value:function(e){this._source=e}}]),t}(),wu=function(e){function t(e,n){var r;return c(this,t),(r=a(this,o(t).call(this,e))).formula=n,r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,V(this.formula))}},{key:"merge",value:function(e){for(var t in this.formula=Object.assign({},this.formula),e.formula)this.formula[t]&&!e.formula[t].band||(this.formula[t]=e.formula[t]);var n=!0,r=!1,i=void 0;try{for(var a,o=e.children[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;e.removeChild(u),u.parent=this}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}e.remove()}},{key:"producedFields",value:function(){return new Set(ue(this.formula).map(function(e){return e.as}))}},{key:"dependentFields",value:function(){return new Set(ue(this.formula).map(function(e){return e.field}))}},{key:"hash",value:function(){return"TimeUnit ".concat(X(this.formula))}},{key:"assemble",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,a=ue(this.formula)[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,u=o.timeUnit,s=o.field,l=o.as,c=o.band;e.push({type:"formula",as:l,expr:kn(u,s)}),c&&e.push({type:"formula",as:l+"_end",expr:kn(u,s,{end:!0})})}}catch(f){n=!0,r=f}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return e}}],[{key:"makeFromEncoding",value:function(e,n){var r=n.reduceFieldDef(function(e,t,r){var i=t.timeUnit,a=t.field,o=wd(n)?n.encoding[Ut(r)]:void 0,u=wd(n)&&Rr(r,t,o,n.markDef,n.config);if(i){var s=Gr(t,{forAs:!0});e[X({as:s,timeUnit:i,field:a})]=Object.assign({as:s,timeUnit:i,field:a},u?{band:!0}:{})}return e},{});return 0===oe(r).length?null:new t(e,r)}},{key:"makeFromTransform",value:function(e,n){var r=Object.assign({},n);return new t(e,l({},X(r),r))}}]),t}(),ku="_tuple_fields",Au=function e(){c(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this.items=n,this.has={}},Eu={has:function(e){return"single"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind},parse:function(e,t,n,r){r.on||delete t.events,r.clear||delete t.clear},topLevelSignals:function(e,t,n){var r=t.name,i=t.project,a=t.bind,o=t.init&&t.init[0],u=yu.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach(function(e,i){var s=le("".concat(r,"_").concat(e.field));n.filter(function(e){return e.name===s}).length||n.unshift(Object.assign(Object.assign({name:s},o?{init:Iu(o[i])}:{value:null}),{on:t.events?[{events:t.events,update:"datum && item().mark.marktype !== 'group' ? ".concat(u,"[").concat(x(e.field),"] : null")}]:[],bind:a[e.field]||a[e.channel]||a}))}),n},signals:function(e,t,n){var r=t.name,i=t.project,a=n.filter(function(e){return e.name===r+Qu})[0],o=r+ku,u=i.items.map(function(e){return le("".concat(r,"_").concat(e.field))}),s=u.map(function(e){return"".concat(e," !== null")}).join(" && ");return u.length&&(a.update="".concat(s," ? {fields: ").concat(o,", values: [").concat(u.join(", "),"]} : null")),delete a.value,delete a.on,n}},Du={has:function(e){return"multi"===e.type&&e.toggle},signals:function(e,t,n){return n.concat({name:t.name+"_toggle",value:!1,on:[{events:t.events,update:t.toggle}]})},modifyExpr:function(e,t){var n=t.name+Qu,r=t.name+"_toggle";return"".concat(r," ? null : ").concat(n,", ")+("global"===t.resolve?"".concat(r," ? null : true, "):"".concat(r," ? null : {unit: ").concat(rs(e),"}, "))+"".concat(r," ? ").concat(n," : null")}},Cu={has:function(e){return void 0!==e.clear&&!1!==e.clear},parse:function(e,t,n){n.clear&&(t.clear=b(n.clear)?Eo(n.clear,"scope"):n.clear)},topLevelSignals:function(e,t,n){return Eu.has(t)&&t.project.items.forEach(function(e){var r=n.findIndex(function(n){return n.name===le("".concat(t.name,"_").concat(e.field))});-1!==r&&n[r].on.push({events:t.clear,update:"null"})}),n},signals:function(e,t,n){function r(e,r){-1!==e&&n[e].on&&n[e].on.push({events:t.clear,update:r})}if("interval"===t.type)t.project.items.forEach(function(e){var t=n.findIndex(function(t){return t.name===e.signals.visual});r(t,"[0, 0]"),-1===t&&r(n.findIndex(function(t){return t.name===e.signals.data}),"null")});else{var i=n.findIndex(function(e){return e.name===t.name+Qu});r(i,"null"),Du.has(t)&&r(i=n.findIndex(function(e){return e.name===t.name+"_toggle"}),"false")}return n}},Ou={has:function(e){return"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind},parse:function(e,t){var n=le(t.name),r=t.scales=[],i=!0,a=!1,o=void 0;try{for(var u,s=t.project.items[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value,c=l.channel;if(Kt(c)){var f=e.getScaleComponent(c),d=f?f.get("type"):void 0;f&&er(d)?(f.set("domainRaw",{signal:"".concat(n,"[").concat(x(l.field),"]")},!0),r.push(l),e.repeater&&e.repeater.row===e.repeater.column&&e.getScaleComponent(c===rt?it:rt).set("domainRaw",{signal:"".concat(n,"[").concat(x(l.field),"]")},!0)):un(rn.SCALE_BINDINGS_CONTINUOUS)}}}catch(h){a=!0,o=h}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}},topLevelSignals:function(e,t,n){var r=t.scales.filter(function(e){return!n.filter(function(t){return t.name===e.signals.data}).length});if(!e.parent||_u(e)||!r.length)return n;var i=n.filter(function(e){return e.name===t.name})[0],a=i.update;if(a.indexOf(es)>=0)i.update="{".concat(r.map(function(e){return"".concat(x(e.field),": ").concat(e.signals.data)}).join(", "),"}");else{var o=!0,u=!1,s=void 0;try{for(var l,c=r[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value,d="".concat(x(f.field),": ").concat(f.signals.data);a.indexOf(d)<0&&(a="".concat(a.substring(0,a.length-1),", ").concat(d,"}"))}}catch(h){u=!0,s=h}finally{try{o||null==c.return||c.return()}finally{if(u)throw s}}i.update=a}return n.concat(r.map(function(e){return{name:e.signals.data}}))},signals:function(e,t,n){if(e.parent&&!_u(e)){var r=!0,i=!1,a=void 0;try{for(var o,u=function(){var e=o.value,t=n.filter(function(t){return t.name===e.signals.data})[0];t.push="outer",delete t.value,delete t.update},s=t.scales[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)u()}catch(l){i=!0,a=l}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}return n}};function Fu(e,t){var n=x(e.scaleName(t));return"domain(".concat(n,")")}function _u(e){return e.parent&&Dd(e.parent)&&(!e.parent.parent||_u(e.parent.parent))}var Su="_translate_anchor",Mu="_translate_delta",ju={has:function(e){return"interval"===e.type&&e.translate},signals:function(e,t,n){var r=t.name,i=Ou.has(t),a=r+Su,o=t.project.has,u=o.x,s=o.y,l=Eo(t.translate,"scope");return i||(l=l.map(function(e){return e.between[0].markname=r+Wu,e})),n.push({name:a,value:{},on:[{events:l.map(function(e){return e.between[0]}),update:"{x: x(unit), y: y(unit)"+(void 0!==u?", extent_x: "+(i?Fu(e,rt):"slice(".concat(u.signals.visual,")")):"")+(void 0!==s?", extent_y: "+(i?Fu(e,it):"slice(".concat(s.signals.visual,")")):"")+"}"}]},{name:r+Mu,value:{},on:[{events:l,update:"{x: ".concat(a,".x - x(unit), y: ").concat(a,".y - y(unit)}")}]}),void 0!==u&&Tu(e,t,u,"width",n),void 0!==s&&Tu(e,t,s,"height",n),n}};function Tu(e,t,n,r,i){var a=t.name,o=a+Su,u=a+Mu,s=n.channel,l=Ou.has(t),c=i.filter(function(e){return e.name===n.signals[l?"data":"visual"]})[0],f=e.getSizeSignalRef(r).signal,d=e.getScaleComponent(s),h=d.get("type"),p=l&&s===rt?"-":"",v="".concat(o,".extent_").concat(s),m="".concat(p).concat(u,".").concat(s," / ")+(l?"".concat(f):"span(".concat(v,")")),g="".concat(l?"log"===h?"panLog":"pow"===h?"panPow":"panLinear":"panLinear","(").concat(v,", ").concat(m)+(l&&"pow"===h?", ".concat(d.get("exponent")||1):"")+")";c.on.push({events:{signal:u},update:l?g:"clampRange(".concat(g,", 0, ").concat(f,")")})}var Nu="_zoom_anchor",Bu="_zoom_delta",Ru={has:function(e){return"interval"===e.type&&e.zoom},signals:function(e,t,n){var r=t.name,i=Ou.has(t),a=r+Bu,o=t.project.has,u=o.x,s=o.y,l=x(e.scaleName(rt)),c=x(e.scaleName(it)),f=Eo(t.zoom,"scope");return i||(f=f.map(function(e){return e.markname=r+Wu,e})),n.push({name:r+Nu,on:[{events:f,update:i?"{"+[l?"x: invert(".concat(l,", x(unit))"):"",c?"y: invert(".concat(c,", y(unit))"):""].filter(function(e){return!!e}).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:a,on:[{events:f,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==u&&zu(e,t,u,"width",n),void 0!==s&&zu(e,t,s,"height",n),n}};function zu(e,t,n,r,i){var a=t.name,o=n.channel,u=Ou.has(t),s=i.filter(function(e){return e.name===n.signals[u?"data":"visual"]})[0],l=e.getSizeSignalRef(r).signal,c=e.getScaleComponent(o),f=c.get("type"),d=u?Fu(e,o):s.name,h=a+Bu,p="".concat(a).concat(Nu,".").concat(o),v="".concat(u?"log"===f?"zoomLog":"pow"===f?"zoomPow":"zoomLinear":"zoomLinear","(").concat(d,", ").concat(p,", ").concat(h)+(u&&"pow"===f?", ".concat(c.get("exponent")||1):"")+")";s.on.push({events:{signal:h},update:u?v:"clampRange(".concat(v,", 0, ").concat(l,")")})}var Pu=[{has:function(){return!0},parse:function(e,t,n){var r=t.name,i=t.project||(t.project=new Au),a={},o={},u=new Set,s=function(e,t){for(var n="visual"===t?e.channel:e.field,i=le("".concat(r,"_").concat(n)),a=1;u.has(i);a++)i=le("".concat(r,"_").concat(n,"_").concat(a));return u.add(i),l({},t,i)};if(!n.fields&&!n.encodings){var c=e.config.selection[n.type];if(n.init){var f=!0,d=!1,h=void 0;try{for(var p,v=_(n.init)[Symbol.iterator]();!(f=(p=v.next()).done);f=!0){var m=p.value,y=!0,b=!1,x=void 0;try{for(var w,k=oe(m)[Symbol.iterator]();!(y=(w=k.next()).done);y=!0){var A=w.value;Rt[A]?(n.encodings||(n.encodings=[])).push(A):"interval"===n.type?(un('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=c.encodings):(n.fields||(n.fields=[])).push(A)}}catch(H){b=!0,x=H}finally{try{y||null==k.return||k.return()}finally{if(b)throw x}}}}catch(H){d=!0,h=H}finally{try{f||null==v.return||v.return()}finally{if(d)throw h}}}else n.encodings=c.encodings,n.fields=c.fields}var E=!0,D=!1,C=void 0;try{for(var O,F=(n.fields||[])[Symbol.iterator]();!(E=(O=F.next()).done);E=!0){var S={type:"E",field:O.value};S.signals=Object.assign({},s(S,"data")),i.items.push(S)}}catch(H){D=!0,C=H}finally{try{E||null==F.return||F.return()}finally{if(D)throw C}}var M=!0,j=!1,T=void 0;try{for(var N,B=(n.encodings||[])[Symbol.iterator]();!(M=(N=B.next()).done);M=!0){var R=N.value,z=e.fieldDef(R);if(z){var P=z.field;if(z.timeUnit){var L={as:P=e.vgField(R),field:z.field,timeUnit:z.timeUnit};o[X(L)]=L}if(!a[P]){var I="E";"interval"===t.type?er(e.getScaleComponent(R).get("type"))&&(I="R"):z.bin&&(I="R-RE");var U={field:P,channel:R,type:I};U.signals=Object.assign(Object.assign({},s(U,"data")),s(U,"visual")),i.items.push(a[P]=U),i.has[R]=a[P]}}else un(rn.cannotProjectOnChannelWithoutField(R))}}catch(H){j=!0,T=H}finally{try{M||null==B.return||B.return()}finally{if(j)throw T}}if(n.init){var q=function(e){return i.items.map(function(t){return void 0!==e[t.channel]?e[t.channel]:e[t.field]})};if("interval"===n.type)t.init=q(n.init);else{var W=g(n.init)?n.init:[n.init];t.init=W.map(q)}}oe(o).length&&(i.timeUnit=new wu(null,o))},signals:function(e,t,n){var r=t.name+ku;return n.filter(function(e){return e.name===r}).length?n:n.concat({name:r,value:t.project.items.map(function(e){var t=He(e,["signals"]),n=V(t);return n.field=pe(n.field),n})})}},Du,Ou,ju,Ru,Eu,yu,Cu];function Lu(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=Pu[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;u.has(e)&&t(u)}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}function Iu(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:k;if(g(e)){var r=e.map(function(e){return Iu(e,t,n)});return t?"[".concat(r.join(", "),"]"):r}return ln(e)?n(vn(e,!1,!t)):t?n(JSON.stringify(e)):e}function Uu(e,t){return ns(e,function(n,r){t=r.marks?r.marks(e,n,t):t,Lu(n,function(r){r.marks&&(t=r.marks(e,n,t))})}),t}function qu(e){return e.map(function(e){return e.on&&!e.on.length&&delete e.on,e})}var Wu="_brush",Hu="_scale_trigger",Vu={signals:function(e,t){var n=t.name,r=n+ku,i=Ou.has(t),a=[],o=[],u=[];if(t.translate&&!i){var s="!event.item || event.item.mark.name !== ".concat(x(n+Wu));Gu(t,function(e,t){var n=_(t.between[0].filter||(t.between[0].filter=[]));return n.indexOf(s)<0&&n.push(s),e})}t.project.items.forEach(function(n,r){var i=n.channel;if(i===rt||i===it){var s=t.init?t.init[r]:null,l=function(e,t,n,r){var i=n.channel,a=n.signals.visual,o=n.signals.data,u=Ou.has(t),s=x(e.scaleName(i)),l=e.getScaleComponent(i),c=l?l.get("type"):void 0,f=function(e){return"scale(".concat(s,", ").concat(e,")")},d=e.getSizeSignalRef(i===rt?"width":"height").signal,p="".concat(i,"(unit)"),v=Gu(t,function(e,t){return[].concat(h(e),[{events:t.between[0],update:"[".concat(p,", ").concat(p,"]")},{events:t,update:"[".concat(a,"[0], clamp(").concat(p,", 0, ").concat(d,")]")}])});return v.push({events:{signal:t.name+Hu},update:er(c)?"[".concat(f("".concat(o,"[0]")),", ").concat(f("".concat(o,"[1]")),"]"):"[0, 0]"}),u?[{name:o,on:[]}]:[Object.assign(Object.assign({name:a},r?{init:Iu(r,!0,f)}:{value:[]}),{on:v}),Object.assign(Object.assign({name:o},r?{init:Iu(r)}:{}),{on:[{events:{signal:a},update:"".concat(a,"[0] === ").concat(a,"[1] ? null : invert(").concat(s,", ").concat(a,")")}]})]}(e,t,n,s),c=n.signals.data,f=n.signals.visual,d=x(e.scaleName(i)),p=er(e.getScaleComponent(i).get("type"))?"+":"";a.push.apply(a,h(l)),o.push(c),u.push({scaleName:e.scaleName(i),expr:"(!isArray(".concat(c,") || ")+"(".concat(p,"invert(").concat(d,", ").concat(f,")[0] === ").concat(p).concat(c,"[0] && ")+"".concat(p,"invert(").concat(d,", ").concat(f,")[1] === ").concat(p).concat(c,"[1]))")})}else un("Interval selections only support x and y encoding channels.")}),i||a.push({name:n+Hu,value:{},on:[{events:u.map(function(e){return{scale:e.scaleName}}),update:u.map(function(e){return e.expr}).join(" && ")+" ? ".concat(n+Hu," : {}")}]});var l=t.init,c="unit: ".concat(rs(e),", fields: ").concat(r,", values");return a.concat(Object.assign(Object.assign({name:n+Qu},l?{init:"{".concat(c,": ").concat(Iu(l),"}")}:{}),{on:[{events:[{signal:o.join(" || ")}],update:o.join(" && ")+" ? {".concat(c,": [").concat(o,"]} : null")}]}))},modifyExpr:function(e,t){return t.name+Qu+", "+("global"===t.resolve?"true":"{unit: ".concat(rs(e),"}"))},marks:function(e,t,n){var r=t.name,i=t.project.has,a=i.x,o=i.y,u=a&&a.signals.visual,s=o&&o.signals.visual,l="data(".concat(x(t.name+Ju),")");if(Ou.has(t))return n;var c={x:void 0!==a?{signal:"".concat(u,"[0]")}:{value:0},y:void 0!==o?{signal:"".concat(s,"[0]")}:{value:0},x2:void 0!==a?{signal:"".concat(u,"[1]")}:{field:{group:"width"}},y2:void 0!==o?{signal:"".concat(s,"[1]")}:{field:{group:"height"}}};if("global"===t.resolve){var f=!0,d=!1,p=void 0;try{for(var v,m=oe(c)[Symbol.iterator]();!(f=(v=m.next()).done);f=!0){var g=v.value;c[g]=[Object.assign({test:"".concat(l,".length && ").concat(l,"[0].unit === ").concat(rs(e))},c[g]),{value:0}]}}catch(E){d=!0,p=E}finally{try{f||null==m.return||m.return()}finally{if(d)throw p}}}var y=t.mark,b=y.fill,w=y.fillOpacity,k=He(y,["fill","fillOpacity"]),A=oe(k).reduce(function(e,t){return e[t]=[{test:[void 0!==a&&"".concat(u,"[0] !== ").concat(u,"[1]"),void 0!==o&&"".concat(s,"[0] !== ").concat(s,"[1]")].filter(function(e){return e}).join(" && "),value:k[t]},{value:null}],e},{});return[{name:r+Wu+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:b},fillOpacity:{value:w}},update:c}}].concat(h(n),[{name:r+Wu,type:"rect",clip:!0,encode:{enter:{fill:{value:"transparent"}},update:Object.assign(Object.assign({},c),A)}}])}};function Gu(e,t){return e.events.reduce(function(e,n){return n.between?t(e,n):(un("".concat(n," is not an ordered event stream for interval selections.")),e)},[])}function $u(e,t){var n=t.name,r=n+ku,i=t.project,a="(item().isVoronoi ? datum.datum : datum)",o=i.items.map(function(t){var n=e.fieldDef(t.channel);return n&&n.bin?"[".concat(a,"[").concat(x(e.vgField(t.channel,{})),"], ")+"".concat(a,"[").concat(x(e.vgField(t.channel,{binSuffix:"end"})),"]]"):"".concat(a,"[").concat(x(t.field),"]")}).join(", "),u="unit: ".concat(rs(e),", fields: ").concat(r,", values");return[{name:n+Qu,on:t.events?[{events:t.events,update:"datum && item().mark.marktype !== 'group' ? {".concat(u,": [").concat(o,"]} : null"),force:!0}]:[]}]}var Yu={signals:$u,modifyExpr:function(e,t){return t.name+Qu+", "+("global"===t.resolve?"null":"{unit: ".concat(rs(e),"}"))}},Xu={signals:$u,modifyExpr:function(e,t){return t.name+Qu+", "+("global"===t.resolve?"true":"{unit: ".concat(rs(e),"}"))}},Ju="_store",Qu="_tuple",Ku="_modify",Zu="_selection_domain_",es="vlSelectionResolve",ts={single:Xu,multi:Yu,interval:Vu};function ns(e,t){var n=e.component.selection;for(var r in n)if(M(n,r)){var i=n[r];t(i,ts[i.type])}}function rs(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{escape:!0}).escape?x(e.name):e.name,n=function(e){for(var t=e.parent;t&&!kd(t);)t=t.parent;return t}(e);if(n){var r=n.facet,i=!0,a=!1,o=void 0;try{for(var u,s=jt[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;r[l]&&(t+=" + '__facet_".concat(l,"_' + (facet[").concat(x(n.vgField(l)),"])"))}}catch(c){a=!0,o=c}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}}return t}function is(e){var t=!1;return ns(e,function(e){t=t||e.project.items.some(function(e){return e.field===ea})}),t}function as(e,t,n){var r=[],i=ce(t,function(t){var i=le(t),a=e.getSelectionComponent(i,t),o=x(i+Ju);if(a.project.timeUnit){var u=n||e.component.data.raw,s=a.project.timeUnit.clone();u.parent?s.insertAsParentOf(u):u.parent=s}return"none"!==a.empty&&r.push(o),"vlSelectionTest(".concat(o,", datum")+("global"===a.resolve?")":", ".concat(x(a.resolve),")"))});return(r.length?"!("+r.map(function(e){return"length(data(".concat(e,"))")}).join(" || ")+") || ":"")+"(".concat(i,")")}function os(e,t,n){return ce(t,function(t){return b(t)?t:function(e){return e&&e.selection}(t)?as(e,t.selection,n):Nn(t)})}function us(e,t,n,r){e.encode=e.encode||{},e.encode[t]=e.encode[t]||{},e.encode[t].update=e.encode[t].update||{},e.encode[t].update[n]=r}function ss(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{header:!1},i=e.combine(),a=i.orient,o=i.scale,u=i.labelExpr,s=i.title,l=i.zindex,c=He(i,["orient","scale","labelExpr","title","zindex"]);if(oe(c).forEach(function(e){var n=wo[e],r=c[e];if(n&&n!==t&&"both"!==n)delete c[e];else if(r.condition){var i=bo[e],a=i.vgProp,o=i.part,u=r.condition,s=r.value,l=[].concat(h((g(u)?u:[u]).map(function(e){var t=e.value;return{test:os(null,e.test),value:t}})),[{value:s}]);us(c,o,a,l),delete c[e]}}),"grid"===t){if(!c.grid)return;if(c.encode){var f=c.encode.grid;c.encode=Object.assign({},f?{grid:f}:{}),0===oe(c.encode).length&&delete c.encode}return Object.assign(Object.assign({scale:o,orient:a},c),{domain:!1,labels:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:ye(l,0)})}if(r.header||!e.mainExtracted){if(void 0!==u){var d=u;c.encode&&c.encode.labels&&c.encode.labels.update&&vo(c.encode.labels.update.text)&&(d=ve(u,"datum.label",c.encode.labels.update.text.signal)),us(c,"labels","text",{signal:d})}if(c.encode){var p=!0,v=!1,m=void 0;try{for(var y,b=xo[Symbol.iterator]();!(p=(y=b.next()).done);p=!0){var x=y.value;e.hasAxisPart(x)||delete c.encode[x]}}catch(k){v=!0,m=k}finally{try{p||null==b.return||b.return()}finally{if(v)throw m}}0===oe(c.encode).length&&delete c.encode}var w=function(e,t){return g(e)?e.map(function(e){return ti(e,t)}).join(", "):e}(s,n);return Object.assign(Object.assign(Object.assign({scale:o,orient:a,grid:!1},w?{title:w}:{}),c),{zindex:ye(l,0)})}}function ls(e){var t=e.component.axes,n=!0,r=!1,i=void 0;try{for(var a,o=Vt[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(t[u]){var s=!0,l=!1,c=void 0;try{for(var f,d=t[u][Symbol.iterator]();!(s=(f=d.next()).done);s=!0)if(!f.value.get("gridScale")){var h="x"===u?"height":"width";return[{name:h,update:e.getSizeSignalRef(h).signal}]}}catch(p){l=!0,c=p}finally{try{s||null==d.return||d.return()}finally{if(l)throw c}}}}}catch(p){r=!0,i=p}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return[]}var cs={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleOrient:"orient",titlePadding:"offset"},fs={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelLimit:"limit",labelOrient:"orient",labelPadding:"offset"},ds=oe(cs),hs=oe(fs);function ps(e,t,n,r,i){var a=[].concat(h("band"===i?["axisBand"]:[]),["x"===n?"axisX":"axisY"],h(r?["axis"+r.substr(0,1).toUpperCase()+r.substr(1)]:[]),["axis"]),o=!0,u=!1,s=void 0;try{for(var l,c=a[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value;if(t[f]&&void 0!==t[f][e])return t[f][e]}}catch(d){u=!0,s=d}finally{try{o||null==c.return||c.return()}finally{if(u)throw s}}}function vs(e,t){if(void 0!==e)return e=xe(e),"top"===t||"bottom"===t?e<=45||315<=e?"top"===t?"bottom":"top":135<=e&&e<=225?"top"===t?"top":"bottom":"middle":e<=45||315<=e||135<=e&&e<=225?"middle":45<=e&&e<=135?"left"===t?"top":"bottom":"left"===t?"bottom":"top"}function ms(e,t){if(void 0!==e)return e=xe(e),"top"===t||"bottom"===t?e%180===0?"center":0<e&&e<180?"top"===t?"right":"left":"top"===t?"left":"right":(e+90)%180===0?"center":90<=e&&e<270?"left"===t?"left":"right":"left"===t?"right":"left"}function gs(e){switch(e){case rt:return"bottom";case it:return"left"}throw new Error(rn.INVALID_CHANNEL_FOR_AXIS)}var ys,bs,xs,ws,ks,As="RawCode",Es="Literal",Ds="Property",Cs="Identifier",Os="ArrayExpression",Fs="BinaryExpression",_s="CallExpression",Ss="ConditionalExpression",Ms="LogicalExpression",js="MemberExpression",Ts="ObjectExpression",Ns="UnaryExpression";function Bs(e){this.type=e}Bs.prototype.visit=function(e){var t,n,r;if(e(this))return 1;for(n=0,r=(t=function(e){switch(e.type){case Os:return e.elements;case Fs:case Ms:return[e.left,e.right];case _s:var t=e.arguments.slice();return t.unshift(e.callee),t;case Ss:return[e.test,e.consequent,e.alternate];case js:return[e.object,e.property];case Ts:return e.properties;case Ds:return[e.key,e.value];case Ns:return[e.argument];case Cs:case Es:case As:default:return[]}}(this)).length;n<r;++n)if(t[n].visit(e))return 1};var Rs=1,zs=2,Ps=3,Ls=4,Is=5,Us=6,qs=7,Ws=8;(ys={})[Rs]="Boolean",ys[zs]="<end>",ys[Ps]="Identifier",ys[Ls]="Keyword",ys[Is]="Null",ys[Us]="Numeric",ys[qs]="Punctuator",ys[Ws]="String",ys[9]="RegularExpression";var Hs="ArrayExpression",Vs="BinaryExpression",Gs="CallExpression",$s="ConditionalExpression",Ys="Identifier",Xs="Literal",Js="LogicalExpression",Qs="MemberExpression",Ks="ObjectExpression",Zs="Property",el="UnaryExpression",tl="Unexpected token %0",nl="Unexpected number",rl="Unexpected string",il="Unexpected identifier",al="Unexpected reserved word",ol="Unexpected end of input",ul="Invalid regular expression",sl="Invalid regular expression: missing /",ll="Octal literals are not allowed in strict mode.",cl="Duplicate data property in object literal not allowed in strict mode",fl="ILLEGAL",dl="Disabled.",hl=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),pl=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function vl(e,t){if(!e)throw new Error("ASSERT: "+t)}function ml(e){return e>=48&&e<=57}function gl(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function yl(e){return"01234567".indexOf(e)>=0}function bl(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function xl(e){return 10===e||13===e||8232===e||8233===e}function wl(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&hl.test(String.fromCharCode(e))}function kl(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&pl.test(String.fromCharCode(e))}var Al={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function El(){for(var e;xs<ws&&(bl(e=bs.charCodeAt(xs))||xl(e));)++xs}function Dl(e){var t,n,r,i=0;for(n="u"===e?4:2,t=0;t<n;++t)xs<ws&&gl(bs[xs])?(r=bs[xs++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):Ul({},tl,fl);return String.fromCharCode(i)}function Cl(){var e,t,n,r;for(t=0,"}"===(e=bs[xs])&&Ul({},tl,fl);xs<ws&&gl(e=bs[xs++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&Ul({},tl,fl),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function Ol(){var e,t;for(e=bs.charCodeAt(xs++),t=String.fromCharCode(e),92===e&&(117!==bs.charCodeAt(xs)&&Ul({},tl,fl),++xs,(e=Dl("u"))&&"\\"!==e&&wl(e.charCodeAt(0))||Ul({},tl,fl),t=e);xs<ws&&kl(e=bs.charCodeAt(xs));)++xs,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==bs.charCodeAt(xs)&&Ul({},tl,fl),++xs,(e=Dl("u"))&&"\\"!==e&&kl(e.charCodeAt(0))||Ul({},tl,fl),t+=e);return t}function Fl(){var e,t;return e=xs,{type:1===(t=92===bs.charCodeAt(xs)?Ol():function(){var e,t;for(e=xs++;xs<ws;){if(92===(t=bs.charCodeAt(xs)))return xs=e,Ol();if(!kl(t))break;++xs}return bs.slice(e,xs)}()).length?Ps:Al.hasOwnProperty(t)?Ls:"null"===t?Is:"true"===t||"false"===t?Rs:Ps,value:t,start:e,end:xs}}function _l(){var e,t,n,r,i=xs,a=bs.charCodeAt(xs),o=bs[xs];switch(a){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++xs,{type:qs,value:String.fromCharCode(a),start:i,end:xs};default:if(61===(e=bs.charCodeAt(xs+1)))switch(a){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return xs+=2,{type:qs,value:String.fromCharCode(a)+String.fromCharCode(e),start:i,end:xs};case 33:case 61:return xs+=2,61===bs.charCodeAt(xs)&&++xs,{type:qs,value:bs.slice(i,xs),start:i,end:xs}}}return">>>="===(r=bs.substr(xs,4))?{type:qs,value:r,start:i,end:xs+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:qs,value:n,start:i,end:xs+=3}:o===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===t?{type:qs,value:t,start:i,end:xs+=2}:"<>=!+-*%&|^/".indexOf(o)>=0?{type:qs,value:o,start:i,end:++xs}:void Ul({},tl,fl)}function Sl(){var e,t,n;if(vl(ml((n=bs[xs]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=xs,e="","."!==n){if(e=bs[xs++],n=bs[xs],"0"===e){if("x"===n||"X"===n)return++xs,function(e){for(var t="";xs<ws&&gl(bs[xs]);)t+=bs[xs++];return 0===t.length&&Ul({},tl,fl),wl(bs.charCodeAt(xs))&&Ul({},tl,fl),{type:Us,value:parseInt("0x"+t,16),start:e,end:xs}}(t);if(yl(n))return function(e){for(var t="0"+bs[xs++];xs<ws&&yl(bs[xs]);)t+=bs[xs++];return(wl(bs.charCodeAt(xs))||ml(bs.charCodeAt(xs)))&&Ul({},tl,fl),{type:Us,value:parseInt(t,8),octal:!0,start:e,end:xs}}(t);n&&ml(n.charCodeAt(0))&&Ul({},tl,fl)}for(;ml(bs.charCodeAt(xs));)e+=bs[xs++];n=bs[xs]}if("."===n){for(e+=bs[xs++];ml(bs.charCodeAt(xs));)e+=bs[xs++];n=bs[xs]}if("e"===n||"E"===n)if(e+=bs[xs++],"+"!==(n=bs[xs])&&"-"!==n||(e+=bs[xs++]),ml(bs.charCodeAt(xs)))for(;ml(bs.charCodeAt(xs));)e+=bs[xs++];else Ul({},tl,fl);return wl(bs.charCodeAt(xs))&&Ul({},tl,fl),{type:Us,value:parseFloat(e),start:t,end:xs}}function Ml(){var e,t,n,r;return ks=null,El(),e=xs,t=function(){var e,t,n,r;for(vl("/"===(e=bs[xs]),"Regular expression literal must start with a slash"),t=bs[xs++],n=!1,r=!1;xs<ws;)if(t+=e=bs[xs++],"\\"===e)xl((e=bs[xs++]).charCodeAt(0))&&Ul({},sl),t+=e;else if(xl(e.charCodeAt(0)))Ul({},sl);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||Ul({},sl),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";xs<ws&&kl((e=bs[xs]).charCodeAt(0));)++xs,"\\"===e&&xs<ws?Ul({},tl,fl):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Ul({},ul,n),{value:n,literal:t}}(),r=function(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(e,t){if(parseInt(t,16)<=1114111)return"x";Ul({},ul)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){Ul({},ul)}try{return new RegExp(e,t)}catch(i){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:xs}}function jl(){var e;return El(),xs>=ws?{type:zs,start:xs,end:xs}:wl(e=bs.charCodeAt(xs))?Fl():40===e||41===e||59===e?_l():39===e||34===e?function(){var e,t,n,r,i="",a=!1;for(vl("'"===(e=bs[xs])||'"'===e,"String literal must starts with a quote"),t=xs,++xs;xs<ws;){if((n=bs[xs++])===e){e="";break}if("\\"===n)if((n=bs[xs++])&&xl(n.charCodeAt(0)))"\r"===n&&"\n"===bs[xs]&&++xs;else switch(n){case"u":case"x":"{"===bs[xs]?(++xs,i+=Cl()):i+=Dl(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:yl(n)?(0!==(r="01234567".indexOf(n))&&(a=!0),xs<ws&&yl(bs[xs])&&(a=!0,r=8*r+"01234567".indexOf(bs[xs++]),"0123".indexOf(n)>=0&&xs<ws&&yl(bs[xs])&&(r=8*r+"01234567".indexOf(bs[xs++]))),i+=String.fromCharCode(r)):i+=n}else{if(xl(n.charCodeAt(0)))break;i+=n}}return""!==e&&Ul({},tl,fl),{type:Ws,value:i,octal:a,start:t,end:xs}}():46===e?ml(bs.charCodeAt(xs+1))?Sl():_l():ml(e)?Sl():_l()}function Tl(){var e;return xs=(e=ks).end,ks=jl(),xs=e.end,e}function Nl(){var e;e=xs,ks=jl(),xs=e}function Bl(e,t,n){var r=new Bs("||"===e||"&&"===e?Js:Vs);return r.operator=e,r.left=t,r.right=n,r}function Rl(e,t){var n=new Bs(Gs);return n.callee=e,n.arguments=t,n}function zl(e){var t=new Bs(Ys);return t.name=e,t}function Pl(e){var t=new Bs(Xs);return t.value=e.value,t.raw=bs.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function Ll(e,t,n){var r=new Bs(Qs);return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function Il(e,t,n){var r=new Bs(Zs);return r.key=t,r.value=n,r.kind=e,r}function Ul(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,function(e,t){return vl(t<r.length,"Message reference must be in range"),r[t]});throw(n=new Error(i)).index=xs,n.description=i,n}function ql(e){e.type===zs&&Ul(e,ol),e.type===Us&&Ul(e,nl),e.type===Ws&&Ul(e,rl),e.type===Ps&&Ul(e,il),e.type===Ls&&Ul(e,al),Ul(e,tl,e.value)}function Wl(e){var t=Tl();t.type===qs&&t.value===e||ql(t)}function Hl(e){return ks.type===qs&&ks.value===e}function Vl(e){return ks.type===Ls&&ks.value===e}function Gl(){var e=[];for(xs=ks.start,Wl("[");!Hl("]");)Hl(",")?(Tl(),e.push(null)):(e.push(ic()),Hl("]")||Wl(","));return Tl(),function(e){var t=new Bs(Hs);return t.elements=e,t}(e)}function $l(){var e;return xs=ks.start,(e=Tl()).type===Ws||e.type===Us?(e.octal&&Ul(e,ll),Pl(e)):zl(e.value)}function Yl(){var e,t,n;return xs=ks.start,(e=ks).type===Ps?(n=$l(),Wl(":"),Il("init",n,ic())):e.type!==zs&&e.type!==qs?(t=$l(),Wl(":"),Il("init",t,ic())):void ql(e)}function Xl(){var e,t,n=[],r={},i=String;for(xs=ks.start,Wl("{");!Hl("}");)t="$"+((e=Yl()).key.type===Ys?e.key.name:i(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?Ul({},cl):r[t]=!0,n.push(e),Hl("}")||Wl(",");return Wl("}"),function(e){var t=new Bs(Ks);return t.properties=e,t}(n)}var Jl={if:1,this:1};function Ql(){var e,t,n;if(Hl("("))return function(){var e;return Wl("("),e=ac(),Wl(")"),e}();if(Hl("["))return Gl();if(Hl("{"))return Xl();if(e=ks.type,xs=ks.start,e===Ps||Jl[ks.value])n=zl(Tl().value);else if(e===Ws||e===Us)ks.octal&&Ul(ks,ll),n=Pl(Tl());else{if(e===Ls)throw new Error(dl);e===Rs?((t=Tl()).value="true"===t.value,n=Pl(t)):e===Is?((t=Tl()).value=null,n=Pl(t)):Hl("/")||Hl("/=")?(n=Pl(Ml()),Nl()):ql(Tl())}return n}function Kl(){var e=[];if(Wl("("),!Hl(")"))for(;xs<ws&&(e.push(ic()),!Hl(")"));)Wl(",");return Wl(")"),e}function Zl(){var e;return xs=ks.start,function(e){return e.type===Ps||e.type===Ls||e.type===Rs||e.type===Is}(e=Tl())||ql(e),zl(e.value)}function ec(){var e;return Wl("["),e=ac(),Wl("]"),e}function tc(){var e=function(){var e;for(e=Ql();;)if(Hl("."))Wl("."),e=Ll(".",e,Zl());else if(Hl("("))e=Rl(e,Kl());else{if(!Hl("["))break;e=Ll("[",e,ec())}return e}();if(ks.type===qs&&(Hl("++")||Hl("--")))throw new Error(dl);return e}function nc(){var e,t;if(ks.type!==qs&&ks.type!==Ls)t=tc();else{if(Hl("++")||Hl("--"))throw new Error(dl);if(Hl("+")||Hl("-")||Hl("~")||Hl("!"))e=Tl(),t=nc(),t=function(e,t){var n=new Bs(el);return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(Vl("delete")||Vl("void")||Vl("typeof"))throw new Error(dl);t=tc()}}return t}function rc(e){var t=0;if(e.type!==qs&&e.type!==Ls)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function ic(){var e,t;return e=function(){var e,t,n,r,i,a,o,u,s,l;if(e=ks,s=nc(),0===(i=rc(r=ks)))return s;for(r.prec=i,Tl(),t=[e,ks],a=[s,r,o=nc()];(i=rc(ks))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),u=a.pop().value,s=a.pop(),t.pop(),n=Bl(u,s,o),a.push(n);(r=Tl()).prec=i,a.push(r),t.push(ks),n=nc(),a.push(n)}for(n=a[l=a.length-1],t.pop();l>1;)t.pop(),n=Bl(a[l-1].value,a[l-2],n),l-=2;return n}(),Hl("?")&&(Tl(),t=ic(),Wl(":"),e=function(e,t,n){var r=new Bs($s);return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,ic())),e}function ac(){var e=ic();if(Hl(","))throw new Error(dl);return e}function oc(e,t,n){return e.fields=t||[],e.fname=n,e}function uc(e){throw Error(e)}var sc=Array.isArray;function lc(e){return sc(e)?"["+e.map(lc)+"]":(t=e)===Object(t)||function(e){return"string"===typeof e}(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e;var t}var cc=[];function fc(e){var t=function(e){xs=0,ws=(bs=e).length,ks=null,Nl();var t=ac();if(ks.type!==zs)throw new Error("Unexpect token after expression.");return t}(e),n=new Set;return t.visit(function(e){"MemberExpression"===e.type&&function e(t){return"MemberExpression"===t.object.type?e(t.object):"datum"===t.object.name}(e)&&n.add(function e(t){var n=[];return"Identifier"===t.type?[t.name]:"Literal"===t.type?[t.value]:("MemberExpression"===t.type&&(n.push.apply(n,h(e(t.object))),n.push.apply(n,h(e(t.property)))),n)}(e).slice(1).join("."))}),n}(function(e,t){var n=function(e){var t,n,r,i=[],a=null,o=0,u=e.length,s="";function l(){i.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<u;++n)if("\\"===(r=e[n]))s+=e.substring(t,n),t=++n;else if(r===a)l(),a=null,o=-1;else{if(a)continue;t===o&&'"'===r?(t=n+1,a=r):t===o&&"'"===r?(t=n+1,a=r):"."!==r||o?"["===r?(n>t&&l(),o=t=n+1):"]"===r&&(o||uc("Access path missing open bracket: "+e),o>0&&l(),o=0,t=n+1):n>t?l():t=n+1}return o&&uc("Access path missing closing bracket: "+e),a&&uc("Access path missing closing quote: "+e),n>t&&(n++,l()),i}(e),r="return _["+n.map(lc).join("][")+"];";oc(Function("_",r),[e=1===n.length?n[0]:e],t||e)})("id"),oc(function(e){return e},cc,"identity"),oc(function(){return 0},cc,"zero"),oc(function(){return 1},cc,"one"),oc(function(){return!0},cc,"true"),oc(function(){return!1},cc,"false");var dc=function(e){function t(e,n){var r;return c(this,t),(r=a(this,o(t).call(this,e))).transform=n,r._dependentFields=fc(r.transform.calculate),r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,V(this.transform))}},{key:"producedFields",value:function(){return new Set([this.transform.as])}},{key:"dependentFields",value:function(){return this._dependentFields}},{key:"assemble",value:function(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}},{key:"hash",value:function(){return"Calculate ".concat(X(this.transform))}}],[{key:"parseAllForSortIndex",value:function(e,n){return n.forEachFieldDef(function(n,r){if(Wr(n)&&Sr(n.sort)){var i=n.field,a=n.timeUnit,o=n.sort,u=o.map(function(e,t){return"".concat(Nn({field:i,timeUnit:a,equal:e})," ? ").concat(t," : ")}).join("")+o.length;e=new t(e,{calculate:u,as:hc(n,r,{forAs:!0})})}}),e}}]),t}();function hc(e,t,n){return Gr(e,Object.assign({prefix:t,suffix:"sort_index"},n||{}))}function pc(e,t){return Q(["top","bottom"],t)?"column":Q(["left","right"],t)?"row":"row"===e?"row":"column"}function vc(e,t,n,r){var i="row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet;return ye(t&&t.header?t.header[e]:void 0,i[e],n.header[e])}function mc(e,t,n,r){var i={},a=!0,o=!1,u=void 0;try{for(var s,l=e[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value,f=vc(c,t,n,r);void 0!==f&&(i[c]=f)}}catch(d){o=!0,u=d}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}return i}var gc=["row","column"],yc=["header","footer"];function bc(e,t){var n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,a=mc(["titleAnchor","titleAngle","titleOrient"],i,r,t),o=a.titleAnchor,u=a.titleAngle,s=pc(t,a.titleOrient);return{name:"".concat(t,"-title"),type:"group",role:"".concat(s,"-title"),title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===t?{orient:"left"}:{}),{style:"guide-title"}),wc(u,s)),xc(s,u,o)),Fc(r,i,t,ds,cs))}}function xc(e,t){switch(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"middle"){case"start":return{align:"left"};case"end":return{align:"right"}}var n=ms(t,"row"===e?"left":"top");return n?{align:n}:{}}function wc(e,t){var n=vs(e,"row"===t?"left":"top");return n?{baseline:n}:{}}function kc(e,t){var n=e.component.layoutHeaders[t],r=[],i=!0,a=!1,o=void 0;try{for(var u,s=yc[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;if(n[l]){var c=!0,f=!1,d=void 0;try{for(var h,p=n[l][Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var v=h.value;r.push(Dc(e,t,l,n,v))}}catch(m){f=!0,d=m}finally{try{c||null==p.return||p.return()}finally{if(f)throw d}}}}}catch(m){a=!0,o=m}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return r}function Ac(e,t){var n=e.sort;return _r(n)?{field:Gr(n,{expr:"datum"}),order:n.order||"ascending"}:g(n)?{field:hc(e,t,{expr:"datum"}),order:"ascending"}:{field:Gr(e,{expr:"datum"}),order:n||"ascending"}}function Ec(e,t,n){var r=mc(["format","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),i=r.format,a=r.labelAngle,o=r.labelAnchor,u=r.labelOrient,s=r.labelExpr,l=vr(e,i,"parent",n).signal,c=pc(t,u);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:s?ve(ve(s,"datum.label",l),"datum.value",Gr(e,{expr:"parent"})):l}},"row"===t?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),wc(a,c)),xc(c,a,o)),Fc(n,e,t,hs,fs))}function Dc(e,t,n,r,i){if(i){var a=null,o=r.facetFieldDef,u=e.config?e.config:void 0;if(o&&i.labels){var s=mc(["labelOrient"],o,u,t).labelOrient;("row"===t&&!Q(["top","bottom"],s)||"column"===t&&!Q(["left","right"],s))&&(a=Ec(o,t,u))}var c=kd(e)&&!Mr(e.facet),f=i.axes,d=f&&f.length>0;if(a||d){var h="row"===t?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("".concat(t,"_").concat(n)),type:"group",role:"".concat(t,"-").concat(n)},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:Ac(o,t)}:{}),d&&c?{from:{data:e.getName("facet_domain_".concat(t))}}:{}),a?{title:a}:{}),i.sizeSignal?{encode:{update:l({},h,i.sizeSignal)}}:{}),d?{axes:f}:{})}}return null}var Cc={column:{start:0,end:1},row:{start:1,end:0}};function Oc(e,t){return Cc[t][e]}function Fc(e,t,n,r,i){var a={},o=!0,u=!1,s=void 0;try{for(var l,c=r[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value;if(i[f]){var d=vc(f,t,e,n);void 0!==d&&(a[i[f]]=d)}}}catch(h){u=!0,s=h}finally{try{o||null==c.return||c.return()}finally{if(u)throw s}}return a}function _c(e){return[].concat(h(Sc(e,"width")),h(Sc(e,"height")))}function Sc(e,t){var n="width"===t?"x":"y",r=e.component.layoutSize.get(t);if(!r||"merged"===r)return[];var i=e.getSizeSignalRef(t).signal;if("step"===r){var a=e.getScaleComponent(n);if(a){var o=a.get("type"),u=a.get("range");if(Zn(o)&&mo(u)){var s=e.scaleName(n);return kd(e.parent)&&"independent"===e.parent.component.resolve.scale[n]?[Mc(s,u)]:[Mc(s,u),{name:i,update:jc(s,a,"domain('".concat(s,"').length"))}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){var l=i.endsWith("width"),c=l?"containerSize()[0]":"containerSize()[1]",f=l?e.config.view.continuousWidth:e.config.view.continuousHeight,d="isFinite(".concat(c,") ? ").concat(c," : ").concat(f);return[{name:i,init:d,on:[{update:d,events:"window:resize"}]}]}return[{name:i,value:r}]}function Mc(e,t){return{name:e+"_step",value:t.step}}function jc(e,t,n){var r=t.get("type"),i=t.get("padding"),a=ye(t.get("paddingOuter"),i),o=t.get("paddingInner");return o="band"===r?void 0!==o?o:i:1,"bandspace(".concat(n,", ").concat(o,", ").concat(a,") * ").concat(e,"_step")}function Tc(e,t){return oe(e).reduce(function(n,r){var i=e[r];return Object.assign(Object.assign({},n),lu(t,i,r,function(e){return{value:e.value}}))},{})}function Nc(e,t){var n=e.scale[t],r=Q(Vt,t)?"axis":"legend";return"independent"===n?("shared"===e[r][t]&&un(rn.independentScaleMeansIndependentGuide(t)),"independent"):e[r][t]||"shared"}var Bc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};c(this,e),this.explicit=t,this.implicit=n}return f(e,[{key:"clone",value:function(){return new e(V(this.explicit),V(this.implicit))}},{key:"combine",value:function(){return Object.assign(Object.assign({},this.explicit),this.implicit)}},{key:"get",value:function(e){return ye(this.explicit[e],this.implicit[e])}},{key:"getWithExplicit",value:function(e){return void 0!==this.explicit[e]?{explicit:!0,value:this.explicit[e]}:void 0!==this.implicit[e]?{explicit:!1,value:this.implicit[e]}:{explicit:!1,value:void 0}}},{key:"setWithExplicit",value:function(e,t){void 0!==t.value&&this.set(e,t.value,t.explicit)}},{key:"set",value:function(e,t,n){return delete this[n?"implicit":"explicit"][e],this[n?"explicit":"implicit"][e]=t,this}},{key:"copyKeyFromSplit",value:function(e,t){void 0!==t.explicit[e]?this.set(e,t.explicit[e],!0):void 0!==t.implicit[e]&&this.set(e,t.implicit[e],!1)}},{key:"copyKeyFromObject",value:function(e,t){void 0!==t[e]&&this.set(e,t[e],!0)}},{key:"copyAll",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=oe(e.combine())[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,u=e.getWithExplicit(o);this.setWithExplicit(o,u)}}catch(s){n=!0,r=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}}]),e}();function Rc(e){return{explicit:!0,value:e}}function zc(e){return{explicit:!1,value:e}}function Pc(e){return function(t,n,r,i){var a=e(t.value,n.value);return a>0?t:a<0?n:Lc(t,n,r,i)}}function Lc(e,t,n,r){return e.explicit&&t.explicit&&un(rn.mergeConflictingProperty(n,r,e.value,t.value)),e}function Ic(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Lc;return void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:Y(e.value)===Y(t.value)?e:i(e,t,n,r)}var Uc=Object.assign(Object.assign({},{clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1}),{labelExpr:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),qc=oe(Uc),Wc=function(e){function t(){return c(this,t),a(this,o(t).apply(this,arguments))}return s(t,Bc),t}();function Hc(e){return ye(e.legend.type,Vc(e))}function Vc(e){var t=e.channel,n=e.timeUnit,r=e.scaleType,i=e.alwaysReturn;if(St(t)){if(Q(["quarter","month","day"],n))return"symbol";if(tr(r))return i?"gradient":void 0}return i?"symbol":void 0}function Gc(e){var t=e.legend,n=e.legendConfig,r=e.timeUnit,i=e.channel,a=e.scaleType,o=ye(t.orient,n.orient,"right"),u=Hc({legend:t,channel:i,timeUnit:r,scaleType:a,alwaysReturn:!0});return ye(t.direction,n[u?"gradientDirection":"symbolDirection"],function(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===t?"horizontal":void 0}}(o,u))}function $c(e,t,n,r){var i=e.getSizeSignalRef(t).signal;return{signal:"clamp(".concat(i,", ").concat(n,", ").concat(r,")")}}function Yc(e,t,n){var r=t.getScaleComponent(n).get("type");return ye(e.get("type"),Vc({channel:n,scaleType:r,alwaysReturn:!0}))}function Xc(e){return Qc(e,function(e,t){return Math.max(e,t.value)})}function Jc(e){return Qc(e,function(e,t){return ye(e,t.value)})}function Qc(e,t){return function(e){return!!e&&!!e.condition&&(g(e.condition)||qr(e.condition))}(e)?(g(e.condition)?e.condition:[e.condition]).reduce(t,e.value):qr(e)?e.value:void 0}var Kc=Object.freeze({__proto__:null,symbols:function(e,t,n,r,i){if("symbol"===Yc(i,n,r)){var a=Object.assign(Object.assign({},function(e,t,n){var r=!0,i=!1,a=void 0;try{for(var o,u=n[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=hr(s,t.markDef,t.config);void 0!==l&&(e[s]={value:l})}}catch(c){i=!0,a=c}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return e}({},n,Pe)),nu(n)),o=n.markDef,u=n.encoding,s=n.config,l=o.filled,c=Xc(u.opacity)||o.opacity;if(a.fill)if("fill"===r||l&&r===ft)delete a.fill;else if(a.fill.field)i.get("symbolFillColor")?delete a.fill:(a.fill={value:s.legend.symbolBaseFillColor||"black"},a.fillOpacity={value:c||1});else if(g(a.fill)){var f=Jc(u.fill||u.color)||o.fill||l&&o.color;f&&(a.fill={value:f})}if(a.stroke)if("stroke"===r||!l&&r===ft)delete a.stroke;else if(a.stroke.field)delete a.stroke;else if(g(a.stroke)){var d=ye(Jc(u.stroke||u.color),o.stroke,l?o.color:void 0);d&&(a.stroke={value:d})}return r!==mt&&c&&(a.opacity={value:c}),a=Object.assign(Object.assign({},a),t),oe(a).length>0?a:void 0}},gradient:function(e,t,n,r,i){if("gradient"===Yc(i,n,r)){var a={},o=Xc(n.encoding.opacity)||n.markDef.opacity;return o&&(a.opacity={value:o}),a=Object.assign(Object.assign({},a),t),oe(a).length>0?a:void 0}},labels:function(e,t,n,r){var i=n.legend(r),a=n.config,o={};if(li(e)){var u=n.getScaleComponent(r).get("type")===zn.UTC,s=xr("datum.value",e.timeUnit,i.format,a.legend.shortTimeLabels,a.timeFormat,u);t=Object.assign(Object.assign({},s?{text:{signal:s}}:{}),t)}return o=Object.assign(Object.assign({},o),t),oe(o).length>0?o:void 0},getFirstConditionValue:Jc});function Zc(e){wd(e)?e.component.legends=function(e){var t=e.encoding;return[ft,dt,ht,bt,vt,pt,mt,gt,yt].reduce(function(n,r){var i=t[r];return!e.legend(r)||!e.getScaleComponent(r)||Lr(i)&&r===pt&&i.type===Wn||(n[r]=function(e,t){var n=e.fieldDef(t),r=e.legend(t),i=new Wc({},function(e,t){var n=e.scaleName(ft);return"color"===t?e.markDef.filled?{fill:n}:{stroke:n}:l({},t,e.scaleName(t))}(e,t)),a=!0,o=!1,u=void 0;try{for(var s,c=qc[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var f=s.value,d=tf(f,r,t,e);if(void 0!==d){var h=ef(d,f,r,n);(h||void 0===e.config.legend[f])&&i.set(f,d,h)}}}catch(m){o=!0,u=m}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}var p=r.encoding||{},v=["labels","legend","title","symbols","gradient"].reduce(function(r,a){var o=Tc(p[a]||{},e),u=Kc[a]?Kc[a](n,o,e,t,i):o;return void 0!==u&&oe(u).length>0&&(r[a]={update:u}),r},{});return oe(v).length>0&&i.set("encode",v,!!r.encoding),i}(e,r)),n},{})}(e):e.component.legends=function(e){var t=e.component,n=t.legends,r=t.resolve,i=!0,a=!1,o=void 0;try{for(var u,s=function(){var t=u.value;Zc(t),oe(t.component.legends).forEach(function(i){r.legend[i]=Nc(e.component.resolve,i),"shared"===r.legend[i]&&(n[i]=nf(n[i],t.component.legends[i]),n[i]||(r.legend[i]="independent",delete n[i]))})},l=e.children[Symbol.iterator]();!(i=(u=l.next()).done);i=!0)s()}catch(c){a=!0,o=c}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}return oe(n).forEach(function(t){var n=!0,i=!1,a=void 0;try{for(var o,u=e.children[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var s=o.value;s.component.legends[t]&&"shared"===r.legend[t]&&delete s.component.legends[t]}}catch(c){i=!0,a=c}finally{try{n||null==u.return||u.return()}finally{if(i)throw a}}}),n}(e)}function ef(e,t,n,r){switch(t){case"values":return!!n.values;case"title":if("title"===t&&e===r.title)return!0}return e===n[t]}function tf(e,t,n,r){var i=r.encoding,a=r.mark,o=ii(i[n]),u=r.config.legend,s=o.timeUnit,l=r.getScaleComponent(n).get("type");switch(e){case"direction":return Gc({legend:t,legendConfig:u,timeUnit:s,channel:n,scaleType:l});case"format":if(li(o))return;return mr(o,t.format,r.config);case"formatType":if(li(o))return;return t.formatType;case"gradientLength":return ye(t.gradientLength,u.gradientLength,function(e){var t=e.legend,n=e.legendConfig,r=e.model,i=e.channel,a=e.scaleType,o=n.gradientHorizontalMaxLength,u=n.gradientHorizontalMinLength,s=n.gradientVerticalMaxLength,l=n.gradientVerticalMinLength;if("horizontal"===Gc({legend:t,legendConfig:n,channel:i,scaleType:a})){var c=ye(t.orient,n.orient);return"top"===c||"bottom"===c?$c(r,"width",u,o):u}return $c(r,"height",l,s)}({model:r,legend:t,legendConfig:u,channel:n,scaleType:l}));case"labelOverlap":return ye(t.labelOverlap,function(e){if(Q(["quantile","threshold","log"],e))return"greedy"}(l));case"symbolType":return ye(t.symbolType,function(e,t,n,r){if("shape"!==t){var i=Jc(n)||r;if(i)return i}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(a,n,i.shape,r.markDef.shape));case"title":return Zr(o,r.config,{allowDisabling:!0})||void 0;case"type":return Hc({legend:t,channel:n,timeUnit:s,scaleType:l,alwaysReturn:!1});case"values":return function(e,t){var n=e.values;if(n)return fi(t,n)}(t,o)}return t[e]}function nf(e,t){if(!e)return t.clone();var n=e.getWithExplicit("orient"),r=t.getWithExplicit("orient");if(!n.explicit||!r.explicit||n.value===r.value){var i=!1,a=!0,o=!1,u=void 0;try{for(var s,l=function(){var n=s.value,r=Ic(e.getWithExplicit(n),t.getWithExplicit(n),n,"legend",function(e,t){switch(n){case"symbolType":return r=e,"circle"===(a=t).value?a:r;case"title":return Er(e,t);case"type":return i=!0,zc("symbol")}var r,a;return Lc(e,t,n,"legend")});e.setWithExplicit(n,r)},c=qc[Symbol.iterator]();!(a=(s=c.next()).done);a=!0)l()}catch(f){o=!0,u=f}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}return i&&(((e.implicit||{}).encode||{}).gradient&&fe(e.implicit,["encode","gradient"]),((e.explicit||{}).encode||{}).gradient&&fe(e.explicit,["encode","gradient"])),e}}function rf(e){var t=e.component.legends,n={},r=!0,i=!1,a=void 0;try{for(var o,u=oe(t)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=e.getScaleComponent(s),c=Y(l.get("domains"));if(n[c]){var f=!0,d=!1,h=void 0;try{for(var p,v=n[c][Symbol.iterator]();!(f=(p=v.next()).done);f=!0)nf(p.value,t[s])||n[c].push(t[s])}catch(m){d=!0,h=m}finally{try{f||null==v.return||v.return()}finally{if(d)throw h}}}else n[c]=[t[s].clone()]}}catch(m){i=!0,a=m}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return ue(n).flat().map(function(e){var t=e.combine(),n=t.labelExpr,r=He(t,["labelExpr"]);if(r.encode&&r.encode.symbols){var i=r.encode.symbols.update;!i.fill||"transparent"===i.fill.value||i.stroke||r.stroke||(i.stroke={value:"transparent"}),r.fill&&delete i.fill}if(void 0!==n){var a=n;r.encode&&r.encode.labels&&r.encode.labels.update&&vo(r.encode.labels.update.text)&&(a=ve(n,"datum.label",r.encode.labels.update.text.signal)),function(e,t,n,r){e.encode=e.encode||{},e.encode[t]=e.encode[t]||{},e.encode[t].update=e.encode[t].update||{},e.encode[t].update[n]=r}(r,"labels","text",{signal:a})}return r})}function af(e){return Dd(e)||Ed(e)||Ad(e)?function(e){return e.children.reduce(function(e,t){return e.concat(t.assembleProjections())},of(e))}(e):of(e)}function of(e){var t=e.component.projection;if(!t||t.merged)return[];var n=t.combine(),r=n.name,i=He(n,["name"]);if(t.data){var a={signal:"[".concat(t.size.map(function(e){return e.signal}).join(", "),"]")},o=t.data.reduce(function(t,n){var r=vo(n)?n.signal:"data('".concat(e.lookupDataSource(n),"')");return Q(t,r)||t.push(r),t},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:a,fit:{signal:o.length>1?"[".concat(o.join(", "),"]"):o[0]}},i)]}return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),i)]}var uf=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"],sf=function(e){function t(e,n,r,i){var u;return c(this,t),(u=a(this,o(t).call(this,Object.assign({},n),{name:e}))).specifiedProjection=n,u.size=r,u.data=i,u.merged=!1,u}return s(t,Bc),f(t,[{key:"isFit",get:function(){return!!this.data}}]),t}();function lf(e){e.component.projection=wd(e)?function(e){if(e.hasProjection){var t=e.specifiedProjection,n=!(t&&(null!=t.scale||null!=t.translate)),r=n?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,i=n?function(e){var t=[];return[[st,ut],[ct,lt]].forEach(function(n){(e.channelHasField(n[0])||e.channelHasField(n[1]))&&t.push({signal:e.getName("geojson_".concat(t.length))})}),e.channelHasField(pt)&&e.fieldDef(pt).type===Wn&&t.push({signal:e.getName("geojson_".concat(t.length))}),0===t.length&&t.push(e.requestDataName(Ya)),t}(e):void 0;return new sf(e.projectionName(!0),Object.assign(Object.assign({},e.config.projection||{}),t||{}),r,i)}}(e):function(e){if(0!==e.children.length){var t;e.children.forEach(function(e){return lf(e)});var n=Z(e.children,function(e){var n=e.component.projection;if(n){if(t){var r=function(e,t){var n=Z(uf,function(n){return!M(e.explicit,n)&&!M(t.explicit,n)||!(!M(e.explicit,n)||!M(t.explicit,n)||Y(e.get(n))!==Y(t.get(n)))});if(Y(e.size)===Y(t.size)){if(n)return e;if(Y(e.explicit)===Y({}))return t;if(Y(t.explicit)===Y({}))return e}return null}(t,n);return r&&(t=r),!!r}return t=n,!0}return!0});if(t&&n){var r=e.projectionName(!0),i=new sf(r,t.specifiedProjection,t.size,V(t.data));return e.children.forEach(function(e){var t,n=e.component.projection;n&&(n.isFit&&(t=i.data).push.apply(t,h(e.component.projection.data)),e.renameProjection(n.get("name"),r),n.merged=!0)}),i}}}(e)}function cf(e,t){return"".concat(hi(e),"_").concat(t)}function ff(e,t,n){var r=cf(ui(n,void 0)||{},t);return e.getName("".concat(r,"_bins"))}function df(e,t,n){var r;r=function(e){return"as"in e}(e)?b(e.as)?[e.as,"".concat(e.as,"_end")]:[e.as[0],e.as[1]]:[Gr(e,{forAs:!0}),Gr(e,{binSuffix:"end",forAs:!0})];var i=ui(t,void 0)||{},a=cf(i,e.field),o=function(e,t){return{signal:e.getName("".concat(t,"_bins")),extentSignal:e.getName("".concat(t,"_extent"))}}(n,a),u=o.signal,s=o.extentSignal;return{key:a,binComponent:Object.assign(Object.assign({bin:i,field:e.field,as:[r]},u?{signal:u}:{}),s?{extentSignal:s}:{})}}var hf=function(e){function t(e,n){var r;return c(this,t),(r=a(this,o(t).call(this,e))).bins=n,r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,V(this.bins))}},{key:"merge",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=oe(e.bins)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;u in this.bins?(t(e.bins[u].signal,this.bins[u].signal),this.bins[u].as=ne([].concat(h(this.bins[u].as),h(e.bins[u].as)),X)):this.bins[u]=e.bins[u]}}catch(v){r=!0,i=v}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}var s=!0,l=!1,c=void 0;try{for(var f,d=e.children[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var p=f.value;e.removeChild(p),p.parent=this}}catch(v){l=!0,c=v}finally{try{s||null==d.return||d.return()}finally{if(l)throw c}}e.remove()}},{key:"producedFields",value:function(){return new Set(ue(this.bins).map(function(e){return e.as}).flat(2))}},{key:"dependentFields",value:function(){return new Set(ue(this.bins).map(function(e){return e.field}))}},{key:"hash",value:function(){return"Bin ".concat(X(this.bins))}},{key:"assemble",value:function(){return ue(this.bins).flatMap(function(e){var t=[],n=i(e.as),r=n[0],a=n.slice(1),o=Object.assign({type:"bin",field:pe(e.field),as:r,signal:e.signal},e.bin);!e.bin.extent&&e.extentSignal&&(t.push({type:"extent",field:pe(e.field),signal:e.extentSignal}),o.extent={signal:e.extentSignal}),t.push(o);var u=!0,s=!1,l=void 0;try{for(var c,f=a[Symbol.iterator]();!(u=(c=f.next()).done);u=!0)for(var d=c.value,h=0;h<2;h++)t.push({type:"formula",expr:Gr({field:r[h]},{expr:"datum"}),as:d[h]})}catch(p){s=!0,l=p}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}return e.formula&&t.push({type:"formula",expr:e.formula,as:e.formulaAs}),t})}}],[{key:"makeFromEncoding",value:function(e,n){var r=n.reduceFieldDef(function(e,t,r){if(Ir(t)&&pi(t.bin)){var i=df(t,t.bin,n),a=i.key,o=i.binComponent;e[a]=Object.assign(Object.assign(Object.assign({},o),e[a]),function(e,t,n,r){if(di(t,n)){var i=wd(e)&&(e.axis(n)||e.legend(n))||{},a=Gr(t,{expr:"datum"}),o=Gr(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Gr(t,{binSuffix:"range",forAs:!0}),formula:br(a,o,i.format,r)}}return{}}(n,t,r,n.config))}return e},{});return 0===oe(r).length?null:new t(e,r)}},{key:"makeFromTransform",value:function(e,n,r){var i=df(n,n.bin,r),a=i.key,o=i.binComponent;return new t(e,l({},a,o))}}]),t}(),pf=function(e){function t(e){var n,r;if(c(this,t),n=a(this,o(t).call(this,null)),Ha(e=e||{name:"source"})||(r=e.format?Object.assign({},$(e.format,["parse"])):{}),qa(e))n._data={values:e.values};else if(Ua(e)){if(n._data={url:e.url},!r.type){var i=/(?:\.([^.]+))?$/.exec(e.url)[1];Q(["json","csv","tsv","dsv","topojson"],i)||(i="json"),r.type=i}}else Ga(e)?n._data={values:[{type:"Sphere"}]}:(Wa(e)||Ha(e))&&(n._data={});return n._generator=Ha(e),e.name&&(n._name=e.name),r&&oe(r).length>0&&(n._data.format=r),n}return s(t,bu),f(t,[{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){}},{key:"hasName",value:function(){return!!this._name}},{key:"remove",value:function(){throw new Error("Source nodes are roots and cannot be removed.")}},{key:"hash",value:function(){throw new Error("Cannot hash sources")}},{key:"assemble",value:function(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}},{key:"data",get:function(){return this._data}},{key:"isGenerator",get:function(){return this._generator}},{key:"dataName",get:function(){return this._name},set:function(e){this._name=e}},{key:"parent",set:function(e){throw new Error("Source nodes have to be roots.")}}]),t}();function vf(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,u=!0,s=!1,l=void 0;try{for(var c,f=o.children[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var d=c.value;if(d.parent!==o)return console.error("Dataflow graph is inconsistent.",o,d),!1}}catch(h){s=!0,l=h}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}if(!vf(o.children))return!1}}catch(h){n=!0,r=h}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!0}var mf=function(e){function t(e,n){var r;return c(this,t),(r=a(this,o(t).call(this,e))).params=n,r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,this.params)}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){}},{key:"hash",value:function(){return"Graticule ".concat(X(this.params))}},{key:"assemble",value:function(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}]),t}(),gf=function(e){function t(e,n){var r;return c(this,t),(r=a(this,o(t).call(this,e))).params=n,r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,this.params)}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set([this.params.as||"data"])}},{key:"hash",value:function(){return"Hash ".concat(X(this.params))}},{key:"assemble",value:function(){return Object.assign({type:"sequence"},this.params)}}]),t}();function yf(e){return e instanceof pf||e instanceof mf||e instanceof gf}var bf=function(){function e(){c(this,e),this._mutated=!1}return f(e,[{key:"setMutated",value:function(){this._mutated=!0}},{key:"mutatedFlag",get:function(){return this._mutated}}]),e}(),xf=function(e){function t(){var e;return c(this,t),(e=a(this,o(t).call(this)))._continue=!1,e}return s(t,bf),f(t,[{key:"setContinue",value:function(){this._continue=!0}},{key:"reset",value:function(){}},{key:"optimizeNextFromLeaves",value:function(e){if(yf(e))return!1;var t=e.parent;return this.run(e).continueFlag&&this.optimizeNextFromLeaves(t),this.mutatedFlag}},{key:"continueFlag",get:function(){return this._continue}},{key:"flags",get:function(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}},set:function(e){var t=e.continueFlag,n=e.mutatedFlag;t&&this.setContinue(),n&&this.setMutated()}}]),t}(),wf=function(e){function t(){return c(this,t),a(this,o(t).apply(this,arguments))}return s(t,bf),t}();function kf(e,t,n,r){var i=wd(r)?r.encoding[Ut(t)]:void 0;if(Ir(n)&&wd(r)&&Rr(t,n,i,r.markDef,r.config))e.add(Gr(n,{})),e.add(Gr(n,{suffix:"end"})),di(n,t)&&e.add(Gr(n,{binSuffix:"range"}));else if(t in Ot){var a=function(e){switch(e){case ut:return"y";case lt:return"y2";case st:return"x";case ct:return"x2"}}(t);e.add(r.getName(a))}else e.add(Gr(n));return e}var Af=function(e){function t(e,n,r){var i;return c(this,t),(i=a(this,o(t).call(this,e))).dimensions=n,i.measures=r,i}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,new Set(this.dimensions),V(this.measures))}},{key:"merge",value:function(e){return function(e,t){if(e.size!==t.size)return!1;var n=!0,r=!1,i=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(!t.has(u))return!1}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return!0}(this.dimensions,e.dimensions)?(function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=oe(t)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value,s=t[u],c=!0,f=!1,d=void 0;try{for(var p,v=oe(s)[Symbol.iterator]();!(c=(p=v.next()).done);c=!0){var m=p.value;u in e?e[u][m]=new Set([].concat(h(e[u][m]||[]),h(s[m]))):e[u]=l({},m,s[m])}}catch(g){f=!0,d=g}finally{try{c||null==v.return||v.return()}finally{if(f)throw d}}}}catch(g){r=!0,i=g}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}(this.measures,e.measures),!0):(function(){var e;(e=on).debug.apply(e,arguments)}("different dimensions, cannot merge"),!1)}},{key:"addDimensions",value:function(e){e.forEach(this.dimensions.add,this.dimensions)}},{key:"dependentFields",value:function(){return new Set([].concat(h(this.dimensions),h(oe(this.measures))))}},{key:"producedFields",value:function(){var e=new Set,t=!0,n=!1,r=void 0;try{for(var i,a=oe(this.measures)[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,u=!0,s=!1,l=void 0;try{for(var c,f=oe(this.measures[o])[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var d=c.value,h=this.measures[o][d];0===h.size?e.add("".concat(d,"_").concat(o)):h.forEach(e.add,e)}}catch(p){s=!0,l=p}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}}}catch(p){n=!0,r=p}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return e}},{key:"hash",value:function(){return"Aggregate ".concat(X({dimensions:this.dimensions,measures:this.measures}))}},{key:"assemble",value:function(){var e=[],t=[],n=[],r=!0,i=!1,a=void 0;try{for(var o,u=oe(this.measures)[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=!0,c=!1,f=void 0;try{for(var d,p=oe(this.measures[s])[Symbol.iterator]();!(l=(d=p.next()).done);l=!0){var v=d.value,m=!0,g=!1,y=void 0;try{for(var b,x=this.measures[s][v][Symbol.iterator]();!(m=(b=x.next()).done);m=!0){var w=b.value;n.push(w),e.push(v),t.push("*"===s?null:pe(s))}}catch(k){g=!0,y=k}finally{try{m||null==x.return||x.return()}finally{if(g)throw y}}}}catch(k){c=!0,f=k}finally{try{l||null==p.return||p.return()}finally{if(c)throw f}}}}catch(k){i=!0,a=k}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return{type:"aggregate",groupby:h(this.dimensions),ops:e,fields:t,as:n}}},{key:"groupBy",get:function(){return this.dimensions}}],[{key:"makeFromEncoding",value:function(e,n){var r=!1;n.forEachFieldDef(function(e){e.aggregate&&(r=!0)});var i={},a=new Set;return r?(n.forEachFieldDef(function(e,t){var r=e.aggregate,o=e.field;if(r)if("count"===r)i["*"]=i["*"]||{},i["*"].count=new Set([Gr(e,{forAs:!0})]);else{if($e(r)||Ye(r)){var u=$e(r)?"argmin":"argmax",s=r[u];i[s]=i[s]||{},i[s][u]=new Set([Gr({op:u,field:s},{forAs:!0})])}else i[o]=i[o]||{},i[o][r]=new Set([Gr(e,{forAs:!0})]);Kt(t)&&"unaggregated"===n.scaleDomain(t)&&(i[o]=i[o]||{},i[o].min=new Set([Gr({field:o,aggregate:"min"},{forAs:!0})]),i[o].max=new Set([Gr({field:o,aggregate:"max"},{forAs:!0})]))}else kf(a,t,e,n)}),a.size+oe(i).length===0?null:new t(e,a,i)):null}},{key:"makeFromTransform",value:function(e,n){var r=new Set,i={},a=!0,o=!1,u=void 0;try{for(var s,l=n.aggregate[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value,f=c.op,d=c.field,h=c.as;f&&("count"===f?(i["*"]=i["*"]||{},i["*"].count=new Set([h||Gr(c,{forAs:!0})])):(i[d]=i[d]||{},i[d][f]=new Set([h||Gr(c,{forAs:!0})])))}}catch(x){o=!0,u=x}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}var p=!0,v=!1,m=void 0;try{for(var g,y=(n.groupby||[])[Symbol.iterator]();!(p=(g=y.next()).done);p=!0){var b=g.value;r.add(b)}}catch(x){v=!0,m=x}finally{try{p||null==y.return||y.return()}finally{if(v)throw m}}return r.size+oe(i).length===0?null:new t(e,r,i)}}]),t}(),Ef=function(e){function t(e,n,r,i){var u;c(this,t),(u=a(this,o(t).call(this,e))).model=n,u.name=r,u.data=i;var s=!0,l=!1,f=void 0;try{for(var d,p=jt[Symbol.iterator]();!(s=(d=p.next()).done);s=!0){var v=d.value,m=n.facet[v];if(m){var y=m.bin,b=m.sort;u[v]=Object.assign({name:n.getName("".concat(v,"_domain")),fields:[Gr(m)].concat(h(pi(y)?[Gr(m,{binSuffix:"end"})]:[]))},_r(b)?{sortField:b}:g(b)?{sortIndexField:hc(m,v)}:{})}}}catch(x){l=!0,f=x}finally{try{s||null==p.return||p.return()}finally{if(l)throw f}}return u.childModel=n.child,u}return s(t,bu),f(t,[{key:"hash",value:function(){var e="Facet",t=!0,n=!1,r=void 0;try{for(var i,a=jt[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this[o]&&(e+=" ".concat(o.charAt(0),":").concat(X(this[o])))}}catch(u){n=!0,r=u}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return e}},{key:"dependentFields",value:function(){var e=new Set(this.fields),t=!0,n=!1,r=void 0;try{for(var i,a=jt[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this[o]&&(this[o].sortField&&e.add(this[o].sortField.field),this[o].sortIndexField&&e.add(this[o].sortIndexField))}}catch(u){n=!0,r=u}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return e}},{key:"producedFields",value:function(){return new Set}},{key:"getSource",value:function(){return this.name}},{key:"getChildIndependentFieldsWithStep",value:function(){for(var e={},t=0,n=["x","y"];t<n.length;t++){var r=n[t],i=this.childModel.component.scales[r];if(i&&!i.merged){var a=i.get("type"),o=i.get("range");if(Zn(a)&&mo(o)){var u=rd(id(this.childModel,r));u?e[r]=u:un("Unknown field for ".concat(r,". Cannot calculate view size."))}}}return e}},{key:"assembleRowColumnHeaderData",value:function(e,t,n){var r={row:"y",column:"x"}[e],i=[],a=[],o=[];n&&n[r]&&(t?(i.push("distinct_".concat(n[r])),a.push("max")):(i.push(n[r]),a.push("distinct")),o.push("distinct_".concat(n[r])));var u=this[e],s=u.sortField,l=u.sortIndexField;if(s){var c=s.op,f=void 0===c?Dr:c,d=s.field;i.push(d),a.push(f),o.push(Gr(s,{forAs:!0}))}else l&&(i.push(l),a.push("max"),o.push(l));return{name:this[e].name,source:t||this.data,transform:[Object.assign({type:"aggregate",groupby:this[e].fields},i.length?{fields:i,ops:a,as:o}:{})]}}},{key:"assembleFacetHeaderData",value:function(e){var t=this.model.layout.columns,n=this.model.component.layoutHeaders,r=[],i={},a=!0,o=!1,u=void 0;try{for(var s,l=gc[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value,f=!0,d=!1,h=void 0;try{for(var p,v=yc[Symbol.iterator]();!(f=(p=v.next()).done);f=!0){var m=p.value,g=n[c]&&n[c][m]||[],y=!0,b=!1,x=void 0;try{for(var w,k=g[Symbol.iterator]();!(y=(w=k.next()).done);y=!0){var A=w.value;if(A.axes&&A.axes.length>0){i[c]=!0;break}}}catch(F){b=!0,x=F}finally{try{y||null==k.return||k.return()}finally{if(b)throw x}}}}catch(F){d=!0,h=F}finally{try{f||null==v.return||v.return()}finally{if(d)throw h}}if(i[c]){var E='length(data("'.concat(this.facet.name,'"))'),D="row"===c?t?{signal:"ceil(".concat(E," / ").concat(t,")")}:1:t?{signal:"min(".concat(E,", ").concat(t,")")}:{signal:E};r.push({name:"".concat(this.facet.name,"_").concat(c),transform:[{type:"sequence",start:0,stop:D}]})}}}catch(F){o=!0,u=F}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}var C=i.row,O=i.column;return(C||O)&&r.unshift(this.assembleRowColumnHeaderData("facet",null,e)),r}},{key:"assemble",value:function(){var e=[],t=null,n=this.getChildIndependentFieldsWithStep(),r=this.column,i=this.row,a=this.facet;if(r&&i&&(n.x||n.y)){t="cross_".concat(this.column.name,"_").concat(this.row.name);var o=[].concat(n.x||[],n.y||[]),u=o.map(function(){return"distinct"});e.push({name:t,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:o,ops:u}]})}for(var s=0,l=[tt,et];s<l.length;s++){var c=l[s];this[c]&&e.push(this.assembleRowColumnHeaderData(c,t,n))}if(a){var f=this.assembleFacetHeaderData(n);f&&e.push.apply(e,h(f))}return e}},{key:"fields",get:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,a=jt[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this[o]&&this[o].fields&&e.push.apply(e,h(this[o].fields))}}catch(u){n=!0,r=u}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return e}}]),t}(),Df=function(e){function t(e,n,i){var u;return c(this,t),(u=a(this,o(t).call(this,e))).model=n,u.filter=i,u.expr=os(u.model,u.filter,r(u)),u._dependentFields=fc(u.expr),u}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,this.model,V(this.filter))}},{key:"dependentFields",value:function(){return this._dependentFields}},{key:"producedFields",value:function(){return new Set}},{key:"assemble",value:function(){return{type:"filter",expr:this.expr}}},{key:"hash",value:function(){return"Filter ".concat(this.expr)}}]),t}();function Cf(e){return"'"===e[0]&&"'"===e[e.length-1]||'"'===e[0]&&'"'===e[e.length-1]?e.slice(1,-1):e}function Of(e,t){var n=he(e);if("number"===t)return"toNumber(".concat(n,")");if("boolean"===t)return"toBoolean(".concat(n,")");if("string"===t)return"toString(".concat(n,")");if("date"===t)return"toDate(".concat(n,")");if("flatten"===t)return n;if(0===t.indexOf("date:")){var r=Cf(t.slice(5,t.length));return"timeParse(".concat(n,",'").concat(r,"')")}if(0===t.indexOf("utc:")){var i=Cf(t.slice(4,t.length));return"utcParse(".concat(n,",'").concat(i,"')")}return un(rn.unrecognizedParse(t)),null}function Ff(e){var t={};return function e(t,n){if(q(t))e(t.not,n);else if(U(t)){var r=!0,i=!1,a=void 0;try{for(var o,u=t.and[Symbol.iterator]();!(r=(o=u.next()).done);r=!0)e(o.value,n)}catch(h){i=!0,a=h}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}else if(I(t)){var s=!0,l=!1,c=void 0;try{for(var f,d=t.or[Symbol.iterator]();!(s=(f=d.next()).done);s=!0)e(f.value,n)}catch(h){l=!0,c=h}finally{try{s||null==d.return||d.return()}finally{if(l)throw c}}}else n(t)}(e.filter,function(e){if(jn(e)){var n=null;Dn(e)?n=e.equal:Sn(e)?n=e.range[0]:Mn(e)&&(n=(e.oneOf||e.in)[0]),n&&(ln(n)?t[e.field]="date":T(n)?t[e.field]="number":b(n)&&(t[e.field]="string")),e.timeUnit&&(t[e.field]="date")}}),t}function _f(e){var t={};function n(e){var n;li(e)?t[e.field]="date":"quantitative"===e.type&&(n=e.aggregate)&&b(n)&&Q(["min","max"],n)?t[e.field]="number":ge(e.field)>1?e.field in t||(t[e.field]="flatten"):Wr(e)&&_r(e.sort)&&ge(e.sort.field)>1&&(e.sort.field in t||(t[e.sort.field]="flatten"))}if((wd(e)||kd(e))&&e.forEachFieldDef(function(t,r){if(Ir(t))n(t);else{var i=It(r),a=e.fieldDef(i);n(Object.assign(Object.assign({},t),{type:a.type}))}}),wd(e)){var r=e.mark,i=e.markDef,a=e.encoding;if(Ne(r)&&!e.encoding.order){var o=a["horizontal"===i.orient?"y":"x"];!Lr(o)||"quantitative"!==o.type||o.field in t||(t[o.field]="number")}}return t}var Sf=function(e){function t(e,n){var r;return c(this,t),(r=a(this,o(t).call(this,e)))._parse=n,r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,V(this._parse))}},{key:"hash",value:function(){return"Parse ".concat(X(this._parse))}},{key:"merge",value:function(e){this._parse=Object.assign(Object.assign({},this._parse),e.parse),e.remove()}},{key:"assembleFormatParse",value:function(){var e={},t=!0,n=!1,r=void 0;try{for(var i,a=oe(this._parse)[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,u=this._parse[o];1===ge(o)&&(e[o]=u)}}catch(s){n=!0,r=s}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return e}},{key:"producedFields",value:function(){return new Set(oe(this._parse))}},{key:"dependentFields",value:function(){return new Set(oe(this._parse))}},{key:"assembleTransforms",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return oe(this._parse).filter(function(e){return!t||ge(e)>1}).map(function(t){var n=Of(t,e._parse[t]);return n?{type:"formula",expr:n,as:me(t)}:null}).filter(function(e){return null!==e})}},{key:"parse",get:function(){return this._parse}}],[{key:"makeExplicit",value:function(e,t,n){var r={},i=t.data;return!Ha(i)&&i&&i.format&&i.format.parse&&(r=i.format.parse),this.makeWithAncestors(e,r,{},n)}},{key:"makeWithAncestors",value:function(e,n,r,i){var a=!0,o=!1,u=void 0;try{for(var s,l=oe(r)[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value,f=i.getWithExplicit(c);void 0!==f.value&&(f.explicit||f.value===r[c]||"derived"===f.value||"flatten"===r[c]?delete r[c]:un(rn.differentParse(c,r[c],f.value)))}}catch(F){o=!0,u=F}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}var d=!0,h=!1,p=void 0;try{for(var v,m=oe(n)[Symbol.iterator]();!(d=(v=m.next()).done);d=!0){var g=v.value,y=i.get(g);void 0!==y&&(y===n[g]?delete n[g]:un(rn.differentParse(g,n[g],y)))}}catch(F){h=!0,p=F}finally{try{d||null==m.return||m.return()}finally{if(h)throw p}}var b=new Bc(n,r);i.copyAll(b);var x={},w=!0,k=!1,A=void 0;try{for(var E,D=oe(b.combine())[Symbol.iterator]();!(w=(E=D.next()).done);w=!0){var C=E.value,O=b.get(C);null!==O&&(x[C]=O)}}catch(F){k=!0,A=F}finally{try{w||null==D.return||D.return()}finally{if(k)throw A}}return 0===oe(x).length||i.parseNothing?null:new t(e,x)}}]),t}(),Mf=function(e){function t(e,n){var r;return c(this,t),(r=a(this,o(t).call(this,e))).transform=n,r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,V(this.transform))}},{key:"addDimensions",value:function(e){this.transform.groupby=ne(this.transform.groupby.concat(e),function(e){return e})}},{key:"dependentFields",value:function(){var e=new Set;return this.transform.groupby&&this.transform.groupby.forEach(function(t){return e.add(t)}),this.transform.joinaggregate.map(function(e){return e.field}).filter(function(e){return void 0!==e}).forEach(function(t){return e.add(t)}),e}},{key:"producedFields",value:function(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}},{key:"getDefaultName",value:function(e){return e.as||Gr(e)}},{key:"hash",value:function(){return"JoinAggregateTransform ".concat(X(this.transform))}},{key:"assemble",value:function(){var e=[],t=[],n=[],r=!0,i=!1,a=void 0;try{for(var o,u=this.transform.joinaggregate[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;t.push(s.op),n.push(this.getDefaultName(s)),e.push(void 0===s.field?null:s.field)}}catch(c){i=!0,a=c}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}var l=this.transform.groupby;return Object.assign({type:"joinaggregate",as:n,ops:t,fields:e},void 0!==l?{groupby:l}:{})}}]),t}(),jf=function(e){function t(e,n){var r;return c(this,t),(r=a(this,o(t).call(this,e)))._stack=n,r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,V(this._stack))}},{key:"addDimensions",value:function(e){var t;(t=this._stack.facetby).push.apply(t,h(e))}},{key:"dependentFields",value:function(){var e=new Set;return e.add(this._stack.stackField),this.getGroupbyFields().forEach(function(t){return e.add(t)}),this._stack.facetby.forEach(function(t){return e.add(t)}),this._stack.sort.field.forEach(function(t){return e.add(t)}),e}},{key:"producedFields",value:function(){return new Set(this._stack.as)}},{key:"hash",value:function(){return"Stack ".concat(X(this._stack))}},{key:"getGroupbyFields",value:function(){var e=this._stack,t=e.dimensionFieldDef,n=e.impute,r=e.groupby;return t?t.bin?n?[Gr(t,{binSuffix:"mid"})]:[Gr(t,{}),Gr(t,{binSuffix:"end"})]:[Gr(t)]:r||[]}},{key:"assemble",value:function(){var e=[],t=this._stack,n=t.facetby,r=t.dimensionFieldDef,i=t.stackField,a=t.stackby,o=t.sort,u=t.offset,s=t.impute,l=t.as;if(s&&r){var c=r.band,f=void 0===c?.5:c;r.bin&&e.push({type:"formula",expr:"".concat(f,"*")+Gr(r,{expr:"datum"})+"+".concat(1-f,"*")+Gr(r,{expr:"datum",binSuffix:"end"}),as:Gr(r,{binSuffix:"mid",forAs:!0})}),e.push({type:"impute",field:i,groupby:[].concat(h(a),h(n)),key:Gr(r,{binSuffix:"mid"}),method:"value",value:0})}return e.push({type:"stack",groupby:[].concat(h(this.getGroupbyFields()),h(n)),field:i,sort:o,as:l,offset:u}),e}},{key:"stack",get:function(){return this._stack}}],[{key:"makeFromTransform",value:function(e,n){var r=n.stack,i=n.groupby,a=n.as,o=n.offset,u=void 0===o?"zero":o,s=[],l=[];if(void 0!==n.sort){var c=!0,f=!1,d=void 0;try{for(var h,p=n.sort[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var v=h.value;s.push(v.field),l.push(ye(v.order,"ascending"))}}catch(m){f=!0,d=m}finally{try{c||null==p.return||p.return()}finally{if(f)throw d}}}return new t(e,{stackField:r,groupby:i,offset:u,sort:{field:s,order:l},facetby:[],as:function(e){return g(e)&&e.every(function(e){return b(e)})&&e.length>1}(a)?a:b(a)?[a,a+"_end"]:[n.stack+"_start",n.stack+"_end"]})}},{key:"makeFromEncoding",value:function(e,n){var r,i=n.stack,a=n.encoding;if(!i)return null;i.groupbyChannel&&(r=ii(a[i.groupbyChannel]));var o,u=function(e){return e.stack.stackBy.reduce(function(e,t){var n=Gr(t.fieldDef);return n&&e.push(n),e},[])}(n),s=n.encoding.order;return o=g(s)||Lr(s)?wr(s):u.reduce(function(e,t){return e.field.push(t),e.order.push("descending"),e},{field:[],order:[]}),new t(e,{dimensionFieldDef:r,stackField:n.vgField(i.fieldChannel),facetby:[],stackby:u,sort:o,offset:i.offset,impute:i.impute,as:[n.vgField(i.fieldChannel,{suffix:"start",forAs:!0}),n.vgField(i.fieldChannel,{suffix:"end",forAs:!0})]})}}]),t}(),Tf=function(e){function t(e,n){var r;return c(this,t),(r=a(this,o(t).call(this,e))).transform=n,r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,V(this.transform))}},{key:"addDimensions",value:function(e){this.transform.groupby=ne(this.transform.groupby.concat(e),function(e){return e})}},{key:"dependentFields",value:function(){var e=new Set;return(this.transform.groupby||[]).forEach(function(t){return e.add(t)}),(this.transform.sort||[]).forEach(function(t){return e.add(t.field)}),this.transform.window.map(function(e){return e.field}).filter(function(e){return void 0!==e}).forEach(function(t){return e.add(t)}),e}},{key:"producedFields",value:function(){return new Set(this.transform.window.map(this.getDefaultName))}},{key:"getDefaultName",value:function(e){return e.as||Gr(e)}},{key:"hash",value:function(){return"WindowTransform ".concat(X(this.transform))}},{key:"assemble",value:function(){var e=[],t=[],n=[],r=[],i=!0,a=!1,o=void 0;try{for(var u,s=this.transform.window[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;t.push(l.op),n.push(this.getDefaultName(l)),r.push(void 0===l.param?null:l.param),e.push(void 0===l.field?null:l.field)}}catch(k){a=!0,o=k}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}var c=this.transform.frame,f=this.transform.groupby;if(c&&null===c[0]&&null===c[1]&&t.every(function(e){return Xe(e)}))return Object.assign({type:"joinaggregate",as:n,ops:t,fields:e},void 0!==f?{groupby:f}:{});var d=[],h=[];if(void 0!==this.transform.sort){var p=!0,v=!1,m=void 0;try{for(var g,y=this.transform.sort[Symbol.iterator]();!(p=(g=y.next()).done);p=!0){var b=g.value;d.push(b.field),h.push(b.order||"ascending")}}catch(k){v=!0,m=k}finally{try{p||null==y.return||y.return()}finally{if(v)throw m}}}var x={field:d,order:h},w=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:r,as:n,ops:t,fields:e,sort:x},void 0!==w?{ignorePeers:w}:{}),void 0!==f?{groupby:f}:{}),void 0!==c?{frame:c}:{})}}]),t}(),Nf=function(e){function t(){return c(this,t),a(this,o(t).apply(this,arguments))}return s(t,xf),f(t,[{key:"run",value:function(e){var t=e.parent;if(e instanceof Sf){if(yf(t))return this.flags;if(t.numChildren()>1)return this.setContinue(),this.flags;if(t instanceof Sf)this.setMutated(),t.merge(e);else{if(ae(t.producedFields(),e.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),e.swapWithParent()}}return this.setContinue(),this.flags}}]),t}(),Bf=function(e){function t(){return c(this,t),a(this,o(t).apply(this,arguments))}return s(t,wf),f(t,[{key:"mergeNodes",value:function(e,t){var n=t.shift(),r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;e.removeChild(s),s.parent=n,s.remove()}}catch(l){i=!0,a=l}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}},{key:"run",value:function(e){for(var t=e.children.map(function(e){return e.hash()}),n={},r=0;r<t.length;r++)void 0===n[t[r]]?n[t[r]]=[e.children[r]]:n[t[r]].push(e.children[r]);var i=!0,a=!1,o=void 0;try{for(var u,s=oe(n)[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value;n[l].length>1&&(this.setMutated(),this.mergeNodes(e,n[l]))}}catch(m){a=!0,o=m}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}var c=!0,f=!1,d=void 0;try{for(var h,p=e.children[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var v=h.value;this.run(v)}}catch(m){f=!0,d=m}finally{try{c||null==p.return||p.return()}finally{if(f)throw d}}return this.mutatedFlag}}]),t}(),Rf=function(e){function t(){return c(this,t),a(this,o(t).apply(this,arguments))}return s(t,xf),f(t,[{key:"run",value:function(e){return e instanceof xu||e.numChildren()>0||e instanceof Ef?this.flags:(this.setMutated(),e.remove(),this.flags)}}]),t}(),zf=function(e){function t(){var e;return c(this,t),(e=a(this,o(t).apply(this,arguments))).fields=new Set,e}return s(t,xf),f(t,[{key:"run",value:function(e){if(this.setContinue(),e instanceof wu){var t=e.producedFields();re(t,this.fields)?(this.setMutated(),e.remove()):this.fields=new Set([].concat(h(this.fields),h(t)))}return this.flags}},{key:"reset",value:function(){this.fields.clear()}}]),t}(),Pf=function(e){function t(){return c(this,t),a(this,o(t).apply(this,arguments))}return s(t,xf),f(t,[{key:"run",value:function(e){this.setContinue();var t=e.parent.children.filter(function(e){return e instanceof wu}),n=t.pop(),r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;this.setMutated(),n.merge(s)}}catch(l){i=!0,a=l}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return this.flags}}]),t}();function Lf(e){if(e instanceof Ef)if(1!==e.numChildren()||e.children[0]instanceof xu){var t=e.model.component.data.main;!function e(t){if(t instanceof xu&&t.type===Ya&&1===t.numChildren()){var n=t.children[0];n instanceof Ef||(n.swapWithParent(),e(t))}}(t);var n=(c=e,function e(t){if(!(t instanceof Ef)){var n=t.clone();if(n instanceof xu){var r=Vf+n.getSource();n.setSource(r),c.model.component.data.outputNodes[r]=n}else(n instanceof Af||n instanceof jf||n instanceof Tf||n instanceof Mf)&&n.addDimensions(c.fields);return t.children.flatMap(e).forEach(function(e){return e.parent=n}),[n]}return t.children.flatMap(e)}),r=e.children.map(n).flat(),i=!0,a=!1,o=void 0;try{for(var u,s=r[Symbol.iterator]();!(i=(u=s.next()).done);i=!0)u.value.parent=t}catch(f){a=!0,o=f}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}}else{var l=e.children[0];(l instanceof Af||l instanceof jf||l instanceof Tf||l instanceof Mf)&&l.addDimensions(e.fields),l.swapWithParent(),Lf(e)}else e.children.map(Lf);var c}var If=function(e){function t(){return c(this,t),a(this,o(t).apply(this,arguments))}return s(t,wf),f(t,[{key:"run",value:function(e){e instanceof xu&&!e.isRequired()&&(this.setMutated(),e.remove());var t=!0,n=!1,r=void 0;try{for(var i,a=e.children[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;this.run(o)}}catch(u){n=!0,r=u}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return this.mutatedFlag}}]),t}(),Uf=function(e){function t(){return c(this,t),a(this,o(t).apply(this,arguments))}return s(t,xf),f(t,[{key:"run",value:function(e){var t=e.parent,n=h(t.children),r=t.children.filter(function(e){return e instanceof Sf});if(t.numChildren()>1&&r.length>=1){var i={},a=new Set,o=!0,u=!1,s=void 0;try{for(var l,c=r[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value.parse,d=!0,p=!1,v=void 0;try{for(var m,g=oe(f)[Symbol.iterator]();!(d=(m=g.next()).done);d=!0){var y=m.value;y in i?i[y]!==f[y]&&a.add(y):i[y]=f[y]}}catch(z){p=!0,v=z}finally{try{d||null==g.return||g.return()}finally{if(p)throw v}}}}catch(z){u=!0,s=z}finally{try{o||null==c.return||c.return()}finally{if(u)throw s}}var b=!0,x=!1,w=void 0;try{for(var k,A=a[Symbol.iterator]();!(b=(k=A.next()).done);b=!0)delete i[k.value]}catch(z){x=!0,w=z}finally{try{b||null==A.return||A.return()}finally{if(x)throw w}}if(0!==oe(i).length){this.setMutated();var E=new Sf(t,i),D=!0,C=!1,O=void 0;try{for(var F,_=n[Symbol.iterator]();!(D=(F=_.next()).done);D=!0){var S=F.value;if(S instanceof Sf){var M=!0,j=!1,T=void 0;try{for(var N,B=oe(i)[Symbol.iterator]();!(M=(N=B.next()).done);M=!0){var R=N.value;delete S.parse[R]}}catch(z){j=!0,T=z}finally{try{M||null==B.return||B.return()}finally{if(j)throw T}}}t.removeChild(S),S.parent=E,S instanceof Sf&&0===oe(S.parse).length&&S.remove()}}catch(z){C=!0,O=z}finally{try{D||null==_.return||_.return()}finally{if(C)throw O}}}}return this.setContinue(),this.flags}}]),t}(),qf=function(e){function t(){return c(this,t),a(this,o(t).apply(this,arguments))}return s(t,xf),f(t,[{key:"run",value:function(e){var t=e.parent,n=t.children.filter(function(e){return e instanceof Af}),r={},i=!0,a=!1,o=void 0;try{for(var u,s=n[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var l=u.value,c=X(l.groupBy);c in r||(r[c]=[]),r[c].push(l)}}catch(E){a=!0,o=E}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}var f=!0,d=!1,h=void 0;try{for(var p,v=oe(r)[Symbol.iterator]();!(f=(p=v.next()).done);f=!0){var m=r[p.value];if(m.length>1){var g=m.pop(),y=!0,b=!1,x=void 0;try{for(var w,k=m[Symbol.iterator]();!(y=(w=k.next()).done);y=!0){var A=w.value;g.merge(A)&&(t.removeChild(A),A.parent=g,A.remove(),this.setMutated())}}catch(E){b=!0,x=E}finally{try{y||null==k.return||k.return()}finally{if(b)throw x}}}}}catch(E){d=!0,h=E}finally{try{f||null==v.return||v.return()}finally{if(d)throw h}}return this.setContinue(),this.flags}}]),t}(),Wf=function(e){function t(e){var n;return c(this,t),(n=a(this,o(t).call(this))).model=e,n}return s(t,xf),f(t,[{key:"run",value:function(e){var t=e.parent,n=!(yf(t)||t instanceof Df||t instanceof Sf),r=[],i=[],a=!0,o=!1,u=void 0;try{for(var s,l=t.children[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;c instanceof hf&&(n&&!ae(t.producedFields(),c.dependentFields())?r.push(c):i.push(c))}}catch(D){o=!0,u=D}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}if(r.length>0){var f=r.pop(),d=!0,h=!1,p=void 0;try{for(var v,m=r[Symbol.iterator]();!(d=(v=m.next()).done);d=!0){var g=v.value;f.merge(g,this.model.renameSignal.bind(this.model))}}catch(D){h=!0,p=D}finally{try{d||null==m.return||m.return()}finally{if(h)throw p}}this.setMutated(),t instanceof hf?t.merge(f,this.model.renameSignal.bind(this.model)):f.swapWithParent()}if(i.length>1){var y=i.pop(),b=!0,x=!1,w=void 0;try{for(var k,A=i[Symbol.iterator]();!(b=(k=A.next()).done);b=!0){var E=k.value;y.merge(E,this.model.renameSignal.bind(this.model))}}catch(D){x=!0,w=D}finally{try{b||null==A.return||A.return()}finally{if(x)throw w}}this.setMutated()}return this.setContinue(),this.flags}}]),t}(),Hf=function(e){function t(){return c(this,t),a(this,o(t).apply(this,arguments))}return s(t,xf),f(t,[{key:"run",value:function(e){var t=e.parent,n=h(t.children);if(!K(n,function(e){return e instanceof xu})||t.numChildren()<=1)return this.setContinue(),this.flags;var r,i=[],a=!0,o=!1,u=void 0;try{for(var s,l=n[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;if(c instanceof xu){for(var f=c;1===f.numChildren();){var d=f.children[0];if(!(d instanceof xu))break;f=d}i.push.apply(i,h(f.children)),r?(t.removeChild(c),c.parent=r.parent,r.parent.removeChild(r),r.parent=f,this.setMutated()):r=f}else i.push(c)}}catch(x){o=!0,u=x}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}if(i.length){this.setMutated();var p=!0,v=!1,m=void 0;try{for(var g,y=i[Symbol.iterator]();!(p=(g=y.next()).done);p=!0){var b=g.value;b.parent.removeChild(b),b.parent=r}}catch(x){v=!0,m=x}finally{try{p||null==y.return||y.return()}finally{if(v)throw m}}}return this.setContinue(),this.flags}}]),t}(),Vf="scale_",Gf=5;function $f(e){var t=[];return e.forEach(function e(n){0===n.numChildren()?t.push(n):n.children.forEach(e)}),t}function Yf(e){return e}function Xf(e,t){return t.map(function(t){if(e instanceof xf){var n=e.optimizeNextFromLeaves(t);return e.reset(),n}return e.run(t)}).some(Yf)}function Jf(e,t){var n=e.sources,r=new Set;return r.add(Xf(new If,n)),n=n.filter(function(e){return e.numChildren()>0}),r.add(Xf(new Rf,$f(n))),n=n.filter(function(e){return e.numChildren()>0}),r.add(Xf(new Nf,$f(n))),r.add(Xf(new Wf(t),$f(n))),r.add(Xf(new zf,$f(n))),r.add(Xf(new Uf,$f(n))),r.add(Xf(new qf,$f(n))),r.add(Xf(new Pf,$f(n))),r.add(Xf(new Bf,n)),r.add(Xf(new Hf,$f(n))),e.sources=n,r.has(!0)}var Qf=function(){function e(t){c(this,e),Object.defineProperty(this,"signal",{enumerable:!0,get:t})}return f(e,null,[{key:"fromName",value:function(t,n){return new e(function(){return t(n)})}}]),e}();function Kf(e){wd(e)?function(e){var t=e.specifiedScales,n=e.component.scales;oe(n).forEach(function(r){var i=t[r],a=i?i.domain:void 0,o=function(e,t){var n=e.getScaleComponent(t).get("type"),r=function(e,t,n,r){if("unaggregated"===e){var i=td(t,n),a=i.valid,o=i.reason;if(!a)return void un(o)}else if(void 0===e&&r.useUnaggregatedDomain&&td(t,n).valid)return"unaggregated";return e}(e.scaleDomain(t),e.fieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:r})),"x"===t&&e.channelHasField("x2")?e.channelHasField("x")?Ic(Zf(n,r,e,"x"),Zf(n,r,e,"x2"),"domain","scale",nd):Zf(n,r,e,"x2"):"y"===t&&e.channelHasField("y2")?e.channelHasField("y")?Ic(Zf(n,r,e,"y"),Zf(n,r,e,"y2"),"domain","scale",nd):Zf(n,r,e,"y2"):Zf(n,r,e,t)}(e,r),u=n[r];if(u.setWithExplicit("domains",o),rr(a)&&u.set("domainRaw",{signal:Zu+X(a)},!0),e.component.data.isFaceted){for(var s=e;!kd(s)&&s.parent;)s=s.parent;if("shared"===s.component.resolve.scale[r]){var l=!0,c=!1,f=void 0;try{for(var d,h=o.value[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var p=d.value;go(p)&&(p.data=Vf+p.data.replace(Vf,""))}}catch(v){c=!0,f=v}finally{try{l||null==h.return||h.return()}finally{if(c)throw f}}}}})}(e):function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.children[Symbol.iterator]();!(t=(i=a.next()).done);t=!0)Kf(i.value)}catch(u){n=!0,r=u}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}var o=e.component.scales;oe(o).forEach(function(t){var n,r=null,i=!0,a=!1,s=void 0;try{for(var l,c=e.children[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var f=l.value.component.scales[t];if(f){n=void 0===n?f.getWithExplicit("domains"):Ic(n,f.getWithExplicit("domains"),"domains","scale",nd);var d=f.get("domainRaw");r&&d&&r.signal!==d.signal&&un("The same selection must be used to override scale domains in a layered view."),r=d}}}catch(u){a=!0,s=u}finally{try{i||null==c.return||c.return()}finally{if(a)throw s}}o[t].setWithExplicit("domains",n),r&&o[t].set("domainRaw",r,!0)})}(e)}function Zf(e,t,n,r){var i=n.fieldDef(r);if(t&&"unaggregated"!==t&&!rr(t)){var a=i.type,o=i.timeUnit;return Rc("temporal"===a||o?function(e,t,n){return e.map(function(e){var r=ci(e,{timeUnit:n,type:t});return{signal:"{data: ".concat(r,"}")}})}(t,a,o):[t])}var u=n.stack;if(u&&r===u.fieldChannel){if("normalize"===u.offset)return zc([[0,1]]);var s=n.requestDataName(Ya);return zc([{data:s,field:n.vgField(r,{suffix:"start"})},{data:s,field:n.vgField(r,{suffix:"end"})}])}var l=Kt(r)?function(e,t,n){if(Zn(n)){var r=e.fieldDef(t),i=r.sort;if(Sr(i))return{op:"min",field:hc(r,t),order:"ascending"};var a=null!==e.stack;if(_r(i))return ed(i,a);if(Fr(i)){var o=i.encoding,u=i.order,s=e.fieldDef(o),l=s.aggregate,c=s.field;if($e(l)||Ye(l))return ed({field:Gr(s),order:u},a);if(Xe(l)||!l)return ed({op:l,field:c,order:u},a)}else{if("descending"===i)return{op:"min",field:e.vgField(t),order:"descending"};if(Q(["ascending",void 0],i))return!0}}}(n,r,e):void 0;if("unaggregated"===t){var c=n.requestDataName(Ya),f=i.field;return zc([{data:c,field:Gr({field:f,aggregate:"min"})},{data:c,field:Gr({field:f,aggregate:"max"})}])}if(pi(i.bin)){if(Zn(e))return zc("bin-ordinal"===e?[]:[{data:se(l)?n.requestDataName(Ya):n.requestDataName(Xa),field:n.vgField(r,di(i,r)?{binSuffix:"range"}:{}),sort:!0!==l&&y(l)?l:{field:n.vgField(r,{}),op:"min"}}]);var d=i.bin;if(pi(d)){var h=ff(n,i.field,d);return zc([new Qf(function(){var e=n.getSignalName(h);return"[".concat(e,".start, ").concat(e,".stop]")})])}return zc([{data:n.requestDataName(Ya),field:n.vgField(r,{})}])}if(i.timeUnit&&Q(["time","utc"],e)&&Rr(r,i,wd(n)?n.encoding[Ut(r)]:void 0,n.markDef,n.config)){var p=n.requestDataName(Ya);return zc([{data:p,field:n.vgField(r)},{data:p,field:n.vgField(r,{suffix:"end"})}])}return zc(l?[{data:se(l)?n.requestDataName(Ya):n.requestDataName(Xa),field:n.vgField(r),sort:l}]:[{data:n.requestDataName(Ya),field:n.vgField(r)}])}function ed(e,t){var n=e.op,r=e.field,i=e.order;return Object.assign(Object.assign({op:n||(t?"sum":Dr)},r?{field:pe(r)}:{}),i?{order:i}:{})}function td(e,t){var n=e.aggregate,r=e.type;return n?b(n)&&!Ze[n]?{valid:!1,reason:rn.unaggregateDomainWithNonSharedDomainOp(n)}:"quantitative"===r&&"log"===t?{valid:!1,reason:rn.unaggregatedDomainWithLogScale(e)}:{valid:!0}:{valid:!1,reason:rn.unaggregateDomainHasNoEffectForRawField(e)}}function nd(e,t,n,r){return e.explicit&&t.explicit&&un(rn.mergeConflictingDomainProperty(n,r,e.value,t.value)),{explicit:e.explicit,value:[].concat(h(e.value),h(t.value))}}function rd(e){if(go(e)&&b(e.field))return e.field;if(function(e){return!g(e)&&"fields"in e&&!("data"in e)}(e)){var t,n=!0,r=!1,i=void 0;try{for(var a,o=e.fields[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;if(go(u)&&b(u.field))if(t){if(t!==u.field)return un("Detected faceted independent scales that union domain of multiple fields from different data sources.  We will use the first field.  The result view size may be incorrect."),t}else t=u.field}}catch(l){r=!0,i=l}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return un("Detected faceted independent scales that union domain of identical fields from different source detected.  We will assume that this is the same field from a different fork of the same data source.  However, if this is not case, the result view size maybe incorrect."),t}if(function(e){return!g(e)&&"fields"in e&&"data"in e}(e)){un("Detected faceted independent scales that union domain of multiple fields from the same data source.  We will use the first field.  The result view size may be incorrect.");var s=e.fields[0];return b(s)?s:void 0}}function id(e,t){return function(e){var t=ne(e.map(function(e){return go(e)?He(e,["sort"]):e}),X),n=ne(e.map(function(e){if(go(e)){var t=e.sort;return void 0===t||se(t)||("count"===t.op&&delete t.field,"ascending"===t.order&&delete t.order),t}}).filter(function(e){return void 0!==e}),X);if(0!==t.length){if(1===t.length){var r=e[0];if(go(r)&&n.length>0){var i=n[0];return n.length>1&&(un(rn.MORE_THAN_ONE_SORT),i=!0),Object.assign(Object.assign({},r),{sort:i})}return r}var a,o=ne(n.map(function(e){return se(e)||e.op in Ge?e:(un(rn.domainSortDropped(e)),!0)}),X);1===o.length?a=o[0]:o.length>1&&(un(rn.MORE_THAN_ONE_SORT),a=!0);var u=ne(e.map(function(e){return go(e)?e.data:null}),function(e){return e});return 1===u.length&&null!==u[0]?Object.assign({data:u[0],fields:t.map(function(e){return e.field})},a?{sort:a}:{}):Object.assign({fields:t},a?{sort:a}:{})}}(e.component.scales[t].get("domains").map(function(t){return go(t)&&(t.data=e.lookupDataSource(t.data)),t}))}function ad(e){return Dd(e)||Ed(e)||Ad(e)?e.children.reduce(function(e,t){return e.concat(ad(t))},od(e)):od(e)}function od(e){return oe(e.component.scales).reduce(function(t,n){var r=e.component.scales[n];if(r.merged)return t;var i=r.combine(),a=i.domainRaw,o=i.name,u=i.type,s=(i.domains,i.domainRaw,i.range,He(i,["name","type","domains","domainRaw","range"])),l=function(e,t,n){return"x"!==n&&"y"!==n||!mo(e)?e:{step:{signal:t+"_step"}}}(i.range,o,n);a&&function(e){return e.signal.indexOf(Zu)>=0}(a)&&(a=function(e,t){var n=JSON.parse(t.signal.replace(Zu,"")),r=le(n.selection),i=n.encoding,a=n.field,o=e.component.selection&&e.component.selection[r];if(!o){if(o=e.getSelectionComponent(r,n.selection),i||a){if(i&&!a){var u=o.project.items.filter(function(e){return e.channel===i});!u.length||u.length>1?(a=o.project.items[0].field,un((u.length?"Multiple ":"No ")+"matching ".concat(x(i)," encoding found for selection ").concat(x(n.selection),". ")+'Using "field": '.concat(x(a),"."))):a=u[0].field}}else a=o.project.items[0].field,o.project.items.length>1&&un('A "field" or "encoding" must be specified when using a selection as a scale domain. '+'Using "field": '.concat(x(a),"."));return{signal:"".concat(r,"[").concat(x(a),"]")}}return un('Use "bind": "scales" to setup a binding for scales and selections within the same view.'),{signal:"null"}}(e,a));var c=id(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign({name:o,type:u},c?{domain:c}:{}),a?{domainRaw:a}:{}),{range:l}),s)),t},[])}var ud=function(e){function t(e,n){var r;return c(this,t),(r=a(this,o(t).call(this,{},{name:e}))).merged=!1,r.setWithExplicit("type",n),r}return s(t,Bc),f(t,[{key:"domainDefinitelyIncludesZero",value:function(){return!1!==this.get("zero")||K(this.get("domains"),function(e){return g(e)&&2===e.length&&e[0]<=0&&e[1]>=0})}}]),t}(),sd=["range","scheme"];function ld(e){return"x"===e?"width":"y"===e?"height":void 0}function cd(e){var t=e.component.scales;Qt.forEach(function(n){var r=t[n];if(r){var i=function(e,t){var n,r=t.specifiedScales[e],i=t.size,a=t.getScaleComponent(e).get("type"),o=!0,u=!1,s=void 0;try{for(var l,c=sd[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value;if(void 0!==r[f]){var d=or(a,f),h=ur(e,f);if(d)if(h)un(h);else switch(f){case"range":return Rc(r[f]);case"scheme":return Rc(function(e){return e&&!!e.name}(n=r[f])?Object.assign({scheme:n.name},$(n,["name"])):{scheme:n})}else un(rn.scalePropertyNotWorkWithScaleType(a,f,e))}}}catch(m){u=!0,s=m}finally{try{o||null==c.return||c.return()}finally{if(u)throw s}}if(e===rt||e===it){var p=e===rt?"width":"height",v=i[p];if(oa(v)){if(Zn(a))return Rc({step:v.step});un(rn.stepDropped(p))}}return zc(function(e,t){var n=t.size,r=t.config,i=t.mark,a=t.getSignalName.bind(t),o=t.fieldDef(e).type,u=t.getScaleComponent(e).get("type"),s=t.specifiedScales[e].domain;switch(e){case rt:case it:if(Q(["point","band"],u))if(e!==rt||n.width){if(e===it&&!n.height){var l=fa(r.view,"height");if(oa(l))return l}}else{var c=fa(r.view,"width");if(oa(c))return c}var f=ld(e),d=t.getName(f);return e===it&&er(u)?[Qf.fromName(a,d),0]:[0,Qf.fromName(a,d)];case vt:var h=t.component.scales[e].get("zero"),p=function(e,t,n){if(t)return 0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(rn.incompatibleChannel("size",e))}(i,h,r),v=function(e,t,n,r){var i={x:fd(n,"x"),y:fd(n,"y")};switch(e){case"bar":case"tick":if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;var a=hd(t,i,r.view);return T(a)?a-1:new Qf(function(){return"".concat(a.signal," - 1")});case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":if(r.scale.maxSize)return r.scale.maxSize;var o=hd(t,i,r.view);return T(o)?Math.pow(dd*o,2):new Qf(function(){return"pow(".concat(dd," * ").concat(o.signal,", 2)")})}throw new Error(rn.incompatibleChannel("size",e))}(i,n,t,r);return nr(u)?function(e,t,n){var r=function(){var r=vo(t)?t.signal:t,i="(".concat(r," - ").concat(e,") / (").concat(n," - 1)");return"sequence(".concat(e,", ").concat(t," + ").concat(i,", ").concat(i,")")};return vo(t)?new Qf(r):{signal:r()}}(p,v,function(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==n&&g(n)?n.length+1:(un(rn.domainRequiredForThresholdScale(r)),3)}}(u,r,s,e)):[p,v];case bt:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case pt:return"symbol";case ft:case dt:case ht:return"ordinal"===u?"nominal"===o?"category":"ordinal":"rect"===i||"geoshape"===i?"heatmap":"ramp";case mt:case gt:case yt:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error("Scale range undefined for channel ".concat(e))}(e,t))}(n,e);r.setWithExplicit("range",i)}})}function fd(e,t){var n=e.fieldDef(t);if(n&&n.bin&&pi(n.bin)){var r=ff(e,n.field,n.bin),i=ld(t),a=e.getName(i);return new Qf(function(){var t=e.getSignalName(r),n="(".concat(t,".stop - ").concat(t,".start) / ").concat(t,".step");return"".concat(e.getSignalName(a)," / (").concat(n,")")})}}var dd=.95;function hd(e,t,n){var r=oa(e.width)?e.width.step:ca(n,"width"),i=oa(e.height)?e.height.step:ca(n,"height");return t.x||t.y?new Qf(function(){var e=[t.x?t.x.signal:r,t.y?t.y.signal:i];return"min(".concat(e.join(", "),")")}):Math.min(r,i)}function pd(e,t){wd(e)?function(e,t){var n=e.component.scales;oe(n).forEach(function(r){var i=e.specifiedScales[r],a=n[r],o=e.getScaleComponent(r),u=e.fieldDef(r),s=e.config,l=i[t],c=o.get("type"),f=or(c,t),d=ur(r,t);if(void 0!==l&&(f?d&&un(d):un(rn.scalePropertyNotWorkWithScaleType(c,t,r))),f&&void 0===d)if(void 0!==l)a.copyKeyFromObject(t,i);else{var h=function(e,t,n,r,i,a,o,u,s,l){var c=l.scale,f=r.type,d=r.sort;switch(e){case"bins":return function(e,t){var n=t.bin;if(pi(n)){var r=ff(e,t.field,n);return new Qf(function(){return e.getSignalName(r)})}if(vi(n)&&mi(n)&&void 0!==n.step)return{step:n.step}}(t,r);case"interpolate":return function(e,t){if(Q([ft,dt,ht],e)&&"nominal"!==t)return"hcl"}(n,f);case"nice":return function(e,t,n){if(!n.bin&&!Q([zn.TIME,zn.UTC],e))return!!Q([rt,it],t)||void 0}(i,n,r);case"padding":return function(e,t,n,r,i,a){if(Q([rt,it],e)){if(tr(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;var o=i.type,u=i.orient;if("bar"===o&&!r.bin&&!r.timeUnit&&("vertical"===u&&"x"===e||"horizontal"===u&&"y"===e))return a.continuousBandSize}if(t===zn.POINT)return n.pointPadding}}(n,i,c,r,s,l.bar);case"paddingInner":return function(e,t,n,r){if(void 0===e&&Q([rt,it],t)){var i=r.bandPaddingInner,a=r.barBandPaddingInner,o=r.rectBandPaddingInner;return ye(i,"bar"===n?a:o)}}(a,n,s.type,c);case"paddingOuter":return function(e,t,n,r,i,a){if(void 0===e)return Q([rt,it],t)&&n===zn.BAND?ye(a.bandPaddingOuter,i/2):void 0}(a,n,i,s.type,o,c);case"reverse":return function(e,t){if(er(e)&&"descending"===t)return!0}(i,d);case"zero":return function(e,t,n,r,i){if(n&&"unaggregated"!==n&&er(i)){if(g(n)){var a=n[0],o=n[n.length-1];if(a<=0&&o>=0)return!0}return!1}if("size"===e&&"quantitative"===t.type&&!nr(i))return!0;if(!t.bin&&Q([rt,it],e)){var u=r.orient;return!Q(["bar","area","line","trail"],r.type)||!("horizontal"===u&&"y"===e||"vertical"===u&&"x"===e)}return!1}(n,r,u,s,i)}return c[e]}(t,e,r,u,o.get("type"),o.get("padding"),o.get("paddingInner"),i.domain,e.markDef,s);void 0!==h&&a.set(t,h,!1)}})}(e,t):md(e,t)}function vd(e){wd(e)?cd(e):md(e,"range")}function md(e,t){var n=e.component.scales,r=!0,i=!1,a=void 0;try{for(var o,u=e.children[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;"range"===t?vd(s):pd(s,t)}}catch(l){i=!0,a=l}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}oe(n).forEach(function(r){var i,a=!0,o=!1,u=void 0;try{for(var s,c=e.children[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var f=s.value.component.scales[r];f&&(i=Ic(i,f.getWithExplicit(t),t,"scale",Pc(function(e,n){switch(t){case"range":return e.step&&n.step?e.step-n.step:0}return 0})))}}catch(l){o=!0,u=l}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}n[r].setWithExplicit(t,i)})}function gd(e,t,n,r){var i=function(e,t,n){switch(t.type){case"nominal":case"ordinal":return St(e)||"discrete"===nn(e)?("shape"===e&&"ordinal"===t.type&&un(rn.discreteChannelCannotEncode(e,"ordinal")),"ordinal"):Q(["x","y"],e)&&Q(["rect","bar","image","rule"],n)?"band":"point";case"temporal":return St(e)?"time":"discrete"===nn(e)?(un(rn.discreteChannelCannotEncode(e,"temporal")),"ordinal"):"time";case"quantitative":return St(e)?pi(t.bin)?"bin-ordinal":"linear":"discrete"===nn(e)?(un(rn.discreteChannelCannotEncode(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(rn.invalidFieldType(t.type))}(t,n,r),a=e.type;return Kt(t)?void 0!==a?lr(t,a)?sr(a,n.type)?a:(un(rn.scaleTypeNotWorkWithFieldDef(a,i)),i):(un(rn.scaleTypeNotWorkWithChannel(t,a,i)),i):i:null}function yd(e){wd(e)?e.component.scales=function(e){var t=e.encoding,n=e.mark;return Qt.reduce(function(r,i){var a,o,u=t[i];if(Lr(u)&&n===Te&&i===pt&&u.type===Wn)return r;if(Lr(u)?(a=u,o=u.scale):Pr(u)&&(a=u.condition,o=u.condition.scale),a&&null!==o&&!1!==o){var s=gd(o=o||{},i,a,n);r[i]=new ud(e.scaleName(i+"",!0),{value:s,explicit:o.type===s})}return r},{})}(e):e.component.scales=function(e){var t=e.component.scales={},n={},r=e.component.resolve,i=!0,a=!1,o=void 0;try{for(var u,s=function(){var t=u.value;yd(t),oe(t.component.scales).forEach(function(i){if(r.scale[i]=r.scale[i]||function(e,t){if(Dd(t)||kd(t))return"shared";if(Ed(t)||Ad(t))return Q(Vt,e)?"independent":"shared";throw new Error("invalid model type for resolve")}(i,e),"shared"===r.scale[i]){var a=n[i],o=t.component.scales[i].getWithExplicit("type");a?function(e,t){var n=Hn[e],r=Hn[t];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}(a.value,o.value)?n[i]=Ic(a,o,"type","scale",bd):(r.scale[i]="independent",delete n[i]):n[i]=o}})},l=e.children[Symbol.iterator]();!(i=(u=l.next()).done);i=!0)s()}catch(D){a=!0,o=D}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}var c=!0,f=!1,d=void 0;try{for(var h,p=oe(n)[Symbol.iterator]();!(c=(h=p.next()).done);c=!0){var v=h.value,m=e.scaleName(v,!0),g=n[v];t[v]=new ud(m,g);var y=!0,b=!1,x=void 0;try{for(var w,k=e.children[Symbol.iterator]();!(y=(w=k.next()).done);y=!0){var A=w.value,E=A.component.scales[v];E&&(A.renameScale(E.get("name"),m),E.merged=!0)}}catch(D){b=!0,x=D}finally{try{y||null==k.return||k.return()}finally{if(b)throw x}}}}catch(D){f=!0,d=D}finally{try{c||null==p.return||p.return()}finally{if(f)throw d}}return t}(e)}var bd=Pc(function(e,t){return $n(e)-$n(t)}),xd=function(){function e(){c(this,e),this.nameMap={}}return f(e,[{key:"rename",value:function(e,t){this.nameMap[e]=t}},{key:"has",value:function(e){return void 0!==this.nameMap[e]}},{key:"get",value:function(e){for(;this.nameMap[e]&&e!==this.nameMap[e];)e=this.nameMap[e];return e}}]),e}();function wd(e){return e&&"unit"===e.type}function kd(e){return e&&"facet"===e.type}function Ad(e){return e&&"repeat"===e.type}function Ed(e){return e&&"concat"===e.type}function Dd(e){return e&&"layer"===e.type}var Cd=function(){function e(t,n,r,i,a,o,u,s){var l=this;c(this,e),this.type=n,this.parent=r,this.config=a,this.repeater=o,this.view=s,this.children=[],this.correctDataNames=function(e){return e.from&&e.from.data&&(e.from.data=l.lookupDataSource(e.from.data)),e.from&&e.from.facet&&e.from.facet.data&&(e.from.facet.data=l.lookupDataSource(e.from.facet.data)),e},this.parent=r,this.config=a,this.repeater=o,this.name=t.name||i,this.title=b(t.title)?{text:t.title}:t.title,this.scaleNameMap=r?r.scaleNameMap:new xd,this.projectionNameMap=r?r.projectionNameMap:new xd,this.signalNameMap=r?r.signalNameMap:new xd,this.data=t.data,this.description=t.description,this.transforms=(t.transform||[]).map(function(e){return Ja(e)?{filter:W(e.filter,Rn)}:e}),this.layout=qe(t)||xa(t)?{}:function(e,t,n){var r=n[t],i={},a=r.spacing,o=r.columns;void 0!==a&&(i.spacing=a),void 0!==o&&(jr(e)&&!Mr(e.facet)||aa(e)&&g(e.repeat)||na(e))&&(i.columns=o);var u=!0,s=!1,l=void 0;try{for(var c,f=ua[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var d=c.value;if(void 0!==e[d])if("spacing"===d){var h=e[d];i[d]=T(h)?h:{row:h.row||a,column:h.column||a}}else i[d]=e[d]}}catch(p){s=!0,l=p}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}return i}(t,n,a),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:jr(t)||r&&r.component.data.isFaceted&&void 0===t.data},layoutSize:new Bc,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},u?V(u):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}return f(e,[{key:"parse",value:function(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}},{key:"parseScale",value:function(){!function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ignoreRange;yd(e),Kf(e);var n=!0,r=!1,i=void 0;try{for(var a,o=ar[Symbol.iterator]();!(n=(a=o.next()).done);n=!0)pd(e,a.value)}catch(u){r=!0,i=u}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}t||vd(e)}(this)}},{key:"parseProjection",value:function(){lf(this)}},{key:"renameTopLevelLayoutSizeSignal",value:function(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}},{key:"parseLegends",value:function(){Zc(this)}},{key:"assembleGroupStyle",value:function(){if("unit"===this.type||"layer"===this.type)return this.view&&this.view.style||"cell"}},{key:"assembleEncodeFromView",value:function(e){var t=He(e,["style"]),n={};for(var r in t)if(M(t,r)){var i=t[r];void 0!==i&&(n[r]={value:i})}return n}},{key:"assembleGroupEncodeEntry",value:function(e){var t=void 0;return this.view&&(t=this.assembleEncodeFromView(this.view)),e||"unit"!==this.type&&"layer"!==this.type?t:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},t||{})}},{key:"assembleLayout",value:function(){if(this.layout){var e=this.layout,t=e.spacing,n=He(e,["spacing"]),r=this.component,i=this.config,a=function(e,t){var n={},r=!0,i=!1,a=void 0;try{for(var o,u=jt[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=e[s];if(l&&l.facetFieldDef){var c=mc(["titleAnchor","titleOrient"],l.facetFieldDef,t,s),f=c.titleAnchor,d=pc(s,c.titleOrient),h=Oc(f,d);void 0!==h&&(n[d]=h)}}}catch(p){i=!0,a=p}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return oe(n).length>0?n:void 0}(r.layoutHeaders,i);return Object.assign(Object.assign(Object.assign({padding:t},this.assembleDefaultLayout()),n),a?{titleBand:a}:{})}}},{key:"assembleDefaultLayout",value:function(){return{}}},{key:"assembleHeaderMarks",value:function(){var e=this.component.layoutHeaders,t=[],n=!0,r=!1,i=void 0;try{for(var a,o=jt[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;e[u].title&&t.push(bc(this,u))}}catch(p){r=!0,i=p}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}var s=!0,l=!1,c=void 0;try{for(var f,d=gc[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var h=f.value;t=t.concat(kc(this,h))}}catch(p){l=!0,c=p}finally{try{s||null==d.return||d.return()}finally{if(l)throw c}}return t}},{key:"assembleAxes",value:function(){return function(e,t){var n=e.x,r=void 0===n?[]:n,i=e.y,a=void 0===i?[]:i;return[].concat(h(r.map(function(e){return ss(e,"grid",t)})),h(a.map(function(e){return ss(e,"grid",t)})),h(r.map(function(e){return ss(e,"main",t)})),h(a.map(function(e){return ss(e,"main",t)}))).filter(function(e){return e})}(this.component.axes,this.config)}},{key:"assembleLegends",value:function(){return rf(this)}},{key:"assembleProjections",value:function(){return af(this)}},{key:"assembleTitle",value:function(){var e=this.title||{},t=e.encoding,n=He(e,["encoding"]),r=Object.assign(Object.assign(Object.assign({},sa(this.config.title).nonMark),n),t?{encode:{update:t}}:{});if(r.text)return Q(["unit","layer"],this.type)?Q(["middle",void 0],r.anchor)&&(r.frame=r.frame||"group"):r.anchor=r.anchor||"start",oe(r).length>0?r:void 0}},{key:"assembleGroup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={};(e=e.concat(this.assembleSignals())).length>0&&(t.signals=e);var n=this.assembleLayout();n&&(t.layout=n),t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());var r=!this.parent||kd(this.parent)?ad(this):[];r.length>0&&(t.scales=r);var i=this.assembleAxes();i.length>0&&(t.axes=i);var a=this.assembleLegends();return a.length>0&&(t.legends=a),t}},{key:"hasDescendantWithFieldOnChannel",value:function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=this.children[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value;if(wd(o)){if(o.channelHasField(e))return!0}else if(o.hasDescendantWithFieldOnChannel(e))return!0}}catch(u){n=!0,r=u}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return!1}},{key:"getName",value:function(e){return le((this.name?this.name+"_":"")+e)}},{key:"requestDataName",value:function(e){var t=this.getName(e),n=this.component.data.outputNodeRefCounts;return n[t]=(n[t]||0)+1,t}},{key:"getSizeSignalRef",value:function(e){if(kd(this.parent)){var t=$t(e),n=this.component.scales[t];if(n&&!n.merged){var r=n.get("type"),i=n.get("range");if(Zn(r)&&mo(i)){var a=n.get("name"),o=rd(id(this,t));return o?{signal:jc(a,n,Gr({aggregate:"distinct",field:o},{expr:"datum"}))}:(un("Unknown field for ".concat(t,". Cannot calculate view size.")),null)}}}return{signal:this.signalNameMap.get(this.getName(e))}}},{key:"lookupDataSource",value:function(e){var t=this.component.data.outputNodes[e];return t?t.getSource():e}},{key:"getSignalName",value:function(e){return this.signalNameMap.get(e)}},{key:"renameSignal",value:function(e,t){this.signalNameMap.rename(e,t)}},{key:"renameScale",value:function(e,t){this.scaleNameMap.rename(e,t)}},{key:"renameProjection",value:function(e,t){this.projectionNameMap.rename(e,t)}},{key:"scaleName",value:function(e,t){return t?this.getName(e):zt(e)&&Kt(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))?this.scaleNameMap.get(this.getName(e)):void 0}},{key:"projectionName",value:function(e){return e?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}},{key:"getScaleComponent",value:function(e){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale().  Make sure you have called parseScale or use parseUnitModelWithScale().");var t=this.component.scales[e];return t&&!t.merged?t:this.parent?this.parent.getScaleComponent(e):void 0}},{key:"getSelectionComponent",value:function(e,t){var n=this.component.selection[e];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(e,t)),!n)throw new Error(rn.selectionNotFound(t));return n}},{key:"width",get:function(){return this.getSizeSignalRef("width")}},{key:"height",get:function(){return this.getSizeSignalRef("height")}}]),e}(),Od=function(e){function t(){return c(this,t),a(this,o(t).apply(this,arguments))}return s(t,Cd),f(t,[{key:"vgField",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.fieldDef(e);if(n)return Gr(n,t)}},{key:"reduceFieldDef",value:function(e,t){return Ei(this.getMapping(),function(t,n,r){var i=ri(n);return i?e(t,i,r):t},t)}},{key:"forEachFieldDef",value:function(e,t){Ai(this.getMapping(),function(t,n){var r=ri(t);r&&e(r,n)},t)}}]),t}(),Fd=function(e){function t(e,n){var r;c(this,t),(r=a(this,o(t).call(this,e))).transform=n,r.transform=V(n);var i=r.transform.as||[void 0,void 0];return r.transform.as=[i[0]||"value",i[1]||"density"],r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,V(this.transform))}},{key:"dependentFields",value:function(){return new Set([this.transform.density].concat(h(this.transform.groupby||[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"DensityTransform ".concat(X(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.density,n=He(e,["density"]);return Object.assign({type:"kde",field:t},n)}}]),t}(),_d=function(e){function t(e,n){var r;return c(this,t),(r=a(this,o(t).call(this,e))).filter=n,r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,Object.assign({},this.filter))}},{key:"dependentFields",value:function(){return new Set(oe(this.filter))}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return"FilterInvalid ".concat(X(this.filter))}},{key:"assemble",value:function(){var e=this,t=oe(this.filter).reduce(function(t,n){var r=e.filter[n],i=Gr(r,{expr:"datum"});return null!==r&&("temporal"===r.type?t.push("(isDate(".concat(i,") || (isValid(").concat(i,") && isFinite(+").concat(i,")))")):"quantitative"===r.type&&(t.push("isValid(".concat(i,")")),t.push("isFinite(+".concat(i,")")))),t},[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}],[{key:"make",value:function(e,n){var r=n.config,i=n.mark;if("filter"!==dr("invalid",n.markDef,r))return null;var a=n.reduceFieldDef(function(e,t,r){var a=Kt(r)&&n.getScaleComponent(r);return a&&(!er(a.get("type"))||t.aggregate||Ne(i)||(e[t.field]=t)),e},{});return oe(a).length?new t(e,a):null}}]),t}(),Sd=function(e){function t(e,n){var r;c(this,t),(r=a(this,o(t).call(this,e))).transform=n,r.transform=V(n);var i=r.transform,u=i.flatten,s=i.as,l=void 0===s?[]:s;return r.transform.as=u.map(function(e,t){return l[t]||e}),r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(this.parent,V(this.transform))}},{key:"dependentFields",value:function(){return new Set(this.transform.flatten)}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"FlattenTransform ".concat(X(this.transform))}},{key:"assemble",value:function(){var e=this.transform;return{type:"flatten",fields:e.flatten,as:e.as}}}]),t}(),Md=function(e){function t(e,n){var r;c(this,t),(r=a(this,o(t).call(this,e))).transform=n,r.transform=V(n);var i=r.transform.as||[void 0,void 0];return r.transform.as=[i[0]||"key",i[1]||"value"],r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,V(this.transform))}},{key:"dependentFields",value:function(){return new Set(this.transform.fold)}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"FoldTransform ".concat(X(this.transform))}},{key:"assemble",value:function(){var e=this.transform;return{type:"fold",fields:e.fold,as:e.as}}}]),t}(),jd=function(e){function t(e,n,r,i){var u;return c(this,t),(u=a(this,o(t).call(this,e))).fields=n,u.geojson=r,u.signal=i,u}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,V(this.fields),this.geojson,this.signal)}},{key:"dependentFields",value:function(){return new Set([].concat(h(this.geojson?[this.geojson]:[]),h((this.fields||[]).filter(b))))}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return"GeoJSON ".concat(this.geojson," ").concat(this.signal," ").concat(X(this.fields))}},{key:"assemble",value:function(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}],[{key:"parseAll",value:function(e,n){if(n.component.projection&&!n.component.projection.isFit)return e;var r=0;if([[st,ut],[ct,lt]].forEach(function(i){var a=i.map(function(e){return n.channelHasField(e)?n.fieldDef(e).field:qr(n.encoding[e])?{expr:n.encoding[e].value+""}:void 0});(a[0]||a[1])&&(e=new t(e,a,null,n.getName("geojson_".concat(r++))))}),n.channelHasField(pt)){var i=n.fieldDef(pt);i.type===Wn&&(e=new t(e,null,i.field,n.getName("geojson_".concat(r++))))}return e}}]),t}(),Td=function(e){function t(e,n,r,i){var u;return c(this,t),(u=a(this,o(t).call(this,e))).projection=n,u.fields=r,u.as=i,u}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,this.projection,V(this.fields),V(this.as))}},{key:"dependentFields",value:function(){return new Set(this.fields.filter(b))}},{key:"producedFields",value:function(){return new Set(this.as)}},{key:"hash",value:function(){return"Geopoint ".concat(this.projection," ").concat(X(this.fields)," ").concat(X(this.as))}},{key:"assemble",value:function(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}],[{key:"parseAll",value:function(e,n){return n.projectionName()?([[st,ut],[ct,lt]].forEach(function(r){var i=r.map(function(e){return n.channelHasField(e)?n.fieldDef(e).field:qr(n.encoding[e])?{expr:n.encoding[e].value+""}:void 0}),a=r[0]===ct?"2":"";(i[0]||i[1])&&(e=new t(e,n.projectionName(),i,[n.getName("x"+a),n.getName("y"+a)]))}),e):e}}]),t}(),Nd=function(e){function t(e){return c(this,t),a(this,o(t).call(this,e))}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null)}}]),f(t,[{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set([ea])}},{key:"hash",value:function(){return"Identifier"}},{key:"assemble",value:function(){return{type:"identifier",as:ea}}}]),t}(),Bd=function(e){function t(e,n){var r;return c(this,t),(r=a(this,o(t).call(this,e))).transform=n,r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,V(this.transform))}},{key:"dependentFields",value:function(){return new Set([this.transform.impute,this.transform.key].concat(h(this.transform.groupby||[])))}},{key:"producedFields",value:function(){return new Set([this.transform.impute])}},{key:"processSequence",value:function(e){var t=e.start,n=void 0===t?0:t,r=e.stop,i=e.step,a=[n,r].concat(h(i?[i]:[])).join(",");return{signal:"sequence(".concat(a,")")}}},{key:"hash",value:function(){return"Impute ".concat(X(this.transform))}},{key:"assemble",value:function(){var e,t,n=this.transform,r=n.impute,i=n.key,a=n.keyvals,o=n.method,u=n.groupby,s=n.value,l=n.frame,c=void 0===l?[null,null]:l,f=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:r,key:i},a?{keyvals:(e=a,e&&void 0!==e.stop?this.processSequence(a):a)}:{}),{method:"value"}),u?{groupby:u}:{}),{value:null});return t=o&&"value"!==o?[Object.assign({type:"window",as:["imputed_".concat(r,"_value")],ops:[o],fields:[r],frame:c,ignorePeers:!1},u?{groupby:u}:{}),{type:"formula",expr:"datum.".concat(r," === null ? datum.imputed_").concat(r,"_value : datum.").concat(r),as:r}]:[{type:"formula",expr:"datum.".concat(r," === null ? ").concat(s," : datum.").concat(r),as:r}],[f].concat(h(t))}}],[{key:"makeFromTransform",value:function(e,n){return new t(e,n)}},{key:"makeFromEncoding",value:function(e,n){var r=n.encoding,i=r.x,a=r.y;if(Lr(i)&&Lr(a)){var o=i.impute?i:a.impute?a:void 0;if(void 0===o)return;var u=i.impute?a:a.impute?i:void 0,s=o.impute,l=s.method,c=s.value,f=s.frame,d=s.keyvals,h=Di(n.mark,r);return new t(e,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:u.field},l?{method:l}:{}),void 0!==c?{value:c}:{}),f?{frame:f}:{}),void 0!==d?{keyvals:d}:{}),h.length?{groupby:h}:{}))}return null}}]),t}(),Rd=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return c(this,t),(e=a(this,o(t).call(this,n,r))).explicit=n,e.implicit=r,e.parseNothing=i,e}return s(t,Bc),f(t,[{key:"clone",value:function(){var e=u(o(t.prototype),"clone",this).call(this);return e.parseNothing=this.parseNothing,e}}]),t}(),zd=function(e){function t(e,n){var r;c(this,t),(r=a(this,o(t).call(this,e))).transform=n,r.transform=V(n);var i=r.transform.as||[void 0,void 0];return r.transform.as=[i[0]||n.on,i[1]||n.loess],r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,V(this.transform))}},{key:"dependentFields",value:function(){return new Set([this.transform.loess,this.transform.on].concat(h(this.transform.groupby||[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"LoessTransform ".concat(X(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.loess,n=e.on,r=He(e,["loess","on"]);return Object.assign({type:"loess",x:n,y:t},r)}}]),t}(),Pd=function(e){function t(e,n,r){var i;return c(this,t),(i=a(this,o(t).call(this,e))).transform=n,i.secondary=r,i}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,V(this.transform),this.secondary)}},{key:"dependentFields",value:function(){return new Set([this.transform.lookup])}},{key:"producedFields",value:function(){return new Set(this.transform.as?_(this.transform.as):this.transform.from.fields)}},{key:"hash",value:function(){return"Lookup ".concat(X({transform:this.transform,secondary:this.secondary}))}},{key:"assemble",value:function(){var e;if(this.transform.from.fields)e=Object.assign({values:this.transform.from.fields},this.transform.as?{as:_(this.transform.as)}:{});else{var t=this.transform.as;b(t)||(un(rn.NO_FIELDS_NEEDS_AS),t="_lookup"),e={as:[t]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},e),this.transform.default?{default:this.transform.default}:{})}}],[{key:"make",value:function(e,n,r,i){var a=n.component.data.sources,o=oh(r.from.data,a);o||(o=new pf(r.from.data),a.push(o));var u=n.getName("lookup_".concat(i)),s=new xu(o,u,"lookup",n.component.data.outputNodeRefCounts);return n.component.data.outputNodes[u]=s,new t(e,r,s.getSource())}}]),t}(),Ld=function(e){function t(e,n){var r;c(this,t),(r=a(this,o(t).call(this,e))).transform=n,r.transform=V(n);var i=r.transform.as||[void 0,void 0];return r.transform.as=[i[0]||"prob",i[1]||"value"],r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,V(this.transform))}},{key:"dependentFields",value:function(){return new Set([this.transform.quantile].concat(h(this.transform.groupby||[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"QuantileTransform ".concat(X(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.quantile,n=He(e,["quantile"]);return Object.assign({type:"quantile",field:t},n)}}]),t}(),Id=function(e){function t(e,n){var r;c(this,t),(r=a(this,o(t).call(this,e))).transform=n,r.transform=V(n);var i=r.transform.as||[void 0,void 0];return r.transform.as=[i[0]||n.on,i[1]||n.regression],r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,V(this.transform))}},{key:"dependentFields",value:function(){return new Set([this.transform.regression,this.transform.on].concat(h(this.transform.groupby||[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"RegressionTransform ".concat(X(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.regression,n=e.on,r=He(e,["regression","on"]);return Object.assign({type:"regression",x:n,y:t},r)}}]),t}(),Ud=function(e){function t(e,n){var r;return c(this,t),(r=a(this,o(t).call(this,e))).transform=n,r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,V(this.transform))}},{key:"addDimensions",value:function(e){this.transform.groupby=ne((this.transform.groupby||[]).concat(e),function(e){return e})}},{key:"producedFields",value:function(){}},{key:"dependentFields",value:function(){return new Set([this.transform.pivot,this.transform.value].concat(h(this.transform.groupby||[])))}},{key:"hash",value:function(){return"PivotTransform ".concat(X(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.pivot,n=e.value,r=e.groupby,i=e.limit,a=e.op;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},void 0!==i?{limit:i}:{}),void 0!==a?{op:a}:{}),void 0!==r?{groupby:r}:{})}}]),t}(),qd=function(e){function t(e,n){var r;return c(this,t),(r=a(this,o(t).call(this,e))).transform=n,r}return s(t,bu),f(t,[{key:"clone",value:function(){return new t(null,V(this.transform))}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return"SampleTransform ".concat(X(this.transform))}},{key:"assemble",value:function(){return{type:"sample",size:this.transform.sample}}}]),t}();function Wd(e){var t=0;return function n(r,i){var a,o,u;if(r instanceof pf&&(r.isGenerator||Ua(r.data)||(e.push(i),i={name:null,source:i.name,transform:[]})),r instanceof Sf&&(r.parent instanceof pf&&!i.source?(i.format=Object.assign(Object.assign({},i.format||{}),{parse:r.assembleFormatParse()}),(a=i.transform).push.apply(a,h(r.assembleTransforms(!0)))):(o=i.transform).push.apply(o,h(r.assembleTransforms()))),r instanceof Ef)return i.name||(i.name="data_".concat(t++)),!i.source||i.transform.length>0?(e.push(i),r.data=i.name):r.data=i.source,void r.assemble().forEach(function(t){return e.push(t)});switch((r instanceof mf||r instanceof gf||r instanceof _d||r instanceof Df||r instanceof dc||r instanceof Td||r instanceof jd||r instanceof Af||r instanceof Pd||r instanceof Tf||r instanceof Mf||r instanceof Md||r instanceof Sd||r instanceof Fd||r instanceof zd||r instanceof Ld||r instanceof Id||r instanceof Nd||r instanceof qd||r instanceof Ud)&&i.transform.push(r.assemble()),(r instanceof hf||r instanceof wu||r instanceof Bd||r instanceof jf)&&(u=i.transform).push.apply(u,h(r.assemble())),r instanceof xu&&(i.source&&0===i.transform.length?r.setSource(i.source):r.parent instanceof xu?r.setSource(i.name):(i.name||(i.name="data_".concat(t++)),r.setSource(i.name),1===r.numChildren()&&(e.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof xu&&(!i.source||i.transform.length>0)&&e.push(i);break;case 1:n(r.children[0],i);break;default:i.name||(i.name="data_".concat(t++));var s=i.name;!i.source||i.transform.length>0?e.push(i):s=i.source,r.children.forEach(function(e){n(e,{name:null,source:s,transform:[]})})}}}function Hd(e){return"top"===e||"left"===e?"header":"footer"}function Vd(e,t){if(e.channelHasField(t)){var n=e.facet[t],r=vc("title",null,e.config,t),i=Zr(n,e.config,{allowDisabling:!0,includeDefault:void 0===r||!!r});e.child.component.layoutHeaders[t].title&&(i+=" / "+e.child.component.layoutHeaders[t].title,e.child.component.layoutHeaders[t].title=null);var a=vc("labelOrient",n,e.config,t),o=ye((n.header||{}).labels,!0),u=Q(["bottom","right"],a)?"footer":"header";e.component.layoutHeaders[t]=l({title:i,facetFieldDef:n},u,"facet"===t?[]:[Gd(e,t,o)])}}function Gd(e,t,n){var r="row"===t?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function $d(e,t){var n=e.child;if(n.component.axes[t]){var r=e.component,i=r.layoutHeaders,a=r.resolve;if(a.axis[t]=Nc(a,t),"shared"===a.axis[t]){var o="x"===t?"column":"row",u=i[o],s=!0,l=!1,c=void 0;try{for(var f,d=n.component.axes[t][Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var h=f.value,p=Hd(h.get("orient"));u[p]=u[p]||[Gd(e,o,!1)];var v=ss(h,"main",e.config,{header:!0});u[p][0].axes.push(v),h.mainExtracted=!0}}catch(m){l=!0,c=m}finally{try{s||null==d.return||d.return()}finally{if(l)throw c}}}}}function Yd(e){Qd(e);var t=e.component.layoutSize;t.setWithExplicit("width",Kd(e,"width")),t.setWithExplicit("height",Kd(e,"height"))}var Xd=Yd,Jd={vconcat:"width",hconcat:"height"};function Qd(e){var t=!0,n=!1,r=void 0;try{for(var i,a=e.children[Symbol.iterator]();!(t=(i=a.next()).done);t=!0)i.value.parseLayoutSize()}catch(o){n=!0,r=o}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}}function Kd(e,t){var n,r="width"===t?"x":"y",i=e.component.resolve,a=!0,o=!1,u=void 0;try{for(var s,l=e.children[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value.component.layoutSize.getWithExplicit(t),f=i.scale[r];if("independent"===f&&"step"===c.value){n=void 0;break}if(n){if("independent"===f&&n.value!==c.value){n=void 0;break}n=Ic(n,c,t,"")}else n=c}}catch(y){o=!0,u=y}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}if(n){var d=!0,h=!1,p=void 0;try{for(var v,m=e.children[Symbol.iterator]();!(d=(v=m.next()).done);d=!0){var g=v.value;e.renameSignal(g.getName(t),e.getName(t)),g.component.layoutSize.set(t,"merged",!1)}}catch(y){h=!0,p=y}finally{try{d||null==m.return||m.return()}finally{if(h)throw p}}return n}return{explicit:!1,value:void 0}}function Zd(e,t){var n="width"===t?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){var a=i.get("type"),o=i.get("range");if(Zn(a)){var u=fa(r.view,t);return mo(o)||oa(u)?"step":u}return la(r.view,t)}if(e.hasProjection)return la(r.view,t);var s=fa(r.view,t);return oa(s)?s.step:s}function eh(e,t){return function(e){return e&&!b(e)&&"repeat"in e}(e.field)?e.field.repeat in t?Object.assign(Object.assign({},e),{field:t[e.field.repeat]}):void un(rn.noSuchRepeatedValue(e.field.repeat)):e}function th(e,t){if(void 0!==(e=eh(e,t))){if(null===e)return null;if(Nr(e)&&_r(e.sort)){var n=eh(e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function nh(e,t){if(!Lr(e)){if(Pr(e)){var n=th(e.condition,t);return n?Object.assign(Object.assign({},e),{condition:n}):He(e,["condition"])}return e}var r=th(e,t);return r||(zr(e)?{condition:e.condition}:void 0)}function rh(e,t){var n={};for(var r in e)if(M(e,r)){var i=e[r];if(g(i))n[r]=i.map(function(e){return nh(e,t)}).filter(function(e){return e});else{var a=nh(i,t);void 0!==a&&(n[r]=a)}}return n}function ih(e,t,n){return Gr(t,Object.assign({suffix:"by_".concat(Gr(e))},n||{}))}var ah=function(e){function t(e,n,i,u,s){var l;c(this,t),(l=a(this,o(t).call(this,e,"facet",n,i,s,u,e.resolve))).child=Sh(e.spec,r(l),l.getName("child"),void 0,u,s),l.children=[l.child];var f=function(e,t){return Mr(e)?rh(e,t):th(e,t)}(e.facet,u);return l.facet=l.initFacet(f),l}return s(t,Od),f(t,[{key:"initFacet",value:function(e){return Mr(e)?Ei(e,function(e,t,n){return Q([et,tt],n)?void 0===t.field?(un(rn.emptyFieldDef(t,n)),e):(e[n]=ai(t,n),e):(un(rn.incompatibleChannel(n,"facet")),e)},{}):{facet:ai(e,"facet")}}},{key:"channelHasField",value:function(e){return!!this.facet[e]}},{key:"fieldDef",value:function(e){return this.facet[e]}},{key:"parseData",value:function(){this.component.data=uh(this),this.child.parseData()}},{key:"parseLayoutSize",value:function(){Qd(this)}},{key:"parseSelections",value:function(){this.child.parseSelections(),this.component.selection=this.child.component.selection}},{key:"parseMarkGroup",value:function(){this.child.parseMarkGroup()}},{key:"parseAxesAndHeaders",value:function(){this.child.parseAxesAndHeaders(),function(e){var t=!0,n=!1,r=void 0;try{for(var i,a=jt[Symbol.iterator]();!(t=(i=a.next()).done);t=!0)Vd(e,i.value)}catch(o){n=!0,r=o}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}$d(e,"x"),$d(e,"y")}(this)}},{key:"assembleSelectionTopLevelSignals",value:function(e){return this.child.assembleSelectionTopLevelSignals(e)}},{key:"assembleSignals",value:function(){return this.child.assembleSignals(),[]}},{key:"assembleSelectionData",value:function(e){return this.child.assembleSelectionData(e)}},{key:"getHeaderLayoutMixins",value:function(){var e={},t=!0,n=!1,r=void 0;try{for(var i,a=jt[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var o=i.value,u=!0,s=!1,l=void 0;try{for(var c,f=yc[Symbol.iterator]();!(u=(c=f.next()).done);u=!0){var d=c.value,h=this.component.layoutHeaders[o],p=h[d],v=h.facetFieldDef;if(v){var m=vc("titleOrient",v,this.config,o);if(Q(["right","bottom"],m)){var g=pc(o,m);e.titleAnchor=e.titleAnchor||{},e.titleAnchor[g]="end"}}if(p&&p[0]){var y="row"===o?"height":"width",b="header"===d?"headerBand":"footerBand";"facet"===o||this.child.component.layoutSize.get(y)||(e[b]=e[b]||{},e[b][o]=.5),h.title&&(e.offset=e.offset||{},e.offset["row"===o?"rowTitle":"columnTitle"]=10)}}}catch(x){s=!0,l=x}finally{try{u||null==f.return||f.return()}finally{if(s)throw l}}}}catch(x){n=!0,r=x}finally{try{t||null==a.return||a.return()}finally{if(n)throw r}}return e}},{key:"assembleDefaultLayout",value:function(){var e=this.facet,t=e.column,n=e.row,r=t?this.columnDistinctSignal():n?1:void 0,i="all";return(n||"independent"!==this.component.resolve.scale.x)&&(t||"independent"!==this.component.resolve.scale.y)||(i="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:i})}},{key:"assembleLayoutSignals",value:function(){return this.child.assembleLayoutSignals()}},{key:"columnDistinctSignal",value:function(){if(!(this.parent&&this.parent instanceof t)){var e=this.getName("column_domain");return{signal:"length(data('".concat(e,"'))")}}}},{key:"assembleGroup",value:function(e){return this.parent&&this.parent instanceof t?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:Gr(this.facet.column,{prefix:"distinct"})}}}}:{}),u(o(t.prototype),"assembleGroup",this).call(this,e)):u(o(t.prototype),"assembleGroup",this).call(this,e)}},{key:"getCardinalityAggregateForChild",value:function(){var e=[],n=[],r=[];if(this.child instanceof t){if(this.child.channelHasField("column")){var i=Gr(this.child.facet.column);e.push(i),n.push("distinct"),r.push("distinct_".concat(i))}}else for(var a=0,o=["x","y"];a<o.length;a++){var u=o[a],s=this.child.component.scales[u];if(s&&!s.merged){var l=s.get("type"),c=s.get("range");if(Zn(l)&&mo(c)){var f=rd(id(this.child,u));f?(e.push(f),n.push("distinct"),r.push("distinct_".concat(f))):un("Unknown field for ".concat(u,". Cannot calculate view size."))}}}return{fields:e,ops:n,as:r}}},{key:"assembleFacet",value:function(){var e=this.component.data.facetRoot,t=e.name,n=e.data,r=this.facet,i=r.row,a=r.column,o=this.getCardinalityAggregateForChild(),u=o.fields,s=o.ops,l=o.as,c=[],f=!0,d=!1,h=void 0;try{for(var p,v=jt[Symbol.iterator]();!(f=(p=v.next()).done);f=!0){var m=p.value,y=this.facet[m];if(y){c.push(Gr(y));var b=y.bin,x=y.sort;if(pi(b)&&c.push(Gr(y,{binSuffix:"end"})),_r(x)){var w=x.field,k=x.op,A=void 0===k?Dr:k,E=ih(y,x);i&&a?(u.push(E),s.push("max"),l.push(E)):(u.push(w),s.push(A),l.push(E))}else if(g(x)){var D=hc(y,m);u.push(D),s.push("max"),l.push(D)}}}}catch(O){d=!0,h=O}finally{try{f||null==v.return||v.return()}finally{if(d)throw h}}var C=!!i&&!!a;return Object.assign({name:t,data:n,groupby:c},C||u.length?{aggregate:Object.assign(Object.assign({},C?{cross:C}:{}),u.length?{fields:u,ops:s,as:l}:{})}:{})}},{key:"facetSortFields",value:function(e){var t=this.facet[e];return t?_r(t.sort)?[ih(t,t.sort,{expr:"datum"})]:g(t.sort)?[hc(t,e,{expr:"datum"})]:[Gr(t,{expr:"datum"})]:[]}},{key:"facetSortOrder",value:function(e){var t=this.facet[e];if(t){var n=t.sort;return[(_r(n)?n.order:!g(n)&&n)||"ascending"]}return[]}},{key:"assembleLabelTitle",value:function(){var e=this.facet,t=this.config;if(e.facet)return Ec(e.facet,"facet",t);var n={row:["top","bottom"],column:["left","right"]},r=!0,i=!1,a=void 0;try{for(var o,u=gc[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;if(e[s]){var l=vc("labelOrient",e[s],t,s);if(Q(n[s],l))return Ec(e[s],s,t)}}}catch(c){i=!0,a=c}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}},{key:"assembleMarks",value:function(){var e=this,t=this.child,n=function(e){var t=[],n=Wd(t);return e.children.forEach(function(t){return n(t,{source:e.name,name:null,transform:[]})}),t}(this.component.data.facetRoot),r=t.assembleGroupEncodeEntry(!1),i=this.assembleLabelTitle()||t.assembleTitle(),a=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},i?{title:i}:{}),a?{style:a}:{}),{from:{facet:this.assembleFacet()},sort:{field:jt.map(function(t){return e.facetSortFields(t)}).flat(),order:jt.map(function(t){return e.facetSortOrder(t)}).flat()}}),n.length>0?{data:n}:{}),r?{encode:{update:r}}:{}),t.assembleGroup(function(e,t){if(e.component.selection&&oe(e.component.selection).length){var n=x(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:Eo("mousemove","scope"),update:"isTuple(facet) ? facet : group(".concat(n,").datum")}]})}return qu(t)}(this,[])))]}},{key:"getMapping",value:function(){return this.facet}}]),t}();function oh(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value,s=u.data;if((!e.name||!u.hasName()||e.name===u.dataName)&&!(e.format&&e.format.mesh&&s.format&&s.format.feature))if(qa(e)&&qa(s)){if(H(e.values,s.values))return u}else if(Ua(e)&&Ua(s)){if(e.url===s.url)return u}else if(Wa(e)&&e.name===u.dataName)return u}}catch(l){r=!0,i=l}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return null}function uh(e){var t=function(e,t){if(void 0===e.data&&e.parent)return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main;if(null===e.data){var n=new pf([]);return t.push(n),n}var r=oh(e.data,t);if(r)return Ha(e.data)||(r.data.format=ee({},e.data.format,r.data.format)),!r.hasName()&&e.data.name&&(r.dataName=e.data.name),r;var i=new pf(e.data);return t.push(i),i}(e,e.component.data.sources),n=e.component.data,r=n.outputNodes,i=n.outputNodeRefCounts,a=e.parent?e.parent.component.data.ancestorParse.clone():new Rd,o=e.data;Ha(o)?(Va(o)?t=new gf(t,o.sequence):$a(o)&&(t=new mf(t,o.graticule)),a.parseNothing=!0):o&&o.format&&null===o.format.parse&&(a.parseNothing=!0),t=Sf.makeExplicit(t,e,a)||t,!is(e)||!wd(e)&&!Dd(e)||e.parent&&Dd(e.parent)||(t=new Nd(t));var u=e.parent&&Dd(e.parent);(wd(e)||kd(e))&&u&&(t=hf.makeFromEncoding(t,e)||t),e.transforms.length>0&&(t=function(e,t,n){var r=0,i=!0,a=!1,o=void 0;try{for(var u,s=t.transforms[Symbol.iterator]();!(i=(u=s.next()).done);i=!0){var c=u.value,f=void 0,d=void 0;if(uo(c))d=e=new dc(e,c),f="derived";else if(Ja(c)){var h=Ff(c);d=e=Sf.makeWithAncestors(e,{},h,n)||e,e=new Df(e,t,c.filter)}else if(so(c))d=e=hf.makeFromTransform(e,c,t),f="number";else if(co(c))f="date",void 0===n.getWithExplicit(c.field).value&&(e=new Sf(e,l({},c.field,f)),n.set(c.field,f,!1)),d=e=wu.makeFromTransform(e,c);else if(fo(c))d=e=Af.makeFromTransform(e,c),f="number",is(t)&&(e=new Nd(e));else if(no(c))d=e=Pd.make(e,t,c,r++),f="derived";else if(io(c))d=e=new Tf(e,c),f="number";else if(ao(c))d=e=new Mf(e,c),f="number";else if(ho(c))d=e=jf.makeFromTransform(e,c),f="derived";else if(po(c))d=e=new Md(e,c),f="derived";else if(oo(c))d=e=new Sd(e,c),f="derived";else if(Qa(c))d=e=new Ud(e,c),f="derived";else if(ro(c))e=new qd(e,c);else if(lo(c))d=e=Bd.makeFromTransform(e,c),f="derived";else if(Ka(c))d=e=new Fd(e,c),f="derived";else if(Za(c))d=e=new Ld(e,c),f="derived";else if(eo(c))d=e=new Id(e,c),f="derived";else{if(!to(c)){un(rn.invalidTransformIgnored(c));continue}d=e=new zd(e,c),f="derived"}if(d&&void 0!==f){var p=!0,v=!1,m=void 0;try{for(var g,y=(d.producedFields()||[])[Symbol.iterator]();!(p=(g=y.next()).done);p=!0){var b=g.value;n.set(b,f,!1)}}catch(x){v=!0,m=x}finally{try{p||null==y.return||y.return()}finally{if(v)throw m}}}}}catch(x){a=!0,o=x}finally{try{i||null==s.return||s.return()}finally{if(a)throw o}}return e}(t,e,a));var s=function(e){var t={};if(wd(e)&&e.component.selection){var n=!0,r=!1,i=void 0;try{for(var a,o=oe(e.component.selection)[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value,s=e.component.selection[u],l=!0,c=!1,f=void 0;try{for(var d,h=s.project.items[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var p=d.value;!p.channel&&ge(p.field)>1&&(t[p.field]="flatten")}}catch(v){c=!0,f=v}finally{try{l||null==h.return||h.return()}finally{if(c)throw f}}}}catch(v){r=!0,i=v}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}return t}(e),c=_f(e);t=Sf.makeWithAncestors(t,{},Object.assign(Object.assign({},s),c),a)||t,wd(e)&&(t=jd.parseAll(t,e),t=Td.parseAll(t,e)),(wd(e)||kd(e))&&(u||(t=hf.makeFromEncoding(t,e)||t),t=wu.makeFromEncoding(t,e)||t,t=dc.parseAllForSortIndex(t,e));var f=e.getName(Xa),d=new xu(t,f,Xa,i);if(r[f]=d,t=d,wd(e)){var h=Af.makeFromEncoding(t,e);h&&(t=h,is(e)&&(t=new Nd(t))),t=Bd.makeFromEncoding(t,e)||t,t=jf.makeFromEncoding(t,e)||t}wd(e)&&(t=_d.make(t,e)||t);var p=e.getName(Ya),v=new xu(t,p,Ya,i);r[p]=v,t=v;var m=null;if(kd(e)){var g=e.getName("facet");t=function(e,t){var n=t.row,r=t.column;if(n&&r){for(var i=null,a=0,o=[n,r];a<o.length;a++){var u=o[a];if(_r(u.sort)){var s=u.sort,l=s.field,c=s.op;e=i=new Mf(e,{joinaggregate:[{op:void 0===c?Dr:c,field:l,as:ih(u,u.sort,{forAs:!0})}],groupby:[Gr(u)]})}}return i}return null}(t=dc.parseAllForSortIndex(t,e),e.facet)||t,m=new Ef(t,e,g,v.getSource()),r[g]=m,t=m}return Object.assign(Object.assign({},e.component.data),{outputNodes:r,outputNodeRefCounts:i,raw:d,main:v,facetRoot:m,ancestorParse:a})}var sh=function(e){function t(e,n,r,i,u,s,l){return c(this,t),a(this,o(t).call(this,e,n,r,i,u,s,l))}return s(t,Cd),f(t,[{key:"parseData",value:function(){this.component.data=uh(this),this.children.forEach(function(e){e.parseData()})}},{key:"parseSelections",value:function(){var e=this;this.component.selection={};var t=!0,n=!1,r=void 0;try{for(var i,a=function(){var t=i.value;t.parseSelections(),oe(t.component.selection).forEach(function(n){e.component.selection[n]=t.component.selection[n]})},o=this.children[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)a()}catch(u){n=!0,r=u}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"parseMarkGroup",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.children[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)r.value.parseMarkGroup()}catch(a){t=!0,n=a}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"parseAxesAndHeaders",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.children[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)r.value.parseAxesAndHeaders()}catch(a){t=!0,n=a}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"assembleSelectionTopLevelSignals",value:function(e){return this.children.reduce(function(e,t){return t.assembleSelectionTopLevelSignals(e)},e)}},{key:"assembleSignals",value:function(){return this.children.forEach(function(e){return e.assembleSignals()}),[]}},{key:"assembleLayoutSignals",value:function(){return this.children.reduce(function(e,t){return[].concat(h(e),h(t.assembleLayoutSignals()))},_c(this))}},{key:"assembleSelectionData",value:function(e){return this.children.reduce(function(e,t){return t.assembleSelectionData(e)},e)}},{key:"assembleMarks",value:function(){return this.children.map(function(e){var t=e.assembleTitle(),n=e.assembleGroupStyle(),r=e.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:e.getName("group")},t?{title:t}:{}),n?{style:n}:{}),r?{encode:{update:r}}:{}),e.assembleGroup())})}}]),t}(),lh=function(e){function t(e,n,i,u,s){var l;return c(this,t),l=a(this,o(t).call(this,e,"concat",n,i,s,u,e.resolve)),e.resolve&&e.resolve.axis&&("shared"===e.resolve.axis.x||"shared"===e.resolve.axis.y)&&un(rn.CONCAT_CANNOT_SHARE_AXIS),l.concatType=ra(e)?"vconcat":ia(e)?"hconcat":"concat",l.children=l.getChildren(e).map(function(e,t){return Sh(e,r(l),l.getName("concat_"+t),void 0,u,s)}),l}return s(t,sh),f(t,[{key:"getChildren",value:function(e){return ra(e)?e.vconcat:ia(e)?e.hconcat:e.concat}},{key:"parseLayoutSize",value:function(){!function(e){Qd(e);var t=e.component.layoutSize,n=Jd[e.concatType];n&&t.setWithExplicit(n,Kd(e,n))}(this)}},{key:"parseAxisGroup",value:function(){return null}},{key:"assembleDefaultLayout",value:function(){return Object.assign(Object.assign({},"vconcat"===this.concatType?{columns:1}:{}),{bounds:"full",align:"each"})}}]),t}(),ch=Object.assign(Object.assign({gridScale:1,scale:1},ko),{labelExpr:1,encode:1}),fh=oe(ch),dh=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return c(this,t),(e=a(this,o(t).call(this))).explicit=n,e.implicit=r,e.mainExtracted=i,e}return s(t,Bc),f(t,[{key:"clone",value:function(){return new t(V(this.explicit),V(this.implicit),this.mainExtracted)}},{key:"hasAxisPart",value:function(e){return"axis"===e||("grid"===e||"title"===e?!!this.get(e):!(!1===(t=this.get(e))||null===t));var t}}]),t}(),hh={bottom:"top",top:"bottom",left:"right",right:"left"};function ph(e,t){if(!e)return t.map(function(e){return e.clone()});if(e.length===t.length){for(var n=e.length,r=0;r<n;r++){var i=e[r],a=t[r];if(!!i!==!!a)return;if(i&&a){var o=i.getWithExplicit("orient"),u=a.getWithExplicit("orient");if(o.explicit&&u.explicit&&o.value!==u.value)return;e[r]=vh(i,a)}}return e}}function vh(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=function(){var n=a.value,r=Ic(e.getWithExplicit(n),t.getWithExplicit(n),n,"axis",function(e,t){switch(n){case"title":return Er(e,t);case"gridScale":return{explicit:e.explicit,value:ye(e.value,t.value)}}return Lc(e,t,n,"axis")});e.setWithExplicit(n,r)},u=fh[Symbol.iterator]();!(n=(a=u.next()).done);n=!0)o()}catch(s){r=!0,i=s}finally{try{n||null==u.return||u.return()}finally{if(r)throw i}}return e}function mh(e,t){var n="x"===t?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),a=r?r.title:void 0,o=i?i.title:void 0;return a&&o?Ar(a,o):a||o||(void 0!==a?a:void 0!==o?o:void 0)}function gh(e,t){var n=t.axis(e),r=new dh;fh.forEach(function(i){var a=function(e,t,n,r){var i=r.fieldDef(n),a=function(e,t,n,r){if(void 0!==t.labelAngle)return xe(t.labelAngle);var i=ps("labelAngle",e.config,n,gs(n),e.getScaleComponent(n).get("type"));return void 0!==i?xe(i):n===rt&&Q([qn,In],r.type)?270:void 0}(r,t,n,i),o=ye(t.orient,gs(n)),u=r.mark,s=r.config;switch(e){case"scale":return r.scaleName(n);case"gridScale":return function(e,t){var n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}(r,n);case"format":if(li(i))return;return mr(i,t.format,s);case"formatType":if(li(i))return;return t.formatType;case"grid":if(vi(r.fieldDef(n).bin))return!1;var l=r.getScaleComponent(n).get("type");return ye(t.grid,function(e,t){return!Zn(e)&&!pi(t.bin)}(l,i));case"labelAlign":return ye(t.labelAlign,ms(a,o));case"labelAngle":return a;case"labelBaseline":return ye(t.labelBaseline,vs(a,o));case"labelFlush":return ye(t.labelFlush,function(e,t){if("x"===t&&Q(["quantitative","temporal"],e.type))return!0}(i,n));case"labelOverlap":var c=r.getScaleComponent(n).get("type");return ye(t.labelOverlap,function(e,t){if("nominal"!==e.type)return"log"!==t||"greedy"}(i,c));case"orient":return o;case"tickCount":var f=r.getScaleComponent(n).get("type"),d="x"===n?"width":"y"===n?"height":void 0,h=d?r.getSizeSignalRef(d):void 0;return ye(t.tickCount,function(e){var t=e.fieldDef,n=e.scaleType,r=e.size;if(!Zn(n)&&"log"!==n&&!Q(["month","hours","day","quarter"],t.timeUnit))return pi(t.bin)?{signal:"ceil(".concat(r.signal,"/10)")}:{signal:"ceil(".concat(r.signal,"/40)")}}({fieldDef:i,scaleType:f,size:h}));case"title":var p="x"===n?"x2":"y2",v=r.fieldDef(p);return ye(t.title,mh(r,n),kr([Tr(i)],v?[Tr(v)]:[]));case"values":return function(e,t,n){var r=e.values;if(r)return fi(n,r)}(t,0,i);case"zindex":return ye(t.zindex,function(e,t){return"rect"===e&&$r(t)?1:0}(u,i))}return Ao[e]?t[e]:void 0}(i,n,e,t);if(void 0!==a){var o=function(e,t,n,r,i){switch(t){case"titleAngle":case"labelAngle":return e===xe(n[t]);case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===mh(r,i))return!0}return e===n[t]}(a,i,n,t,e),u=ps(i,t.config,e,r.get("orient"),t.getScaleComponent(e).get("type"));o||void 0===u?r.set(i,a,o):Q(["grid","orient"],i)&&u&&r.set(i,u,!1)}});var i=n.encoding||{},a=xo.reduce(function(n,a){if(!r.hasAxisPart(a))return n;var o=Tc(i[a]||{},t),u="labels"===a?function(e,t,n){var r=e.fieldDef(t)||("x"===t?e.fieldDef("x2"):"y"===t?e.fieldDef("y2"):void 0),i=e.axis(t),a=e.config,o={};if(li(r)){var u=e.getScaleComponent(t).get("type")===zn.UTC,s=xr("datum.value",r.timeUnit,i.format,a.axis.shortTimeLabels,null,u);s&&(o.text={signal:s})}return o=Object.assign(Object.assign({},o),n),0===oe(o).length?void 0:o}(t,e,o):o;return void 0!==u&&oe(u).length>0&&(n[a]={update:u}),n},{});return oe(a).length>0&&r.set("encode",a,!!n.encoding||void 0!==n.labelAngle),r}function yh(e,t,n,r){var i=r.graticule,a=ze(e)?Object.assign({},e):{type:e},o=a.orient||hr("orient",a,n);return a.orient=function(e,t,n){switch(e){case De:case Me:case je:case Fe:case Ce:case Ae:return}var r=t.x,i=t.y,a=t.x2,o=t.y2;switch(e){case ke:if(Lr(r)&&(vi(r.bin)||Lr(i)&&i.aggregate&&!r.aggregate))return"vertical";if(Lr(i)&&(vi(i.bin)||Lr(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(o||a){if(n)return n;if(!a&&Lr(r)&&r.type===Ln&&!pi(r.bin))return"horizontal";if(!o&&Lr(i)&&i.type===Ln&&!pi(i.bin))return"vertical"}case Oe:if(a&&o)return;case we:if(o)return Lr(i)&&vi(i.bin)?"horizontal":"vertical";if(a)return Lr(r)&&vi(r.bin)?"vertical":"horizontal";if(e===Oe){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case Ee:case _e:var u=Lr(r)&&Yr(r),s=Lr(i)&&Yr(i);if(u&&!s)return"tick"!==e?"horizontal":"vertical";if(!u&&s)return"tick"!==e?"vertical":"horizontal";if(u&&s){var l=r,c=i,f=l.type===Un,d=c.type===Un;return f&&!d?"tick"!==e?"vertical":"horizontal":!f&&d?"tick"!==e?"horizontal":"vertical":!l.aggregate&&c.aggregate?"tick"!==e?"vertical":"horizontal":l.aggregate&&!c.aggregate?"tick"!==e?"horizontal":"vertical":n||"vertical"}return n||void 0}return"vertical"}(a.type,t,o),void 0!==o&&o!==a.orient&&un(rn.orientOverridden(a.orient,o)),void 0===ye(a.opacity,hr("opacity",a,n))&&(a.opacity=function(e,t){if(Q([De,_e,Me,je],e)&&!bi(t))return.7}(a.type,t)),void 0===a.filled&&(a.filled=!i&&function(e,t){var n=hr("filled",e,t),r=e.type;return ye(n,r!==De&&r!==Ee&&r!==Oe)}(a,n)),void 0===(a.cursor||hr("cursor",a,n))&&(a.cursor=function(e,t,n){return t.href||e.href||hr("href",e,n)?"pointer":e.cursor}(a,t,n)),a}function bh(e,t,n){var r=e.config,i=e.encoding,a=e.markDef,o="x"===t?"x2":"y2",u="x"===t?"width":"height",s=i[t],c=i[o],f=e.getScaleComponent(t),d=f?f.get("type"):void 0,h=e.scaleName(t),p=a.orient,v=i[u]||i.size||a[u]||a.size||hr("size",a,r,{vgChannel:u}),m="x"===t?"vertical"===p:"horizontal"===p;return Lr(s)&&(pi(s.bin)||vi(s.bin)||s.timeUnit&&!c)&&!v&&!Zn(d)?function(e){var t,n,r=e.fieldDef,i=e.fieldDef2,a=e.channel,o=e.band,u=e.scaleName,s=e.markDef,c=e.spacing,f=void 0===c?0:c,d=e.reverse,h={x:d?f:0,x2:d?0:f,y:d?0:f,y2:d?f:0},p=a===rt?at:ot;return pi(r.bin)||r.timeUnit?(l(t={},p,Go({channel:a,fieldDef:r,scaleName:u,markDef:s,band:(1-o)/2,offset:h["".concat(a,"2")]})),l(t,a,Go({channel:a,fieldDef:r,scaleName:u,markDef:s,band:1-(1-o)/2,offset:h[a]})),t):vi(r.bin)&&Lr(i)?(l(n={},p,$o(r,u,{},{offset:h["".concat(a,"2")]})),l(n,a,$o(i,u,{},{offset:h[a]})),n):void un(rn.channelRequiredForBinned(p))}({fieldDef:s,fieldDef2:c,channel:t,markDef:a,scaleName:h,band:Br(t,s,void 0,a,r),spacing:ye(a.binSpacing,r[n].binSpacing),reverse:f.get("reverse")}):(Lr(s)&&Zn(d)||m)&&!c?Lr(s)&&d===zn.BAND?function(e,t,n,r){var i,a=n.scaleName(t),o="x"===t?"width":"height";if(n.encoding.size||void 0!==n.markDef.size||r&&void 0!==r.value)if(n.markDef.orient){var u=l({},t+"c",$o(e,a,{},{band:.5}));if(ii(n.encoding.size))return Object.assign(Object.assign({},u),su("size",n,{vgChannel:o}));if(qr(n.encoding.size))return Object.assign(Object.assign({},u),su("size",n,{vgChannel:o}));if(void 0!==n.markDef.size)return Object.assign(Object.assign({},u),l({},o,{value:n.markDef.size}));if(r&&void 0!==r.value)return Object.assign(Object.assign({},u),l({},o,r))}else un(rn.cannotApplySizeToNonOrientedMark(n.markDef.type));var s=e.band,c=void 0===s?1:s;return l(i={},t,$o(e,a,{binSuffix:"range"},{band:(1-c)/2})),l(i,o,r||Yo(a,c)),i}(s,t,e,xh(n,a,u,h,f,r,Hr(s)?s.band:void 0)):function(e,t,n,r){var i="x"===e?"xc":"yc",a="x"===e?"width":"height";return Object.assign(Object.assign({},du(e,t,n,{vgChannel:i})),su("size",t,{defaultRef:r,vgChannel:a}))}(t,e,eu(e[u]),xh(n,a,u,h,f,r)):mu(t,e,{defaultRef:"zeroOrMax",defaultRef2:"zeroOrMin"})}function xh(e,t,n,r,i,a,o){var u=ye(t[n],t.size,hr("size",t,a,{vgChannel:n}));if(void 0!==u)return{value:u};if(i){var s=i.get("type");if("point"===s||"band"===s){if(void 0!==a[e].discreteBandSize)return{value:a[e].discreteBandSize};if(s===zn.POINT){var l=i.get("range");return mo(l)&&T(l.step)?{value:l.step-2}:{value:da-2}}return Yo(r,o)}return{value:a[e].continuousBandSize}}var c=ca(a.view,n);return{value:ye(a[e].discreteBandSize,c-2)}}function wh(e,t){e.config;var n=e.width,r=e.height;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ru(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore"})),du("x",e,eu(n))),du("y",e,eu(r))),su("size",e)),function(e,t,n){return n?{shape:{value:n}}:su("shape",e)}(e,0,t))}function kh(e){var t=e.config,n=e.markDef,r=n.orient,i="horizontal"===r?"width":"height",a=e.getScaleComponent("horizontal"===r?"x":"y"),o=ye(n[i],n.size,hr("size",n,t,{vgChannel:i}),t.tick.bandSize);if(void 0!==o)return o;var u=a?a.get("range"):void 0;return u&&mo(u)&&T(u.step)?3*u.step/4:3*ca(t.view,i)/4}var Ah={area:{vgMark:"area",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign({},ru(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore"})),vu("x",e,{defaultRef:"zeroOrMin",defaultRef2:"zeroOrMin",range:"horizontal"===e.markDef.orient})),vu("y",e,{defaultRef:"zeroOrMin",defaultRef2:"zeroOrMin",range:"vertical"===e.markDef.orient})),uu(e))}},bar:{vgMark:"rect",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign({},ru(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore"})),bh(e,"x","bar")),bh(e,"y","bar"))}},circle:{vgMark:"symbol",encodeEntry:function(e){return wh(e,"circle")}},geoshape:{vgMark:"shape",encodeEntry:function(e){return Object.assign({},ru(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore"}))},postEncodingTransform:function(e){var t=e.encoding.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},t&&Lr(t)&&t.type===Wn?{field:Gr(t,{expr:"datum"})}:{})]}},image:{vgMark:"image",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign({},ru(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore"})),bh(e,"x","image")),bh(e,"y","image")),fu(e,"url"))}},line:{vgMark:"line",encodeEntry:function(e){var t=e.width,n=e.height;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ru(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore"})),du("x",e,eu(t))),du("y",e,eu(n))),su("size",e,{vgChannel:"strokeWidth"})),uu(e))}},point:{vgMark:"symbol",encodeEntry:function(e){return wh(e)}},rect:{vgMark:"rect",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign({},ru(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore"})),bh(e,"x","rect")),bh(e,"y","rect"))}},rule:{vgMark:"rule",encodeEntry:function(e){var t=e.markDef,n=e.width,r=e.height,i=t.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},ru(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore"})),vu("x",e,{defaultRef:"horizontal"===i?"zeroOrMin":eu(n),defaultRef2:"zeroOrMax",range:"vertical"!==i})),vu("y",e,{defaultRef:"vertical"===i?"zeroOrMin":eu(r),defaultRef2:"zeroOrMax",range:"horizontal"!==i})),su("size",e,{vgChannel:"strokeWidth"})):{}}},square:{vgMark:"symbol",encodeEntry:function(e){return wh(e,"square")}},text:{vgMark:"text",encodeEntry:function(e){var t=e.config,n=(e.encoding,e.width),r=e.height;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ru(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore"})),du("x",e,eu(n))),du("y",e,eu(r))),fu(e)),su("size",e,{vgChannel:"fontSize"})),au("align",function(e,t,n){if(void 0===(e.align||hr("align",e,n)))return"center"}(e.markDef,0,t))),au("baseline",function(e,t,n){if(void 0===(e.baseline||hr("baseline",e,n)))return"middle"}(e.markDef,0,t)))}},tick:{vgMark:"rect",encodeEntry:function(e){var t=e.config,n=e.markDef,r=e.width,i=e.height,a=n.orient,o="horizontal"===a?"width":"height",u="horizontal"===a?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ru(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore"})),du("x",e,eu(r),{vgChannel:"xc"})),du("y",e,eu(i),{vgChannel:"yc"})),su("size",e,{defaultValue:kh(e),vgChannel:o})),l({},u,{value:ye(n.thickness,t.tick.thickness)}))}},trail:{vgMark:"trail",encodeEntry:function(e){var t=e.width,n=e.height;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ru(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore"})),du("x",e,eu(t))),du("y",e,eu(n))),su("size",e)),uu(e))}}};function Eh(e){return Q([Ee,we,Se],e.mark)?function(e){var t=Di(e.mark,e.encoding),n=Ch(e,{fromPrefix:t.length>0?Dh:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:Dh+e.requestDataName(Ya),data:e.requestDataName(Ya),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}(e):Ch(e)}var Dh="faceted_path_";function Ch(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fromPrefix:""},n=e.mark,r=ye(e.markDef.clip,function(e){var t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!!(t&&t.get("domainRaw")||n&&n.get("domainRaw"))||void 0}(e),function(e){var t=e.component.projection;return!(!t||t.isFit)||void 0}(e)),i=fr(e.markDef),a=e.encoding.key,o=function(e){var t=e.encoding,n=e.stack,r=e.mark,i=e.markDef,a=e.config,o=t.order;if(!(!g(o)&&qr(o)&&J(o.value)||!o&&J(i.order)||J(hr("order",i,a)))){if((g(o)||Lr(o))&&!n)return wr(o,{expr:"datum"});if(Ne(r)){var u="horizontal"===i.orient?"y":"x",s=t[u];if(Lr(s)){var l=s.sort;return g(l)?{field:Gr(s,{prefix:u,suffix:"sort_index",expr:"datum"})}:_r(l)?{field:Gr({aggregate:bi(e.encoding)?l.op:void 0,field:l.field},{expr:"datum"})}:Fr(l)?{field:Gr(e.fieldDef(l.encoding),{expr:"datum"}),order:l.order}:{field:Gr(s,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}}}}(e),u=Ah[n].postEncodingTransform?Ah[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:Ah[n].vgMark},r?{clip:!0}:{}),i?{style:i}:{}),a?{key:a.field}:{}),o?{sort:o}:{}),{from:{data:t.fromPrefix+e.requestDataName(Ya)},encode:{update:Ah[n].encodeEntry(e)}}),u?{transform:u}:{})]}var Oh=function(e){function t(e,n,r){var i,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0;c(this,t),(i=a(this,o(t).call(this,e,"unit",n,r,l,s,void 0,e.view))).specifiedScales={},i.specifiedAxes={},i.specifiedLegends={},i.specifiedProjection={},i.selection={},i.children=[];var f=ze(e.mark)?e.mark.type:e.mark,d=function(e,t){return rh(e,t)}(e.encoding||{},s);i.markDef=yh(e.mark,d,l,{graticule:e.data&&$a(e.data)});var h=i.encoding=wi(d,i.markDef);return i.size=function(e){var t=e.encoding,n=e.size,r=!0,i=!1,a=void 0;try{for(var o,u=Vt[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,l=Gt(s),c=ri(t[s]);oa(n[l])&&c&&Yr(c)&&(delete n[l],un(rn.stepDropped(l)))}}catch(f){i=!0,a=f}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return n}({encoding:h,size:Object.assign(Object.assign(Object.assign({},u),e.width?{width:e.width}:{}),e.height?{height:e.height}:{})}),i.stack=Da(f,h),i.specifiedScales=i.initScales(f,h),i.specifiedAxes=i.initAxes(h),i.specifiedLegends=i.initLegend(h),i.specifiedProjection=e.projection,i.selection=e.selection,i}return s(t,Od),f(t,[{key:"scaleDomain",value:function(e){var t=this.specifiedScales[e];return t?t.domain:void 0}},{key:"axis",value:function(e){return this.specifiedAxes[e]}},{key:"legend",value:function(e){return this.specifiedLegends[e]}},{key:"initScales",value:function(e,t){return Qt.reduce(function(e,n){var r,i,a=t[n];return Lr(a)?(r=a,i=a.scale):Pr(a)&&(r=a.condition,i=a.condition.scale),r&&(e[n]=i||{}),e},{})}},{key:"initAxes",value:function(e){return[rt,it].reduce(function(t,n){var r=e[n];if(Lr(r)||n===rt&&Lr(e.x2)||n===it&&Lr(e.y2)){var i=Lr(r)?r.axis:null;null!==i&&(t[n]=Object.assign({},i))}return t},{})}},{key:"initLegend",value:function(e){return Xt.reduce(function(t,n){var r=e[n];if(r){var i=Lr(r)?r.legend:Pr(r)?r.condition.legend:null;null!==i&&!1!==i&&function(e){switch(e){case ft:case dt:case ht:case vt:case pt:case mt:case bt:return!0;case gt:case yt:return!1}}(n)&&(t[n]=Object.assign({},i))}return t},{})}},{key:"parseData",value:function(){this.component.data=uh(this)}},{key:"parseLayoutSize",value:function(){!function(e){var t=e.size,n=e.component,r=!0,i=!1,a=void 0;try{for(var o,u=Vt[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=Gt(o.value);if(t[s]){var l=t[s];n.layoutSize.set(s,oa(l)?"step":l,!0)}else{var c=Zd(e,s);n.layoutSize.set(s,c,!1)}}}catch(f){i=!0,a=f}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}}(this)}},{key:"parseSelections",value:function(){this.component.selection=function(e,t){var n={},r=e.config.selection,i=function(i){if(!M(t,i))return a=i,"continue";var o=V(t[i]),u=He(r[o.type],["fields","encodings"]);for(var s in u)"encodings"===s&&o.fields||"fields"===s&&o.encodings||("mark"===s&&(o[s]=Object.assign(Object.assign({},u[s]),o[s])),void 0!==o[s]&&!0!==o[s]||(o[s]=u[s]||o[s]));i=le(i);var l=n[i]=Object.assign(Object.assign({},o),{name:i,events:b(o.on)?Eo(o.on,"scope"):o.on});Lu(l,function(n){n.parse&&n.parse(e,l,o,t[i])}),a=i};for(var a in t)i(a);return n}(this,this.selection)}},{key:"parseMarkGroup",value:function(){this.component.mark=Eh(this)}},{key:"parseAxesAndHeaders",value:function(){var e;this.component.axes=(e=this,Vt.reduce(function(t,n){return e.component.scales[n]&&e.axis(n)&&(t[n]=[gh(n,e)]),t},{}))}},{key:"assembleSelectionTopLevelSignals",value:function(e){return function(e,t){var n=!1;return ns(e,function(r,i){var a=r.name,o=x(a+Ju);t.filter(function(e){return e.name===a}).length||t.push({name:r.name,update:"".concat(es,"(").concat(o)+("global"===r.resolve?")":", ".concat(x(r.resolve),")"))}),n=!0,i.topLevelSignals&&(t=i.topLevelSignals(e,r,t)),Lu(r,function(n){n.topLevelSignals&&(t=n.topLevelSignals(e,r,t))})}),n&&(t.filter(function(e){return"unit"===e.name}).length||t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})),qu(t)}(this,e)}},{key:"assembleSignals",value:function(){return[].concat(h(ls(this)),h((t=[],ns(e=this,function(n,r){var i,a=n.name,o=r.modifyExpr(e,n);(i=t).push.apply(i,h(r.signals(e,n))),Lu(n,function(r){r.signals&&(t=r.signals(e,n,t)),r.modifyExpr&&(o=r.modifyExpr(e,n,o))}),t.push({name:a+Ku,update:"modify(".concat(x(n.name+Ju),", ").concat(o,")")})}),qu(t))));var e,t}},{key:"assembleSelectionData",value:function(e){return function(e,t){var n=h(t);return ns(e,function(t){var r={name:t.name+Ju};if(t.init){var i=t.project.items.map(function(e){return He(e,["signals"])}),a=t.init.map(function(e){return Iu(e,!1)});r.values="interval"===t.type?[{unit:rs(e,{escape:!1}),fields:i,values:a}]:a.map(function(t){return{unit:rs(e,{escape:!1}),fields:i,values:t}})}n.filter(function(e){return e.name===t.name+Ju}).length||n.push(r)}),n}(this,e)}},{key:"assembleLayout",value:function(){return null}},{key:"assembleLayoutSignals",value:function(){return _c(this)}},{key:"assembleMarks",value:function(){var e=this.component.mark||[];return this.parent&&Dd(this.parent)||(e=Uu(this,e)),e.map(this.correctDataNames)}},{key:"getMapping",value:function(){return this.encoding}},{key:"channelHasField",value:function(e){return yi(this.encoding,e)}},{key:"fieldDef",value:function(e){return ii(this.encoding[e])}},{key:"hasProjection",get:function(){var e=this.encoding,t=this.mark===Te,n=e&&Ft.some(function(t){return Lr(e[t])});return t||n}},{key:"mark",get:function(){return this.markDef.type}}]),t}(),Fh=function(e){function t(e,n,i,u,s,l){var f;c(this,t),f=a(this,o(t).call(this,e,"layer",n,i,l,s,e.resolve,e.view));var d=Object.assign(Object.assign(Object.assign({},u),e.width?{width:e.width}:{}),e.height?{height:e.height}:{});return f.children=e.layer.map(function(e,n){if(xa(e))return new t(e,r(f),f.getName("layer_"+n),d,s,l);if(qe(e))return new Oh(e,r(f),f.getName("layer_"+n),d,s,l);throw new Error(rn.invalidSpec(e))}),f}return s(t,Cd),f(t,[{key:"parseData",value:function(){this.component.data=uh(this);var e=!0,t=!1,n=void 0;try{for(var r,i=this.children[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)r.value.parseData()}catch(a){t=!0,n=a}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"parseLayoutSize",value:function(){Yd(this)}},{key:"parseSelections",value:function(){var e=this;this.component.selection={};var t=!0,n=!1,r=void 0;try{for(var i,a=function(){var t=i.value;t.parseSelections(),oe(t.component.selection).forEach(function(n){e.component.selection[n]=t.component.selection[n]})},o=this.children[Symbol.iterator]();!(t=(i=o.next()).done);t=!0)a()}catch(u){n=!0,r=u}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}},{key:"parseMarkGroup",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this.children[Symbol.iterator]();!(e=(r=i.next()).done);e=!0)r.value.parseMarkGroup()}catch(a){t=!0,n=a}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}}},{key:"parseAxesAndHeaders",value:function(){!function(e){var t=e.component,n=t.axes,r=t.resolve,i={top:0,bottom:0,right:0,left:0},a=!0,o=!1,u=void 0;try{for(var s,l=e.children[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var c=s.value;c.parseAxesAndHeaders();var f=!0,d=!1,h=void 0;try{for(var p,v=oe(c.component.axes)[Symbol.iterator]();!(f=(p=v.next()).done);f=!0){var m=p.value;r.axis[m]=Nc(e.component.resolve,m),"shared"===r.axis[m]&&(n[m]=ph(n[m],c.component.axes[m]),n[m]||(r.axis[m]="independent",delete n[m]))}}catch(q){d=!0,h=q}finally{try{f||null==v.return||v.return()}finally{if(d)throw h}}}}catch(q){o=!0,u=q}finally{try{a||null==l.return||l.return()}finally{if(o)throw u}}for(var g=0,y=[rt,it];g<y.length;g++){var b=y[g],x=!0,w=!1,k=void 0;try{for(var A,E=e.children[Symbol.iterator]();!(x=(A=E.next()).done);x=!0){var D=A.value;if(D.component.axes[b]){if("independent"===r.axis[b]){n[b]=(n[b]||[]).concat(D.component.axes[b]);var C=!0,O=!1,F=void 0;try{for(var _,S=D.component.axes[b][Symbol.iterator]();!(C=(_=S.next()).done);C=!0){var M=_.value,j=M.getWithExplicit("orient"),T=j.value,N=j.explicit;if(i[T]>0&&!N){var B=hh[T];i[T]>i[B]&&M.set("orient",B,!1)}i[T]++}}catch(q){O=!0,F=q}finally{try{C||null==S.return||S.return()}finally{if(O)throw F}}}delete D.component.axes[b]}}}catch(q){w=!0,k=q}finally{try{x||null==E.return||E.return()}finally{if(w)throw k}}if("independent"===r.axis[b]&&n[b]&&n[b].length>1){var R=!0,z=!1,P=void 0;try{for(var L,I=n[b][Symbol.iterator]();!(R=(L=I.next()).done);R=!0){var U=L.value;U.get("grid")&&!U.explicit.grid&&(U.implicit.grid=!1)}}catch(q){z=!0,P=q}finally{try{R||null==I.return||I.return()}finally{if(z)throw P}}}}}(this)}},{key:"assembleSelectionTopLevelSignals",value:function(e){return this.children.reduce(function(e,t){return t.assembleSelectionTopLevelSignals(e)},e)}},{key:"assembleSignals",value:function(){return this.children.reduce(function(e,t){return e.concat(t.assembleSignals())},ls(this))}},{key:"assembleLayoutSignals",value:function(){return this.children.reduce(function(e,t){return e.concat(t.assembleLayoutSignals())},_c(this))}},{key:"assembleSelectionData",value:function(e){return this.children.reduce(function(e,t){return t.assembleSelectionData(e)},e)}},{key:"assembleTitle",value:function(){var e=u(o(t.prototype),"assembleTitle",this).call(this);if(e)return e;var n=!0,r=!1,i=void 0;try{for(var a,s=this.children[Symbol.iterator]();!(n=(a=s.next()).done);n=!0)if(e=a.value.assembleTitle())return e}catch(l){r=!0,i=l}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}},{key:"assembleLayout",value:function(){return null}},{key:"assembleMarks",value:function(){return function(e,t){var n=!0,r=!1,i=void 0;try{for(var a,o=e.children[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var u=a.value;wd(u)&&(t=Uu(u,t))}}catch(s){r=!0,i=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}return t}(this,this.children.flatMap(function(e){return e.assembleMarks()}))}},{key:"assembleLegends",value:function(){return this.children.reduce(function(e,t){return e.concat(t.assembleLegends())},rf(this))}}]),t}(),_h=function(e){function t(e,n,r,i,u){var s;return c(this,t),s=a(this,o(t).call(this,e,"repeat",n,r,u,i,e.resolve)),e.resolve&&e.resolve.axis&&("shared"===e.resolve.axis.x||"shared"===e.resolve.axis.y)&&un(rn.REPEAT_CANNOT_SHARE_AXIS),s.repeat=e.repeat,s.children=s._initChildren(e,s.repeat,i,u),s}return s(t,sh),f(t,[{key:"_initChildren",value:function(e,t,n,r){var i=[],a=!g(t)&&t.row||[n?n.row:null],o=!g(t)&&t.column||[n?n.column:null],u=g(t)&&t||[n?n.repeat:null],s=!0,l=!1,c=void 0;try{for(var f,d=u[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var h=f.value,p=!0,v=!1,m=void 0;try{for(var y,b=a[Symbol.iterator]();!(p=(y=b.next()).done);p=!0){var x=y.value,w=!0,k=!1,A=void 0;try{for(var E,D=o[Symbol.iterator]();!(w=(E=D.next()).done);w=!0){var C=E.value,O=(h?"__repeat_repeat_".concat(h):"")+(x?"__repeat_row_".concat(x):"")+(C?"__repeat_column_".concat(C):""),F={repeat:h,row:x,column:C};i.push(Sh(e.spec,this,this.getName("child"+O),void 0,F,r))}}catch(_){k=!0,A=_}finally{try{w||null==D.return||D.return()}finally{if(k)throw A}}}}catch(_){v=!0,m=_}finally{try{p||null==b.return||b.return()}finally{if(v)throw m}}}}catch(_){l=!0,c=_}finally{try{s||null==d.return||d.return()}finally{if(l)throw c}}return i}},{key:"parseLayoutSize",value:function(){Xd(this)}},{key:"assembleDefaultLayout",value:function(){var e=this.repeat,t=g(e)?void 0:e.column?e.column.length:1;return Object.assign(Object.assign({},t?{columns:t}:{}),{bounds:"full",align:"all"})}}]),t}();function Sh(e,t,n,r,i,a){if(jr(e))return new ah(e,t,n,i,a);if(xa(e))return new Fh(e,t,n,r,i,a);if(qe(e))return new Oh(e,t,n,r,i,a);if(aa(e))return new _h(e,t,n,i,a);if(function(e){return ra(e)||ia(e)||na(e)}(e))return new lh(e,t,n,i,a);throw new Error(rn.invalidSpec(e))}var Mh=new(function(e){function t(){return c(this,t),a(this,o(t).apply(this,arguments))}return s(t,wa),f(t,[{key:"mapUnit",value:function(e,t){var n=t.config;if(e.encoding){var r=e.encoding,i=e.transform,a=xi(r,n),o=a.bins,u=a.timeUnits,s=a.aggregate,l=a.groupby,c=a.encoding,f=[].concat(h(i||[]),h(o),h(u),h(s.length?[{aggregate:s,groupby:l}]:[]));return Object.assign(Object.assign(Object.assign({},e),f.length>0?{transform:f}:{}),{encoding:c})}return e}}]),t}()),jh=n;t.compile=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n.logger&&(t=n.logger,on=t),n.fieldTitle&&Kr(n.fieldTitle);try{var r=pa(ee({},n.config,e.config)),i=Ba(e,r),a=Sh(i,null,"",void 0,void 0,r);return a.parse(),function(e,t){vf(e.sources);for(var n=0,r=0,i=0;i<Gf&&Jf(e,t);i++)n++;e.sources.map(Lf);for(var a=0;a<Gf&&Jf(e,t);a++)r++;vf(e.sources),Math.max(n,r)===Gf&&un("Maximum optimization runs(".concat(Gf,") reached."))}(a.component.data,a),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0,i=e.config?ya(e.config):void 0,a=[].concat(e.assembleSelectionData([]),function(e,t){var n=[],r=Wd(n),i=0;e.sources.forEach(function(e){e.hasName()||(e.dataName="source_".concat(i++));var t=e.assemble();r(e,t)}),n.forEach(function(e){0===e.transform.length&&delete e.transform});var a=0,o=!0,u=!1,s=void 0;try{for(var l,c=n.entries()[Symbol.iterator]();!(o=(l=c.next()).done);o=!0){var f=l.value,h=d(f,2),p=h[0],v=h[1];0!==(v.transform||[]).length||v.source||n.splice(a++,0,n.splice(p,1)[0])}}catch(F){u=!0,s=F}finally{try{o||null==c.return||c.return()}finally{if(u)throw s}}for(var m=0,g=n;m<g.length;m++){var y=g[m],b=!0,x=!1,w=void 0;try{for(var k,A=(y.transform||[])[Symbol.iterator]();!(b=(k=A.next()).done);b=!0){var E=k.value;"lookup"===E.type&&(E.from=e.outputNodes[E.from].getSource())}}catch(F){x=!0,w=F}finally{try{b||null==A.return||A.return()}finally{if(x)throw w}}}for(var D=0,C=n;D<C.length;D++){var O=C[D];O.name in t&&(O.values=t[O.name])}return n}(e.component.data,n)),o=e.assembleProjections(),u=e.assembleTitle(),s=e.assembleGroupStyle(),l=e.assembleGroupEncodeEntry(!0),c=e.assembleLayoutSignals();return c=c.filter(function(e){return"width"!==e.name&&"height"!==e.name||void 0===e.value||(t[e.name]=+e.value,!1)}),{spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),u?{title:u}:{}),s?{style:s}:{}),l?{encode:{update:l}}:{}),{data:a}),o.length>0?{projections:o}:{}),e.assembleGroup([].concat(h(c),h(e.assembleSelectionTopLevelSignals([]))))),i?{config:i}:{}),r?{usermeta:r}:{})}}(a,function(e,t,n,r){var i,a=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(b(t)&&(t={type:t}),a&&o&&("fit"===(i=t.type)||"fit-x"===i||"fit-y"===i))if("step"===a&&"step"===o)un(rn.droppingFit()),t.type="pad";else if("step"===a||"step"===o){var u="step"===a?"width":"height";un(rn.droppingFit($t(u)));var s="width"===u?"height":"width";t.type=function(e){return e?"fit-".concat($t(e)):"fit"}(s)}return Object.assign(Object.assign(Object.assign({},1===oe(t).length&&t.type?"pad"===t.type?{}:{autosize:t.type}:{autosize:t}),Ia(n)),Ia(e))}(e,i.autosize,r,a),e.datasets,e.usermeta)}finally{n.logger&&(on=an),n.fieldTitle&&Kr(Jr)}},t.extractTransforms=function(e,t){return Mh.map(e,{config:t})},t.normalize=Ba,t.version=jh,Object.defineProperty(t,"__esModule",{value:!0})}(t)}).call(this,n(60).Buffer)},2898:function(e,t,n){var r=n(595),i=n(597),a=n(596);e.exports=function(e){return r(e)||i(e)||a()}}}]);
//# sourceMappingURL=11.9f064317.chunk.js.map